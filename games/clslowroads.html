

<!-- Ultimate Game Stash file--> 
<!-- For the regularly updating doc go to https://docs.google.com/document/d/1_FmH3BlSBQI7FGgAQL59-ZPe8eCxs35wel6JUyVaG8Q/ -->



<html lang="en"><head><script src="https://s0.2mdn.net/instream/video/client.js" async="" type="text/javascript"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" id="analytics" async="" src=""></script><script type="text/javascript" async="" src="https://imasdk.googleapis.com/js/sdkloader/ima3.js"></script><script id="gamemonetize-sdk" src=""></script><script src="//www.google.com/jsapi"></script><script>window.parent.maeExportApis_();</script>


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="#ffffff">
    <script src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/alea.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/css/main.ac3cb8b3.chunk.css" rel="stylesheet">
<style type="text/css">#button {
  display:none;
}
.imgb_vis {
  animation: imgb-animation 7s linear;
}
@keyframes imgb-animation {
  10% {
    transform: translateX(0);
  }
  20% {
    transform: translateX(100px);
  }
  90% {
    transform: translateX(100px);
  }
  100% {
    transform: translateX(0);
  }
}</style><meta http-equiv="origin-trial" content="A9AxgGSwmnfgzzkyJHILUr3H8nJ/3D+57oAsL4DBt4USlng4jZ0weq+fZtHC/Qwwn6gd4QSa5DzT3OBif+kXVA0AAAB4eyJvcmlnaW4iOiJodHRwczovL2ltYXNkay5nb29nbGVhcGlzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="></head>

<body><noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"><div class="App"><div id="game-main" tabindex="1" class="render-panel"><div id="update-alert"><div class="update-alert-title">New version available!</div>Update with a hard refresh<br>(CTRL + F5)</div><div id="game-ui" style="display: block;"><div id="control-prompt" style="opacity: 0;"></div><div id="achievement" class=""></div><div id="ui-mouse" style="bottom: calc(25px + 24vh); display: none;"><div id="ui-mouse-prompt">[ click to begin ]</div><div id="ui-mouse-input"><div class="ui-mouse-bar"><div class="ui-mouse-bar-line"></div><div class="ui-mouse-bar-midline"></div></div><div id="ui-mouse-bar-marker"><div class="ui-mouse-bar-marker-tick"></div></div></div><div class="ui-mouse-bar-boundary"></div><div class="ui-mouse-reset">reset</div></div><div id="game-paused" style="display: block;"><div class="game-paused-main">PAUSED</div></div> <div id="autodrive" class=""><div class="autodrive-bar autodrive-bar-left"></div><div id="autodrive-button">autodrive off</div><div class="autodrive-bar autodrive-bar-right"></div></div><div id="menu-bar"><div id="menu-bar-left"><div class="menu-item" tabindex="-1"><img class="menu-icon" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/globe.0021026f.svg" alt="" width="50%"></div><div class="menu-bar-vertical-divider"></div><div class="menu-item" tabindex="-1"><img class="menu-icon" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/panorama.568dc952.svg" alt="" width="50%"></div><div class="menu-item" tabindex="-1"><img class="menu-icon" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/v_config_1.45a9fb9a.svg" alt="" width="50%"></div></div><div id="menu-bar-right"><a href="https://ko-fi.com/slowroads" target="_blank" rel="noreferrer" title="Support development on Ko-fi!" class="menu-item" style="padding: 0px 12px; width: auto; text-align: right; display: flex;"><img alt="" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/ico_kofi.0dd3be2c.svg" style="height: 50%; margin-top: 25px; margin-right: 8px; transform: translateY(-50%);"><div style="font-size: 14px; color: rgb(255, 255, 255);">donate</div></a><div class="menu-item" tabindex="-1"><img class="menu-icon" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/controls.0048d852.svg" alt="" width="50%"></div><div class="menu-item" tabindex="-1"><img class="menu-icon" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/vol_high.30de055e.svg" alt="" width="50%"></div><div class="menu-item" style="padding: 0px 12px; width: auto; text-align: right; display: flex;"><img alt="" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/feedback2.24052523.svg" style="height: 50%; margin-top: 25px; margin-right: 4px; transform: translateY(-50%);"></div><div class="menu-item" tabindex="-1"><img class="menu-icon" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/config.fa1e0797.svg" alt="" width="50%"></div><div class="menu-bar-vertical-divider"></div><div class="menu-item"><img class="menu-icon" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/favicon_circle_white.eb1953e3.svg" alt="" width="50%"></div></div></div><div id="main-stats"><div id="ui-dist" class="ui-stat"><span id="ui-dist-val" class="ui-stat-val">0.0</span><div class="ui-stat-unit">miles</div><div id="ui-dist-reset"><img id="ui-dist-reset-icon" alt="" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/refresh.56c65653.svg"></div></div><div class="ui-stat-spacer"></div><div id="ui-speed" class="ui-stat"><span id="ui-speed-val" class="ui-stat-val">0.0</span><div class="ui-stat-unit">mph</div><div id="ui-cruise-controls"><img id="ui-cruise-toggle" title="Toggle cruise control" alt="" src="https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/static/media/lock_open.2037b97e.svg"></div></div></div><div id="upcoming-container" style="opacity: 1;"><svg viewBox="0 0 160 120" width="100%" height="100%"><g transform="translate(80 96) scale(-0.5 -0.5)"><polyline points="-0.615968 49.9882 -0.650948 50.6123 -0.685928 51.2363 -0.720908 51.8603 -0.755888 52.4843 -0.790868 53.1083 -0.825848 53.7323 -0.860828 54.3564 -0.895809 54.9804 -0.930789 55.6044 -0.965769 56.2284 -1.00075 56.8525 -1.03573 57.4765 -1.07071 58.1005 -1.10569 58.7245 -1.14067 59.3485 -1.17565 59.9726 -1.20949 60.5966 -1.24334 61.2207 -1.27718 61.8448 -1.31102 62.4689 -1.34487 63.093 -1.37871 63.717 -1.41255 64.3411 -1.4464 64.9652 -1.48024 65.5893 -1.51408 66.2134 -1.54793 66.8374 -1.58177 67.4615 -1.61561 68.0856 -1.64946 68.7097 -1.6833 69.3338 -1.71714 69.9579 -1.71975 70.5821 -1.72236 71.2064 -1.72497 71.8307 -1.72758 72.455 -1.73019 73.0793 -1.7328 73.7035 -1.73541 74.3278 -1.73802 74.9521 -1.74063 75.5764 -1.74323 76.2007 -1.74584 76.8249 -1.74845 77.4492 -1.75106 78.0735 -1.75367 78.6978 -1.75628 79.3221 -1.75889 79.9464 -1.68423 80.565 -1.60957 81.1837 -1.53491 81.8024 -1.46026 82.4211 -1.3856 83.0398 -1.31094 83.6585 -1.23628 84.2771 -1.16162 84.8958 -1.08697 85.5145 -1.01231 86.1332 -0.937649 86.7519 -0.862991 87.3706 -0.788333 87.9893 -0.713674 88.6079 -0.639016 89.2266 -0.564358 89.8453 -0.401291 90.4472 -0.238225 91.049 -0.0751582 91.6509 0.0879084 92.2527 0.250975 92.8546 0.414042 93.4564 0.577108 94.0583 0.740175 94.6601 0.903241 95.262 1.06631 95.8639 1.22937 96.4657 1.39244 97.0676 1.55551 97.6694 1.71857 98.2713 1.88164 98.8731 2.04471 99.475 2.30378 100.041 2.56284 100.606 2.82191 101.172 3.08098 101.737 3.34005 102.303 3.59912 102.868 3.85818 103.434 4.11725 103.999 4.37632 104.565 4.63539 105.131 4.89446 105.696 5.15352 106.262 5.41259 106.827 5.67166 107.393 5.93073 107.958 6.1898 108.524 6.56542 109.017 6.94105 109.511 7.31668 110.004 7.6923 110.498 8.06793 110.991 8.44356 111.485 8.81918 111.978 9.19481 112.472 9.57043 112.965 9.94606 113.459 10.3217 113.952 10.6973 114.446 11.0729 114.939 11.4486 115.433 11.8242 115.926 12.1998 116.42 12.6675 116.832 13.1351 117.244 13.6028 117.656 14.0704 118.068 14.5381 118.48 15.0058 118.892 15.4734 119.304 15.9411 119.716 16.4087 120.128 16.8764 120.541 17.344 120.953 17.8117 121.365 18.2794 121.777 18.747 122.189 19.2147 122.601 19.6823 123.013 20.1753 123.397 20.6684 123.781 21.1614 124.165 21.6544 124.549 22.1474 124.933 22.6404 125.317 23.1334 125.701 23.6264 126.085 24.1194 126.469 24.6124 126.853 25.1054 127.238 25.5984 127.622 26.0914 128.006 26.5844 128.39 27.0774 128.774 27.5705 129.158 28.0418 129.567 28.5132 129.977 28.9846 130.387 29.456 130.796 29.9274 131.206 30.3988 131.615 30.8702 132.025 31.3416 132.435 31.813 132.844 32.2844 133.254 32.7558 133.664 33.2272 134.073 33.6986 134.483 34.17 134.892 34.6414 135.302 35.1128 135.712 35.5321 136.173 35.9514 136.633 36.3707 137.094 36.7901 137.555 37.2094 138.016 37.6287 138.477 38.0481 138.938 38.4674 139.399 38.8867 139.86 39.3061 140.321 39.7254 140.782 40.1447 141.243 40.564 141.704 40.9834 142.165 41.4027 142.626 41.822 143.087 42.1727 143.603 42.5234 144.118 42.874 144.634 43.2247 145.15 43.5754 145.666 43.926 146.182 44.2767 146.697 44.6273 147.213 44.978 147.729 45.3287 148.245 45.6793 148.761 46.03 149.276 46.3807 149.792 46.7313 150.308 47.082 150.824 47.4326 151.34 47.7279 151.89 48.0231 152.44 48.3183 152.991 48.6135 153.541 48.9088 154.091 49.204 154.641 49.4992 155.192 49.7944 155.742 50.0896 156.292 50.3849 156.843 50.6801 157.393 50.9753 157.943 51.2705 158.494 51.5657 159.044 51.861 159.594 52.1562 160.144 52.4102 160.715 52.6642 161.286 52.9182 161.856 53.1723 162.427 53.4263 162.998 53.6803 163.569 53.9343 164.139 54.1884 164.71 54.4424 165.281 54.6964 165.851 54.9504 166.422 55.2044 166.993 55.4585 167.563 55.7125 168.134 55.9665 168.705 56.2205 169.275 56.4347 169.862 56.6489 170.449 56.8632 171.035 57.0774 171.622 57.2916 172.209 57.5058 172.796 57.72 173.382 57.9342 173.969 58.1484 174.556 58.3627 175.142 58.5769 175.729 58.7911 176.316 59.0053 176.903 59.2195 177.489 59.4337 178.076 59.648 178.663 59.8181 179.264 59.9883 179.865 60.1585 180.466 60.3287 181.066 60.4988 181.667 60.669 182.268 60.8392 182.869 61.0094 183.47 61.1795 184.071 61.3497 184.672 61.5199 185.273 61.6901 185.874 61.8602 186.475 62.0304 187.076 62.2006 187.676" transform="rotate(-3.186987082019371) translate(0.6159675218736893 -49.988229292517744)" stroke="#2224" stroke-width="24" stroke-linecap="round" fill="none"></polyline><polyline points="-0.615968 49.9882 -0.650948 50.6123 -0.685928 51.2363 -0.720908 51.8603 -0.755888 52.4843 -0.790868 53.1083 -0.825848 53.7323 -0.860828 54.3564 -0.895809 54.9804 -0.930789 55.6044 -0.965769 56.2284 -1.00075 56.8525 -1.03573 57.4765 -1.07071 58.1005 -1.10569 58.7245 -1.14067 59.3485 -1.17565 59.9726 -1.20949 60.5966 -1.24334 61.2207 -1.27718 61.8448 -1.31102 62.4689 -1.34487 63.093 -1.37871 63.717 -1.41255 64.3411 -1.4464 64.9652 -1.48024 65.5893 -1.51408 66.2134 -1.54793 66.8374 -1.58177 67.4615 -1.61561 68.0856 -1.64946 68.7097 -1.6833 69.3338 -1.71714 69.9579 -1.71975 70.5821 -1.72236 71.2064 -1.72497 71.8307 -1.72758 72.455 -1.73019 73.0793 -1.7328 73.7035 -1.73541 74.3278 -1.73802 74.9521 -1.74063 75.5764 -1.74323 76.2007 -1.74584 76.8249 -1.74845 77.4492 -1.75106 78.0735 -1.75367 78.6978 -1.75628 79.3221 -1.75889 79.9464 -1.68423 80.565 -1.60957 81.1837 -1.53491 81.8024 -1.46026 82.4211 -1.3856 83.0398 -1.31094 83.6585 -1.23628 84.2771 -1.16162 84.8958 -1.08697 85.5145 -1.01231 86.1332 -0.937649 86.7519 -0.862991 87.3706 -0.788333 87.9893 -0.713674 88.6079 -0.639016 89.2266 -0.564358 89.8453 -0.401291 90.4472 -0.238225 91.049 -0.0751582 91.6509 0.0879084 92.2527 0.250975 92.8546 0.414042 93.4564 0.577108 94.0583 0.740175 94.6601 0.903241 95.262 1.06631 95.8639 1.22937 96.4657 1.39244 97.0676 1.55551 97.6694 1.71857 98.2713 1.88164 98.8731 2.04471 99.475 2.30378 100.041 2.56284 100.606 2.82191 101.172 3.08098 101.737 3.34005 102.303 3.59912 102.868 3.85818 103.434 4.11725 103.999 4.37632 104.565 4.63539 105.131 4.89446 105.696 5.15352 106.262 5.41259 106.827 5.67166 107.393 5.93073 107.958 6.1898 108.524 6.56542 109.017 6.94105 109.511 7.31668 110.004 7.6923 110.498 8.06793 110.991 8.44356 111.485 8.81918 111.978 9.19481 112.472 9.57043 112.965 9.94606 113.459 10.3217 113.952 10.6973 114.446 11.0729 114.939 11.4486 115.433 11.8242 115.926 12.1998 116.42 12.6675 116.832 13.1351 117.244 13.6028 117.656 14.0704 118.068 14.5381 118.48 15.0058 118.892 15.4734 119.304 15.9411 119.716 16.4087 120.128 16.8764 120.541 17.344 120.953 17.8117 121.365 18.2794 121.777 18.747 122.189 19.2147 122.601 19.6823 123.013 20.1753 123.397 20.6684 123.781 21.1614 124.165 21.6544 124.549 22.1474 124.933 22.6404 125.317 23.1334 125.701 23.6264 126.085 24.1194 126.469 24.6124 126.853 25.1054 127.238 25.5984 127.622 26.0914 128.006 26.5844 128.39 27.0774 128.774 27.5705 129.158 28.0418 129.567 28.5132 129.977 28.9846 130.387 29.456 130.796 29.9274 131.206 30.3988 131.615 30.8702 132.025 31.3416 132.435 31.813 132.844 32.2844 133.254 32.7558 133.664 33.2272 134.073 33.6986 134.483 34.17 134.892 34.6414 135.302 35.1128 135.712 35.5321 136.173 35.9514 136.633 36.3707 137.094 36.7901 137.555 37.2094 138.016 37.6287 138.477 38.0481 138.938 38.4674 139.399 38.8867 139.86 39.3061 140.321 39.7254 140.782 40.1447 141.243 40.564 141.704 40.9834 142.165 41.4027 142.626 41.822 143.087 42.1727 143.603 42.5234 144.118 42.874 144.634 43.2247 145.15 43.5754 145.666 43.926 146.182 44.2767 146.697 44.6273 147.213 44.978 147.729 45.3287 148.245 45.6793 148.761 46.03 149.276 46.3807 149.792 46.7313 150.308 47.082 150.824 47.4326 151.34 47.7279 151.89 48.0231 152.44 48.3183 152.991 48.6135 153.541 48.9088 154.091 49.204 154.641 49.4992 155.192 49.7944 155.742 50.0896 156.292 50.3849 156.843 50.6801 157.393 50.9753 157.943 51.2705 158.494 51.5657 159.044 51.861 159.594 52.1562 160.144 52.4102 160.715 52.6642 161.286 52.9182 161.856 53.1723 162.427 53.4263 162.998 53.6803 163.569 53.9343 164.139 54.1884 164.71 54.4424 165.281 54.6964 165.851 54.9504 166.422 55.2044 166.993 55.4585 167.563 55.7125 168.134 55.9665 168.705 56.2205 169.275 56.4347 169.862 56.6489 170.449 56.8632 171.035 57.0774 171.622 57.2916 172.209 57.5058 172.796 57.72 173.382 57.9342 173.969 58.1484 174.556 58.3627 175.142 58.5769 175.729 58.7911 176.316 59.0053 176.903 59.2195 177.489 59.4337 178.076 59.648 178.663 59.8181 179.264 59.9883 179.865 60.1585 180.466 60.3287 181.066 60.4988 181.667 60.669 182.268 60.8392 182.869 61.0094 183.47 61.1795 184.071 61.3497 184.672 61.5199 185.273 61.6901 185.874 61.8602 186.475 62.0304 187.076 62.2006 187.676" transform="rotate(-3.186987082019371) translate(0.6159675218736893 -49.988229292517744)" stroke="#fff9" stroke-width="12" stroke-linecap="round" fill="none"></polyline><circle fill="#444" r="3" cx="-0.6159675218736893" cy="49.988229292517744" transform="rotate(-3.186987082019371) translate(0.6159675218736893 -49.988229292517744)"></circle></g></svg></div><div id="game-ui-backing"></div></div><div id="ui-debug"><div class="ui-debug-row"><div class="ui-debug-label">Position:</div><div id="ui-debug-position">1, 2, 3</div></div><div class="ui-debug-row"><div class="ui-debug-label">Far Coords:</div><div id="ui-debug-far-coords">1, 2, 3</div></div><div class="ui-debug-row"><div class="ui-debug-label">Vehicle Node:</div><div id="ui-debug-node">1</div></div><div class="ui-debug-row"><div class="ui-debug-label">Midline Tail:</div><div id="ui-debug-midline-tail">123</div></div><hr></div><canvas class="render-canvas" tabindex="-1" data-engine="three.js r144" width="1322" height="925" style="width: 1322px; height: 925px;"></canvas></div></div></div>
    <script>!function (e) { function r(r) { for (var n, a, i = r[0], c = r[1], l = r[2], f = 0, s = []; f < i.length; f++)a = i[f], Object.prototype.hasOwnProperty.call(o, a) && o[a] && s.push(o[a][0]), o[a] = 0; for (n in c) Object.prototype.hasOwnProperty.call(c, n) && (e[n] = c[n]); for (p && p(r); s.length;)s.shift()(); return u.push.apply(u, l || []), t() } function t() { for (var e, r = 0; r < u.length; r++) { for (var t = u[r], n = !0, i = 1; i < t.length; i++) { var c = t[i]; 0 !== o[c] && (n = !1) } n && (u.splice(r--, 1), e = a(a.s = t[0])) } return e } var n = {}, o = { 1: 0 }, u = []; function a(r) { if (n[r]) return n[r].exports; var t = n[r] = { i: r, l: !1, exports: {} }; return e[r].call(t.exports, t, t.exports, a), t.l = !0, t.exports } a.e = function (e) { var r = [], t = o[e]; if (0 !== t) if (t) r.push(t[2]); else { var n = new Promise((function (r, n) { t = o[e] = [r, n] })); r.push(t[2] = n); var u, i = document.createElement("script"); i.charset = "utf-8", i.timeout = 120, a.nc && i.setAttribute("nonce", a.nc), i.src = function (e) { return a.p + "static/js/" + ({}[e] || e) + "." + { 3: "7a0cc4e7" }[e] + ".chunk.js" }(e); var c = new Error; u = function (r) { i.onerror = i.onload = null, clearTimeout(l); var t = o[e]; if (0 !== t) { if (t) { var n = r && ("load" === r.type ? "missing" : r.type), u = r && r.target && r.target.src; c.message = "Loading chunk " + e + " failed.\n(" + n + ": " + u + ")", c.name = "ChunkLoadError", c.type = n, c.request = u, t[1](c) } o[e] = void 0 } }; var l = setTimeout((function () { u({ type: "timeout", target: i }) }), 12e4); i.onerror = i.onload = u, document.head.appendChild(i) } return Promise.all(r) }, a.m = e, a.c = n, a.d = function (e, r, t) { a.o(e, r) || Object.defineProperty(e, r, { enumerable: !0, get: t }) }, a.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, a.t = function (e, r) { if (1 & r && (e = a(e)), 8 & r) return e; if (4 & r && "object" == typeof e && e && e.__esModule) return e; var t = Object.create(null); if (a.r(t), Object.defineProperty(t, "default", { enumerable: !0, value: e }), 2 & r && "string" != typeof e) for (var n in e) a.d(t, n, function (r) { return e[r] }.bind(null, n)); return t }, a.n = function (e) { var r = e && e.__esModule ? function () { return e.default } : function () { return e }; return a.d(r, "a", r), r }, a.o = function (e, r) { return Object.prototype.hasOwnProperty.call(e, r) }, a.p = "https://cdn.jsdelivr.net/gh/Hiram-Y/AwesomeSites-Pack02@bb9f50fae0838b123199bf0d51e543158330c69d/game/slowroads/", a.oe = function (e) { throw console.error(e), e }; var i = this.webpackJsonpapp = this.webpackJsonpapp || [], c = i.push.bind(i); i.push = r, i = i.slice(); for (var l = 0; l < i.length; l++)r(i[l]); var p = c; t() }([])</script>
    <script>
   
(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[2],[function(e,t,n){"use strict";e.exports=n(46)},function(e,t,n){"use strict";n.d(t,"a",(function(){return zs})),n.d(t,"b",(function(){return Ys})),n.d(t,"c",(function(){return Xs})),n.d(t,"d",(function(){return Bs})),n.d(t,"e",(function(){return An})),n.d(t,"f",(function(){return Zt})),n.d(t,"g",(function(){return ln})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return _e})),n.d(t,"j",(function(){return Os})),n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return G})),n.d(t,"m",(function(){return yt})),n.d(t,"n",(function(){return Ms})),n.d(t,"o",(function(){return Qt})),n.d(t,"p",(function(){return Ea})),n.d(t,"q",(function(){return Ma})),n.d(t,"r",(function(){return ga})),n.d(t,"s",(function(){return As})),n.d(t,"t",(function(){return Ca})),n.d(t,"u",(function(){return Da})),n.d(t,"v",(function(){return Fa})),n.d(t,"w",(function(){return ka})),n.d(t,"x",(function(){return Ha})),n.d(t,"y",(function(){return bs})),n.d(t,"z",(function(){return qt})),n.d(t,"A",(function(){return lt})),n.d(t,"B",(function(){return Tn})),n.d(t,"C",(function(){return Xt})),n.d(t,"D",(function(){return ns})),n.d(t,"E",(function(){return ts})),n.d(t,"F",(function(){return es})),n.d(t,"G",(function(){return kt})),n.d(t,"H",(function(){return i})),n.d(t,"I",(function(){return In})),n.d(t,"J",(function(){return Yn})),n.d(t,"K",(function(){return Ya})),n.d(t,"L",(function(){return Wa})),n.d(t,"M",(function(){return Qs})),n.d(t,"N",(function(){return $a})),n.d(t,"O",(function(){return d})),n.d(t,"P",(function(){return Ta})),n.d(t,"Q",(function(){return Dn})),n.d(t,"R",(function(){return Qe})),n.d(t,"S",(function(){return Qa})),n.d(t,"T",(function(){return Is})),n.d(t,"U",(function(){return Ts})),n.d(t,"V",(function(){return ae})),n.d(t,"W",(function(){return Re})),n.d(t,"X",(function(){return Sa}));const r="144",i=2,a=2,s=100,o=301,l=302,c=303,u=304,h=306,d=1e3,f=1001,p=1002,m=1003,g=1004,v=1005,y=1006,_=1008,x=1009,b=1014,w=1015,S=1016,M=1020,E=1023,T=1026,C=1027,A=33776,L=33777,P=33778,R=33779,D=2300,k=2301,I=2302,N=2400,O=2401,z=2402,U=3e3,F=3001,B="srgb",V="srgb-linear",H=7680,W=35044,G=35048,j="300 es",q=1035;class X{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const Y=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const K=Math.PI/180,Z=180/Math.PI;function J(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Y[255&e]+Y[e>>8&255]+Y[e>>16&255]+Y[e>>24&255]+"-"+Y[255&t]+Y[t>>8&255]+"-"+Y[t>>16&15|64]+Y[t>>24&255]+"-"+Y[63&n|128]+Y[n>>8&255]+"-"+Y[n>>16&255]+Y[n>>24&255]+Y[255&r]+Y[r>>8&255]+Y[r>>16&255]+Y[r>>24&255]).toLowerCase()}function $(e,t,n){return Math.max(t,Math.min(n,e))}function Q(e,t){return(e%t+t)%t}function ee(e,t,n){return(1-n)*e+n*t}function te(e){return 0===(e&e-1)&&0!==e}function ne(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function re(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function ie(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}class ae{constructor(e=0,t=0){ae.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class se{constructor(){se.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,i,a,s,o,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=i,c[5]=o,c[6]=n,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[3],o=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],x=r[2],b=r[5],w=r[8];return i[0]=a*p+s*v+o*x,i[3]=a*m+s*y+o*b,i[6]=a*g+s*_+o*w,i[1]=l*p+c*v+u*x,i[4]=l*m+c*y+u*b,i[7]=l*g+c*_+u*w,i[2]=h*p+d*v+f*x,i[5]=h*m+d*y+f*b,i[8]=h*g+d*_+f*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8];return t*a*c-t*s*l-n*i*c+n*s*o+r*i*l-r*a*o}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],u=c*a-s*l,h=s*o-c*i,d=l*i-a*o,f=t*u+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=u*p,e[1]=(r*l-c*n)*p,e[2]=(s*n-r*a)*p,e[3]=h*p,e[4]=(c*t-r*o)*p,e[5]=(r*i-s*t)*p,e[6]=d*p,e[7]=(n*o-l*t)*p,e[8]=(a*t-n*i)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,s){const o=Math.cos(i),l=Math.sin(i);return this.set(n*o,n*l,-n*(o*a+l*s)+a+e,-r*l,r*o,-r*(-l*a+o*s)+s+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],s=r[6],o=r[1],l=r[4],c=r[7];return r[0]=t*i+n*o,r[3]=t*a+n*l,r[6]=t*s+n*c,r[1]=-n*i+t*o,r[4]=-n*a+t*l,r[7]=-n*s+t*c,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function oe(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function le(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function ce(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ue(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const he={[B]:{[V]:ce},[V]:{[B]:ue}},de={legacyMode:!0,get workingColorSpace(){return V},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(this.legacyMode||t===n||!t||!n)return e;if(he[t]&&void 0!==he[t][n]){const r=he[t][n];return e.r=r(e.r),e.g=r(e.g),e.b=r(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},fe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pe={r:0,g:0,b:0},me={h:0,s:0,l:0},ge={h:0,s:0,l:0};function ve(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function ye(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}class _e{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t="srgb"){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,de.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r="srgb-linear"){return this.r=e,this.g=t,this.b=n,de.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r="srgb-linear"){if(e=Q(e,1),t=$(t,0,1),n=$(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=ve(i,r,e+1/3),this.g=ve(i,r,e),this.b=ve(i,r,e-1/3)}return de.toWorkingColorSpace(this,r),this}setStyle(e,t="srgb"){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;const i=r[1],a=r[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,de.toWorkingColorSpace(this,t),n(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,de.toWorkingColorSpace(this,t),n(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const r=parseFloat(e[1])/360,i=parseFloat(e[2])/100,a=parseFloat(e[3])/100;return n(e[4]),this.setHSL(r,i,a,t)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=r[1],n=e.length;if(3===n)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,de.toWorkingColorSpace(this,t),this;if(6===n)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,de.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t="srgb"){const n=fe[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ce(e.r),this.g=ce(e.g),this.b=ce(e.b),this}copyLinearToSRGB(e){return this.r=ue(e.r),this.g=ue(e.g),this.b=ue(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e="srgb"){return de.fromWorkingColorSpace(ye(this,pe),e),$(255*pe.r,0,255)<<16^$(255*pe.g,0,255)<<8^$(255*pe.b,0,255)<<0}getHexString(e="srgb"){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t="srgb-linear"){de.fromWorkingColorSpace(ye(this,pe),t);const n=pe.r,r=pe.g,i=pe.b,a=Math.max(n,r,i),s=Math.min(n,r,i);let o,l;const c=(s+a)/2;if(s===a)o=0,l=0;else{const e=a-s;switch(l=c<=.5?e/(a+s):e/(2-a-s),a){case n:o=(r-i)/e+(r<i?6:0);break;case r:o=(i-n)/e+2;break;case i:o=(n-r)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e,t="srgb-linear"){return de.fromWorkingColorSpace(ye(this,pe),t),e.r=pe.r,e.g=pe.g,e.b=pe.b,e}getStyle(e="srgb"){return de.fromWorkingColorSpace(ye(this,pe),e),e!==B?`color(${e} ${pe.r} ${pe.g} ${pe.b})`:`rgb(${255*pe.r|0},${255*pe.g|0},${255*pe.b|0})`}offsetHSL(e,t,n){return this.getHSL(me),me.h+=e,me.s+=t,me.l+=n,this.setHSL(me.h,me.s,me.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(me),e.getHSL(ge);const n=ee(me.h,ge.h,t),r=ee(me.s,ge.s,t),i=ee(me.l,ge.l,t);return this.setHSL(n,r,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let xe;_e.NAMES=fe;class be{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===xe&&(xe=le("canvas")),xe.width=e.width,xe.height=e.height;const n=xe.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=xe}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=le("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*ce(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*ce(t[e]/255)):t[e]=ce(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class we{constructor(e=null){this.isSource=!0,this.uuid=J(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(Se(r[t].image)):e.push(Se(r[t]))}else e=Se(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function Se(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?be.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Me=0;class Ee extends X{constructor(e=Ee.DEFAULT_IMAGE,t=Ee.DEFAULT_MAPPING,n=f,r=f,i=1006,a=1008,s=1023,o=1009,l=1,c=3e3){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Me++}),this.uuid=J(),this.name="",this.source=new we(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new ae(0,0),this.repeat=new ae(1,1),this.center=new ae(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new se,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case d:e.x=e.x-Math.floor(e.x);break;case f:e.x=e.x<0?0:1;break;case p:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case d:e.y=e.y-Math.floor(e.y);break;case f:e.y=e.y<0?0:1;break;case p:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}}Ee.DEFAULT_IMAGE=null,Ee.DEFAULT_MAPPING=300;class Te{constructor(e=0,t=0,n=0,r=1){Te.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const a=.01,s=.1,o=e.elements,l=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(c-h)<a&&Math.abs(u-p)<a&&Math.abs(f-m)<a){if(Math.abs(c+h)<s&&Math.abs(u+p)<s&&Math.abs(f+m)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+h)/4,_=(u+p)/4,x=(f+m)/4;return e>o&&e>v?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=_/n):o>v?o<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=y/r,i=x/r):v<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=_/i,r=x/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ce extends X{constructor(e,t,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Te(0,0,e,t),this.scissorTest=!1,this.viewport=new Te(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new Ee(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:y,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new we(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ae extends Ee{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=m,this.minFilter=m,this.wrapR=f,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Le extends Ee{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=m,this.minFilter=m,this.wrapR=f,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Pe{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,s){let o=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[a+0],d=i[a+1],f=i[a+2],p=i[a+3];if(0===s)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===s)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(u!==p||o!==h||l!==d||c!==f){let e=1-s;const t=o*h+l*d+c*f+u*p,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),a=Math.atan2(i,t*n);e=Math.sin(e*a)/i,s=Math.sin(s*a)/i}const i=s*n;if(o=o*e+h*i,l=l*e+d*i,c=c*e+f*i,u=u*e+p*i,e===1-s){const e=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=e,l*=e,c*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,a){const s=n[r],o=n[r+1],l=n[r+2],c=n[r+3],u=i[a],h=i[a+1],d=i[a+2],f=i[a+3];return e[t]=s*f+c*u+o*d-l*h,e[t+1]=o*f+c*h+l*u-s*d,e[t+2]=l*f+c*d+s*h-o*u,e[t+3]=c*f-s*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,i=e._z,a=e._order,s=Math.cos,o=Math.sin,l=s(n/2),c=s(r/2),u=s(i/2),h=o(n/2),d=o(r/2),f=o(i/2);switch(a){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],s=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=n+s+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-o)*e,this._y=(i-l)*e,this._z=(a-r)*e}else if(n>s&&n>u){const e=2*Math.sqrt(1+n-s-u);this._w=(c-o)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+l)/e}else if(s>u){const e=2*Math.sqrt(1+s-n-u);this._w=(i-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+u-n-s);this._w=(a-r)/e,this._x=(i+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs($(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,s=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+a*s+r*l-i*o,this._y=r*c+a*o+i*s-n*l,this._z=i*c+a*l+n*o-r*s,this._w=a*c-n*s-r*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let s=a*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const o=1-s*s;if(o<=Number.EPSILON){const e=1-t;return this._w=e*a+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(o),c=Math.atan2(l,s),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=a*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Re{constructor(e=0,t=0,n=0){Re.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ke.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ke.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,s=e.z,o=e.w,l=o*t+a*r-s*n,c=o*n+s*t-i*r,u=o*r+i*n-a*t,h=-i*t-a*n-s*r;return this.x=l*o+h*-i+c*-s-u*-a,this.y=c*o+h*-a+u*-i-l*-s,this.z=u*o+h*-s+l*-a-c*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,s=t.y,o=t.z;return this.x=r*o-i*s,this.y=i*a-n*o,this.z=n*s-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return De.copy(this).projectOnVector(e),this.sub(De)}reflect(e){return this.sub(De.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos($(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const De=new Re,ke=new Pe;class Ie{constructor(e=new Re(1/0,1/0,1/0),t=new Re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,s=-1/0;for(let o=0,l=e.length;o<l;o+=3){const l=e[o],c=e[o+1],u=e[o+2];l<t&&(t=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>a&&(a=c),u>s&&(s=u)}return this.min.set(t,n,r),this.max.set(i,a,s),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,s=-1/0;for(let o=0,l=e.count;o<l;o++){const l=e.getX(o),c=e.getY(o),u=e.getZ(o);l<t&&(t=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>a&&(a=c),u>s&&(s=u)}return this.min.set(t,n,r),this.max.set(i,a,s),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Oe.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&void 0!=n.attributes&&void 0!==n.attributes.position){const t=n.attributes.position;for(let n=0,r=t.count;n<r;n++)Oe.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(Oe)}else null===n.boundingBox&&n.computeBoundingBox(),ze.copy(n.boundingBox),ze.applyMatrix4(e.matrixWorld),this.union(ze);const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Oe),Oe.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ge),je.subVectors(this.max,Ge),Ue.subVectors(e.a,Ge),Fe.subVectors(e.b,Ge),Be.subVectors(e.c,Ge),Ve.subVectors(Fe,Ue),He.subVectors(Be,Fe),We.subVectors(Ue,Be);let t=[0,-Ve.z,Ve.y,0,-He.z,He.y,0,-We.z,We.y,Ve.z,0,-Ve.x,He.z,0,-He.x,We.z,0,-We.x,-Ve.y,Ve.x,0,-He.y,He.x,0,-We.y,We.x,0];return!!Ye(t,Ue,Fe,Be,je)&&(t=[1,0,0,0,1,0,0,0,1],!!Ye(t,Ue,Fe,Be,je)&&(qe.crossVectors(Ve,He),t=[qe.x,qe.y,qe.z],Ye(t,Ue,Fe,Be,je)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Oe.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Oe).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ne[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ne[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ne[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ne[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ne[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ne[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ne[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ne[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ne)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ne=[new Re,new Re,new Re,new Re,new Re,new Re,new Re,new Re],Oe=new Re,ze=new Ie,Ue=new Re,Fe=new Re,Be=new Re,Ve=new Re,He=new Re,We=new Re,Ge=new Re,je=new Re,qe=new Re,Xe=new Re;function Ye(e,t,n,r,i){for(let a=0,s=e.length-3;a<=s;a+=3){Xe.fromArray(e,a);const s=i.x*Math.abs(Xe.x)+i.y*Math.abs(Xe.y)+i.z*Math.abs(Xe.z),o=t.dot(Xe),l=n.dot(Xe),c=r.dot(Xe);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>s)return!1}return!0}const Ke=new Ie,Ze=new Re,Je=new Re,$e=new Re;class Qe{constructor(e=new Re,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Ke.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){$e.subVectors(e,this.center);const t=$e.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.add($e.multiplyScalar(n/e)),this.radius+=n}return this}union(e){return!0===this.center.equals(e.center)?Je.set(0,0,1).multiplyScalar(e.radius):Je.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Ze.copy(e.center).add(Je)),this.expandByPoint(Ze.copy(e.center).sub(Je)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const et=new Re,tt=new Re,nt=new Re,rt=new Re,it=new Re,at=new Re,st=new Re;class ot{constructor(e=new Re,t=new Re(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,et)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=et.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(et.copy(this.direction).multiplyScalar(t).add(this.origin),et.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){tt.copy(e).add(t).multiplyScalar(.5),nt.copy(t).sub(e).normalize(),rt.copy(this.origin).sub(tt);const i=.5*e.distanceTo(t),a=-this.direction.dot(nt),s=rt.dot(this.direction),o=-rt.dot(nt),l=rt.lengthSq(),c=Math.abs(1-a*a);let u,h,d,f;if(c>0)if(u=a*o-s,h=a*s-o,f=i*c,u>=0)if(h>=-f)if(h<=f){const e=1/c;u*=e,h*=e,d=u*(u+a*h+2*s)+h*(a*u+h+2*o)+l}else h=i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;else h=-i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;else h<=-f?(u=Math.max(0,-(-a*i+s)),h=u>0?-i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l):h<=f?(u=0,h=Math.min(Math.max(-i,-o),i),d=h*(h+2*o)+l):(u=Math.max(0,-(a*i+s)),h=u>0?i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l);else h=a>0?-i:i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(nt).multiplyScalar(h).add(tt),d}intersectSphere(e,t){et.subVectors(e.center,this.origin);const n=et.dot(this.direction),r=et.dot(et)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),s=n-a,o=n+a;return s<0&&o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,s,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,a=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,a=(e.min.y-h.y)*c),n>a||i>r?null:((i>n||n!==n)&&(n=i),(a<r||r!==r)&&(r=a),u>=0?(s=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(s=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),n>o||s>r?null:((s>n||n!==n)&&(n=s),(o<r||r!==r)&&(r=o),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,et)}intersectTriangle(e,t,n,r,i){it.subVectors(t,e),at.subVectors(n,e),st.crossVectors(it,at);let a,s=this.direction.dot(st);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}rt.subVectors(this.origin,e);const o=a*this.direction.dot(at.crossVectors(rt,at));if(o<0)return null;const l=a*this.direction.dot(it.cross(rt));if(l<0)return null;if(o+l>s)return null;const c=-a*rt.dot(st);return c<0?null:this.at(c/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class lt{constructor(){lt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,i,a,s,o,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new lt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/ct.setFromMatrixColumn(e,0).length(),i=1/ct.setFromMatrixColumn(e,1).length(),a=1/ct.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),s=Math.sin(n),o=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=a*c,n=a*u,r=s*c,i=s*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-s*o,t[2]=i-e*l,t[6]=r+n*l,t[10]=a*o}else if("YXZ"===e.order){const e=o*c,n=o*u,r=l*c,i=l*u;t[0]=e+i*s,t[4]=r*s-n,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=a*o}else if("ZXY"===e.order){const e=o*c,n=o*u,r=l*c,i=l*u;t[0]=e-i*s,t[4]=-a*u,t[8]=r+n*s,t[1]=n+r*s,t[5]=a*c,t[9]=i-e*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){const e=a*c,n=a*u,r=s*c,i=s*u;t[0]=o*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=o*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=a*c,t[9]=-s*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=a*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=s*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ht,e,dt)}lookAt(e,t,n){const r=this.elements;return mt.subVectors(e,t),0===mt.lengthSq()&&(mt.z=1),mt.normalize(),ft.crossVectors(n,mt),0===ft.lengthSq()&&(1===Math.abs(n.z)?mt.x+=1e-4:mt.z+=1e-4,mt.normalize(),ft.crossVectors(n,mt)),ft.normalize(),pt.crossVectors(mt,ft),r[0]=ft.x,r[4]=pt.x,r[8]=mt.x,r[1]=ft.y,r[5]=pt.y,r[9]=mt.y,r[2]=ft.z,r[6]=pt.z,r[10]=mt.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[4],o=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],x=n[15],b=r[0],w=r[4],S=r[8],M=r[12],E=r[1],T=r[5],C=r[9],A=r[13],L=r[2],P=r[6],R=r[10],D=r[14],k=r[3],I=r[7],N=r[11],O=r[15];return i[0]=a*b+s*E+o*L+l*k,i[4]=a*w+s*T+o*P+l*I,i[8]=a*S+s*C+o*R+l*N,i[12]=a*M+s*A+o*D+l*O,i[1]=c*b+u*E+h*L+d*k,i[5]=c*w+u*T+h*P+d*I,i[9]=c*S+u*C+h*R+d*N,i[13]=c*M+u*A+h*D+d*O,i[2]=f*b+p*E+m*L+g*k,i[6]=f*w+p*T+m*P+g*I,i[10]=f*S+p*C+m*R+g*N,i[14]=f*M+p*A+m*D+g*O,i[3]=v*b+y*E+_*L+x*k,i[7]=v*w+y*T+_*P+x*I,i[11]=v*S+y*C+_*R+x*N,i[15]=v*M+y*A+_*D+x*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],s=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*o*u-r*l*u-i*s*h+n*l*h+r*s*d-n*o*d)+e[7]*(+t*o*d-t*l*h+i*a*h-r*a*d+r*l*c-i*o*c)+e[11]*(+t*l*u-t*s*d-i*a*u+n*a*d+i*s*c-n*l*c)+e[15]*(-r*s*c-t*o*u+t*s*h+r*a*u-n*a*h+n*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*h*l+p*o*d-s*m*d-u*o*g+s*h*g,y=f*h*l-c*m*l-f*o*d+a*m*d+c*o*g-a*h*g,_=c*p*l-f*u*l+f*s*d-a*p*d-c*s*g+a*u*g,x=f*u*o-c*p*o-f*s*h+a*p*h+c*s*m-a*u*m,b=t*v+n*y+r*_+i*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/b;return e[0]=v*w,e[1]=(p*h*i-u*m*i-p*r*d+n*m*d+u*r*g-n*h*g)*w,e[2]=(s*m*i-p*o*i+p*r*l-n*m*l-s*r*g+n*o*g)*w,e[3]=(u*o*i-s*h*i-u*r*l+n*h*l+s*r*d-n*o*d)*w,e[4]=y*w,e[5]=(c*m*i-f*h*i+f*r*d-t*m*d-c*r*g+t*h*g)*w,e[6]=(f*o*i-a*m*i-f*r*l+t*m*l+a*r*g-t*o*g)*w,e[7]=(a*h*i-c*o*i+c*r*l-t*h*l-a*r*d+t*o*d)*w,e[8]=_*w,e[9]=(f*u*i-c*p*i-f*n*d+t*p*d+c*n*g-t*u*g)*w,e[10]=(a*p*i-f*s*i+f*n*l-t*p*l-a*n*g+t*s*g)*w,e[11]=(c*s*i-a*u*i-c*n*l+t*u*l+a*n*d-t*s*d)*w,e[12]=x*w,e[13]=(c*p*r-f*u*r+f*n*h-t*p*h-c*n*m+t*u*m)*w,e[14]=(f*s*r-a*p*r-f*n*o+t*p*o+a*n*m-t*s*m)*w,e[15]=(a*u*r-c*s*r+c*n*o-t*u*o-a*n*h+t*s*h)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,s=e.y,o=e.z,l=i*a,c=i*s;return this.set(l*a+n,l*s-r*o,l*o+r*s,0,l*s+r*o,c*s+n,c*o-r*a,0,l*o-r*s,c*o+r*a,i*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,s=t._z,o=t._w,l=i+i,c=a+a,u=s+s,h=i*l,d=i*c,f=i*u,p=a*c,m=a*u,g=s*u,v=o*l,y=o*c,_=o*u,x=n.x,b=n.y,w=n.z;return r[0]=(1-(p+g))*x,r[1]=(d+_)*x,r[2]=(f-y)*x,r[3]=0,r[4]=(d-_)*b,r[5]=(1-(h+g))*b,r[6]=(m+v)*b,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=ct.set(r[0],r[1],r[2]).length();const a=ct.set(r[4],r[5],r[6]).length(),s=ct.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],ut.copy(this);const o=1/i,l=1/a,c=1/s;return ut.elements[0]*=o,ut.elements[1]*=o,ut.elements[2]*=o,ut.elements[4]*=l,ut.elements[5]*=l,ut.elements[6]*=l,ut.elements[8]*=c,ut.elements[9]*=c,ut.elements[10]*=c,t.setFromRotationMatrix(ut),n.x=i,n.y=a,n.z=s,this}makePerspective(e,t,n,r,i,a){const s=this.elements,o=2*i/(t-e),l=2*i/(n-r),c=(t+e)/(t-e),u=(n+r)/(n-r),h=-(a+i)/(a-i),d=-2*a*i/(a-i);return s[0]=o,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(e,t,n,r,i,a){const s=this.elements,o=1/(t-e),l=1/(n-r),c=1/(a-i),u=(t+e)*o,h=(n+r)*l,d=(a+i)*c;return s[0]=2*o,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const ct=new Re,ut=new lt,ht=new Re(0,0,0),dt=new Re(1,1,1),ft=new Re,pt=new Re,mt=new Re,gt=new lt,vt=new Pe;class yt{constructor(e=0,t=0,n=0,r=yt.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],s=r[8],o=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin($(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-$(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin($(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-$(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin($(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-$(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return gt.makeRotationFromQuaternion(e),this.setFromRotationMatrix(gt,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vt.setFromEuler(this),this.setFromQuaternion(vt,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}yt.DefaultOrder="XYZ",yt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class _t{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&(1<<e|0))}}let xt=0;const bt=new Re,wt=new Pe,St=new lt,Mt=new Re,Et=new Re,Tt=new Re,Ct=new Pe,At=new Re(1,0,0),Lt=new Re(0,1,0),Pt=new Re(0,0,1),Rt={type:"added"},Dt={type:"removed"};class kt extends X{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:xt++}),this.uuid=J(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kt.DefaultUp.clone();const e=new Re,t=new yt,n=new Pe,r=new Re(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new lt},normalMatrix:{value:new se}}),this.matrix=new lt,this.matrixWorld=new lt,this.matrixAutoUpdate=kt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=kt.DefaultMatrixWorldAutoUpdate,this.layers=new _t,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return wt.setFromAxisAngle(e,t),this.quaternion.multiply(wt),this}rotateOnWorldAxis(e,t){return wt.setFromAxisAngle(e,t),this.quaternion.premultiply(wt),this}rotateX(e){return this.rotateOnAxis(At,e)}rotateY(e){return this.rotateOnAxis(Lt,e)}rotateZ(e){return this.rotateOnAxis(Pt,e)}translateOnAxis(e,t){return bt.copy(e).applyQuaternion(this.quaternion),this.position.add(bt.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(At,e)}translateY(e){return this.translateOnAxis(Lt,e)}translateZ(e){return this.translateOnAxis(Pt,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(St.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Mt.copy(e):Mt.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Et.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?St.lookAt(Et,Mt,this.up):St.lookAt(Mt,Et,this.up),this.quaternion.setFromRotationMatrix(St),r&&(St.extractRotation(r.matrixWorld),wt.setFromRotationMatrix(St),this.quaternion.premultiply(wt.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Rt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Dt)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Dt)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),St.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),St.multiply(e.parent.matrixWorld)),e.applyMatrix4(St),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Et,e,Tt),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Et,Ct,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){if(!this.visible)return;this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){const r=t[n];!0!==r.matrixWorldAutoUpdate&&!0!==e||r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){const n=e[t];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=a(e.geometries),r=a(e.materials),i=a(e.textures),s=a(e.images),o=a(e.shapes),l=a(e.skeletons),c=a(e.animations),u=a(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function a(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}kt.DefaultUp=new Re(0,1,0),kt.DefaultMatrixAutoUpdate=!0,kt.DefaultMatrixWorldAutoUpdate=!0;const It=new Re,Nt=new Re,Ot=new Re,zt=new Re,Ut=new Re,Ft=new Re,Bt=new Re,Vt=new Re,Ht=new Re,Wt=new Re;class Gt{constructor(e=new Re,t=new Re,n=new Re){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),It.subVectors(e,t),r.cross(It);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){It.subVectors(r,t),Nt.subVectors(n,t),Ot.subVectors(e,t);const a=It.dot(It),s=It.dot(Nt),o=It.dot(Ot),l=Nt.dot(Nt),c=Nt.dot(Ot),u=a*l-s*s;if(0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*o-s*c)*h,f=(a*c-s*o)*h;return i.set(1-d-f,f,d)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,zt),zt.x>=0&&zt.y>=0&&zt.x+zt.y<=1}static getUV(e,t,n,r,i,a,s,o){return this.getBarycoord(e,t,n,r,zt),o.set(0,0),o.addScaledVector(i,zt.x),o.addScaledVector(a,zt.y),o.addScaledVector(s,zt.z),o}static isFrontFacing(e,t,n,r){return It.subVectors(n,t),Nt.subVectors(e,t),It.cross(Nt).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return It.subVectors(this.c,this.b),Nt.subVectors(this.a,this.b),.5*It.cross(Nt).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gt.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gt.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,i){return Gt.getUV(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Gt.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gt.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,s;Ut.subVectors(r,n),Ft.subVectors(i,n),Vt.subVectors(e,n);const o=Ut.dot(Vt),l=Ft.dot(Vt);if(o<=0&&l<=0)return t.copy(n);Ht.subVectors(e,r);const c=Ut.dot(Ht),u=Ft.dot(Ht);if(c>=0&&u<=c)return t.copy(r);const h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return a=o/(o-c),t.copy(n).addScaledVector(Ut,a);Wt.subVectors(e,i);const d=Ut.dot(Wt),f=Ft.dot(Wt);if(f>=0&&d<=f)return t.copy(i);const p=d*l-o*f;if(p<=0&&l>=0&&f<=0)return s=l/(l-f),t.copy(n).addScaledVector(Ft,s);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return Bt.subVectors(i,r),s=(u-c)/(u-c+(d-f)),t.copy(r).addScaledVector(Bt,s);const g=1/(m+p+h);return a=p*g,s=h*g,t.copy(n).addScaledVector(Ut,a).addScaledVector(Ft,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let jt=0;class qt extends X{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:jt++}),this.uuid=J(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=s,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=H,this.stencilZFail=H,this.stencilZPass=H,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Xt extends qt{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Yt=new Re,Kt=new ae;class Zt{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=W,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Kt.fromBufferAttribute(this,t),Kt.applyMatrix3(e),this.setXY(t,Kt.x,Kt.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Yt.fromBufferAttribute(this,t),Yt.applyMatrix3(e),this.setXYZ(t,Yt.x,Yt.y,Yt.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Yt.fromBufferAttribute(this,t),Yt.applyMatrix4(e),this.setXYZ(t,Yt.x,Yt.y,Yt.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Yt.fromBufferAttribute(this,t),Yt.applyNormalMatrix(e),this.setXYZ(t,Yt.x,Yt.y,Yt.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Yt.fromBufferAttribute(this,t),Yt.transformDirection(e),this.setXYZ(t,Yt.x,Yt.y,Yt.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=re(t,this.array)),t}setX(e,t){return this.normalized&&(t=ie(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=re(t,this.array)),t}setY(e,t){return this.normalized&&(t=ie(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=re(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ie(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=re(t,this.array)),t}setW(e,t){return this.normalized&&(t=ie(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ie(t,this.array),n=ie(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ie(t,this.array),n=ie(n,this.array),r=ie(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=ie(t,this.array),n=ie(n,this.array),r=ie(r,this.array),i=ie(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==W&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Jt extends Zt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class $t extends Zt{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Qt extends Zt{constructor(e,t,n){super(new Float32Array(e),t,n)}}let en=0;const tn=new lt,nn=new kt,rn=new Re,an=new Ie,sn=new Ie,on=new Re;class ln extends X{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:en++}),this.uuid=J(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(oe(e)?$t:Jt)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new se).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return tn.makeRotationFromQuaternion(e),this.applyMatrix4(tn),this}rotateX(e){return tn.makeRotationX(e),this.applyMatrix4(tn),this}rotateY(e){return tn.makeRotationY(e),this.applyMatrix4(tn),this}rotateZ(e){return tn.makeRotationZ(e),this.applyMatrix4(tn),this}translate(e,t,n){return tn.makeTranslation(e,t,n),this.applyMatrix4(tn),this}scale(e,t,n){return tn.makeScale(e,t,n),this.applyMatrix4(tn),this}lookAt(e){return nn.lookAt(e),nn.updateMatrix(),this.applyMatrix4(nn.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(rn).negate(),this.translate(rn.x,rn.y,rn.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Qt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ie);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Re(-1/0,-1/0,-1/0),new Re(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const e=t[n];an.setFromBufferAttribute(e),this.morphTargetsRelative?(on.addVectors(this.boundingBox.min,an.min),this.boundingBox.expandByPoint(on),on.addVectors(this.boundingBox.max,an.max),this.boundingBox.expandByPoint(on)):(this.boundingBox.expandByPoint(an.min),this.boundingBox.expandByPoint(an.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Qe);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Re,1/0);if(e){const n=this.boundingSphere.center;if(an.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const n=t[e];sn.setFromBufferAttribute(n),this.morphTargetsRelative?(on.addVectors(an.min,sn.min),an.expandByPoint(on),on.addVectors(an.max,sn.max),an.expandByPoint(on)):(an.expandByPoint(sn.min),an.expandByPoint(sn.max))}an.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)on.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(on));if(t)for(let i=0,a=t.length;i<a;i++){const a=t[i],s=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)on.fromBufferAttribute(a,t),s&&(rn.fromBufferAttribute(e,t),on.add(rn)),r=Math.max(r,n.distanceToSquared(on))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,s=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Zt(new Float32Array(4*s),4));const o=this.getAttribute("tangent").array,l=[],c=[];for(let E=0;E<s;E++)l[E]=new Re,c[E]=new Re;const u=new Re,h=new Re,d=new Re,f=new ae,p=new ae,m=new ae,g=new Re,v=new Re;function y(e,t,n){u.fromArray(r,3*e),h.fromArray(r,3*t),d.fromArray(r,3*n),f.fromArray(a,2*e),p.fromArray(a,2*t),m.fromArray(a,2*n),h.sub(u),d.sub(u),p.sub(f),m.sub(f);const i=1/(p.x*m.y-m.x*p.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(i),v.copy(d).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[n].add(g),c[e].add(v),c[t].add(v),c[n].add(v))}let _=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(let E=0,T=_.length;E<T;++E){const e=_[E],t=e.start;for(let r=t,i=t+e.count;r<i;r+=3)y(n[r+0],n[r+1],n[r+2])}const x=new Re,b=new Re,w=new Re,S=new Re;function M(e){w.fromArray(i,3*e),S.copy(w);const t=l[e];x.copy(t),x.sub(w.multiplyScalar(w.dot(t))).normalize(),b.crossVectors(S,t);const n=b.dot(c[e])<0?-1:1;o[4*e]=x.x,o[4*e+1]=x.y,o[4*e+2]=x.z,o[4*e+3]=n}for(let E=0,T=_.length;E<T;++E){const e=_[E],t=e.start;for(let r=t,i=t+e.count;r<i;r+=3)M(n[r+0]),M(n[r+1]),M(n[r+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Zt(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Re,i=new Re,a=new Re,s=new Re,o=new Re,l=new Re,c=new Re,u=new Re;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,f),a.fromBufferAttribute(t,p),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),s.fromBufferAttribute(n,d),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),s.add(c),o.add(c),l.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)on.fromBufferAttribute(e,t),on.normalize(),e.setXYZ(t,on.x,on.y,on.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r);let s=0,o=0;for(let l=0,c=t.length;l<c;l++){s=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)a[o++]=n[s++]}return new Zt(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ln,n=this.index.array,r=this.attributes;for(const s in r){const i=e(r[s],n);t.setAttribute(s,i)}const i=this.morphAttributes;for(const s in i){const r=[],a=i[s];for(let t=0,i=a.length;t<i;t++){const i=e(a[t],n);r.push(i)}t.morphAttributes[s]=r}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let s=0,o=a.length;s<o;s++){const e=a[s];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const r={};let i=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n.push(i.toJSON(e.data))}n.length>0&&(r[o]=n,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const i=e.morphAttributes;for(const l in i){const e=[],n=i[l];for(let r=0,i=n.length;r<i;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,c=a.length;l<c;l++){const e=a[l];this.addGroup(e.start,e.count,e.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const cn=new lt,un=new ot,hn=new Qe,dn=new Re,fn=new Re,pn=new Re,mn=new Re,gn=new Re,vn=new Re,yn=new Re,_n=new Re,xn=new Re,bn=new ae,wn=new ae,Sn=new ae,Mn=new Re,En=new Re;class Tn extends kt{constructor(e=new ln,t=new Xt){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),hn.copy(n.boundingSphere),hn.applyMatrix4(i),!1===e.ray.intersectsSphere(hn))return;if(cn.copy(i).invert(),un.copy(e.ray).applyMatrix4(cn),null!==n.boundingBox&&!1===un.intersectsBox(n.boundingBox))return;let a;const s=n.index,o=n.attributes.position,l=n.morphAttributes.position,c=n.morphTargetsRelative,u=n.attributes.uv,h=n.attributes.uv2,d=n.groups,f=n.drawRange;if(null!==s)if(Array.isArray(r))for(let p=0,m=d.length;p<m;p++){const n=d[p],i=r[n.materialIndex];for(let r=Math.max(n.start,f.start),d=Math.min(s.count,Math.min(n.start+n.count,f.start+f.count));r<d;r+=3){const d=s.getX(r),f=s.getX(r+1),p=s.getX(r+2);a=Cn(this,i,e,un,o,l,c,u,h,d,f,p),a&&(a.faceIndex=Math.floor(r/3),a.face.materialIndex=n.materialIndex,t.push(a))}}else{for(let n=Math.max(0,f.start),i=Math.min(s.count,f.start+f.count);n<i;n+=3){const i=s.getX(n),d=s.getX(n+1),f=s.getX(n+2);a=Cn(this,r,e,un,o,l,c,u,h,i,d,f),a&&(a.faceIndex=Math.floor(n/3),t.push(a))}}else if(void 0!==o)if(Array.isArray(r))for(let p=0,m=d.length;p<m;p++){const n=d[p],i=r[n.materialIndex];for(let r=Math.max(n.start,f.start),s=Math.min(o.count,Math.min(n.start+n.count,f.start+f.count));r<s;r+=3){a=Cn(this,i,e,un,o,l,c,u,h,r,r+1,r+2),a&&(a.faceIndex=Math.floor(r/3),a.face.materialIndex=n.materialIndex,t.push(a))}}else{for(let n=Math.max(0,f.start),i=Math.min(o.count,f.start+f.count);n<i;n+=3){a=Cn(this,r,e,un,o,l,c,u,h,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),t.push(a))}}}}function Cn(e,t,n,r,i,s,o,l,c,u,h,d){dn.fromBufferAttribute(i,u),fn.fromBufferAttribute(i,h),pn.fromBufferAttribute(i,d);const f=e.morphTargetInfluences;if(s&&f){yn.set(0,0,0),_n.set(0,0,0),xn.set(0,0,0);for(let e=0,t=s.length;e<t;e++){const t=f[e],n=s[e];0!==t&&(mn.fromBufferAttribute(n,u),gn.fromBufferAttribute(n,h),vn.fromBufferAttribute(n,d),o?(yn.addScaledVector(mn,t),_n.addScaledVector(gn,t),xn.addScaledVector(vn,t)):(yn.addScaledVector(mn.sub(dn),t),_n.addScaledVector(gn.sub(fn),t),xn.addScaledVector(vn.sub(pn),t)))}dn.add(yn),fn.add(_n),pn.add(xn)}e.isSkinnedMesh&&(e.boneTransform(u,dn),e.boneTransform(h,fn),e.boneTransform(d,pn));const p=function(e,t,n,r,i,s,o,l){let c;if(c=1===t.side?r.intersectTriangle(o,s,i,!0,l):r.intersectTriangle(i,s,o,t.side!==a,l),null===c)return null;En.copy(l),En.applyMatrix4(e.matrixWorld);const u=n.ray.origin.distanceTo(En);return u<n.near||u>n.far?null:{distance:u,point:En.clone(),object:e}}(e,t,n,r,dn,fn,pn,Mn);if(p){l&&(bn.fromBufferAttribute(l,u),wn.fromBufferAttribute(l,h),Sn.fromBufferAttribute(l,d),p.uv=Gt.getUV(Mn,dn,fn,pn,bn,wn,Sn,new ae)),c&&(bn.fromBufferAttribute(c,u),wn.fromBufferAttribute(c,h),Sn.fromBufferAttribute(c,d),p.uv2=Gt.getUV(Mn,dn,fn,pn,bn,wn,Sn,new ae));const e={a:u,b:h,c:d,normal:new Re,materialIndex:0};Gt.getNormal(dn,fn,pn,e.normal),p.face=e}return p}class An extends ln{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const s=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const o=[],l=[],c=[],u=[];let h=0,d=0;function f(e,t,n,r,i,a,f,p,m,g,v){const y=a/m,_=f/g,x=a/2,b=f/2,w=p/2,S=m+1,M=g+1;let E=0,T=0;const C=new Re;for(let s=0;s<M;s++){const a=s*_-b;for(let o=0;o<S;o++){const h=o*y-x;C[e]=h*r,C[t]=a*i,C[n]=w,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=p>0?1:-1,c.push(C.x,C.y,C.z),u.push(o/m),u.push(1-s/g),E+=1}}for(let s=0;s<g;s++)for(let e=0;e<m;e++){const t=h+e+S*s,n=h+e+S*(s+1),r=h+(e+1)+S*(s+1),i=h+(e+1)+S*s;o.push(t,n,i),o.push(n,r,i),T+=6}s.addGroup(d,T,v),d+=T,h+=E}f("z","y","x",-1,-1,n,t,e,a,i,0),f("z","y","x",1,-1,n,t,-e,a,i,1),f("x","z","y",1,1,e,n,t,r,a,2),f("x","z","y",1,-1,e,n,-t,r,a,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(o),this.setAttribute("position",new Qt(l,3)),this.setAttribute("normal",new Qt(c,3)),this.setAttribute("uv",new Qt(u,2))}static fromJSON(e){return new An(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ln(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Pn(e){const t={};for(let n=0;n<e.length;n++){const r=Ln(e[n]);for(const e in r)t[e]=r[e]}return t}const Rn={clone:Ln,merge:Pn};class Dn extends qt{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ln(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class kn extends kt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new lt,this.projectionMatrix=new lt,this.projectionMatrixInverse=new lt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class In extends kn{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Z*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*K*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Z*Math.atan(Math.tan(.5*K*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*K*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/s,r*=a.width/e,n*=a.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Nn=90;class On extends kt{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new In(Nn,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Re(1,0,0)),this.add(r);const i=new In(Nn,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Re(-1,0,0)),this.add(i);const a=new In(Nn,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new Re(0,1,0)),this.add(a);const s=new In(Nn,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new Re(0,-1,0)),this.add(s);const o=new In(Nn,1,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new Re(0,0,1)),this.add(o);const l=new In(Nn,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Re(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,a,s,o,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,o),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class zn extends Ee{constructor(e,t,n,r,i,a,s,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:o,n,r,i,a,s,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Un extends Ce{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new zn(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:y}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new An(5,5,5),i=new Dn({name:"CubemapFromEquirect",uniforms:Ln(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=t;const a=new Tn(r,i),s=t.minFilter;t.minFilter===_&&(t.minFilter=y);return new On(1,10,this).update(e,a),t.minFilter=s,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}const Fn=new Re,Bn=new Re,Vn=new se;class Hn{constructor(e=new Re(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Fn.subVectors(n,t).cross(Bn.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Fn),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Vn.getNormalMatrix(e),r=this.coplanarPoint(Fn).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Wn=new Qe,Gn=new Re;class jn{constructor(e=new Hn,t=new Hn,n=new Hn,r=new Hn,i=new Hn,a=new Hn){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],s=n[3],o=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(s-r,u-o,p-h,y-m).normalize(),t[1].setComponents(s+r,u+o,p+h,y+m).normalize(),t[2].setComponents(s+i,u+l,p+d,y+g).normalize(),t[3].setComponents(s-i,u-l,p-d,y-g).normalize(),t[4].setComponents(s-a,u-c,p-f,y-v).normalize(),t[5].setComponents(s+a,u+c,p+f,y+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Wn.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Wn)}intersectsSprite(e){return Wn.center.set(0,0,0),Wn.radius=.7071067811865476,Wn.applyMatrix4(e.matrixWorld),this.intersectsSphere(Wn)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Gn.x=r.normal.x>0?e.max.x:e.min.x,Gn.y=r.normal.y>0?e.max.y:e.min.y,Gn.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Gn)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function qn(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Xn(e,t){const n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){const e=r.get(t);return void((!e||e.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const a=r.get(t);void 0===a?r.set(t,function(t,r){const i=t.array,a=t.usage,s=e.createBuffer();let o;if(e.bindBuffer(r,s),e.bufferData(r,i,a),t.onUploadCallback(),i instanceof Float32Array)o=5126;else if(i instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");o=5131}else o=5123;else if(i instanceof Int16Array)o=5122;else if(i instanceof Uint32Array)o=5125;else if(i instanceof Int32Array)o=5124;else if(i instanceof Int8Array)o=5120;else if(i instanceof Uint8Array)o=5121;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);o=5121}return{buffer:s,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(!function(t,r,i){const a=r.array,s=r.updateRange;e.bindBuffer(i,t),-1===s.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,s.offset*a.BYTES_PER_ELEMENT,a,s.offset,s.count):e.bufferSubData(i,s.offset*a.BYTES_PER_ELEMENT,a.subarray(s.offset,s.offset+s.count)),s.count=-1)}(a.buffer,t,i),a.version=t.version)}}}class Yn extends ln{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,s=Math.floor(n),o=Math.floor(r),l=s+1,c=o+1,u=e/s,h=t/o,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const e=g*h-a;for(let t=0;t<l;t++){const n=t*u-i;f.push(n,-e,0),p.push(0,0,1),m.push(t/s),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<s;e++){const t=e+l*g,n=e+l*(g+1),r=e+1+l*(g+1),i=e+1+l*g;d.push(t,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new Qt(f,3)),this.setAttribute("normal",new Qt(p,3)),this.setAttribute("uv",new Qt(m,2))}static fromJSON(e){return new Yn(e.width,e.height,e.widthSegments,e.heightSegments)}}const Kn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = length(mvPosition);\n#ifdef FOG_EXP2\n\t vFogDepth = max(0.0, (vFogDepth - fogNear) * (fogFar / (fogFar - fogNear)));\n\t #endif \n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\t #ifdef FOG_EXP2\n\t uniform float fogNear; uniform float fogFar;\n\t #endif\n\t  varying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert\n#define Material_LightProbeLOD( material )\t(0)",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( cent
er - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Zn={common:{diffuse:{value:new _e(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new se},uv2Transform:{value:new se},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ae(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _e(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _e(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new se}},sprite:{diffuse:{value:new _e(16777215)},opacity:{value:1},center:{value:new ae(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new se}}},Jn={basic:{uniforms:Pn([Zn.common,Zn.specularmap,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.fog]),vertexShader:Kn.meshbasic_vert,fragmentShader:Kn.meshbasic_frag},lambert:{uniforms:Pn([Zn.common,Zn.specularmap,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.fog,Zn.lights,{emissive:{value:new _e(0)}}]),vertexShader:Kn.meshlambert_vert,fragmentShader:Kn.meshlambert_frag},phong:{uniforms:Pn([Zn.common,Zn.specularmap,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.fog,Zn.lights,{emissive:{value:new _e(0)},specular:{value:new _e(1118481)},shininess:{value:30}}]),vertexShader:Kn.meshphong_vert,fragmentShader:Kn.meshphong_frag},standard:{uniforms:Pn([Zn.common,Zn.envmap,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.roughnessmap,Zn.metalnessmap,Zn.fog,Zn.lights,{emissive:{value:new _e(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag},toon:{uniforms:Pn([Zn.common,Zn.aomap,Zn.lightmap,Zn.emissivemap,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.gradientmap,Zn.fog,Zn.lights,{emissive:{value:new _e(0)}}]),vertexShader:Kn.meshtoon_vert,fragmentShader:Kn.meshtoon_frag},matcap:{uniforms:Pn([Zn.common,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,Zn.fog,{matcap:{value:null}}]),vertexShader:Kn.meshmatcap_vert,fragmentShader:Kn.meshmatcap_frag},points:{uniforms:Pn([Zn.points,Zn.fog]),vertexShader:Kn.points_vert,fragmentShader:Kn.points_frag},dashed:{uniforms:Pn([Zn.common,Zn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kn.linedashed_vert,fragmentShader:Kn.linedashed_frag},depth:{uniforms:Pn([Zn.common,Zn.displacementmap]),vertexShader:Kn.depth_vert,fragmentShader:Kn.depth_frag},normal:{uniforms:Pn([Zn.common,Zn.bumpmap,Zn.normalmap,Zn.displacementmap,{opacity:{value:1}}]),vertexShader:Kn.meshnormal_vert,fragmentShader:Kn.meshnormal_frag},sprite:{uniforms:Pn([Zn.sprite,Zn.fog]),vertexShader:Kn.sprite_vert,fragmentShader:Kn.sprite_frag},background:{uniforms:{uvTransform:{value:new se},t2D:{value:null}},vertexShader:Kn.background_vert,fragmentShader:Kn.background_frag},cube:{uniforms:Pn([Zn.envmap,{opacity:{value:1}}]),vertexShader:Kn.cube_vert,fragmentShader:Kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kn.equirect_vert,fragmentShader:Kn.equirect_frag},distanceRGBA:{uniforms:Pn([Zn.common,Zn.displacementmap,{referencePosition:{value:new Re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kn.distanceRGBA_vert,fragmentShader:Kn.distanceRGBA_frag},shadow:{uniforms:Pn([Zn.lights,Zn.fog,{color:{value:new _e(0)},opacity:{value:1}}]),vertexShader:Kn.shadow_vert,fragmentShader:Kn.shadow_frag}};function $n(e,t,n,r,i,a){const s=new _e(0);let o,l,c=!0===i?0:1,u=null,d=0,f=null;function p(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,a)}return{getClearColor:function(){return s},setClearColor:function(e,t=1){s.set(e),c=t,p(s,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,p(s,c)},render:function(n,i){let a=!1,m=!0===i.isScene?i.background:null;m&&m.isTexture&&(m=t.get(m));const g=e.xr,v=g.getSession&&g.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?p(s,c):m&&m.isColor&&(p(m,1),a=!0),(e.autoClear||a)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.mapping===h)?(void 0===l&&(l=new Tn(new An(1,1,1),new Dn({name:"BackgroundCubeMaterial",uniforms:Ln(Jn.cube.uniforms),vertexShader:Jn.cube.vertexShader,fragmentShader:Jn.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=m,l.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,u===m&&d===m.version&&f===e.toneMapping||(l.material.needsUpdate=!0,u=m,d=m.version,f=e.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null)):m&&m.isTexture&&(void 0===o&&(o=new Tn(new Yn(2,2),new Dn({name:"BackgroundMaterial",uniforms:Ln(Jn.background.uniforms),vertexShader:Jn.background.vertexShader,fragmentShader:Jn.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),u===m&&d===m.version&&f===e.toneMapping||(o.material.needsUpdate=!0,u=m,d=m.version,f=e.toneMapping),o.layers.enableAll(),n.unshift(o,o.geometry,o.material,0,0,null))}}}function Qn(e,t,n,r){const i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),s=r.isWebGL2||null!==a,o={},l=f(null);let c=l,u=!1;function h(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function f(e){const t=[],n=[],r=[];for(let a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){const e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function m(e){g(e,0)}function g(n,i){const a=c.newAttributes,s=c.enabledAttributes,o=c.attributeDivisors;if(a[n]=1,0===s[n]&&(e.enableVertexAttribArray(n),s[n]=1),o[n]!==i){(r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),o[n]=i}}function v(){const t=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,i,a,s,o){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,a,s,o):e.vertexAttribIPointer(t,n,i,s,o)}function _(){x(),u=!0,c!==l&&(c=l,h(c.object))}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,d,_,x){let b=!1;if(s){const t=function(t,n,i){const s=!0===i.wireframe;let l=o[t.id];void 0===l&&(l={},o[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[s];void 0===u&&(u=f(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),c[s]=u);return u}(_,d,l);c!==t&&(c=t,h(c.object)),b=function(e,t,n,r){const i=c.attributes,a=t.attributes;let s=0;const o=n.getAttributes();for(const l in o){if(o[l].location>=0){const t=i[l];let n=a[l];if(void 0===n&&("instanceMatrix"===l&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;s++}}return c.attributesNum!==s||c.index!==r}(i,_,d,x),b&&function(e,t,n,r){const i={},a=t.attributes;let s=0;const o=n.getAttributes();for(const l in o){if(o[l].location>=0){let t=a[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),i[l]=n,s++}}c.attributes=i,c.attributesNum=s,c.index=r}(i,_,d,x)}else{const e=!0===l.wireframe;c.geometry===_.id&&c.program===d.id&&c.wireframe===e||(c.geometry=_.id,c.program=d.id,c.wireframe=e,b=!0)}null!==x&&n.update(x,34963),(b||u)&&(u=!1,function(i,a,s,o){if(!1===r.isWebGL2&&(i.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();const l=o.attributes,c=s.getAttributes(),u=a.defaultAttributeValues;for(const t in c){const r=c[t];if(r.location>=0){let a=l[t];if(void 0===a&&("instanceMatrix"===t&&i.instanceMatrix&&(a=i.instanceMatrix),"instanceColor"===t&&i.instanceColor&&(a=i.instanceColor)),void 0!==a){const t=a.normalized,s=a.itemSize,l=n.get(a);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(a.isInterleavedBufferAttribute){const n=a.data,l=n.stride,d=a.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)g(r.location+e,n.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<r.locationSize;e++)m(r.location+e);e.bindBuffer(34962,c);for(let e=0;e<r.locationSize;e++)y(r.location+e,s/r.locationSize,u,t,l*h,(d+s/r.locationSize*e)*h)}else{if(a.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)g(r.location+e,a.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let e=0;e<r.locationSize;e++)m(r.location+e);e.bindBuffer(34962,c);for(let e=0;e<r.locationSize;e++)y(r.location+e,s/r.locationSize,u,t,s*h,s/r.locationSize*e*h)}}else if(void 0!==u){const n=u[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(r.location,n);break;case 3:e.vertexAttrib3fv(r.location,n);break;case 4:e.vertexAttrib4fv(r.location,n);break;default:e.vertexAttrib1fv(r.location,n)}}}}v()}(i,l,d,_),null!==x&&e.bindBuffer(34963,n.get(x).buffer))},reset:_,resetDefaultState:x,dispose:function(){_();for(const e in o){const t=o[e];for(const e in t){const n=t[e];for(const e in n)d(n[e].object),delete n[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;const t=o[e.id];for(const n in t){const e=t[n];for(const t in e)d(e[t].object),delete e[t];delete t[n]}delete o[e.id]},releaseStatesOfProgram:function(e){for(const t in o){const n=o[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)d(r[e].object),delete r[e];delete n[e.id]}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:v}}function er(e,t,n,r){const i=r.isWebGL2;let a;this.setMode=function(e){a=e},this.render=function(t,r){e.drawArrays(a,t,r),n.update(r,a,1)},this.renderInstances=function(r,s,o){if(0===o)return;let l,c;if(i)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](a,r,s,o),n.update(s,a,o)}}function tr(e,t,n){let r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let s=void 0!==n.precision?n.precision:"highp";const o=i(s);o!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);const l=a||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),f=e.getParameter(34076),p=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),y=h>0,_=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:y&&_,maxSamples:a?e.getParameter(36183):0}}function nr(e){const t=this;let n=null,r=0,i=!1,a=!1;const s=new Hn,o=new se,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function u(e,n,r,i){const a=null!==e?e.length:0;let c=null;if(0!==a){if(c=l.value,!0!==i||null===c){const t=r+4*a,i=n.matrixWorldInverse;o.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=r;n!==a;++n,l+=4)s.copy(e[n]).applyMatrix4(i,o),s.normal.toArray(c,l),c[l+3]=s.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){const s=0!==e.length||t||0!==r||i;return i=t,n=u(e,a,0),r=e.length,s},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1,c()},this.setState=function(t,s,o){const h=t.clippingPlanes,d=t.clipIntersection,f=t.clipShadows,p=e.get(t);if(!i||null===h||0===h.length||a&&!f)a?u(null):c();else{const e=a?0:r,t=4*e;let i=p.clippingState||null;l.value=i,i=u(h,s,t,o);for(let r=0;r!==t;++r)i[r]=n[r];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function rr(e){let t=new WeakMap;function n(e,t){return t===c?e.mapping=o:t===u&&(e.mapping=l),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const a=i.mapping;if(a===c||a===u){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const a=i.image;if(a&&a.height>0){const s=new Un(a.height/2);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}Jn.physical={uniforms:Pn([Jn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ae(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new _e(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ae},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new _e(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new _e(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag};class ir extends kn{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,s=r+t,o=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,s,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const ar=[.125,.215,.35,.446,.526,.582],sr=20,or=new ir,lr=new _e;let cr=null;const ur=(1+Math.sqrt(5))/2,hr=1/ur,dr=[new Re(1,1,1),new Re(-1,1,1),new Re(1,1,-1),new Re(-1,1,-1),new Re(0,ur,hr),new Re(0,ur,-hr),new Re(hr,0,ur),new Re(-hr,0,ur),new Re(ur,hr,0),new Re(-ur,hr,0)];class fr{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){cr=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=vr(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=gr(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(cr),e.scissorTest=!1,mr(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===o||e.mapping===l?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),cr=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:y,minFilter:y,generateMipmaps:!1,type:S,format:E,encoding:U,depthBuffer:!1},r=pr(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=pr(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const a=e-4+1+ar.length;for(let s=0;s<a;s++){const a=Math.pow(2,i);n.push(a);let o=1/a;s>e-4?o=ar[s-e+4-1]:0===s&&(o=0),r.push(o);const l=1/(a-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),y=new Float32Array(m*f*d),_=new Float32Array(g*f*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(r,p*f*e),y.set(h,m*f*e);const i=[e,e,e,e,e,e];_.set(i,g*f*e)}const x=new ln;x.setAttribute("position",new Zt(v,p)),x.setAttribute("uv",new Zt(y,m)),x.setAttribute("faceIndex",new Zt(_,g)),t.push(x),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(sr),i=new Re(0,1,0);return new Dn({name:"SphericalGaussianBlur",defines:{n:sr,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:yr(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(r,e,t)}return r}_compileMaterial(e){const t=new Tn(this._lodPlanes[0],e);this._renderer.compile(t,or)}_sceneToCubeUV(e,t,n,r){const i=new In(90,1,t,n),a=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(lr),o.toneMapping=0,o.autoClear=!1;const u=new Xt({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new Tn(new An,u);let d=!1;const f=e.background;f?f.isColor&&(u.color.copy(f),e.background=null,d=!0):(u.color.copy(lr),d=!0);for(let p=0;p<6;p++){const t=p%3;0===t?(i.up.set(0,a[p],0),i.lookAt(s[p],0,0)):1===t?(i.up.set(0,0,a[p]),i.lookAt(0,s[p],0)):(i.up.set(0,a[p],0),i.lookAt(0,0,s[p]));const n=this._cubeSize;mr(r,t*n,p>2?n:0,n,n),o.setRenderTarget(r),d&&o.render(h,i),o.render(e,i)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=f}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===o||e.mapping===l;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=vr()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=gr());const i=r?this._cubemapMaterial:this._equirectMaterial,a=new Tn(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const s=this._cubeSize;mr(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(a,or)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const t=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=dr[(r-1)%dr.length];this._blur(e,r-1,r,t,n)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,s){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new Tn(this._lodPlanes[r],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):sr;p>sr&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let _=0;_<sr;++_){const e=_/f,t=Math.exp(-e*e/2);m.push(t),0===_?g+=t:_<p&&(g+=2*t)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;u.envMap.value=e.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===a,s&&(u.poleAxis.value=s);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const y=this._sizeLods[r];mr(t,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,or)}}function pr(e,t,n){const r=new Ce(e,t,n);return r.texture.mapping=h,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function mr(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function gr(){return new Dn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:yr(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function vr(){return new Dn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:yr(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function yr(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function _r(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping,s=a===c||a===u,h=a===o||a===l;if(s||h){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let r=t.get(i);return null===n&&(n=new fr(e)),r=s?n.fromEquirectangular(i,r):n.fromCubemap(i,r),t.set(i,r),r.texture}if(t.has(i))return t.get(i).texture;{const a=i.image;if(s&&a&&a.height>0||h&&a&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(a)){null===n&&(n=new fr(e));const a=s?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,a),i.addEventListener("dispose",r),a.texture}return null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function xr(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function br(e,t,n,r){const i={},a=new WeakMap;function s(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",s),delete i[o.id];const l=a.get(o);l&&(t.remove(l),a.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],r=e.index,i=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{const e=i.array;s=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}const o=new(oe(n)?$t:Jt)(n,1);o.version=s;const l=a.get(e);l&&t.remove(l),a.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,n.memory.geometries++),t},update:function(e){const n=e.attributes;for(const i in n)t.update(n[i],34962);const r=e.morphAttributes;for(const i in r){const e=r[i];for(let n=0,r=e.length;n<r;n++)t.update(e[n],34962)}},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return a.get(e)}}}function wr(e,t,n,r){const i=r.isWebGL2;let a,s,o;this.setMode=function(e){a=e},this.setIndex=function(e){s=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(a,r,s,t*o),n.update(r,a,1)},this.renderInstances=function(r,l,c){if(0===c)return;let u,h;if(i)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](a,l,s,r*o,c),n.update(l,a,c)}}function Sr(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Mr(e,t){return e[0]-t[0]}function Er(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Tr(e,t,n){const r={},i=new Float32Array(8),a=new WeakMap,s=new Te,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===t.isWebGL2){const r=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,i=void 0!==r?r.length:0;let o=a.get(c);if(void 0===o||o.count!==i){void 0!==o&&o.texture.dispose();const e=void 0!==c.morphAttributes.position,n=void 0!==c.morphAttributes.normal,r=void 0!==c.morphAttributes.color,l=c.morphAttributes.position||[],u=c.morphAttributes.normal||[],h=c.morphAttributes.color||[];let d=0;!0===e&&(d=1),!0===n&&(d=2),!0===r&&(d=3);let f=c.attributes.position.count*d,p=1;f>t.maxTextureSize&&(p=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);const m=new Float32Array(f*p*4*i),g=new Ae(m,f,p,i);g.type=w,g.needsUpdate=!0;const v=4*d;for(let t=0;t<i;t++){const i=l[t],a=u[t],o=h[t],c=f*p*4*t;for(let t=0;t<i.count;t++){const l=t*v;!0===e&&(s.fromBufferAttribute(i,t),m[c+l+0]=s.x,m[c+l+1]=s.y,m[c+l+2]=s.z,m[c+l+3]=0),!0===n&&(s.fromBufferAttribute(a,t),m[c+l+4]=s.x,m[c+l+5]=s.y,m[c+l+6]=s.z,m[c+l+7]=0),!0===r&&(s.fromBufferAttribute(o,t),m[c+l+8]=s.x,m[c+l+9]=s.y,m[c+l+10]=s.z,m[c+l+11]=4===o.itemSize?s.w:1)}}function y(){g.dispose(),a.delete(c),c.removeEventListener("dispose",y)}o={count:i,texture:g,size:new ae(f,p)},a.set(c,o),c.addEventListener("dispose",y)}let l=0;for(let e=0;e<d.length;e++)l+=d[e];const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",o.texture,n),h.getUniforms().setValue(e,"morphTargetsTextureSize",o.size)}else{const t=void 0===d?0:d.length;let n=r[c.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];r[c.id]=n}for(let e=0;e<t;e++){const t=n[e];t[0]=e,t[1]=d[e]}n.sort(Er);for(let e=0;e<8;e++)e<t&&n[e][1]?(o[e][0]=n[e][0],o[e][1]=n[e][1]):(o[e][0]=Number.MAX_SAFE_INTEGER,o[e][1]=0);o.sort(Mr);const a=c.morphAttributes.position,s=c.morphAttributes.normal;let l=0;for(let e=0;e<8;e++){const t=o[e],n=t[0],r=t[1];n!==Number.MAX_SAFE_INTEGER&&r?(a&&c.getAttribute("morphTarget"+e)!==a[n]&&c.setAttribute("morphTarget"+e,a[n]),s&&c.getAttribute("morphNormal"+e)!==s[n]&&c.setAttribute("morphNormal"+e,s[n]),i[e]=r,l+=r):(a&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),s&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),i[e]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function Cr(e,t,n,r){let i=new WeakMap;function a(e){const t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){const s=r.render.frame,o=e.geometry,l=t.get(e,o);return i.get(l)!==s&&(t.update(l),i.set(l,s)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",a)&&e.addEventListener("dispose",a),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}const Ar=new Ee,Lr=new Ae,Pr=new Le,Rr=new zn,Dr=[],kr=[],Ir=new Float32Array(16),Nr=new Float32Array(9),Or=new Float32Array(4);function zr(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=Dr[i];if(void 0===a&&(a=new Float32Array(i),Dr[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function Ur(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Fr(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function Br(e,t){let n=kr[t];void 0===n&&(n=new Int32Array(t),kr[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Vr(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Hr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ur(n,t))return;e.uniform2fv(this.addr,t),Fr(n,t)}}function Wr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ur(n,t))return;e.uniform3fv(this.addr,t),Fr(n,t)}}function Gr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ur(n,t))return;e.uniform4fv(this.addr,t),Fr(n,t)}}function jr(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Ur(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Fr(n,t)}else{if(Ur(n,r))return;Or.set(r),e.uniformMatrix2fv(this.addr,!1,Or),Fr(n,r)}}function qr(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Ur(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Fr(n,t)}else{if(Ur(n,r))return;Nr.set(r),e.uniformMatrix3fv(this.addr,!1,Nr),Fr(n,r)}}function Xr(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Ur(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Fr(n,t)}else{if(Ur(n,r))return;Ir.set(r),e.uniformMatrix4fv(this.addr,!1,Ir),Fr(n,r)}}function Yr(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Kr(e,t){const n=this.cache;Ur(n,t)||(e.uniform2iv(this.addr,t),Fr(n,t))}function Zr(e,t){const n=this.cache;Ur(n,t)||(e.uniform3iv(this.addr,t),Fr(n,t))}function Jr(e,t){const n=this.cache;Ur(n,t)||(e.uniform4iv(this.addr,t),Fr(n,t))}function $r(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Qr(e,t){const n=this.cache;Ur(n,t)||(e.uniform2uiv(this.addr,t),Fr(n,t))}function ei(e,t){const n=this.cache;Ur(n,t)||(e.uniform3uiv(this.addr,t),Fr(n,t))}function ti(e,t){const n=this.cache;Ur(n,t)||(e.uniform4uiv(this.addr,t),Fr(n,t))}function ni(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||Ar,i)}function ri(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Pr,i)}function ii(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||Rr,i)}function ai(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Lr,i)}function si(e,t){e.uniform1fv(this.addr,t)}function oi(e,t){const n=zr(t,this.size,2);e.uniform2fv(this.addr,n)}function li(e,t){const n=zr(t,this.size,3);e.uniform3fv(this.addr,n)}function ci(e,t){const n=zr(t,this.size,4);e.uniform4fv(this.addr,n)}function ui(e,t){const n=zr(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function hi(e,t){const n=zr(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function di(e,t){const n=zr(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function fi(e,t){e.uniform1iv(this.addr,t)}function pi(e,t){e.uniform2iv(this.addr,t)}function mi(e,t){e.uniform3iv(this.addr,t)}function gi(e,t){e.uniform4iv(this.addr,t)}function vi(e,t){e.uniform1uiv(this.addr,t)}function yi(e,t){e.uniform2uiv(this.addr,t)}function _i(e,t){e.uniform3uiv(this.addr,t)}function xi(e,t){e.uniform4uiv(this.addr,t)}function bi(e,t,n){const r=t.length,i=Br(n,r);e.uniform1iv(this.addr,i);for(let a=0;a!==r;++a)n.setTexture2D(t[a]||Ar,i[a])}function wi(e,t,n){const r=t.length,i=Br(n,r);e.uniform1iv(this.addr,i);for(let a=0;a!==r;++a)n.setTexture3D(t[a]||Pr,i[a])}function Si(e,t,n){const r=t.length,i=Br(n,r);e.uniform1iv(this.addr,i);for(let a=0;a!==r;++a)n.setTextureCube(t[a]||Rr,i[a])}function Mi(e,t,n){const r=t.length,i=Br(n,r);e.uniform1iv(this.addr,i);for(let a=0;a!==r;++a)n.setTexture2DArray(t[a]||Lr,i[a])}class Ei{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Vr;case 35664:return Hr;case 35665:return Wr;case 35666:return Gr;case 35674:return jr;case 35675:return qr;case 35676:return Xr;case 5124:case 35670:return Yr;case 35667:case 35671:return Kr;case 35668:case 35672:return Zr;case 35669:case 35673:return Jr;case 5125:return $r;case 36294:return Qr;case 36295:return ei;case 36296:return ti;case 35678:case 36198:case 36298:case 36306:case 35682:return ni;case 35679:case 36299:case 36307:return ri;case 35680:case 36300:case 36308:case 36293:return ii;case 36289:case 36303:case 36311:case 36292:return ai}}(t.type)}}class Ti{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return si;case 35664:return oi;case 35665:return li;case 35666:return ci;case 35674:return ui;case 35675:return hi;case 35676:return di;case 5124:case 35670:return fi;case 35667:case 35671:return pi;case 35668:case 35672:return mi;case 35669:case 35673:return gi;case 5125:return vi;case 36294:return yi;case 36295:return _i;case 36296:return xi;case 35678:case 36198:case 36298:case 36306:case 35682:return bi;case 35679:case 36299:case 36307:return wi;case 35680:case 36300:case 36308:case 36293:return Si;case 36289:case 36303:case 36311:case 36292:return Mi}}(t.type)}}class Ci{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}}}const Ai=/(\w+)(\])?(\[|\.)?/g;function Li(e,t){e.seq.push(t),e.map[t.id]=t}function Pi(e,t,n){const r=e.name,i=r.length;for(Ai.lastIndex=0;;){const a=Ai.exec(r),s=Ai.lastIndex;let o=a[1];const l="]"===a[2],c=a[3];if(l&&(o|=0),void 0===c||"["===c&&s+2===i){Li(n,void 0===c?new Ei(o,e,t):new Ti(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new Ci(o),Li(n,e)),n=e}}}class Ri{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);Pi(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function Di(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let ki=0;function Ii(e,t,n){const r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let s=i;s<a;s++){const e=s+1;r.push(`${e===t?">":" "} ${e}: ${n[s]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return i}function Ni(e,t){const n=function(e){switch(e){case U:return["Linear","( value )"];case F:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Oi(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function zi(e){return""!==e}function Ui(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Fi(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const Bi=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vi(e){return e.replace(Bi,Hi)}function Hi(e,t){const n=Kn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Vi(n)}const Wi=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Gi(e){return e.replace(Wi,ji)}function ji(e,t,n,r){let i="";for(let a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function qi(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Xi(e,t,n,r){const a=e.getContext(),s=n.defines;let c=n.vertexShader,u=n.fragmentShader;const d=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===i?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),f=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case o:case l:t="ENVMAP_TYPE_CUBE";break;case h:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),p=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case l:t="ENVMAP_MODE_REFRACTION"}return t}(n),m=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),g=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),v=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zi).join("\n")}(n),y=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),_=a.createProgram();let x,b,w=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(x=[y].filter(zi).join("\n"),x.length>0&&(x+="\n"),b=[v,y].filter(zi).join("\n"),b.length>0&&(b+="\n")):(x=[qi(n),"#define SHADER_NAME "+n.shaderName,y,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(zi).join("\n"),b=[v,qi(n),"#define SHADER_NAME "+n.shaderName,y,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",n.envMap?"#define "+m:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Kn.tonemapping_pars_fragment:"",0!==n.toneMapping?Oi("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Kn.encodings_pars_fragment,Ni("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(zi).join("\n")),c=Vi(c),c=Ui(c,n),c=Fi(c,n),u=Vi(u),u=Ui(u,n),u=Fi(u,n),c=Gi(c),u=Gi(u),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(w="#version 300 es\n",x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+x,b=["#define varying in",n.glslVersion===j?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===j?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+b);const S=w+b+u,M=Di(a,35633,w+x+c),E=Di(a,35632,S);if(a.attachShader(_,M),a.attachShader(_,E),void 0!==n.index0AttributeName?a.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&a.bindAttribLocation(_,0,"position"),a.linkProgram(_),e.debug.checkShaderErrors){const e=a.getProgramInfoLog(_).trim(),t=a.getShaderInfoLog(M).trim(),n=a.getShaderInfoLog(E).trim();let r=!0,i=!0;if(!1===a.getProgramParameter(_,35714)){r=!1;const t=Ii(a,M,"vertex"),n=Ii(a,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+n)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):""!==t&&""!==n||(i=!1);i&&(this.diagnostics={runnable:r,programLog:e,vertexShader:{log:t,prefix:x},fragmentShader:{log:n,prefix:b}})}let T,C;return a.deleteShader(M),a.deleteShader(E),this.getUniforms=function(){return void 0===T&&(T=new Ri(a,_)),T},this.getAttributes=function(){return void 0===C&&(C=function(e,t){const n={},r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),a=r.name;let s=1;35674===r.type&&(s=2),35675===r.type&&(s=3),35676===r.type&&(s=4),n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:s}}return n}(a,_)),C},this.destroy=function(){r.releaseStatesOfProgram(this),a.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=ki++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=M,this.fragmentShader=E,this}let Yi=0;class Ki{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new Zi(e),t.set(e,n)),n}}class Zi{constructor(e){this.id=Yi++,this.code=e,this.usedTimes=0}}function Ji(e,t,n,r,i,s,o){const l=new _t,c=new Ki,u=[],d=i.isWebGL2,f=i.logarithmicDepthBuffer,p=i.vertexTextures;let m=i.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,l,u,v,y){const _=v.fog,x=y.geometry,b=s.isMeshStandardMaterial?v.environment:null,w=(s.isMeshStandardMaterial?n:t).get(s.envMap||b),S=w&&w.mapping===h?w.image.height:null,M=g[s.type];null!==s.precision&&(m=i.getMaxPrecision(s.precision),m!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",m,"instead."));const E=x.morphAttributes.position||x.morphAttributes.normal||x.morphAttributes.color,T=void 0!==E?E.length:0;let C,A,L,P,R=0;if(void 0!==x.morphAttributes.position&&(R=1),void 0!==x.morphAttributes.normal&&(R=2),void 0!==x.morphAttributes.color&&(R=3),M){const e=Jn[M];C=e.vertexShader,A=e.fragmentShader}else C=s.vertexShader,A=s.fragmentShader,c.update(s),L=c.getVertexShaderID(s),P=c.getFragmentShaderID(s);const D=e.getRenderTarget(),k=s.alphaTest>0,I=s.clearcoat>0,N=s.iridescence>0;return{isWebGL2:d,shaderID:M,shaderName:s.type,vertexShader:C,fragmentShader:A,defines:s.defines,customVertexShaderID:L,customFragmentShaderID:P,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:m,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:p,outputEncoding:null===D?e.outputEncoding:!0===D.isXRRenderTarget?D.texture.encoding:U,map:!!s.map,matcap:!!s.matcap,envMap:!!w,envMapMode:w&&w.mapping,envMapCubeUVHeight:S,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:1===s.normalMapType,tangentSpaceNormalMap:0===s.normalMapType,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===F,clearcoat:I,clearcoatMap:I&&!!s.clearcoatMap,clearcoatRoughnessMap:I&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:I&&!!s.clearcoatNormalMap,iridescence:N,iridescenceMap:N&&!!s.iridescenceMap,iridescenceThicknessMap:N&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&1===s.blending,alphaMap:!!s.alphaMap,alphaTest:k,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!x.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!x.attributes.color&&4===x.attributes.color.itemSize,vertexUvs:!!s.map||!!s.bumpMap||!!s.normalMap||!!s.specularMap||!!s.alphaMap||!!s.emissiveMap||!!s.roughnessMap||!!s.metalnessMap||!!s.clearcoatMap||!!s.clearcoatRoughnessMap||!!s.clearcoatNormalMap||!!s.iridescenceMap||!!s.iridescenceThicknessMap||!!s.displacementMap||!!s.transmissionMap||!!s.thicknessMap||!!s.specularIntensityMap||!!s.specularColorMap||!!s.sheenColorMap||!!s.sheenRoughnessMap,uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap)&&!!s.displacementMap,fog:!!_,useFog:!0===s.fog,fogExp2:_&&_.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:f,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==x.morphAttributes.position,morphNormals:void 0!==x.morphAttributes.normal,morphColors:void 0!==x.morphAttributes.color,morphTargetsCount:T,morphTextureStride:R,numDirLights:l.directional.length,numPointLights:l.point.length,numSpotLights:l.spot.length,numSpotLightMaps:l.spotLightMap.length,numRectAreaLights:l.rectArea.length,numHemiLights:l.hemi.length,numDirLightShadows:l.directionalShadowMap.length,numPointLightShadows:l.pointShadowMap.length,numSpotLightShadows:l.spotShadowMap.length,numSpotLightShadowsWithMaps:l.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===a,flipSided:1===s.side,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||r.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){l.disableAll(),t.isWebGL2&&l.enable(0);t.supportsVertexTextures&&l.enable(1);t.instancing&&l.enable(2);t.instancingColor&&l.enable(3);t.map&&l.enable(4);t.matcap&&l.enable(5);t.envMap&&l.enable(6);t.lightMap&&l.enable(7);t.aoMap&&l.enable(8);t.emissiveMap&&l.enable(9);t.bumpMap&&l.enable(10);t.normalMap&&l.enable(11);t.objectSpaceNormalMap&&l.enable(12);t.tangentSpaceNormalMap&&l.enable(13);t.clearcoat&&l.enable(14);t.clearcoatMap&&l.enable(15);t.clearcoatRoughnessMap&&l.enable(16);t.clearcoatNormalMap&&l.enable(17);t.iridescence&&l.enable(18);t.iridescenceMap&&l.enable(19);t.iridescenceThicknessMap&&l.enable(20);t.displacementMap&&l.enable(21);t.specularMap&&l.enable(22);t.roughnessMap&&l.enable(23);t.metalnessMap&&l.enable(24);t.gradientMap&&l.enable(25);t.alphaMap&&l.enable(26);t.alphaTest&&l.enable(27);t.vertexColors&&l.enable(28);t.vertexAlphas&&l.enable(29);t.vertexUvs&&l.enable(30);t.vertexTangents&&l.enable(31);t.uvsVertexOnly&&l.enable(32);e.push(l.mask),l.disableAll(),t.fog&&l.enable(0);t.useFog&&l.enable(1);t.flatShading&&l.enable(2);t.logarithmicDepthBuffer&&l.enable(3);t.skinning&&l.enable(4);t.morphTargets&&l.enable(5);t.morphNormals&&l.enable(6);t.morphColors&&l.enable(7);t.premultipliedAlpha&&l.enable(8);t.shadowMapEnabled&&l.enable(9);t.physicallyCorrectLights&&l.enable(10);t.doubleSided&&l.enable(11);t.flipSided&&l.enable(12);t.useDepthPacking&&l.enable(13);t.dithering&&l.enable(14);t.specularIntensityMap&&l.enable(15);t.specularColorMap&&l.enable(16);t.transmission&&l.enable(17);t.transmissionMap&&l.enable(18);t.thicknessMap&&l.enable(19);t.sheen&&l.enable(20);t.sheenColorMap&&l.enable(21);t.sheenRoughnessMap&&l.enable(22);t.decodeVideoTexture&&l.enable(23);t.opaque&&l.enable(24);e.push(l.mask)}(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=g[e.type];let n;if(t){const e=Jn[t];n=Rn.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,i=u.length;e<i;e++){const t=u[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new Xi(e,n,t,s),u.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){c.remove(e)},programs:u,dispose:function(){c.dispose()}}}function $i(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Qi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ea(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ta(){const e=[];let t=0;const n=[],r=[],i=[];function a(n,r,i,a,s,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=s,l.group=o),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,s,o,l,c){const u=a(e,t,s,o,l,c);s.transmission>0?r.push(u):!0===s.transparent?i.push(u):n.push(u)},unshift:function(e,t,s,o,l,c){const u=a(e,t,s,o,l,c);s.transmission>0?r.unshift(u):!0===s.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Qi),r.length>1&&r.sort(t||ea),i.length>1&&i.sort(t||ea)}}}function na(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new ta,e.set(t,[i])):n>=r.length?(i=new ta,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function ra(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Re,color:new _e};break;case"SpotLight":n={position:new Re,direction:new Re,color:new _e,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Re,color:new _e,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Re,skyColor:new _e,groundColor:new _e};break;case"RectAreaLight":n={color:new _e,position:new Re,halfWidth:new Re,halfHeight:new Re}}return e[t.id]=n,n}}}let ia=0;function aa(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function sa(e,t){const n=new ra,r=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ae};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ae,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let l=0;l<9;l++)i.probe.push(new Re);const a=new Re,s=new lt,o=new lt;return{setup:function(a,s){let o=0,l=0,c=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0,_=0;a.sort(aa);const x=!0!==s?Math.PI:1;for(let e=0,t=a.length;e<t;e++){const t=a[e],s=t.color,b=t.intensity,w=t.distance,S=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)o+=s.r*b*x,l+=s.g*b*x,c+=s.b*b*x;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],b);else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,i.directionalShadow[u]=n,i.directionalShadowMap[u]=S,i.directionalShadowMatrix[u]=t.shadow.matrix,m++}i.directional[u]=e,u++}else if(t.isSpotLight){const e=n.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(s).multiplyScalar(b*x),e.distance=w,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,i.spot[d]=e;const a=t.shadow;if(t.map&&(i.spotLightMap[y]=t.map,y++,a.updateMatrices(t),t.castShadow&&_++),i.spotLightMatrix[d]=a.matrix,t.castShadow){const e=r.get(t);e.shadowBias=a.bias,e.shadowNormalBias=a.normalBias,e.shadowRadius=a.radius,e.shadowMapSize=a.mapSize,i.spotShadow[d]=e,i.spotShadowMap[d]=S,v++}d++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(s).multiplyScalar(b),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[f]=e,f++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*x),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,i.pointShadow[h]=n,i.pointShadowMap[h]=S,i.pointShadowMatrix[h]=t.shadow.matrix,g++}i.point[h]=e,h++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(b*x),e.groundColor.copy(t.groundColor).multiplyScalar(b*x),i.hemi[p]=e,p++}}f>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=Zn.LTC_FLOAT_1,i.rectAreaLTC2=Zn.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Zn.LTC_HALF_1,i.rectAreaLTC2=Zn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=o,i.ambient[1]=l,i.ambient[2]=c;const b=i.hash;b.directionalLength===u&&b.pointLength===h&&b.spotLength===d&&b.rectAreaLength===f&&b.hemiLength===p&&b.numDirectionalShadows===m&&b.numPointShadows===g&&b.numSpotShadows===v&&b.numSpotMaps===y||(i.directional.length=u,i.spot.length=d,i.rectArea.length=f,i.point.length=h,i.hemi.length=p,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=v+y-_,i.spotLightMap.length=y,i.numSpotLightShadowsWithMaps=_,b.directionalLength=u,b.pointLength=h,b.spotLength=d,b.rectAreaLength=f,b.hemiLength=p,b.numDirectionalShadows=m,b.numPointShadows=g,b.numSpotShadows=v,b.numSpotMaps=y,i.version=ia++)},setupView:function(e,t){let n=0,r=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,f=e.length;d<f;d++){const t=e[d];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),o.identity(),s.copy(t.matrixWorld),s.premultiply(h),o.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(t.isPointLight){const e=i.point[r];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),r++}else if(t.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function oa(e,t){const n=new sa(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function la(e,t){let n=new WeakMap;return{get:function(r,i=0){const a=n.get(r);let s;return void 0===a?(s=new oa(e,t),n.set(r,[s])):i>=a.length?(s=new oa(e,t),a.push(s)):s=a[i],s},dispose:function(){n=new WeakMap}}}class ca extends qt{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ua extends qt{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Re,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function ha(e,t,n){let r=new jn;const i=new ae,s=new ae,o=new Te,l=new ca({depthPacking:3201}),c=new ua,u={},h=n.maxTextureSize,d={0:1,1:0,2:a},f=new Dn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ae},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=f.clone();p.defines.HORIZONTAL_PASS=1;const g=new ln;g.setAttribute("position",new Zt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Tn(g,f),y=this;function _(n,r){const a=t.update(v);f.defines.VSM_SAMPLES!==n.blurSamples&&(f.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,f.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Ce(i.x,i.y)),f.uniforms.shadow_pass.value=n.map.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,f,v,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,p,v,null)}function x(t,n,r,i,a,s){let o=null;const h=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(o=void 0!==h?h:!0===r.isPointLight?c:l,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0){const e=o.uuid,t=n.uuid;let r=u[e];void 0===r&&(r={},u[e]=r);let i=r[t];void 0===i&&(i=o.clone(),r[t]=i),o=i}return o.visible=n.visible,o.wireframe=n.wireframe,o.side=3===s?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:d[n.side],o.alphaMap=n.alphaMap,o.alphaTest=n.alphaTest,o.clipShadows=n.clipShadows,o.clippingPlanes=n.clippingPlanes,o.clipIntersection=n.clipIntersection,o.displacementMap=n.displacementMap,o.displacementScale=n.displacementScale,o.displacementBias=n.displacementBias,o.wireframeLinewidth=n.wireframeLinewidth,o.linewidth=n.linewidth,!0===r.isPointLight&&!0===o.isMeshDistanceMaterial&&(o.referencePosition.setFromMatrixPosition(r.matrixWorld),o.nearDistance=i,o.farDistance=a),o}function b(n,i,a,s,o){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const r=t.update(n),i=n.material;if(Array.isArray(i)){const t=r.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=i[c.materialIndex];if(u&&u.visible){const t=x(n,u,s,a.near,a.far,o);e.renderBufferDirect(a,null,r,t,n,c)}}}else if(i.visible){const t=x(n,i,s,a.near,a.far,o);e.renderBufferDirect(a,null,r,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],i,a,s,o)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,n,a){if(!1===y.enabled)return;if(!1===y.autoUpdate&&!1===y.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let f=0,p=t.length;f<p;f++){const l=t[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const u=c.getFrameExtents();if(i.multiply(u),s.copy(c.mapSize),(i.x>h||i.y>h)&&(i.x>h&&(s.x=Math.floor(h/u.x),i.x=s.x*u.x,c.mapSize.x=s.x),i.y>h&&(s.y=Math.floor(h/u.y),i.y=s.y*u.y,c.mapSize.y=s.y)),null===c.map){const e=3!==this.type?{minFilter:m,magFilter:m}:{};c.map=new Ce(i.x,i.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const p=c.getViewportCount();for(let e=0;e<p;e++){const t=c.getViewport(e);o.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(o),c.updateMatrices(l,e),r=c.getFrustum(),b(n,a,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&_(c,a),c.needsUpdate=!1}y.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function da(e,t,n){const r=n.isWebGL2;const i=new function(){let t=!1;const n=new Te;let r=null;const i=new Te(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,s,o){!0===o&&(t*=s,r*=s,a*=s),n.set(t,r,a,s),!1===i.equals(n)&&(e.clearColor(t,r,a,s),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){let t=!1,n=null,r=null,i=null;return{setTest:function(e){e?H(2929):W(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},l=new function(){let t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,c=null;return{setTest:function(e){t||(e?H(2960):W(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,s){r===t&&i===n&&a===s||(e.stencilFunc(t,n,s),r=t,i=n,a=s)},setOp:function(t,n,r){s===t&&o===n&&l===r||(e.stencilOp(t,n,r),s=t,o=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,c=null}}},c=new WeakMap,u=new WeakMap;let h={},d={},f=new WeakMap,p=[],m=null,g=!1,v=null,y=null,_=null,x=null,b=null,w=null,S=null,M=!1,E=null,T=null,C=null,A=null,L=null;const P=e.getParameter(35661);let R=!1,D=0;const k=e.getParameter(7938);-1!==k.indexOf("WebGL")?(D=parseFloat(/^WebGL (\d)/.exec(k)[1]),R=D>=1):-1!==k.indexOf("OpenGL ES")&&(D=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),R=D>=2);let I=null,N={};const O=e.getParameter(3088),z=e.getParameter(2978),U=(new Te).fromArray(O),F=(new Te).fromArray(z);function B(t,n,r){const i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let s=0;s<r;s++)e.texImage2D(n+s,0,6408,1,1,0,6408,5121,i);return a}const V={};function H(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function W(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}V[3553]=B(3553,3553,1),V[34067]=B(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),l.setClear(0),H(2929),o.setFunc(3),X(!1),Y(1),H(2884),q(0);const G={[s]:32774,101:32778,102:32779};if(r)G[103]=32775,G[104]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(G[103]=e.MIN_EXT,G[104]=e.MAX_EXT)}const j={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function q(t,n,r,i,a,o,l,c){if(0!==t){if(!1===g&&(H(3042),g=!0),5===t)a=a||n,o=o||r,l=l||i,n===y&&a===b||(e.blendEquationSeparate(G[n],G[a]),y=n,b=a),r===_&&i===x&&o===w&&l===S||(e.blendFuncSeparate(j[r],j[i],j[o],j[l]),_=r,x=i,w=o,S=l),v=t,M=null;else if(t!==v||c!==M){if(y===s&&b===s||(e.blendEquation(32774),y=s,b=s),c)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}_=null,x=null,w=null,S=null,v=t,M=c}}else!0===g&&(W(3042),g=!1)}function X(t){E!==t&&(t?e.frontFace(2304):e.frontFace(2305),E=t)}function Y(t){0!==t?(H(2884),t!==T&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):W(2884),T=t}function K(t,n,r){t?(H(32823),A===n&&L===r||(e.polygonOffset(n,r),A=n,L=r)):W(32823)}function Z(t){void 0===t&&(t=33984+P-1),I!==t&&(e.activeTexture(t),I=t)}return{buffers:{color:i,depth:o,stencil:l},enable:H,disable:W,bindFramebuffer:function(t,n){return d[t]!==n&&(e.bindFramebuffer(t,n),d[t]=n,r&&(36009===t&&(d[36160]=n),36160===t&&(d[36009]=n)),!0)},drawBuffers:function(r,i){let a=p,s=!1;if(r)if(a=f.get(i),void 0===a&&(a=[],f.set(i,a)),r.isWebGLMultipleRenderTargets){const e=r.texture;if(a.length!==e.length||36064!==a[0]){for(let t=0,n=e.length;t<n;t++)a[t]=36064+t;a.length=e.length,s=!0}}else 36064!==a[0]&&(a[0]=36064,s=!0);else 1029!==a[0]&&(a[0]=1029,s=!0);s&&(n.isWebGL2?e.drawBuffers(a):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(t){return m!==t&&(e.useProgram(t),m=t,!0)},setBlending:q,setMaterial:function(e,t){e.side===a?W(2884):H(2884);let n=1===e.side;t&&(n=!n),X(n),1===e.blending&&!1===e.transparent?q(0):q(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),o.setFunc(e.depthFunc),o.setTest(e.depthTest),o.setMask(e.depthWrite),i.setMask(e.colorWrite);const r=e.stencilWrite;l.setTest(r),r&&(l.setMask(e.stencilWriteMask),l.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),l.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),K(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?H(32926):W(32926)},setFlipSided:X,setCullFace:Y,setLineWidth:function(t){t!==C&&(R&&e.lineWidth(t),C=t)},setPolygonOffset:K,setScissorTest:function(e){e?H(3089):W(3089)},activeTexture:Z,bindTexture:function(t,n){null===I&&Z();let r=N[I];void 0===r&&(r={type:void 0,texture:void 0},N[I]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||V[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=N[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){let r=u.get(n);void 0===r&&(r=new WeakMap,u.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=u.get(n).get(t);c.get(t)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),c.set(t,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===U.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),U.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===r&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},I=null,N={},d={},f=new WeakMap,p=[],m=null,g=!1,v=null,y=null,_=null,x=null,b=null,w=null,S=null,M=!1,E=null,T=null,C=null,A=null,L=null,U.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),i.reset(),o.reset(),l.reset()}}}function fa(e,t,n,r,i,a,s){const o=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,u=i.maxTextureSize,h=i.maxSamples,A=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,L=/OculusBrowser/g.test(navigator.userAgent),P=new WeakMap;let R;const D=new WeakMap;let k=!1;try{k="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(ue){}function I(e,t){return k?new OffscreenCanvas(e,t):le("canvas")}function N(e,t,n,r){let i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const r=t?ne:Math.floor,a=r(i*e.width),s=r(i*e.height);void 0===R&&(R=I(a,s));const o=n?I(a,s):R;o.width=a,o.height=s;return o.getContext("2d").drawImage(e,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function O(e){return te(e.width)&&te(e.height)}function z(e,t){return e.generateMipmaps&&t&&e.minFilter!==m&&e.minFilter!==y}function B(t){e.generateMipmap(t)}function V(n,r,i,a,s=!1){if(!1===o)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=r;return 6403===r&&(5126===i&&(l=33326),5131===i&&(l=33325),5121===i&&(l=33321)),33319===r&&(5126===i&&(l=33328),5131===i&&(l=33327),5121===i&&(l=33323)),6408===r&&(5126===i&&(l=34836),5131===i&&(l=34842),5121===i&&(l=a===F&&!1===s?35907:32856),32819===i&&(l=32854),32820===i&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||t.get("EXT_color_buffer_float"),l}function H(e,t,n){return!0===z(e,n)||e.isFramebufferTexture&&e.minFilter!==m&&e.minFilter!==y?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function W(e){return e===m||e===g||e===v?9728:9729}function G(e){const t=e.target;t.removeEventListener("dispose",G),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=D.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&X(e),0===Object.keys(i).length&&D.delete(n)}r.remove(e)}(t),t.isVideoTexture&&P.delete(t)}function j(t){const n=t.target;n.removeEventListener("dispose",j),function(t){const n=t.texture,i=r.get(t),a=r.get(n);void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),s.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let r=0;r<6;r++)e.deleteFramebuffer(i.__webglFramebuffer[r]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[r]);else{if(e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let t=0;t<i.__webglColorRenderbuffer.length;t++)i.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[t]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let o=0,l=n.length;o<l;o++){const t=r.get(n[o]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),s.memory.textures--),r.remove(n[o])}r.remove(n),r.remove(t)}(n)}function X(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete D.get(i)[n.__cacheKey],s.memory.textures--}let Y=0;function K(e,t){const i=r.get(e);if(e.isVideoTexture&&function(e){const t=s.render.frame;P.get(e)!==t&&(P.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&i.__version!==e.version){const n=e.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void ee(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}const Z={[d]:10497,[f]:33071,[p]:33648},J={[m]:9728,[g]:9984,[v]:9986,[y]:9729,1007:9985,[_]:9987};function $(n,a,s){if(s?(e.texParameteri(n,10242,Z[a.wrapS]),e.texParameteri(n,10243,Z[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,Z[a.wrapR]),e.texParameteri(n,10240,J[a.magFilter]),e.texParameteri(n,10241,J[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===f&&a.wrapT===f||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,W(a.magFilter)),e.texParameteri(n,10241,W(a.minFilter)),a.minFilter!==m&&a.minFilter!==y&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const s=t.get("EXT_texture_filter_anisotropic");if(a.type===w&&!1===t.has("OES_texture_float_linear"))return;if(!1===o&&a.type===S&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function Q(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",G));const i=n.source;let a=D.get(i);void 0===a&&(a={},D.set(i,a));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(n);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),a[o].usedTimes++;const i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&X(n)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return r}function ee(t,r,i){let s=3553;r.isDataArrayTexture&&(s=35866),r.isData3DTexture&&(s=32879);const l=Q(t,r),c=r.source;if(n.activeTexture(33984+i),n.bindTexture(s,t.__webglTexture),c.version!==c.__currentVersion||!0===l){e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);const t=function(e){return!o&&(e.wrapS!==f||e.wrapT!==f||e.minFilter!==m&&e.minFilter!==y)}(r)&&!1===O(r.image);let i=N(r.image,t,!1,u);i=ce(r,i);const h=O(i)||o,d=a.convert(r.format,r.encoding);let p,g=a.convert(r.type),v=V(r.internalFormat,d,g,r.encoding,r.isVideoTexture);$(s,r,h);const _=r.mipmaps,x=o&&!0!==r.isVideoTexture,S=void 0===c.__currentVersion||!0===l,A=H(r,i,h);if(r.isDepthTexture)v=6402,o?v=r.type===w?36012:r.type===b?33190:r.type===M?35056:33189:r.type===w&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===T&&6402===v&&1012!==r.type&&r.type!==b&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=b,g=a.convert(r.type)),r.format===C&&6402===v&&(v=34041,r.type!==M&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=M,g=a.convert(r.type))),S&&(x?n.texStorage2D(3553,1,v,i.width,i.height):n.texImage2D(3553,0,v,i.width,i.height,0,d,g,null));else if(r.isDataTexture)if(_.length>0&&h){x&&S&&n.texStorage2D(3553,A,v,_[0].width,_[0].height);for(let e=0,t=_.length;e<t;e++)p=_[e],x?n.texSubImage2D(3553,e,0,0,p.width,p.height,d,g,p.data):n.texImage2D(3553,e,v,p.width,p.height,0,d,g,p.data);r.generateMipmaps=!1}else x?(S&&n.texStorage2D(3553,A,v,i.width,i.height),n.texSubImage2D(3553,0,0,0,i.width,i.height,d,g,i.data)):n.texImage2D(3553,0,v,i.width,i.height,0,d,g,i.data);else if(r.isCompressedTexture){x&&S&&n.texStorage2D(3553,A,v,_[0].width,_[0].height);for(let e=0,t=_.length;e<t;e++)p=_[e],r.format!==E?null!==d?x?n.compressedTexSubImage2D(3553,e,0,0,p.width,p.height,d,p.data):n.compressedTexImage2D(3553,e,v,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):x?n.texSubImage2D(3553,e,0,0,p.width,p.height,d,g,p.data):n.texImage2D(3553,e,v,p.width,p.height,0,d,g,p.data)}else if(r.isDataArrayTexture)x?(S&&n.texStorage3D(35866,A,v,i.width,i.height,i.depth),n.texSubImage3D(35866,0,0,0,0,i.width,i.height,i.depth,d,g,i.data)):n.texImage3D(35866,0,v,i.width,i.height,i.depth,0,d,g,i.data);else if(r.isData3DTexture)x?(S&&n.texStorage3D(32879,A,v,i.width,i.height,i.depth),n.texSubImage3D(32879,0,0,0,0,i.width,i.height,i.depth,d,g,i.data)):n.texImage3D(32879,0,v,i.width,i.height,i.depth,0,d,g,i.data);else if(r.isFramebufferTexture){if(S)if(x)n.texStorage2D(3553,A,v,i.width,i.height);else{let e=i.width,t=i.height;for(let r=0;r<A;r++)n.texImage2D(3553,r,v,e,t,0,d,g,null),e>>=1,t>>=1}}else if(_.length>0&&h){x&&S&&n.texStorage2D(3553,A,v,_[0].width,_[0].height);for(let e=0,t=_.length;e<t;e++)p=_[e],x?n.texSubImage2D(3553,e,0,0,d,g,p):n.texImage2D(3553,e,v,d,g,p);r.generateMipmaps=!1}else x?(S&&n.texStorage2D(3553,A,v,i.width,i.height),n.texSubImage2D(3553,0,0,0,d,g,i)):n.texImage2D(3553,0,v,d,g,i);z(r,h)&&B(s),c.__currentVersion=c.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}function re(t,i,s,o,l){const c=a.convert(s.format,s.encoding),u=a.convert(s.type),h=V(s.internalFormat,c,u,s.encoding);r.get(i).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(l,0,h,i.width,i.height,0,c,u,null)),n.bindFramebuffer(36160,t),oe(i)?A.framebufferTexture2DMultisampleEXT(36160,o,l,r.get(s).__webglTexture,0,se(i)):e.framebufferTexture2D(36160,o,l,r.get(s).__webglTexture,0),n.bindFramebuffer(36160,null)}function ie(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r||oe(n)){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===w?i=36012:t.type===b&&(i=33190));const r=se(n);oe(n)?A.renderbufferStorageMultisampleEXT(36161,r,i,n.width,n.height):e.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){const i=se(n);r&&!1===oe(n)?e.renderbufferStorageMultisample(36161,i,35056,n.width,n.height):oe(n)?A.renderbufferStorageMultisampleEXT(36161,i,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let i=0;i<t.length;i++){const s=t[i],o=a.convert(s.format,s.encoding),l=a.convert(s.type),c=V(s.internalFormat,o,l,s.encoding),u=se(n);r&&!1===oe(n)?e.renderbufferStorageMultisample(36161,u,c,n.width,n.height):oe(n)?A.renderbufferStorageMultisampleEXT(36161,u,c,n.width,n.height):e.renderbufferStorage(36161,c,n.width,n.height)}}e.bindRenderbuffer(36161,null)}function ae(t){const i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),K(i.depthTexture,0);const a=r.get(i.depthTexture).__webglTexture,s=se(i);if(i.depthTexture.format===T)oe(i)?A.framebufferTexture2DMultisampleEXT(36160,36096,3553,a,0,s):e.framebufferTexture2D(36160,36096,3553,a,0);else{if(i.depthTexture.format!==C)throw new Error("Unknown depthTexture format");oe(i)?A.framebufferTexture2DMultisampleEXT(36160,33306,3553,a,0,s):e.framebufferTexture2D(36160,33306,3553,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(36160,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=e.createRenderbuffer(),ie(i.__webglDepthbuffer[r],t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),ie(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function se(e){return Math.min(h,e.samples)}function oe(e){const n=r.get(e);return o&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function ce(e,n){const r=e.encoding,i=e.format,a=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===q||r!==U&&(r===F?!1===o?!0===t.has("EXT_sRGB")&&i===E?(e.format=q,e.minFilter=y,e.generateMipmaps=!1):n=be.sRGBToLinear(n):i===E&&a===x||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",r)),n}this.allocateTextureUnit=function(){const e=Y;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),Y+=1,e},this.resetTextureUnits=function(){Y=0},this.setTexture2D=K,this.setTexture2DArray=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?ee(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?ee(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=function(t,i){const s=r.get(t);t.version>0&&s.__version!==t.version?function(t,r,i){if(6!==r.image.length)return;const s=Q(t,r),l=r.source;if(n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),l.version!==l.__currentVersion||!0===s){e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);const t=r.isCompressedTexture||r.image[0].isCompressedTexture,i=r.image[0]&&r.image[0].isDataTexture,u=[];for(let e=0;e<6;e++)u[e]=t||i?i?r.image[e].image:r.image[e]:N(r.image[e],!1,!0,c),u[e]=ce(r,u[e]);const h=u[0],d=O(h)||o,f=a.convert(r.format,r.encoding),p=a.convert(r.type),m=V(r.internalFormat,f,p,r.encoding),g=o&&!0!==r.isVideoTexture,v=void 0===l.__currentVersion||!0===s;let y,_=H(r,h,d);if($(34067,r,d),t){g&&v&&n.texStorage2D(34067,_,m,h.width,h.height);for(let e=0;e<6;e++){y=u[e].mipmaps;for(let t=0;t<y.length;t++){const i=y[t];r.format!==E?null!==f?g?n.compressedTexSubImage2D(34069+e,t,0,0,i.width,i.height,f,i.data):n.compressedTexImage2D(34069+e,t,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?n.texSubImage2D(34069+e,t,0,0,i.width,i.height,f,p,i.data):n.texImage2D(34069+e,t,m,i.width,i.height,0,f,p,i.data)}}}else{y=r.mipmaps,g&&v&&(y.length>0&&_++,n.texStorage2D(34067,_,m,u[0].width,u[0].height));for(let e=0;e<6;e++)if(i){g?n.texSubImage2D(34069+e,0,0,0,u[e].width,u[e].height,f,p,u[e].data):n.texImage2D(34069+e,0,m,u[e].width,u[e].height,0,f,p,u[e].data);for(let t=0;t<y.length;t++){const r=y[t].image[e].image;g?n.texSubImage2D(34069+e,t+1,0,0,r.width,r.height,f,p,r.data):n.texImage2D(34069+e,t+1,m,r.width,r.height,0,f,p,r.data)}}else{g?n.texSubImage2D(34069+e,0,0,0,f,p,u[e]):n.texImage2D(34069+e,0,m,f,p,u[e]);for(let t=0;t<y.length;t++){const r=y[t];g?n.texSubImage2D(34069+e,t+1,0,0,f,p,r.image[e]):n.texImage2D(34069+e,t+1,m,f,p,r.image[e])}}}z(r,d)&&B(34067),l.__currentVersion=l.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}(s,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,s.__webglTexture))},this.rebindTextures=function(e,t,n){const i=r.get(e);void 0!==t&&re(i.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&ae(e)},this.setupRenderTarget=function(t){const l=t.texture,c=r.get(t),u=r.get(l);t.addEventListener("dispose",j),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=l.version,s.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,f=O(t)||o;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),d)if(i.drawBuffers){const n=t.texture;for(let t=0,i=n.length;t<i;t++){const i=r.get(n[t]);void 0===i.__webglTexture&&(i.__webglTexture=e.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&t.samples>0&&!1===oe(t)){const r=d?l:[l];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let n=0;n<r.length;n++){const i=r[n];c.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer[n]);const s=a.convert(i.format,i.encoding),o=a.convert(i.type),l=V(i.internalFormat,s,o,i.encoding),u=se(t);e.renderbufferStorageMultisample(36161,u,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+n,36161,c.__webglColorRenderbuffer[n])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),ie(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}}if(h){n.bindTexture(34067,u.__webglTexture),$(34067,l,f);for(let e=0;e<6;e++)re(c.__webglFramebuffer[e],t,l,36064,34069+e);z(l,f)&&B(34067),n.unbindTexture()}else if(d){const e=t.texture;for(let i=0,a=e.length;i<a;i++){const a=e[i],s=r.get(a);n.bindTexture(3553,s.__webglTexture),$(3553,a,f),re(c.__webglFramebuffer,t,a,36064+i,3553),z(a,f)&&B(3553)}n.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(o?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(e,u.__webglTexture),$(e,l,f),re(c.__webglFramebuffer,t,l,36064,e),z(l,f)&&B(e),n.unbindTexture()}t.depthBuffer&&ae(t)},this.updateRenderTargetMipmap=function(e){const t=O(e)||o,i=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let a=0,s=i.length;a<s;a++){const s=i[a];if(z(s,t)){const t=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(s).__webglTexture;n.bindTexture(t,i),B(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(o&&t.samples>0&&!1===oe(t)){const i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=t.width,s=t.height;let o=16384;const l=[],c=t.stencilBuffer?33306:36096,u=r.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(let t=0;t<i.length;t++)n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),n.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);n.bindFramebuffer(36008,u.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,u.__webglFramebuffer);for(let n=0;n<i.length;n++){l.push(36064+n),t.depthBuffer&&l.push(c);const d=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===d&&(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024)),h&&e.framebufferRenderbuffer(36008,36064,36161,u.__webglColorRenderbuffer[n]),!0===d&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),h){const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,a,s,0,0,a,s,o,9728),L&&e.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),h)for(let t=0;t<i.length;t++){n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,u.__webglColorRenderbuffer[t]);const a=r.get(i[t]).__webglTexture;n.bindFramebuffer(36160,u.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,a,0)}n.bindFramebuffer(36009,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ae,this.setupFrameBufferTexture=re,this.useMultisampledRTT=oe}function pa(e,t,n){const r=n.isWebGL2;return{convert:function(n,i=null){let a;if(n===x)return 5121;if(1017===n)return 32819;if(1018===n)return 32820;if(1010===n)return 5120;if(1011===n)return 5122;if(1012===n)return 5123;if(1013===n)return 5124;if(n===b)return 5125;if(n===w)return 5126;if(n===S)return r?5131:(a=t.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===n)return 6406;if(n===E)return 6408;if(1024===n)return 6409;if(1025===n)return 6410;if(n===T)return 6402;if(n===C)return 34041;if(1028===n)return 6403;if(1022===n)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(n===q)return a=t.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1029===n)return 36244;if(1030===n)return 33319;if(1031===n)return 33320;if(1033===n)return 36249;if(n===A||n===L||n===P||n===R)if(i===F){if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(n===A)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===L)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===P)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===R)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=t.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(n===A)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===L)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===P)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===R)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===n||35841===n||35842===n||35843===n){if(a=t.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===n)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===n)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===n)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===n)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return a=t.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===n||37496===n){if(a=t.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===n)return i===F?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n){if(a=t.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===n)return i===F?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===n){if(a=t.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===n)return i===F?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return n===M?r?34042:(a=t.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[n]?e[n]:null}}}class ma extends In{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ga extends kt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const va={type:"move"};class ya{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ga,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ga,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Re,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Re),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ga,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Re,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Re),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;for(const a of e.hand.values()){const e=t.getJointPose(a,n);if(void 0===l.joints[a.jointName]){const e=new ga;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[a.jointName]=e,l.add(e)}const r=l.joints[a.jointName];null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),o=.02,c=.005;l.inputState.pinching&&s>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1));null!==s&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(va)))}return null!==s&&(s.visible=null!==r),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==a),this}}class _a extends Ee{constructor(e,t,n,r,i,a,s,o,l,c){if((c=void 0!==c?c:T)!==T&&c!==C)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===T&&(n=b),void 0===n&&c===C&&(n=M),super(null,r,i,a,s,o,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==s?s:m,this.minFilter=void 0!==o?o:m,this.flipY=!1,this.generateMipmaps=!1}}class xa extends X{constructor(e,t){super();const n=this;let r=null,i=1,a=null,s="local-floor",o=null,l=null,c=null,u=null,h=null,d=null;const f=t.getContextAttributes();let p=null,m=null;const g=[],v=[],y=new In;y.layers.enable(1),y.viewport=new Te;const _=new In;_.layers.enable(2),_.viewport=new Te;const w=[y,_],S=new ma;S.layers.enable(1),S.layers.enable(2);let A=null,L=null;function P(e){const t=v.indexOf(e.inputSource);if(-1===t)return;const n=g[t];void 0!==n&&n.dispatchEvent({type:e.type,data:e.inputSource})}function R(){r.removeEventListener("select",P),r.removeEventListener("selectstart",P),r.removeEventListener("selectend",P),r.removeEventListener("squeeze",P),r.removeEventListener("squeezestart",P),r.removeEventListener("squeezeend",P),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",D);for(let e=0;e<g.length;e++){const t=v[e];null!==t&&(v[e]=null,g[e].disconnect(t))}A=null,L=null,e.setRenderTarget(p),h=null,u=null,c=null,r=null,m=null,z.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function D(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=v.indexOf(n);r>=0&&(v[r]=null,g[r].dispatchEvent({type:"disconnected",data:n}))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=v.indexOf(n);if(-1===r){for(let e=0;e<g.length;e++){if(e>=v.length){v.push(n),r=e;break}if(null===v[e]){v[e]=n,r=e;break}}if(-1===r)break}const i=g[r];i&&i.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=g[e];return void 0===t&&(t=new ya,g[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=g[e];return void 0===t&&(t=new ya,g[e]=t),t.getGripSpace()},this.getHand=function(e){let t=g[e];return void 0===t&&(t=new ya,g[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o||a},this.setReferenceSpace=function(e){o=e},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return d},this.getSession=function(){return r},this.setSession=async function(l){if(r=l,null!==r){if(p=e.getRenderTarget(),r.addEventListener("select",P),r.addEventListener("selectstart",P),r.addEventListener("selectend",P),r.addEventListener("squeeze",P),r.addEventListener("squeezestart",P),r.addEventListener("squeezeend",P),r.addEventListener("end",R),r.addEventListener("inputsourceschange",D),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2){const n={antialias:void 0!==r.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:h}),m=new Ce(h.framebufferWidth,h.framebufferHeight,{format:E,type:x,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let n=null,a=null,s=null;f.depth&&(s=f.stencil?35056:33190,n=f.stencil?C:T,a=f.stencil?M:b);const o={colorFormat:32856,depthFormat:s,scaleFactor:i};c=new XRWebGLBinding(r,t),u=c.createProjectionLayer(o),r.updateRenderState({layers:[u]}),m=new Ce(u.textureWidth,u.textureHeight,{format:E,type:x,depthTexture:new _a(u.textureWidth,u.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});e.properties.get(m).__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),o=null,a=await r.requestReferenceSpace(s),z.setContext(r),z.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const k=new Re,I=new Re;function N(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;S.near=_.near=y.near=e.near,S.far=_.far=y.far=e.far,A===S.near&&L===S.far||(r.updateRenderState({depthNear:S.near,depthFar:S.far}),A=S.near,L=S.far);const t=e.parent,n=S.cameras;N(S,t);for(let r=0;r<n.length;r++)N(n[r],t);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),e.matrix.copy(S.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);const i=e.children;for(let r=0,a=i.length;r<a;r++)i[r].updateMatrixWorld(!0);2===n.length?function(e,t,n){k.setFromMatrixPosition(t.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);const r=k.distanceTo(I),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,s=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=s*u,f=s*h,p=r/(-u+h),m=p*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=s+p,v=o+p,y=d-m,_=f+(r-m),x=l*o/v*g,b=c*o/v*g;e.projectionMatrix.makePerspective(y,_,x,b,g,v)}(S,y,_):S.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(e){null!==u&&(u.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)};let O=null;const z=new qn;z.setAnimationLoop((function(t,n){if(l=n.getViewerPose(o||a),d=n,null!==l){const t=l.views;null!==h&&(e.setRenderTargetFramebuffer(m,h.framebuffer),e.setRenderTarget(m));let n=!1;t.length!==S.cameras.length&&(S.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r];let a=null;if(null!==h)a=h.getViewport(i);else{const t=c.getViewSubImage(u,i);a=t.viewport,0===r&&(e.setRenderTargetTextures(m,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(m))}let s=w[r];void 0===s&&(s=new In,s.layers.enable(r),s.viewport=new Te,w[r]=s),s.matrix.fromArray(i.transform.matrix),s.projectionMatrix.fromArray(i.projectionMatrix),s.viewport.set(a.x,a.y,a.width,a.height),0===r&&S.matrix.copy(s.matrix),!0===n&&S.cameras.push(s)}}for(let e=0;e<g.length;e++){const t=v[e],r=g[e];null!==t&&void 0!==r&&r.update(t,n,o||a)}O&&O(t,n),d=null})),this.setAnimationLoop=function(e){O=e},this.dispose=function(){}}}function ba(e,t){function n(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,1===r.side&&(n.bumpScale.value*=-1)),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),1===r.side&&n.normalScale.value.negate()),r.specularMap&&(n.specularMap.value=r.specularMap),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);const i=t.get(r).envMap;if(i&&(n.envMap.value=i,n.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;const t=!0!==e.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=r.lightMapIntensity*t}let a,s;r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?a=r.map:r.specularMap?a=r.specularMap:r.displacementMap?a=r.displacementMap:r.normalMap?a=r.normalMap:r.bumpMap?a=r.bumpMap:r.roughnessMap?a=r.roughnessMap:r.metalnessMap?a=r.metalnessMap:r.alphaMap?a=r.alphaMap:r.emissiveMap?a=r.emissiveMap:r.clearcoatMap?a=r.clearcoatMap:r.clearcoatNormalMap?a=r.clearcoatNormalMap:r.clearcoatRoughnessMap?a=r.clearcoatRoughnessMap:r.iridescenceMap?a=r.iridescenceMap:r.iridescenceThicknessMap?a=r.iridescenceThicknessMap:r.specularIntensityMap?a=r.specularIntensityMap:r.specularColorMap?a=r.specularColorMap:r.transmissionMap?a=r.transmissionMap:r.thicknessMap?a=r.thicknessMap:r.sheenColorMap?a=r.sheenColorMap:r.sheenRoughnessMap&&(a=r.sheenRoughnessMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),n.uvTransform.value.copy(a.matrix)),r.aoMap?s=r.aoMap:r.lightMap&&(s=r.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),n.uv2Transform.value.copy(s.matrix))}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),e.fogNear.value=t.near,e.fogFar.value=t.far,t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a,s){r.isMeshBasicMaterial||r.isMeshLambertMaterial?n(e,r):r.isMeshToonMaterial?(n(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(n(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(n(e,r),function(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap);n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap);t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate()));t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap);t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,r,s)):r.isMeshMatcapMaterial?(n(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?n(e,r):r.isMeshDistanceMaterial?(n(e,r),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?n(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,a):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function wa(e,t,n,r){let i={},a={},s=[];const o=n.isWebGL2?e.getParameter(35375):0;function l(e,t,n){const r=e.value;if(void 0===n[t])return n[t]="number"===typeof r?r:r.clone(),!0;if("number"===typeof r){if(n[t]!==r)return n[t]=r,!0}else{const e=n[t];if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t=e.value,n={boundary:0,storage:0};return"number"===typeof t?(n.boundary=4,n.storage=4):t.isVector2?(n.boundary=8,n.storage=8):t.isVector3||t.isColor?(n.boundary=16,n.storage=12):t.isVector4?(n.boundary=16,n.storage=16):t.isMatrix3?(n.boundary=48,n.storage=48):t.isMatrix4?(n.boundary=64,n.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),n}function u(t){const n=t.target;n.removeEventListener("dispose",u);const r=s.indexOf(n.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){let d=i[n.id];void 0===d&&(!function(e){const t=e.uniforms;let n=0;const r=16;let i=0;for(let a=0,s=t.length;a<s;a++){const e=t[a],s=c(e);if(e.__data=new Float32Array(s.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=n,a>0){i=n%r;const t=r-i;0!==i&&t-s.boundary<0&&(n+=r-i,e.__offset=n)}n+=s.storage}i=n%r,i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===s.indexOf(e))return s.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(35345,r),e.bufferData(35345,i,a),e.bindBuffer(35345,null),e.bindBufferBase(35345,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const f=h.program;r.updateUBOMapping(n,f);const p=t.render.frame;a[n.id]!==p&&(!function(t){const n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(35345,n);for(let i=0,s=r.length;i<s;i++){const t=r[i];if(!0===l(t,i,a)){const n=t.value,r=t.__offset;"number"===typeof n?(t.__data[0]=n,e.bufferSubData(35345,r,t.__data)):(t.value.isMatrix3?(t.__data[0]=t.value.elements[0],t.__data[1]=t.value.elements[1],t.__data[2]=t.value.elements[2],t.__data[3]=t.value.elements[0],t.__data[4]=t.value.elements[3],t.__data[5]=t.value.elements[4],t.__data[6]=t.value.elements[5],t.__data[7]=t.value.elements[0],t.__data[8]=t.value.elements[6],t.__data[9]=t.value.elements[7],t.__data[10]=t.value.elements[8],t.__data[11]=t.value.elements[0]):n.toArray(t.__data),e.bufferSubData(35345,r,t.__data))}}e.bindBuffer(35345,null)}(n),a[n.id]=p)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);s=[],i={},a={}}}}function Sa(e={}){this.isWebGLRenderer=!0;const t=void 0!==e.canvas?e.canvas:function(){const e=le("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,r=void 0===e.depth||e.depth,i=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,o=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h;h=null!==n?n.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let d=null,f=null;const p=[],m=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=U,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const g=this;let v=!1,y=0,b=0,M=null,T=-1,C=null;const A=new Te,L=new Te;let P=null,R=t.width,D=t.height,k=1,I=null,N=null;const O=new Te(0,0,R,D),z=new Te(0,0,R,D);let F=!1;const B=new jn;let V=!1,H=!1,W=null;const G=new lt,j=new ae,q=new Re,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return null===M?k:1}let K,Z,J,$,Q,ee,te,re,ie,se,oe,ce,ue,he,de,fe,pe,me,ge,ve,ye,_e,xe,be,we=n;function Se(e,n){for(let r=0;r<e.length;r++){const i=e[r],a=t.getContext(i,n);if(null!==a)return a}return null}try{const e={alpha:!0,depth:r,stencil:i,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r144"),t.addEventListener("webglcontextlost",Ae,!1),t.addEventListener("webglcontextrestored",Le,!1),t.addEventListener("webglcontextcreationerror",Pe,!1),null===we){const t=["webgl2","webgl","experimental-webgl"];if(!0===g.isWebGL1Renderer&&t.shift(),we=Se(t,e),null===we)throw Se(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===we.getShaderPrecisionFormat&&(we.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(We){throw console.error("THREE.WebGLRenderer: "+We.message),We}function Me(){K=new xr(we),Z=new tr(we,K,e),K.init(Z),_e=new pa(we,K,Z),J=new da(we,K,Z),$=new Sr,Q=new $i,ee=new fa(we,K,J,Q,Z,_e,$),te=new rr(g),re=new _r(g),ie=new Xn(we,Z),xe=new Qn(we,K,ie,Z),se=new br(we,ie,$,xe),oe=new Cr(we,se,ie,$),ge=new Tr(we,Z,ee),fe=new nr(Q),ce=new Ji(g,te,re,K,Z,xe,fe),ue=new ba(g,Q),he=new na,de=new la(K,Z),me=new $n(g,te,J,oe,h,o),pe=new ha(g,oe,Z),be=new wa(we,$,Z,J),ve=new er(we,K,$,Z),ye=new wr(we,K,$,Z),$.programs=ce.programs,g.capabilities=Z,g.extensions=K,g.properties=Q,g.renderLists=he,g.shadowMap=pe,g.state=J,g.info=$}Me();const Ee=new xa(g,we);function Ae(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function Le(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;const e=$.autoReset,t=pe.enabled,n=pe.autoUpdate,r=pe.needsUpdate,i=pe.type;Me(),$.autoReset=e,pe.enabled=t,pe.autoUpdate=n,pe.needsUpdate=r,pe.type=i}function Pe(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function De(e){const t=e.target;t.removeEventListener("dispose",De),function(e){(function(e){const t=Q.get(e).programs;void 0!==t&&(t.forEach((function(e){ce.releaseProgram(e)})),e.isShaderMaterial&&ce.releaseShaderCache(e))})(e),Q.remove(e)}(t)}this.xr=Ee,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){const e=K.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=K.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(e){void 0!==e&&(k=e,this.setSize(R,D,!1))},this.getSize=function(e){return e.set(R,D)},this.setSize=function(e,n,r){Ee.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(R=e,D=n,t.width=Math.floor(e*k),t.height=Math.floor(n*k),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(R*k,D*k).floor()},this.setDrawingBufferSize=function(e,n,r){R=e,D=n,k=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(A)},this.getViewport=function(e){return e.copy(O)},this.setViewport=function(e,t,n,r){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,n,r),J.viewport(A.copy(O).multiplyScalar(k).floor())},this.getScissor=function(e){return e.copy(z)},this.setScissor=function(e,t,n,r){e.isVector4?z.set(e.x,e.y,e.z,e.w):z.set(e,t,n,r),J.scissor(L.copy(z).multiplyScalar(k).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(e){J.setScissorTest(F=e)},this.setOpaqueSort=function(e){I=e},this.setTransparentSort=function(e){N=e},this.getClearColor=function(e){return e.copy(me.getClearColor())},this.setClearColor=function(){me.setClearColor.apply(me,arguments)},this.getClearAlpha=function(){return me.getClearAlpha()},this.setClearAlpha=function(){me.setClearAlpha.apply(me,arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;e&&(r|=16384),t&&(r|=256),n&&(r|=1024),we.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ae,!1),t.removeEventListener("webglcontextrestored",Le,!1),t.removeEventListener("webglcontextcreationerror",Pe,!1),he.dispose(),de.dispose(),Q.dispose(),te.dispose(),re.dispose(),oe.dispose(),xe.dispose(),be.dispose(),ce.dispose(),Ee.dispose(),Ee.removeEventListener("sessionstart",Ie),Ee.removeEventListener("sessionend",Ne),W&&(W.dispose(),W=null),Oe.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=X);const s=i.isMesh&&i.matrixWorld.determinant()<0,o=function(e,t,n,r,i){!0!==t.isScene&&(t=X);ee.resetTextureUnits();const a=t.fog,s=r.isMeshStandardMaterial?t.environment:null,o=null===M?g.outputEncoding:!0===M.isXRRenderTarget?M.texture.encoding:U,l=(r.isMeshStandardMaterial?re:te).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color,m=r.toneMapped?g.toneMapping:0,v=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,y=void 0!==v?v.length:0,_=Q.get(r),x=f.state.lights;if(!0===V&&(!0===H||e!==C)){const t=e===C&&r.id===T;fe.setState(r,e,t)}let b=!1;r.version===_.__version?_.needsLights&&_.lightsStateVersion!==x.state.version||_.outputEncoding!==o||i.isInstancedMesh&&!1===_.instancing?b=!0:i.isInstancedMesh||!0!==_.instancing?i.isSkinnedMesh&&!1===_.skinning?b=!0:i.isSkinnedMesh||!0!==_.skinning?_.envMap!==l||!0===r.fog&&_.fog!==a?b=!0:void 0===_.numClippingPlanes||_.numClippingPlanes===fe.numPlanes&&_.numIntersection===fe.numIntersection?(_.vertexAlphas!==c||_.vertexTangents!==u||_.morphTargets!==h||_.morphNormals!==d||_.morphColors!==p||_.toneMapping!==m||!0===Z.isWebGL2&&_.morphTargetsCount!==y)&&(b=!0):b=!0:b=!0:b=!0:(b=!0,_.__version=r.version);let w=_.currentProgram;!0===b&&(w=Ve(r,t,i));let S=!1,E=!1,A=!1;const L=w.getUniforms(),P=_.uniforms;J.useProgram(w.program)&&(S=!0,E=!0,A=!0);r.id!==T&&(T=r.id,E=!0);if(S||C!==e){if(L.setValue(we,"projectionMatrix",e.projectionMatrix),Z.logarithmicDepthBuffer&&L.setValue(we,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),C!==e&&(C=e,E=!0,A=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const t=L.map.cameraPosition;void 0!==t&&t.setValue(we,q.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&L.setValue(we,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&L.setValue(we,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){L.setOptional(we,i,"bindMatrix"),L.setOptional(we,i,"bindMatrixInverse");const e=i.skeleton;e&&(Z.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),L.setValue(we,"boneTexture",e.boneTexture,ee),L.setValue(we,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const R=n.morphAttributes;(void 0!==R.position||void 0!==R.normal||void 0!==R.color&&!0===Z.isWebGL2)&&ge.update(i,n,r,w);(E||_.receiveShadow!==i.receiveShadow)&&(_.receiveShadow=i.receiveShadow,L.setValue(we,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(P.envMap.value=l,P.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);E&&(L.setValue(we,"toneMappingExposure",g.toneMappingExposure),_.needsLights&&(N=A,(I=P).ambientLightColor.needsUpdate=N,I.lightProbe.needsUpdate=N,I.directionalLights.needsUpdate=N,I.directionalLightShadows.needsUpdate=N,I.pointLights.needsUpdate=N,I.pointLightShadows.needsUpdate=N,I.spotLights.needsUpdate=N,I.spotLightShadows.needsUpdate=N,I.rectAreaLights.needsUpdate=N,I.hemisphereLights.needsUpdate=N),a&&!0===r.fog&&ue.refreshFogUniforms(P,a),ue.refreshMaterialUniforms(P,r,k,D,W),Ri.upload(we,_.uniformsList,P,ee));var I,N;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Ri.upload(we,_.uniformsList,P,ee),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&L.setValue(we,"center",i.center);if(L.setValue(we,"modelViewMatrix",i.modelViewMatrix),L.setValue(we,"normalMatrix",i.normalMatrix),L.setValue(we,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++)if(Z.isWebGL2){const n=e[t];be.update(n,w),be.bind(n,w)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return w}(e,t,n,r,i);J.setMaterial(r,s);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===r.wireframe&&(l=se.getWireframeAttribute(n),h=2),xe.setup(i,r,o,n,l);let d=ve;null!==l&&(u=ie.get(l),d=ye,d.setIndex(u));const p=null!==l?l.count:c.count,m=n.drawRange.start*h,v=n.drawRange.count*h,y=null!==a?a.start*h:0,_=null!==a?a.count*h:1/0,x=Math.max(m,y),b=Math.min(p,m+v,y+_)-1,w=Math.max(0,b-x+1);if(0!==w){if(i.isMesh)!0===r.wireframe?(J.setLineWidth(r.wireframeLinewidth*Y()),d.setMode(1)):d.setMode(4);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),J.setLineWidth(e*Y()),i.isLineSegments?d.setMode(1):i.isLineLoop?d.setMode(2):d.setMode(3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);if(i.isInstancedMesh)d.renderInstances(x,w,i.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(x,w,e)}else d.render(x,w)}},this.compile=function(e,t){function n(e,t,n){!0===e.transparent&&e.side===a?(e.side=1,e.needsUpdate=!0,Ve(e,t,n),e.side=0,e.needsUpdate=!0,Ve(e,t,n),e.side=a):Ve(e,t,n)}f=de.get(e),f.init(),m.push(f),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(g.physicallyCorrectLights),e.traverse((function(t){const r=t.material;if(r)if(Array.isArray(r))for(let i=0;i<r.length;i++){n(r[i],e,t)}else n(r,e,t)})),m.pop(),f=null};let ke=null;function Ie(){Oe.stop()}function Ne(){Oe.start()}const Oe=new qn;function ze(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||B.intersectsSprite(e)){r&&q.setFromMatrixPosition(e.matrixWorld).applyMatrix4(G);const t=oe.update(e),i=e.material;i.visible&&d.push(e,t,i,n,q.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==$.render.frame&&(e.skeleton.update(),e.skeleton.frame=$.render.frame),!e.frustumCulled||B.intersectsObject(e))){r&&q.setFromMatrixPosition(e.matrixWorld).applyMatrix4(G);const t=oe.update(e),i=e.material;if(Array.isArray(i)){const r=t.groups;for(let a=0,s=r.length;a<s;a++){const s=r[a],o=i[s.materialIndex];o&&o.visible&&d.push(e,t,o,n,q.z,s)}}else i.visible&&d.push(e,t,i,n,q.z,null)}const i=e.children;for(let a=0,s=i.length;a<s;a++)ze(i[a],t,n,r)}function Ue(e,t,n,r){const i=e.opaque,a=e.transmissive,o=e.transparent;f.setupLightsView(n),a.length>0&&function(e,t,n){const r=Z.isWebGL2;null===W&&(W=new Ce(1,1,{generateMipmaps:!0,type:K.has("EXT_color_buffer_half_float")?S:x,minFilter:_,samples:r&&!0===s?4:0}));g.getDrawingBufferSize(j),r?W.setSize(j.x,j.y):W.setSize(ne(j.x),ne(j.y));const i=g.getRenderTarget();g.setRenderTarget(W),g.clear();const a=g.toneMapping;g.toneMapping=0,Fe(e,t,n),g.toneMapping=a,ee.updateMultisampleRenderTarget(W),ee.updateRenderTargetMipmap(W),g.setRenderTarget(i)}(i,t,n),r&&J.viewport(A.copy(r)),i.length>0&&Fe(i,t,n),a.length>0&&Fe(a,t,n),o.length>0&&Fe(o,t,n),J.buffers.depth.setTest(!0),J.buffers.depth.setMask(!0),J.buffers.color.setMask(!0),J.setPolygonOffset(!1)}function Fe(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],s=a.object,o=a.geometry,l=null===r?a.material:r,c=a.group;s.layers.test(n.layers)&&Be(s,t,n,o,l,c)}}function Be(e,t,n,r,i,s){e.onBeforeRender(g,t,n,r,i,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(g,t,n,r,e,s),!0===i.transparent&&i.side===a?(i.side=1,i.needsUpdate=!0,g.renderBufferDirect(n,t,r,i,e,s),i.side=0,i.needsUpdate=!0,g.renderBufferDirect(n,t,r,i,e,s),i.side=a):g.renderBufferDirect(n,t,r,i,e,s),e.onAfterRender(g,t,n,r,i,s)}function Ve(e,t,n){!0!==t.isScene&&(t=X);const r=Q.get(e),i=f.state.lights,a=f.state.shadowsArray,s=i.state.version,o=ce.getParameters(e,i.state,a,t,n),l=ce.getProgramCacheKey(o);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?re:te).get(e.envMap||r.environment),void 0===c&&(e.addEventListener("dispose",De),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===s)return He(e,o),u}else o.uniforms=ce.getUniforms(e),e.onBuild(n,o,g),e.onBeforeCompile(o,g),u=ce.acquireProgram(o,l),c.set(l,u),r.uniforms=o.uniforms;const h=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=fe.uniform),He(e,o),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const d=u.getUniforms(),p=Ri.seqWithValue(d.seq,h);return r.currentProgram=u,r.uniformsList=p,u}function He(e,t){const n=Q.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Oe.setAnimationLoop((function(e){ke&&ke(e)})),"undefined"!==typeof self&&Oe.setContext(self),this.setAnimationLoop=function(e){ke=e,Ee.setAnimationLoop(e),null===e?Oe.stop():Oe.start()},Ee.addEventListener("sessionstart",Ie),Ee.addEventListener("sessionend",Ne),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===v)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Ee.enabled&&!0===Ee.isPresenting&&(!0===Ee.cameraAutoUpdate&&Ee.updateCamera(t),t=Ee.getCamera()),!0===e.isScene&&e.onBeforeRender(g,e,t,M),f=de.get(e,m.length),f.init(),m.push(f),G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(G),H=this.localClippingEnabled,V=fe.init(this.clippingPlanes,H,t),d=he.get(e,p.length),d.init(),p.push(d),ze(e,t,0,g.sortObjects),d.finish(),!0===g.sortObjects&&d.sort(I,N),!0===V&&fe.beginShadows();const n=f.state.shadowsArray;if(pe.render(n,e,t),!0===V&&fe.endShadows(),!0===this.info.autoReset&&this.info.reset(),me.render(d,e),f.setupLights(g.physicallyCorrectLights),t.isArrayCamera){const n=t.cameras;for(let t=0,r=n.length;t<r;t++){const r=n[t];Ue(d,e,r,r.viewport)}}else Ue(d,e,t);null!==M&&(ee.updateMultisampleRenderTarget(M),ee.updateRenderTargetMipmap(M)),!0===e.isScene&&e.onAfterRender(g,e,t),xe.resetDefaultState(),T=-1,C=null,m.pop(),f=m.length>0?m[m.length-1]:null,p.pop(),d=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(e,t,n){Q.get(e.texture).__webglTexture=t,Q.get(e.depthTexture).__webglTexture=n;const r=Q.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===K.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const n=Q.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,n=0){M=e,y=t,b=n;let r=!0;if(e){const t=Q.get(e);void 0!==t.__useDefaultFramebuffer?(J.bindFramebuffer(36160,null),r=!1):void 0===t.__webglFramebuffer?ee.setupRenderTarget(e):t.__hasExternalTextures&&ee.rebindTextures(e,Q.get(e.texture).__webglTexture,Q.get(e.depthTexture).__webglTexture)}let i=null,a=!1,s=!1;if(e){const n=e.texture;(n.isData3DTexture||n.isDataArrayTexture)&&(s=!0);const r=Q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=r[t],a=!0):i=Z.isWebGL2&&e.samples>0&&!1===ee.useMultisampledRTT(e)?Q.get(e).__webglMultisampledFramebuffer:r,A.copy(e.viewport),L.copy(e.scissor),P=e.scissorTest}else A.copy(O).multiplyScalar(k).floor(),L.copy(z).multiplyScalar(k).floor(),P=F;if(J.bindFramebuffer(36160,i)&&Z.drawBuffers&&r&&J.drawBuffers(e,i),J.viewport(A),J.scissor(L),J.setScissorTest(P),a){const r=Q.get(e.texture);we.framebufferTexture2D(36160,36064,34069+t,r.__webglTexture,n)}else if(s){const r=Q.get(e.texture),i=t||0;we.framebufferTextureLayer(36160,36064,r.__webglTexture,n||0,i)}T=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,s){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=Q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(o=o[s]),o){J.bindFramebuffer(36160,o);try{const s=e.texture,o=s.format,l=s.type;if(o!==E&&_e.convert(o)!==we.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===S&&(K.has("EXT_color_buffer_half_float")||Z.isWebGL2&&K.has("EXT_color_buffer_float"));if(l!==x&&_e.convert(l)!==we.getParameter(35738)&&(l!==w||!(Z.isWebGL2||K.has("OES_texture_float")||K.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&we.readPixels(t,n,r,i,_e.convert(o),_e.convert(l),a)}finally{const e=null!==M?Q.get(M).__webglFramebuffer:null;J.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t,n=0){const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r);ee.setTexture2D(t,0),we.copyTexSubImage2D(3553,n,0,0,e.x,e.y,i,a),J.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r=0){const i=t.image.width,a=t.image.height,s=_e.convert(n.format),o=_e.convert(n.type);ee.setTexture2D(n,0),we.pixelStorei(37440,n.flipY),we.pixelStorei(37441,n.premultiplyAlpha),we.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?we.texSubImage2D(3553,r,e.x,e.y,i,a,s,o,t.image.data):t.isCompressedTexture?we.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,s,t.mipmaps[0].data):we.texSubImage2D(3553,r,e.x,e.y,s,o,t.image),0===r&&n.generateMipmaps&&we.generateMipmap(3553),J.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r,i=0){if(g.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const a=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,o=e.max.z-e.min.z+1,l=_e.convert(r.format),c=_e.convert(r.type);let u;if(r.isData3DTexture)ee.setTexture3D(r,0),u=32879;else{if(!r.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ee.setTexture2DArray(r,0),u=35866}we.pixelStorei(37440,r.flipY),we.pixelStorei(37441,r.premultiplyAlpha),we.pixelStorei(3317,r.unpackAlignment);const h=we.getParameter(3314),d=we.getParameter(32878),f=we.getParameter(3316),p=we.getParameter(3315),m=we.getParameter(32877),v=n.isCompressedTexture?n.mipmaps[0]:n.image;we.pixelStorei(3314,v.width),we.pixelStorei(32878,v.height),we.pixelStorei(3316,e.min.x),we.pixelStorei(3315,e.min.y),we.pixelStorei(32877,e.min.z),n.isDataTexture||n.isData3DTexture?we.texSubImage3D(u,i,t.x,t.y,t.z,a,s,o,l,c,v.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),we.compressedTexSubImage3D(u,i,t.x,t.y,t.z,a,s,o,l,v.data)):we.texSubImage3D(u,i,t.x,t.y,t.z,a,s,o,l,c,v),we.pixelStorei(3314,h),we.pixelStorei(32878,d),we.pixelStorei(3316,f),we.pixelStorei(3315,p),we.pixelStorei(32877,m),0===i&&r.generateMipmaps&&we.generateMipmap(u),J.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?ee.setTextureCube(e,0):e.isData3DTexture?ee.setTexture3D(e,0):e.isDataArrayTexture?ee.setTexture2DArray(e,0):ee.setTexture2D(e,0),J.unbindTexture()},this.resetState=function(){y=0,b=0,M=null,J.reset(),xe.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends Sa{}).prototype.isWebGL1Renderer=!0;class Ma{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new _e(e),this.density=t}clone(){return new Ma(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Ea{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new _e(e),this.near=t,this.far=n}clone(){return new Ea(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Ta extends kt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class Ca extends Zt{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Aa=new lt,La=new lt,Pa=[],Ra=new Tn;class Da extends Tn{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ca(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Ra.geometry=this.geometry,Ra.material=this.material,void 0!==Ra.material)for(let i=0;i<r;i++){this.getMatrixAt(i,Aa),La.multiplyMatrices(n,Aa),Ra.matrixWorld=La,Ra.raycast(e,Pa);for(let e=0,n=Pa.length;e<n;e++){const n=Pa[e];n.instanceId=i,n.object=this,t.push(n)}Pa.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Ca(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ka extends qt{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new _e(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Ia=new Re,Na=new Re,Oa=new lt,za=new ot,Ua=new Qe;class Fa extends kt{constructor(e=new ln,t=new ka){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)Ia.fromBufferAttribute(t,e-1),Na.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Ia.distanceTo(Na);e.setAttribute("lineDistance",new Qt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ua.copy(n.boundingSphere),Ua.applyMatrix4(r),Ua.radius+=i,!1===e.ray.intersectsSphere(Ua))return;Oa.copy(r).invert(),za.copy(e.ray).applyMatrix4(Oa);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=new Re,c=new Re,u=new Re,h=new Re,d=this.isLineSegments?2:1,f=n.index,p=n.attributes.position;if(null!==f){for(let n=Math.max(0,a.start),r=Math.min(f.count,a.start+a.count)-1;n<r;n+=d){const r=f.getX(n),i=f.getX(n+1);l.fromBufferAttribute(p,r),c.fromBufferAttribute(p,i);if(za.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);const a=e.ray.origin.distanceTo(h);a<e.near||a>e.far||t.push({distance:a,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,a.start),r=Math.min(p.count,a.start+a.count)-1;n<r;n+=d){l.fromBufferAttribute(p,n),c.fromBufferAttribute(p,n+1);if(za.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(h);r<e.near||r>e.far||t.push({distance:r,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}const Ba=new Re,Va=new Re;class Ha extends Fa{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)Ba.fromBufferAttribute(t,e),Va.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+Ba.distanceTo(Va);e.setAttribute("lineDistance",new Qt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Wa extends qt{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new _e(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Ga=new lt,ja=new ot,qa=new Qe,Xa=new Re;class Ya extends kt{constructor(e=new ln,t=new Wa){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),qa.copy(n.boundingSphere),qa.applyMatrix4(r),qa.radius+=i,!1===e.ray.intersectsSphere(qa))return;Ga.copy(r).invert(),ja.copy(e.ray).applyMatrix4(Ga);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);n<i;n++){const i=l.getX(n);Xa.fromBufferAttribute(c,i),Ka(Xa,i,o,r,e,t,this)}}else{for(let n=Math.max(0,a.start),i=Math.min(c.count,a.start+a.count);n<i;n++)Xa.fromBufferAttribute(c,n),Ka(Xa,n,o,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Ka(e,t,n,r,i,a,s){const o=ja.distanceSqToPoint(e);if(o<n){const n=new Re;ja.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:t,face:null,object:s})}}class Za{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const i=n.length;let a;a=t||e*n[i-1];let s,o=0,l=i-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),s=n[r]-a,s<0)o=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===a)return r/(i-1);const c=n[r];return(r+(a-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),s=this.getPoint(i),o=t||(a.isVector2?new ae:new Re);return o.copy(s).sub(a).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Re,r=[],i=[],a=[],s=new Re,o=new lt;for(let d=0;d<=e;d++){const t=d/e;r[d]=this.getTangentAt(t,new Re)}i[0]=new Re,a[0]=new Re;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),a[0].crossVectors(r[0],i[0]);for(let d=1;d<=e;d++){if(i[d]=i[d-1].clone(),a[d]=a[d-1].clone(),s.crossVectors(r[d-1],r[d]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos($(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(o.makeRotationAxis(s,e))}a[d].crossVectors(r[d],i[d])}if(!0===t){let t=Math.acos($(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(o.makeRotationAxis(r[n],t*n)),a[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function Ja(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}class $a extends Za{constructor(e=new Re,t=new Re,n=new Re){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Re){const n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(Ja(e,r.x,i.x,a.x),Ja(e,r.y,i.y,a.y),Ja(e,r.z,i.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Qa extends ln{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,a=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(a+s,Math.PI);let l=0;const c=[],u=new Re,h=new Re,d=[],f=[],p=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let y=0;0==g&&0==a?y=.5/t:g==n&&o==Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const o=n/t;u.x=-e*Math.cos(r+o*i)*Math.sin(a+v*s),u.y=e*Math.cos(a+v*s),u.z=e*Math.sin(r+o*i)*Math.sin(a+v*s),f.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(o+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],r=c[g][e],i=c[g+1][e],s=c[g+1][e+1];(0!==g||a>0)&&d.push(t,r,s),(g!==n-1||o<Math.PI)&&d.push(r,i,s)}this.setIndex(d),this.setAttribute("position",new Qt(f,3)),this.setAttribute("normal",new Qt(p,3)),this.setAttribute("uv",new Qt(m,2))}static fromJSON(e){return new Qa(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class es extends qt{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new _e(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ts extends qt{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new _e(16777215),this.specular=new _e(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ns extends qt{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new _e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ae(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function rs(e,t,n){return as(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function is(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function as(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}class ss{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(e>=i)break e;{const s=t[1];e<s&&(n=2,i=s);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===a)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0}}for(;n<a;){const r=n+a>>>1;e<t[r]?a=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class os extends ss{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:N,endingEnd:N}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,s=r[i],o=r[a];if(void 0===s)switch(this.getSettings_().endingStart){case O:i=e,s=2*t-n;break;case z:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===o)switch(this.getSettings_().endingEnd){case O:a=e,o=2*n-t;break;case z:a=1,o=n+r[1]-r[0];break;default:a=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-n),this._offsetPrev=i*c,this._offsetNext=a*c}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,_=d*m-d*p;for(let x=0;x!==s;++x)i[x]=g*a[c+x]+v*a[l+x]+y*a[o+x]+_*a[u+x];return i}}class ls extends ss{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=(n-t)/(r-t),u=1-c;for(let h=0;h!==s;++h)i[h]=a[l+h]*u+a[o+h]*c;return i}}class cs extends ss{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class us{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=is(t,this.TimeBufferType),this.values=is(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:is(e.times,Array),values:is(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new cs(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ls(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new os(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case D:t=this.InterpolantFactoryMethodDiscrete;break;case k:t=this.InterpolantFactoryMethodLinear;break;case I:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return D;case this.InterpolantFactoryMethodLinear:return k;case this.InterpolantFactoryMethodSmooth:return I}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const e=this.getValueSize();this.times=rs(n,i,a),this.values=rs(this.values,i*e,a*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let s=0;s!==i;s++){const t=n[s];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,t),e=!1;break}if(null!==a&&a>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,t,a),e=!1;break}a=t}if(void 0!==r&&as(r))for(let s=0,o=r.length;s!==o;++s){const t=r[s];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,t),e=!1;break}}return e}optimize(){const e=rs(this.times),t=rs(this.values),n=this.getValueSize(),r=this.getInterpolation()===I,i=e.length-1;let a=1;for(let s=1;s<i;++s){let i=!1;const o=e[s];if(o!==e[s+1]&&(1!==s||o!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,a=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[a+s]){i=!0;break}}}if(i){if(s!==a){e[a]=e[s];const r=s*n,i=a*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*n,r=a*n,s=0;s!==n;++s)t[r+s]=t[e+s];++a}return a!==e.length?(this.times=rs(e,0,a),this.values=rs(t,0,a*n)):(this.times=e,this.values=t),this}clone(){const e=rs(this.times,0),t=rs(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}us.prototype.TimeBufferType=Float32Array,us.prototype.ValueBufferType=Float32Array,us.prototype.DefaultInterpolation=k;class hs extends us{}hs.prototype.ValueTypeName="bool",hs.prototype.ValueBufferType=Array,hs.prototype.DefaultInterpolation=D,hs.prototype.InterpolantFactoryMethodLinear=void 0,hs.prototype.InterpolantFactoryMethodSmooth=void 0;class ds extends us{}ds.prototype.ValueTypeName="color";class fs extends us{}fs.prototype.ValueTypeName="number";class ps extends ss{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=(n-t)/(r-t);let l=e*s;for(let c=l+s;l!==c;l+=4)Pe.slerpFlat(i,0,a,l-s,a,l,o);return i}}class ms extends us{InterpolantFactoryMethodLinear(e){return new ps(this.times,this.values,this.getValueSize(),e)}}ms.prototype.ValueTypeName="quaternion",ms.prototype.DefaultInterpolation=k,ms.prototype.InterpolantFactoryMethodSmooth=void 0;class gs extends us{}gs.prototype.ValueTypeName="string",gs.prototype.ValueBufferType=Array,gs.prototype.DefaultInterpolation=D,gs.prototype.InterpolantFactoryMethodLinear=void 0,gs.prototype.InterpolantFactoryMethodSmooth=void 0;class vs extends us{}vs.prototype.ValueTypeName="vector";const ys={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class _s{constructor(e,t,n){const r=this;let i,a=!1,s=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===a&&void 0!==r.onStart&&r.onStart(e,s,o),a=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,o),s===o&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const xs=new _s;class bs{constructor(e){this.manager=void 0!==e?e:xs,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const ws={};class Ss extends Error{constructor(e,t){super(e),this.response=t}}class Ms extends bs{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=ys.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==ws[e])return void ws[e].push({onLoad:t,onProgress:n,onError:r});ws[e]=[],ws[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,o=this.responseType;fetch(a).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=ws[e],r=t.body.getReader(),i=t.headers.get("Content-Length"),a=i?parseInt(i):0,s=0!==a;let o=0;const l=new ReadableStream({start(e){!function t(){r.read().then((({done:r,value:i})=>{if(r)e.close();else{o+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:o,total:a});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(i),t()}}))}()}});return new Response(l)}throw new Ss(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,s)));case"json":return e.json();default:if(void 0===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((e=>r.decode(e)))}}})).then((t=>{ys.add(e,t);const n=ws[e];delete ws[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}})).catch((t=>{const n=ws[e];if(void 0===n)throw this.manager.itemError(e),t;delete ws[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Es extends bs{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=ys.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;const s=le("img");function o(){c(),ys.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(e),s.src=e,s}}class Ts extends bs{constructor(e){super(e)}load(e,t,n,r){const i=new Ee,a=new Es(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}class Cs extends kt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new _e(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class As extends Cs{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(kt.DefaultUp),this.updateMatrix(),this.groundColor=new _e(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Ls=new lt,Ps=new Re,Rs=new Re;class Ds{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ae(512,512),this.map=null,this.mapPass=null,this.matrix=new lt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new jn,this._frameExtents=new ae(1,1),this._viewportCount=1,this._viewports=[new Te(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Ps.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ps),Rs.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Rs),t.updateMatrixWorld(),Ls.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ls),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class ks extends Ds{constructor(){super(new In(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Z*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Is extends Cs{constructor(e,t,n=0,r=Math.PI/3,i=0,a=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(kt.DefaultUp),this.updateMatrix(),this.target=new kt,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new ks}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Ns extends Ds{constructor(){super(new ir(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Os extends Cs{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(kt.DefaultUp),this.updateMatrix(),this.target=new kt,this.shadow=new Ns}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class zs extends Cs{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}let Us;const Fs=function(){return void 0===Us&&(Us=new(window.AudioContext||window.webkitAudioContext)),Us};class Bs extends bs{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new Ms(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{const e=n.slice(0);Fs().decodeAudioData(e,(function(e){t(e)}))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}}),n,r)}}class Vs{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Hs(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Hs();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Hs(){return("undefined"===typeof performance?Date:performance).now()}const Ws=new Re,Gs=new Pe,js=new Re,qs=new Re;class Xs extends kt{constructor(){super(),this.type="AudioListener",this.context=Fs(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Vs}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ws,Gs,js),qs.set(0,0,-1).applyQuaternion(Gs),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Ws.x,e),t.positionY.linearRampToValueAtTime(Ws.y,e),t.positionZ.linearRampToValueAtTime(Ws.z,e),t.forwardX.linearRampToValueAtTime(qs.x,e),t.forwardY.linearRampToValueAtTime(qs.y,e),t.forwardZ.linearRampToValueAtTime(qs.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(Ws.x,Ws.y,Ws.z),t.setOrientation(qs.x,qs.y,qs.z,n.x,n.y,n.z)}}class Ys extends kt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Ks=new Re,Zs=new Pe,Js=new Re,$s=new Re;class Qs extends Ys{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Ks,Zs,Js),$s.set(0,0,1).applyQuaternion(Zs);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Ks.x,e),t.positionY.linearRampToValueAtTime(Ks.y,e),t.positionZ.linearRampToValueAtTime(Ks.z,e),t.orientationX.linearRampToValueAtTime($s.x,e),t.orientationY.linearRampToValueAtTime($s.y,e),t.orientationZ.linearRampToValueAtTime($s.z,e)}else t.setPosition(Ks.x,Ks.y,Ks.z),t.setOrientation($s.x,$s.y,$s.z)}}const eo="\\[\\]\\.:\\/",to=new RegExp("[\\[\\]\\.:\\/]","g"),no="[^\\[\\]\\.:\\/]",ro="[^"+eo.replace("\\.","")+"]",io=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",no)+/(WCOD+)?/.source.replace("WCOD",ro)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",no)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",no)+"$"),ao=["material","materials","bones","map"];class so{constructor(e,t,n){this.path=t,this.parsedPath=n||so.parseTrackName(t),this.node=so.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new so.Composite(e,t,n):new so(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(to,"")}static parseTrackName(e){const t=io.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==ao.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=so.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const a=e[r];if(void 0===a){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}so.Composite=class{constructor(e,t,n){const r=n||so.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},so.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},so.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},so.prototype.GetterByBindingType=[so.prototype._getValue_direct,so.prototype._getValue_array,so.prototype._getValue_arrayElement,so.prototype._getValue_toArray],so.prototype.SetterByBindingTypeAndVersioning=[[so.prototype._setValue_direct,so.prototype._setValue_direct_setNeedsUpdate,so.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[so.prototype._setValue_array,so.prototype._setValue_array_setNeedsUpdate,so.prototype._setValue_array_setMatrixWorldNeedsUpdate],[so.prototype._setValue_arrayElement,so.prototype._setValue_arrayElement_setNeedsUpdate,so.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[so.prototype._setValue_fromArray,so.prototype._setValue_fromArray_setNeedsUpdate,so.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=r)},function(e,t,n){"use strict";e.exports=n(28)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return y}));var r=n(2),i=n(4);function a(e,t){if(!e)throw new Error(t)}const s=Object(r.createContext)(null);const o=Object(r.createContext)(null);const l=Object(r.createContext)({outlet:null,matches:[]});function c(e){return function(e){let t=Object(r.useContext)(l).outlet;if(t)return Object(r.createElement)(v.Provider,{value:e},t);return t}(e.context)}function u(e){a(!1)}function h(e){let{basename:t="/",children:n=null,location:l,navigationType:c=i.a.Pop,navigator:u,static:h=!1}=e;p()&&a(!1);let d=P(t),f=Object(r.useMemo)((()=>({basename:d,navigator:u,static:h})),[d,u,h]);"string"===typeof l&&(l=Object(i.f)(l));let{pathname:m="/",search:g="",hash:v="",state:y=null,key:_="default"}=l,x=Object(r.useMemo)((()=>{let e=A(m,d);return null==e?null:{pathname:e,search:g,hash:v,state:y,key:_}}),[d,m,g,v,y,_]);return null==x?null:Object(r.createElement)(s.Provider,{value:f},Object(r.createElement)(o.Provider,{children:n,value:{location:x,navigationType:c}}))}function d(e){let{children:t,location:n}=e;return function(e,t){p()||a(!1);let{matches:n}=Object(r.useContext)(l),s=n[n.length-1],o=s?s.params:{},c=(s&&s.pathname,s?s.pathnameBase:"/");s&&s.route;0;let u,h=m();if(t){var d;let e="string"===typeof t?Object(i.f)(t):t;"/"===c||(null==(d=e.pathname)?void 0:d.startsWith(c))||a(!1),u=e}else u=h;let f=u.pathname||"/",g="/"===c?f:f.slice(c.length)||"/",v=function(e,t,n){void 0===n&&(n="/");let r=A(("string"===typeof t?Object(i.f)(t):t).pathname||"/",n);if(null==r)return null;let a=x(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]))?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let s=null;for(let i=0;null==s&&i<a.length;++i)s=M(a[i],r);return s}(e,{pathname:g});0;return E(v&&v.map((e=>Object.assign({},e,{params:Object.assign({},o,e.params),pathname:L([c,e.pathname]),pathnameBase:"/"===e.pathnameBase?c:L([c,e.pathnameBase])}))),n)}(_(t),n)}function f(e){p()||a(!1);let{basename:t,navigator:n}=Object(r.useContext)(s),{hash:o,pathname:l,search:c}=y(e),u=l;if("/"!==t){let n=function(e){return""===e||""===e.pathname?"/":"string"===typeof e?Object(i.f)(e).pathname:e.pathname}(e),r=null!=n&&n.endsWith("/");u="/"===l?t+(r?"/":""):L([t,l])}return n.createHref({pathname:u,search:c,hash:o})}function p(){return null!=Object(r.useContext)(o)}function m(){return p()||a(!1),Object(r.useContext)(o).location}function g(){p()||a(!1);let{basename:e,navigator:t}=Object(r.useContext)(s),{matches:n}=Object(r.useContext)(l),{pathname:i}=m(),o=JSON.stringify(n.map((e=>e.pathnameBase))),c=Object(r.useRef)(!1);return Object(r.useEffect)((()=>{c.current=!0})),Object(r.useCallback)((function(n,r){if(void 0===r&&(r={}),!c.current)return;if("number"===typeof n)return void t.go(n);let a=C(n,JSON.parse(o),i);"/"!==e&&(a.pathname=L([e,a.pathname])),(r.replace?t.replace:t.push)(a,r.state)}),[e,t,o,i])}const v=Object(r.createContext)(null);function y(e){let{matches:t}=Object(r.useContext)(l),{pathname:n}=m(),i=JSON.stringify(t.map((e=>e.pathnameBase)));return Object(r.useMemo)((()=>C(e,JSON.parse(i),n)),[e,i,n])}function _(e){let t=[];return r.Children.forEach(e,(e=>{if(!Object(r.isValidElement)(e))return;if(e.type===r.Fragment)return void t.push.apply(t,_(e.props.children));e.type!==u&&a(!1);let n={caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path};e.props.children&&(n.children=_(e.props.children)),t.push(n)})),t}function x(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=""),e.forEach(((e,i)=>{let s={relativePath:e.path||"",caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};s.relativePath.startsWith("/")&&(s.relativePath.startsWith(r)||a(!1),s.relativePath=s.relativePath.slice(r.length));let o=L([r,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(!0===e.index&&a(!1),x(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:S(o,e.index),routesMeta:l})})),t}const b=/^:\w+$/,w=e=>"*"===e;function S(e,t){let n=e.split("/"),r=n.length;return n.some(w)&&(r+=-2),t&&(r+=2),n.filter((e=>!w(e))).reduce(((e,t)=>e+(b.test(t)?3:""===t?1:10)),r)}function M(e,t){let{routesMeta:n}=e,r={},i="/",a=[];for(let s=0;s<n.length;++s){let e=n[s],o=s===n.length-1,l="/"===i?t:t.slice(i.length)||"/",c=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},l);if(!c)return null;Object.assign(r,c.params);let u=e.route;a.push({params:r,pathname:L([i,c.pathname]),pathnameBase:L([i,c.pathnameBase]),route:u}),"/"!==c.pathnameBase&&(i=L([i,c.pathnameBase]))}return a}function E(e,t){return void 0===t&&(t=[]),null==e?null:e.reduceRight(((n,i,a)=>Object(r.createElement)(l.Provider,{children:void 0!==i.route.element?i.route.element:Object(r.createElement)(c,null),value:{outlet:n,matches:t.concat(e.slice(0,a+1))}})),null)}function T(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,((e,t)=>(r.push(t),"([^\\/]+)")));e.endsWith("*")?(r.push("*"),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):i+=n?"\\/*$":"(?:\\b|\\/|$)";return[new RegExp(i,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce(((e,t,n)=>{if("*"===t){let e=o[n]||"";s=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return e}}(o[n]||""),e}),{}),pathname:a,pathnameBase:s,pattern:e}}function C(e,t,n){let r,a="string"===typeof e?Object(i.f)(e):e,s=""===e||""===a.pathname?"/":a.pathname;if(null==s)r=n;else{let e=t.length-1;if(s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}r=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof e?Object(i.f)(e):e;return{pathname:n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t,search:R(r),hash:D(a)}}(a,r);return s&&"/"!==s&&s.endsWith("/")&&!o.pathname.endsWith("/")&&(o.pathname+="/"),o}function A(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=e.charAt(t.length);return n&&"/"!==n?null:e.slice(t.length)||"/"}const L=e=>e.join("/").replace(/\/\/+/g,"/"),P=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),R=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",D=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return h}));var i,a=i||(i={});a.Pop="POP",a.Push="PUSH",a.Replace="REPLACE";var s=function(e){return e};function o(e){e.preventDefault(),e.returnValue=""}function l(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function c(){return Math.random().toString(36).substr(2,8)}function u(e){var t=e.pathname;t=void 0===t?"/":t;var n=e.search;return n=void 0===n?"":n,e=void 0===(e=e.hash)?"":e,n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),e&&"#"!==e&&(t+="#"===e.charAt(0)?e:"#"+e),t}function h(e){var t={};if(e){var n=e.indexOf("#");0<=n&&(t.hash=e.substr(n),e=e.substr(0,n)),0<=(n=e.indexOf("?"))&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function d(e){function t(){var e=p.location,t=m.state||{};return[t.idx,s({pathname:e.pathname,search:e.search,hash:e.hash,state:t.usr||null,key:t.key||"default"})]}function n(e){return"string"===typeof e?e:u(e)}function a(e,t){return void 0===t&&(t=null),s(r({pathname:_.pathname,hash:"",search:""},"string"===typeof e?h(e):e,{state:t,key:c()}))}function d(e){v=e,e=t(),y=e[0],_=e[1],x.call({action:v,location:_})}function f(e){m.go(e)}void 0===e&&(e={});var p=void 0===(e=e.window)?document.defaultView:e,m=p.history,g=null;p.addEventListener("popstate",(function(){if(g)b.call(g),g=null;else{var e=i.Pop,n=t(),r=n[0];if(n=n[1],b.length){if(null!=r){var a=y-r;a&&(g={action:e,location:n,retry:function(){f(-1*a)}},f(a))}}else d(e)}}));var v=i.Pop,y=(e=t())[0],_=e[1],x=l(),b=l();return null==y&&(y=0,m.replaceState(r({},m.state,{idx:y}),"")),{get action(){return v},get location(){return _},createHref:n,push:function e(t,r){var s=i.Push,o=a(t,r);if(!b.length||(b.call({action:s,location:o,retry:function(){e(t,r)}}),0)){var l=[{usr:o.state,key:o.key,idx:y+1},n(o)];o=l[0],l=l[1];try{m.pushState(o,"",l)}catch(c){p.location.assign(l)}d(s)}},replace:function e(t,r){var s=i.Replace,o=a(t,r);b.length&&(b.call({action:s,location:o,retry:function(){e(t,r)}}),1)||(o=[{usr:o.state,key:o.key,idx:y},n(o)],m.replaceState(o[0],"",o[1]),d(s))},go:f,back:function(){f(-1)},forward:function(){f(1)},listen:function(e){return x.push(e)},block:function(e){var t=b.push(e);return 1===b.length&&p.addEventListener("beforeunload",o),function(){t(),b.length||p.removeEventListener("beforeunload",o)}}}}function f(e){function t(){var e=h(m.location.hash.substr(1)),t=e.pathname,n=e.search;e=e.hash;var r=g.state||{};return[r.idx,s({pathname:void 0===t?"/":t,search:void 0===n?"":n,hash:void 0===e?"":e,state:r.usr||null,key:r.key||"default"})]}function n(){if(v)w.call(v),v=null;else{var e=i.Pop,n=t(),r=n[0];if(n=n[1],w.length){if(null!=r){var a=_-r;a&&(v={action:e,location:n,retry:function(){p(-1*a)}},p(a))}}else f(e)}}function a(e){var t=document.querySelector("base"),n="";return t&&t.getAttribute("href")&&(n=-1===(n=(t=m.location.href).indexOf("#"))?t:t.slice(0,n)),n+"#"+("string"===typeof e?e:u(e))}function d(e,t){return void 0===t&&(t=null),s(r({pathname:x.pathname,hash:"",search:""},"string"===typeof e?h(e):e,{state:t,key:c()}))}function f(e){y=e,e=t(),_=e[0],x=e[1],b.call({action:y,location:x})}function p(e){g.go(e)}void 0===e&&(e={});var m=void 0===(e=e.window)?document.defaultView:e,g=m.history,v=null;m.addEventListener("popstate",n),m.addEventListener("hashchange",(function(){u(t()[1])!==u(x)&&n()}));var y=i.Pop,_=(e=t())[0],x=e[1],b=l(),w=l();return null==_&&(_=0,g.replaceState(r({},g.state,{idx:_}),"")),{get action(){return y},get location(){return x},createHref:a,push:function e(t,n){var r=i.Push,s=d(t,n);if(!w.length||(w.call({action:r,location:s,retry:function(){e(t,n)}}),0)){var o=[{usr:s.state,key:s.key,idx:_+1},a(s)];s=o[0],o=o[1];try{g.pushState(s,"",o)}catch(l){m.location.assign(o)}f(r)}},replace:function e(t,n){var r=i.Replace,s=d(t,n);w.length&&(w.call({action:r,location:s,retry:function(){e(t,n)}}),1)||(s=[{usr:s.state,key:s.key,idx:_},a(s)],g.replaceState(s[0],"",s[1]),f(r))},go:p,back:function(){p(-1)},forward:function(){p(1)},listen:function(e){return b.push(e)},block:function(e){var t=w.push(e);return 1===w.length&&m.addEventListener("beforeunload",o),function(){t(),w.length||m.removeEventListener("beforeunload",o)}}}}function p(e){function t(e,t){return void 0===t&&(t=null),s(r({pathname:g.pathname,search:"",hash:""},"string"===typeof e?h(e):e,{state:t,key:c()}))}function n(e,t,n){return!y.length||(y.call({action:e,location:t,retry:n}),!1)}function a(e,t){m=e,g=t,v.call({action:m,location:g})}function o(e){var t=Math.min(Math.max(p+e,0),f.length-1),r=i.Pop,s=f[t];n(r,s,(function(){o(e)}))&&(p=t,a(r,s))}void 0===e&&(e={});var d=e;e=d.initialEntries,d=d.initialIndex;var f=(void 0===e?["/"]:e).map((function(e){return s(r({pathname:"/",search:"",hash:"",state:null,key:c()},"string"===typeof e?h(e):e))})),p=Math.min(Math.max(null==d?f.length-1:d,0),f.length-1),m=i.Pop,g=f[p],v=l(),y=l();return{get index(){return p},get action(){return m},get location(){return g},createHref:function(e){return"string"===typeof e?e:u(e)},push:function e(r,s){var o=i.Push,l=t(r,s);n(o,l,(function(){e(r,s)}))&&(p+=1,f.splice(p,f.length,l),a(o,l))},replace:function e(r,s){var o=i.Replace,l=t(r,s);n(o,l,(function(){e(r,s)}))&&(f[p]=l,a(o,l))},go:o,back:function(){o(-1)},forward:function(){o(1)},listen:function(e){return v.push(e)},block:function(e){return y.push(e)}}}},function(e,t){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}t.Emitter=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},n.prototype.emitReserved=n.prototype.emit,n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";t.a="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")()},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(6);function i(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const a=setTimeout,s=clearTimeout;function o(e,t){t.useNativeTimers?(e.setTimeoutFn=a.bind(r.a),e.clearTimeoutFn=s.bind(r.a)):(e.setTimeoutFn=setTimeout.bind(r.a),e.clearTimeoutFn=clearTimeout.bind(r.a))}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n(6);const i="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),a=r.a.WebSocket||r.a.MozWebSocket,s=!0,o="arraybuffer"},function(e,t,n){"use strict";n.d(t,"e",(function(){return x})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return _}));const r=Object.create(null);r.open="0",r.close="1",r.ping="2",r.pong="3",r.message="4",r.upgrade="5",r.noop="6";const i=Object.create(null);Object.keys(r).forEach((e=>{i[r[e]]=e}));const a={type:"error",data:"parser error"},s="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),o="function"===typeof ArrayBuffer,l=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)};for(var c=({type:e,data:t},n,i)=>{return s&&t instanceof Blob?n?i(t):l(t,i):o&&(t instanceof ArrayBuffer||(a=t,"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a&&a.buffer instanceof ArrayBuffer))?n?i(t):l(new Blob([t]),i):i(r[e]+(t||""));var a},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="undefined"===typeof Uint8Array?[]:new Uint8Array(256),d=0;d<u.length;d++)h[u.charCodeAt(d)]=d;const f="function"===typeof ArrayBuffer,p=(e,t)=>{if(f){const n=function(e){var t,n,r,i,a,s=.75*e.length,o=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),u=new Uint8Array(c);for(t=0;t<o;t+=4)n=h[e.charCodeAt(t)],r=h[e.charCodeAt(t+1)],i=h[e.charCodeAt(t+2)],a=h[e.charCodeAt(t+3)],u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|i>>2,u[l++]=(3&i)<<6|63&a;return c}(e);return m(n,t)}return{base64:!0,data:e}},m=(e,t)=>{switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}};var g=(e,t)=>{if("string"!==typeof e)return{type:"message",data:m(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:p(e.substring(1),t)};return i[n]?e.length>1?{type:i[n],data:e.substring(1)}:{type:i[n]}:a};const v=String.fromCharCode(30),y=(e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach(((e,a)=>{c(e,!1,(e=>{r[a]=e,++i===n&&t(r.join(v))}))}))},_=(e,t)=>{const n=e.split(v),r=[];for(let i=0;i<n.length;i++){const e=g(n[i],t);if(r.push(e),"error"===e.type)break}return r},x=4},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(1);const i=/^[og]\s*(.+)?/,a=/^mtllib /,s=/^usemtl /,o=/^usemap /,l=/\s+/,c=new r.W,u=new r.W,h=new r.W,d=new r.W,f=new r.W,p=new r.i;function m(){const e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){const n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);const r={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){const t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){const t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(let n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"===typeof n.clone){const e=n.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){const r=this.vertices,i=this.object.geometry.vertices;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const r=this.normals,i=this.object.geometry.normals;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(e,t,n){const r=this.vertices,i=this.object.geometry.normals;c.fromArray(r,e),u.fromArray(r,t),h.fromArray(r,n),f.subVectors(h,u),d.subVectors(c,u),f.cross(d),f.normalize(),i.push(f.x,f.y,f.z),i.push(f.x,f.y,f.z),i.push(f.x,f.y,f.z)},addColor:function(e,t,n){const r=this.colors,i=this.object.geometry.colors;void 0!==r[e]&&i.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&i.push(r[t+0],r[t+1],r[t+2]),void 0!==r[n]&&i.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){const r=this.uvs,i=this.object.geometry.uvs;i.push(r[e+0],r[e+1]),i.push(r[t+0],r[t+1]),i.push(r[n+0],r[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,i,a,s,o,l){const c=this.vertices.length;let u=this.parseVertexIndex(e,c),h=this.parseVertexIndex(t,c),d=this.parseVertexIndex(n,c);if(this.addVertex(u,h,d),this.addColor(u,h,d),void 0!==s&&""!==s){const e=this.normals.length;u=this.parseNormalIndex(s,e),h=this.parseNormalIndex(o,e),d=this.parseNormalIndex(l,e),this.addNormal(u,h,d)}else this.addFaceNormal(u,h,d);if(void 0!==r&&""!==r){const e=this.uvs.length;u=this.parseUVIndex(r,e),h=this.parseUVIndex(i,e),d=this.parseUVIndex(a,e),this.addUV(u,h,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,r=e.length;n<r;n++){const r=this.parseVertexIndex(e[n],t);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let i=0,a=e.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(e[i],n));for(let i=0,a=t.length;i<a;i++)this.addUVLine(this.parseUVIndex(t[i],r))}};return e.startObject("",!1),e}class g extends r.y{constructor(e){super(e),this.materials=null}load(e,t,n,i){const a=this,s=new r.n(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{t(a.parse(n))}catch(r){i?i(r):console.error(r),a.manager.itemError(e)}}),n,i)}setMaterials(e){return this.materials=e,this}parse(e){const t=new m;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const n=e.split("\n");let c=[];for(let r=0,h=n.length;r<h;r++){const e=n[r].trimStart();if(0===e.length)continue;const u=e.charAt(0);if("#"!==u)if("v"===u){const n=e.split(l);switch(n[0]){case"v":t.vertices.push(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])),n.length>=7?(p.setRGB(parseFloat(n[4]),parseFloat(n[5]),parseFloat(n[6])).convertSRGBToLinear(),t.colors.push(p.r,p.g,p.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));break;case"vt":t.uvs.push(parseFloat(n[1]),parseFloat(n[2]))}}else if("f"===u){const n=e.slice(1).trim().split(l),r=[];for(let e=0,t=n.length;e<t;e++){const t=n[e];if(t.length>0){const e=t.split("/");r.push(e)}}const i=r[0];for(let e=1,a=r.length-1;e<a;e++){const n=r[e],a=r[e+1];t.addFace(i[0],n[0],a[0],i[1],n[1],a[1],i[2],n[2],a[2])}}else if("l"===u){const n=e.substring(1).trim().split(" ");let r=[];const i=[];if(-1===e.indexOf("/"))r=n;else for(let e=0,t=n.length;e<t;e++){const t=n[e].split("/");""!==t[0]&&r.push(t[0]),""!==t[1]&&i.push(t[1])}t.addLineGeometry(r,i)}else if("p"===u){const n=e.slice(1).trim().split(" ");t.addPointGeometry(n)}else if(null!==(c=i.exec(e))){const e=(" "+c[0].slice(1).trim()).slice(1);t.startObject(e)}else if(s.test(e))t.object.startMaterial(e.substring(7).trim(),t.materialLibraries);else if(a.test(e))t.materialLibraries.push(e.substring(7).trim());else if(o.test(e))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===u){if(c=e.split(" "),c.length>1){const e=c[1].trim().toLowerCase();t.object.smooth="0"!==e&&"off"!==e}else t.object.smooth=!0;const n=t.object.currentMaterial();n&&(n.smooth=t.object.smooth)}else{if("\0"===e)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+e+'"')}}t.finalize();const u=new r.r;u.materialLibraries=[].concat(t.materialLibraries);if(!0===!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let i=0,a=t.objects.length;i<a;i++){const e=t.objects[i],n=e.geometry,a=e.materials,s="Line"===n.type,o="Points"===n.type;let l=!1;if(0===n.vertices.length)continue;const c=new r.g;c.setAttribute("position",new r.o(n.vertices,3)),n.normals.length>0&&c.setAttribute("normal",new r.o(n.normals,3)),n.colors.length>0&&(l=!0,c.setAttribute("color",new r.o(n.colors,3))),!0===n.hasUVIndices&&c.setAttribute("uv",new r.o(n.uvs,2));const h=[];for(let i=0,u=a.length;i<u;i++){const e=a[i],n=e.name+"_"+e.smooth+"_"+l;let c=t.materials[n];if(null!==this.materials)if(c=this.materials.create(e.name),!s||!c||c instanceof r.w){if(o&&c&&!(c instanceof r.L)){const e=new r.L({size:10,sizeAttenuation:!1});r.z.prototype.copy.call(e,c),e.color.copy(c.color),e.map=c.map,c=e}}else{const e=new r.w;r.z.prototype.copy.call(e,c),e.color.copy(c.color),c=e}void 0===c&&(c=s?new r.w:o?new r.L({size:1,sizeAttenuation:!1}):new r.E,c.name=e.name,c.flatShading=!e.smooth,c.vertexColors=l,t.materials[n]=c),h.push(c)}let d;if(h.length>1){for(let e=0,t=a.length;e<t;e++){const t=a[e];c.addGroup(t.groupStart,t.groupCount,e)}d=s?new r.x(c,h):o?new r.K(c,h):new r.B(c,h)}else d=s?new r.x(c,h[0]):o?new r.K(c,h[0]):new r.B(c,h[0]);d.name=e.name,u.add(d)}else if(t.vertices.length>0){const e=new r.L({size:1,sizeAttenuation:!1}),n=new r.g;n.setAttribute("position",new r.o(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(n.setAttribute("color",new r.o(t.colors,3)),e.vertexColors=!0);const i=new r.K(n,e);u.add(i)}return u}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(9),i=n(5),a=n(7);class s extends i.Emitter{constructor(e){super(),this.writable=!1,Object(a.a)(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){const n=new Error(e);return n.type="TransportError",n.description=t,super.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(e){const t=Object(r.a)(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emit("packet",e)}onClose(){this.readyState="closed",super.emit("close")}}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),a=e.indexOf("]");-1!=i&&-1!=a&&(e=e.substring(0,i)+e.substring(i,a).replace(/:/g,";")+e.substring(a,e.length));for(var s=n.exec(e||""),o={},l=14;l--;)o[r[l]]=s[l]||"";return-1!=i&&-1!=a&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1);"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1);return r}(0,o.path),o.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,o.query),o}},function(e,t,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a={},s=0,o=0;function l(e){var t="";do{t=i[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function c(){var e=l(+new Date);return e!==r?(s=0,r=e):e+"."+l(s++)}for(;o<64;o++)a[i[o]]=o;c.encode=l,c.decode=function(e){var t=0;for(o=0;o<e.length;o++)t=64*t+a[e.charAt(o)];return t},e.exports=c},function(e,t,n){"use strict";n.d(t,"a",(function(){return X}));var r={};n.r(r),n.d(r,"protocol",(function(){return N})),n.d(r,"PacketType",(function(){return O})),n.d(r,"Encoder",(function(){return z})),n.d(r,"Decoder",(function(){return U}));var i=n(13),a=n.n(i);var s=n(23),o=n.n(s),l=n(6),c=function(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||o.a))return new XMLHttpRequest}catch(n){}if(!t)try{return new(l.a[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}},u=n(7),h=n(5),d=n(11),f=n(14),p=n.n(f),m=n(12),g=n.n(m),v=n(9);class y extends d.a{constructor(){super(...arguments),this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){Object(v.b)(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose(),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,Object(v.d)(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emit("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=p()()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const r=g.a.encode(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}}function _(){}const x=null!=new c({xdomain:!1}).responseType;class b extends h.Emitter{constructor(e,t){super(),Object(u.a)(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=Object(u.b)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new c(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(n){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(n){}try{t.setRequestHeader("Accept","*/*")}catch(n){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{4===t.readyState&&(200===t.status||1223===t.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"===typeof t.status?t.status:0)}),0))},t.send(this.data)}catch(n){return void this.setTimeoutFn((()=>{this.onError(n)}),0)}"undefined"!==typeof document&&(this.index=b.requestsCount++,b.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=_,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete b.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&this.onData(e)}abort(){this.cleanup()}}if(b.requestsCount=0,b.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",w);else if("function"===typeof addEventListener){const e="onpagehide"in l.a?"pagehide":"unload";addEventListener(e,w,!1)}function w(){for(let e in b.requests)b.requests.hasOwnProperty(e)&&b.requests[e].abort()}const S={websocket:n(24).a,polling:class extends y{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=x&&!t}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new b(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e=>{this.onError("xhr post error",e)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e=>{this.onError("xhr poll error",e)})),this.pollXhr=e}}};class M extends h.Emitter{constructor(e,t={}){super(),e&&"object"===typeof e&&(t=e,e=null),e?(e=a()(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=a()(t.host).host),Object(u.a)(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"===typeof this.opts.query&&(this.opts.query=g.a.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=function(e){const t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.opts.query);t.EIO=v.e,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new S[e](n)}open(){let e;if(this.opts.rememberUpgrade&&M.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(t){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(()=>{this.onClose("transport close")}))}probe(e){let t=this.createTransport(e),n=!1;M.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;M.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function i(){n||(n=!0,c(),t.close(),t=null)}const a=e=>{const n=new Error("probe error: "+e);n.transport=t.name,i(),this.emitReserved("upgradeError",n)};function s(){a("transport closed")}function o(){a("socket closed")}function l(e){t&&e.name!==t.name&&i()}const c=()=>{t.removeListener("open",r),t.removeListener("error",a),t.removeListener("close",s),this.off("close",o),this.off("upgrading",l)};t.once("open",r),t.once("error",a),t.once("close",s),this.once("close",o),this.once("upgrading",l),t.open()}onOpen(){if(this.readyState="open",M.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(e){M.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}M.protocol=v.e;M.protocol;const E="function"===typeof ArrayBuffer,T=Object.prototype.toString,C="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===T.call(Blob),A="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===T.call(File);function L(e){return E&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||C&&e instanceof Blob||A&&e instanceof File}function P(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(P(e[t]))return!0;return!1}if(L(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return P(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&P(e[n]))return!0;return!1}function R(e){const t=[],n=e.data,r=e;return r.data=D(n,t),r.attachments=t.length,{packet:r,buffers:t}}function D(e,t){if(!e)return e;if(L(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=D(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=D(e[r],t));return n}return e}function k(e,t){return e.data=I(e.data,t),e.attachments=void 0,e}function I(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=I(e[n],t);else if("object"===typeof e)for(const n in e)e.hasOwnProperty(n)&&(e[n]=I(e[n],t));return e}const N=5;var O;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(O||(O={}));class z{encode(e){return e.type!==O.EVENT&&e.type!==O.ACK||!P(e)?[this.encodeAsString(e)]:(e.type=e.type===O.EVENT?O.BINARY_EVENT:O.BINARY_ACK,this.encodeAsBinary(e))}encodeAsString(e){let t=""+e.type;return e.type!==O.BINARY_EVENT&&e.type!==O.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),t}encodeAsBinary(e){const t=R(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}class U extends h.Emitter{constructor(){super()}add(e){let t;if("string"===typeof e)t=this.decodeString(e),t.type===O.BINARY_EVENT||t.type===O.BINARY_ACK?(this.reconstructor=new F(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t);else{if(!L(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===O[n.type])throw new Error("unknown packet type "+n.type);if(n.type===O.BINARY_EVENT||n.type===O.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=function(e){try{return JSON.parse(e)}catch(t){return!1}}(e.substr(t));if(!U.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}static isPayloadValid(e,t){switch(e){case O.CONNECT:return"object"===typeof t;case O.DISCONNECT:return void 0===t;case O.CONNECT_ERROR:return"string"===typeof t||"object"===typeof t;case O.EVENT:case O.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case O.ACK:case O.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class F{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=k(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function B(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const V=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class H extends h.Emitter{constructor(e,t,n){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const e=this.io;this.subs=[B(e,"open",this.onopen.bind(this)),B(e,"packet",this.onpacket.bind(this)),B(e,"error",this.onerror.bind(this)),B(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(V.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);const n={type:O.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"===typeof t[t.length-1]){const e=this.ids++,r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?this.packet(n):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){const n=this.flags.timeout;if(void 0===n)return void(this.acks[e]=t);const r=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),n);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(r),t.apply(this,[null,...e])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this.packet({type:O.CONNECT,data:e})})):this.packet({type:O.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case O.CONNECT:if(e.data&&e.data.sid){const t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case O.EVENT:case O.BINARY_EVENT:this.onevent(e);break;case O.ACK:case O.BINARY_ACK:this.onack(e);break;case O.DISCONNECT:this.ondisconnect();break;case O.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:O.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>this.packet(e))),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:O.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var W=n(25),G=n.n(W);class j extends h.Emitter{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Object(u.a)(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new G.a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new M(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=B(t,"open",(function(){n.onopen(),e&&e()})),i=B(t,"error",(t=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",t),e?e(t):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;0===e&&r();const n=this.setTimeoutFn((()=>{r(),t.close(),t.emit("error",new Error("timeout"))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(B(e,"ping",this.onping.bind(this)),B(e,"data",this.ondata.bind(this)),B(e,"error",this.onerror.bind(this)),B(e,"close",this.onclose.bind(this)),B(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n||(n=new H(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const q={};function X(e,t){"object"===typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.pr
otocol+"//"+e:"https://"+e),r=a()(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,i=n.id,s=n.path,o=q[i]&&s in q[i].nsps;let l;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?l=new j(r,t):(q[i]||(q[i]=new j(r,t)),l=q[i]),n.query&&!t.query&&(t.query=n.queryKey),l.socket(n.path,t)}Object.assign(X,{Manager:j,Socket:H,io:X,connect:X})},function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function s(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,t){for(var n,o,l=s(e),c=1;c<arguments.length;c++){for(var u in n=Object(arguments[c]))i.call(n,u)&&(l[u]=n[u]);if(r){o=r(n);for(var h=0;h<o.length;h++)a.call(n,o[h])&&(l[o[h]]=n[o[h]])}}return l}},,,,,,function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(29)},function(e,t){try{e.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){e.exports=!1}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var r=n(11),i=n(12),a=n.n(i),s=n(14),o=n.n(s),l=n(7),c=n(8),u=n(9);const h="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class d extends r.a{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=h?{}:Object(l.b)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=c.d&&!h?t?new c.a(e,t):new c.a(e):new c.a(e,t,n)}catch(r){return this.emit("error",r)}this.ws.binaryType=this.socket.binaryType||c.b,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;Object(u.c)(r,this.supportsBinary,(t=>{const n={};if(!c.d&&(r.options&&(n.compress=r.options.compress),this.opts.perMessageDeflate)){("string"===typeof t?e.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(n.compress=!1)}try{c.d?this.ws.send(t):this.ws.send(t,n)}catch(a){}i&&Object(c.c)((()=>{this.writable=!0,this.emit("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=o()()),this.supportsBinary||(e.b64=1);const r=a.a.encode(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}check(){return!!c.a&&!("__initialize"in c.a&&this.name===d.prototype.name)}}}).call(this,n(33).Buffer)},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t,n){"use strict";var r=function(){var e=0,t=document.createElement("div");function n(e){return t.appendChild(e.dom),e}function i(n){for(var r=0;r<t.children.length;r++)t.children[r].style.display=r===n?"block":"none";e=n}t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",(function(n){n.preventDefault(),i(++e%t.children.length)}),!1);var a=(performance||Date).now(),s=a,o=0,l=n(new r.Panel("FPS","#0ff","#002")),c=n(new r.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=n(new r.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:t,addPanel:n,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){o++;var e=(performance||Date).now();if(c.update(e-a,200),e>=s+1e3&&(l.update(1e3*o/(e-s),100),s=e,o=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:t,setMode:i}};r.Panel=function(e,t,n){var r=1/0,i=0,a=Math.round,s=a(window.devicePixelRatio||1),o=80*s,l=48*s,c=3*s,u=2*s,h=3*s,d=15*s,f=74*s,p=30*s,m=document.createElement("canvas");m.width=o,m.height=l,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,o,l),g.fillStyle=t,g.fillText(e,c,u),g.fillRect(h,d,f,p),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h,d,f,p),{dom:m,update:function(l,v){r=Math.min(r,l),i=Math.max(i,l),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,o,d),g.fillStyle=t,g.fillText(a(l)+" "+e+" ("+a(r)+"-"+a(i)+")",c,u),g.drawImage(m,h+s,d,f-s,p,h,d,f-s,p),g.fillRect(h+f-s,d,s,p),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h+f-s,d,s,a((1-l/v)*p))}}},t.a=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(4),a=n(3);function s(e){let{basename:t,children:n,window:s}=e,o=Object(r.useRef)();null==o.current&&(o.current=Object(i.b)({window:s}));let l=o.current,[c,u]=Object(r.useState)({action:l.action,location:l.location});return Object(r.useLayoutEffect)((()=>l.listen(u)),[l]),Object(r.createElement)(a.b,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l})}},function(e,t,n){"use strict";var r=n(16),i=60103,a=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var s=60109,o=60110,l=60112;t.Suspense=60113;var c=60115,u=60116;if("function"===typeof Symbol&&Symbol.for){var h=Symbol.for;i=h("react.element"),a=h("react.portal"),t.Fragment=h("react.fragment"),t.StrictMode=h("react.strict_mode"),t.Profiler=h("react.profiler"),s=h("react.provider"),o=h("react.context"),l=h("react.forward_ref"),t.Suspense=h("react.suspense"),c=h("react.memo"),u=h("react.lazy")}var d="function"===typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var _=y.prototype=new v;_.constructor=y,r(_,g.prototype),_.isPureReactComponent=!0;var x={current:null},b=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var r,a={},s=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)b.call(t,r)&&!w.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:i,type:e,key:s,ref:o,props:a,_owner:x.current}}function M(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,n,r,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case a:l=!0}}if(l)return s=s(l=e),e=""===r?"."+T(l,0):r,Array.isArray(s)?(n="",null!=e&&(n=e.replace(E,"$&/")+"/"),C(s,t,n,"",(function(e){return e}))):null!=s&&(M(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(E,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var u=r+T(o=e[c],c);l+=C(o,t,n,u,s)}else if("function"===typeof(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e)))for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,n,u=r+T(o,c++),s);else if("object"===o)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function L(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var P={current:null};function R(){var e=P.current;if(null===e)throw Error(f(321));return e}var D={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:x,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!M(e))throw Error(f(143));return e}},t.Component=g,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(f(267,e));var a=r({},e.props),s=e.key,o=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,l=x.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)b.call(t,u)&&!w.hasOwnProperty(u)&&(a[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)a.children=n;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];a.children=c}return{$$typeof:i,type:e.type,key:s,ref:o,props:a,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:o,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:L}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return R().useCallback(e,t)},t.useContext=function(e,t){return R().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return R().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return R().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return R().useLayoutEffect(e,t)},t.useMemo=function(e,t){return R().useMemo(e,t)},t.useReducer=function(e,t,n){return R().useReducer(e,t,n)},t.useRef=function(e){return R().useRef(e)},t.useState=function(e){return R().useState(e)},t.version="17.0.2"},function(e,t,n){"use strict";var r=n(2),i=n(16),a=n(30);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));var o=new Set,l={};function c(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(l[e]=t,e=0;e<t.length;e++)o.add(t[e])}var h=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,p={},m={};function g(e,t,n,r,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function x(e,t,n,r){var i=v.hasOwnProperty(t)?v[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!f.call(m,e)||!f.call(p,e)&&(d.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,_);v[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,_);v[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,_);v[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=60103,S=60106,M=60107,E=60108,T=60114,C=60109,A=60110,L=60112,P=60113,R=60120,D=60115,k=60116,I=60121,N=60128,O=60129,z=60130,U=60131;if("function"===typeof Symbol&&Symbol.for){var F=Symbol.for;w=F("react.element"),S=F("react.portal"),M=F("react.fragment"),E=F("react.strict_mode"),T=F("react.profiler"),C=F("react.provider"),A=F("react.context"),L=F("react.forward_ref"),P=F("react.suspense"),R=F("react.suspense_list"),D=F("react.memo"),k=F("react.lazy"),I=F("react.block"),F("react.scope"),N=F("react.opaque.id"),O=F("react.debug_trace_mode"),z=F("react.offscreen"),U=F("react.legacy_hidden")}var B,V="function"===typeof Symbol&&Symbol.iterator;function H(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=V&&e[V]||e["@@iterator"])?e:null}function W(e){if(void 0===B)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return"\n"+B+e}var G=!1;function j(e,t){if(!e||G)return"";G=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),a=r.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o])return"\n"+i[s].replace(" at new "," at ")}while(1<=s&&0<=o);break}}}finally{G=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?W(e):""}function q(e){switch(e.tag){case 5:return W(e.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 22:return e=j(e.type._render,!1);case 1:return e=j(e.type,!0);default:return""}}function X(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case M:return"Fragment";case S:return"Portal";case T:return"Profiler";case E:return"StrictMode";case P:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case L:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case D:return X(e.type);case I:return X(e._render);case k:t=e._payload,e=e._init;try{return X(e(t))}catch(n){}}return null}function Y(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Z(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function $(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Y(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=Y(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,Y(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&$(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ae(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function se(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Y(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function le(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Y(n)}}function ce(e,t){var n=Y(t.value),r=Y(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var he="http://www.w3.org/1999/xhtml",de="http://www.w3.org/2000/svg";function fe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?fe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var me,ge,ve=(ge=function(e,t){if(e.namespaceURI!==de||"innerHTML"in e)e.innerHTML=t;else{for((me=me||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=me.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ge(e,t)}))}:ge);function ye(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var _e={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xe=["Webkit","ms","Moz","O"];function be(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||_e.hasOwnProperty(e)&&_e[e]?(""+t).trim():t+"px"}function we(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=be(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(_e).forEach((function(e){xe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_e[t]=_e[e]}))}));var Se=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Me(e,t){if(t){if(Se[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function Ee(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Te(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,Ae=null,Le=null;function Pe(e){if(e=ei(e)){if("function"!==typeof Ce)throw Error(s(280));var t=e.stateNode;t&&(t=ni(t),Ce(e.stateNode,e.type,t))}}function Re(e){Ae?Le?Le.push(e):Le=[e]:Ae=e}function De(){if(Ae){var e=Ae,t=Le;if(Le=Ae=null,Pe(e),t)for(e=0;e<t.length;e++)Pe(t[e])}}function ke(e,t){return e(t)}function Ie(e,t,n,r,i){return e(t,n,r,i)}function Ne(){}var Oe=ke,ze=!1,Ue=!1;function Fe(){null===Ae&&null===Le||(Ne(),De())}function Be(e,t){var n=e.stateNode;if(null===n)return null;var r=ni(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ve=!1;if(h)try{var He={};Object.defineProperty(He,"passive",{get:function(){Ve=!0}}),window.addEventListener("test",He,He),window.removeEventListener("test",He,He)}catch(ge){Ve=!1}function We(e,t,n,r,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Ge=!1,je=null,qe=!1,Xe=null,Ye={onError:function(e){Ge=!0,je=e}};function Ke(e,t,n,r,i,a,s,o,l){Ge=!1,je=null,We.apply(Ye,arguments)}function Ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function $e(e){if(Ze(e)!==e)throw Error(s(188))}function Qe(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return $e(i),e;if(a===r)return $e(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,it,at=!1,st=[],ot=null,lt=null,ct=null,ut=new Map,ht=new Map,dt=[],ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function mt(e,t){switch(e){case"focusin":case"focusout":ot=null;break;case"dragenter":case"dragleave":lt=null;break;case"mouseover":case"mouseout":ct=null;break;case"pointerover":case"pointerout":ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ht.delete(t.pointerId)}}function gt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e=pt(t,n,r,i,a),null!==t&&(null!==(t=ei(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function vt(e){var t=Qr(e.target);if(null!==t){var n=Ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Je(n)))return e.blockedOn=t,void it(e.lanePriority,(function(){a.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function yt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ei(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function _t(e,t,n){yt(e)&&n.delete(t)}function xt(){for(at=!1;0<st.length;){var e=st[0];if(null!==e.blockedOn){null!==(e=ei(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&st.shift()}null!==ot&&yt(ot)&&(ot=null),null!==lt&&yt(lt)&&(lt=null),null!==ct&&yt(ct)&&(ct=null),ut.forEach(_t),ht.forEach(_t)}function bt(e,t){e.blockedOn===t&&(e.blockedOn=null,at||(at=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,xt)))}function wt(e){function t(t){return bt(t,e)}if(0<st.length){bt(st[0],e);for(var n=1;n<st.length;n++){var r=st[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==ot&&bt(ot,e),null!==lt&&bt(lt,e),null!==ct&&bt(ct,e),ut.forEach(t),ht.forEach(t),n=0;n<dt.length;n++)(r=dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<dt.length&&null===(n=dt[0]).blockedOn;)vt(n),null===n.blockedOn&&dt.shift()}function St(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Mt={animationend:St("Animation","AnimationEnd"),animationiteration:St("Animation","AnimationIteration"),animationstart:St("Animation","AnimationStart"),transitionend:St("Transition","TransitionEnd")},Et={},Tt={};function Ct(e){if(Et[e])return Et[e];if(!Mt[e])return e;var t,n=Mt[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tt)return Et[e]=n[t];return e}h&&(Tt=document.createElement("div").style,"AnimationEvent"in window||(delete Mt.animationend.animation,delete Mt.animationiteration.animation,delete Mt.animationstart.animation),"TransitionEvent"in window||delete Mt.transitionend.transition);var At=Ct("animationend"),Lt=Ct("animationiteration"),Pt=Ct("animationstart"),Rt=Ct("transitionend"),Dt=new Map,kt=new Map,It=["abort","abort",At,"animationEnd",Lt,"animationIteration",Pt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Rt,"transitionEnd","waiting","waiting"];function Nt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),kt.set(r,t),Dt.set(r,i),c(i,[r])}}(0,a.unstable_now)();var Ot=8;function zt(e){if(0!==(1&e))return Ot=15,1;if(0!==(2&e))return Ot=14,2;if(0!==(4&e))return Ot=13,4;var t=24&e;return 0!==t?(Ot=12,t):0!==(32&e)?(Ot=11,32):0!==(t=192&e)?(Ot=10,t):0!==(256&e)?(Ot=9,256):0!==(t=3584&e)?(Ot=8,t):0!==(4096&e)?(Ot=7,4096):0!==(t=4186112&e)?(Ot=6,t):0!==(t=62914560&e)?(Ot=5,t):67108864&e?(Ot=4,67108864):0!==(134217728&e)?(Ot=3,134217728):0!==(t=805306368&e)?(Ot=2,t):0!==(1073741824&e)?(Ot=1,1073741824):(Ot=8,e)}function Ut(e,t){var n=e.pendingLanes;if(0===n)return Ot=0;var r=0,i=0,a=e.expiredLanes,s=e.suspendedLanes,o=e.pingedLanes;if(0!==a)r=a,i=Ot=15;else if(0!==(a=134217727&n)){var l=a&~s;0!==l?(r=zt(l),i=Ot):0!==(o&=a)&&(r=zt(o),i=Ot)}else 0!==(a=n&~s)?(r=zt(a),i=Ot):0!==o&&(r=zt(o),i=Ot);if(0===r)return 0;if(r=n&((0>(r=31-Gt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&s)){if(zt(t),i<=Ot)return t;Ot=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-Gt(t)),r|=e[n],t&=~i;return r}function Ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Bt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Vt(24&~t))?Bt(10,t):e;case 10:return 0===(e=Vt(192&~t))?Bt(8,t):e;case 8:return 0===(e=Vt(3584&~t))&&(0===(e=Vt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Vt(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function Vt(e){return e&-e}function Ht(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Wt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Gt(t)]=n}var Gt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(jt(e)/qt|0)|0},jt=Math.log,qt=Math.LN2;var Xt=a.unstable_UserBlockingPriority,Yt=a.unstable_runWithPriority,Kt=!0;function Zt(e,t,n,r){ze||Ne();var i=$t,a=ze;ze=!0;try{Ie(i,e,t,n,r)}finally{(ze=a)||Fe()}}function Jt(e,t,n,r){Yt(Xt,$t.bind(null,e,t,n,r))}function $t(e,t,n,r){var i;if(Kt)if((i=0===(4&t))&&0<st.length&&-1<ft.indexOf(e))e=pt(null,e,t,n,r),st.push(e);else{var a=Qt(e,t,n,r);if(null===a)i&&mt(e,r);else{if(i){if(-1<ft.indexOf(e))return e=pt(a,e,t,n,r),void st.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return ot=gt(ot,e,t,n,r,i),!0;case"dragenter":return lt=gt(lt,e,t,n,r,i),!0;case"mouseover":return ct=gt(ct,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return ut.set(a,gt(ut.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,ht.set(a,gt(ht.get(a)||null,e,t,n,r,i)),!0}return!1}(a,e,t,n,r))return;mt(e,r)}Dr(e,t,r,null,n)}}}function Qt(e,t,n,r){var i=Te(r);if(null!==(i=Qr(i))){var a=Ze(i);if(null===a)i=null;else{var s=a.tag;if(13===s){if(null!==(i=Je(a)))return i;i=null}else if(3===s){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return Dr(e,t,r,i,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,i="value"in en?en.value:en.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return nn=i.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function sn(){return!0}function on(){return!1}function ln(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?sn:on,this.isPropagationStopped=on,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=sn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=sn)},persist:function(){},isPersistent:sn}),t}var cn,un,hn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fn=ln(dn),pn=i({},dn,{view:0,detail:0}),mn=ln(pn),gn=i({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hn&&(hn&&"mousemove"===e.type?(cn=e.screenX-hn.screenX,un=e.screenY-hn.screenY):un=cn=0,hn=e),cn)},movementY:function(e){return"movementY"in e?e.movementY:un}}),vn=ln(gn),yn=ln(i({},gn,{dataTransfer:0})),_n=ln(i({},pn,{relatedTarget:0})),xn=ln(i({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=ln(i({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),wn=ln(i({},dn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Cn(){return Tn}var An=ln(i({},pn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Mn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Ln=ln(i({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=ln(i({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Rn=ln(i({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=ln(i({},gn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),kn=[9,13,27,32],In=h&&"CompositionEvent"in window,Nn=null;h&&"documentMode"in document&&(Nn=document.documentMode);var On=h&&"TextEvent"in window&&!Nn,zn=h&&(!In||Nn&&8<Nn&&11>=Nn),Un=String.fromCharCode(32),Fn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==kn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function jn(e,t,n,r){Re(r),0<(t=Ir(t,"onChange")).length&&(n=new fn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Xn=null;function Yn(e){Tr(e,0)}function Kn(e){if(J(ti(e)))return e}function Zn(e,t){if("change"===e)return t}var Jn=!1;if(h){var $n;if(h){var Qn="oninput"in document;if(!Qn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Qn="function"===typeof er.oninput}$n=Qn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Xn=qn=null)}function nr(e){if("value"===e.propertyName&&Kn(Xn)){var t=[];if(jn(t,Xn,e,Te(e)),e=Yn,ze)e(t);else{ze=!0;try{ke(e,t)}finally{ze=!1,Fe()}}}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Xn)}function ar(e,t){if("click"===e)return Kn(t)}function sr(e,t){if("input"===e||"change"===e)return Kn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},lr=Object.prototype.hasOwnProperty;function cr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!lr.call(t,n[r])||!or(e[n[r]],t[n[r]]))return!1;return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=$((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var mr=h&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,_r=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==gr||gr!==$(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=Ir(vr,"onSelect")).length&&(t=new fn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}Nt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Nt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Nt(It,2);for(var br="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),wr=0;wr<br.length;wr++)kt.set(br[wr],0);u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sr));function Er(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,c){if(Ke.apply(this,arguments),Ge){if(!Ge)throw Error(s(198));var u=je;Ge=!1,je=null,qe||(qe=!0,Xe=u)}}(r,t,void 0,e),e.currentTarget=null}function Tr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;Er(i,o,c),a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;Er(i,o,c),a=l}}}if(qe)throw e=Xe,qe=!1,Xe=null,e}function Cr(e,t){var n=ri(t),r=e+"__bubble";n.has(r)||(Rr(t,e,2,!1),n.add(r))}var Ar="_reactListening"+Math.random().toString(36).slice(2);function Lr(e){e[Ar]||(e[Ar]=!0,o.forEach((function(t){Mr.has(t)||Pr(t,!1,e,null),Pr(t,!0,e,null)})))}function Pr(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=n;if("selectionchange"===e&&9!==n.nodeType&&(a=n.ownerDocument),null!==r&&!t&&Mr.has(e)){if("scroll"!==e)return;i|=2,a=r}var s=ri(a),o=e+"__"+(t?"capture":"bubble");s.has(o)||(t&&(i|=4),Rr(a,e,i,t),s.add(o))}function Rr(e,t,n,r){var i=kt.get(t);switch(void 0===i?2:i){case 0:i=Zt;break;case 1:i=Jt;break;default:i=$t}n=i.bind(null,t,n,e),i=void 0,!Ve||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Dr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=Qr(o)))return;if(5===(l=s.tag)||6===l){r=a=s;continue e}o=o.parentNode}}r=r.return}!function(e,t,n){if(Ue)return e(t,n);Ue=!0;try{Oe(e,t,n)}finally{Ue=!1,Fe()}}((function(){var r=a,i=Te(n),s=[];e:{var o=Dt.get(e);if(void 0!==o){var l=fn,c=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=_n;break;case"focusout":c="blur",l=_n;break;case"beforeblur":case"afterblur":l=_n;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=vn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case At:case Lt:case Pt:l=xn;break;case Rt:l=Rn;break;case"scroll":l=mn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ln}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Be(p,d))&&u.push(kr(p,m,f)))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,i),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(c=n.relatedTarget||n.fromElement)||!Qr(c)&&!c[Jr])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?Qr(c):null)&&(c!==(h=Ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=vn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ln,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:ti(l),f=null==c?o:ti(c),(o=new u(m,p+"leave",l,n,i)).target=h,o.relatedTarget=f,m=null,Qr(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Nr(f))p++;for(f=0,m=d;m;m=Nr(m))f++;for(;0<p-f;)u=Nr(u),p--;for(;0<f-p;)d=Nr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Nr(u),d=Nr(d)}u=null}else u=null;null!==l&&Or(s,o,l,u,!1),null!==c&&null!==h&&Or(s,h,c,u,!0)}if("select"===(l=(o=r?ti(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Zn;else if(Gn(o))if(Jn)g=sr;else{g=ir;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ar);switch(g&&(g=g(e,r))?jn(s,g,n,i):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ie(o,"number",o.value)),v=r?ti(r):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,xr(s,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(s,n,i)}var y;if(In)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Hn?Bn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(zn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Hn&&(y=rn()):(tn="value"in(en=i)?en.value:en.textContent,Hn=!0)),0<(v=Ir(r,_)).length&&(_=new wn(_,e,null,n,i),s.push({event:_,listeners:v}),y?_.data=y:null!==(y=Vn(n))&&(_.data=y))),(y=On?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Un);case"textInput":return(e=t.data)===Un&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!In&&Bn(e,t)?(e=rn(),nn=tn=en=null,Hn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zn&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=Ir(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=y))}Tr(s,t)}))}function kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ir(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Be(e,n))&&r.unshift(kr(e,a,i)),null!=(a=Be(e,t))&&r.push(kr(e,a,i))),e=e.return}return r}function Nr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Or(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Be(n,a))&&s.unshift(kr(n,l,o)):i||null!=(l=Be(n,a))&&s.push(kr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}function zr(){}var Ur=null,Fr=null;function Br(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Vr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Hr="function"===typeof setTimeout?setTimeout:void 0,Wr="function"===typeof clearTimeout?clearTimeout:void 0;function Gr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function jr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function qr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Xr=0;var Yr=Math.random().toString(36).slice(2),Kr="__reactFiber$"+Yr,Zr="__reactProps$"+Yr,Jr="__reactContainer$"+Yr,$r="__reactEvents$"+Yr;function Qr(e){var t=e[Kr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jr]||n[Kr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=qr(e);null!==e;){if(n=e[Kr])return n;e=qr(e)}return t}n=(e=n).parentNode}return null}function ei(e){return!(e=e[Kr]||e[Jr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ti(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function ni(e){return e[Zr]||null}function ri(e){var t=e[$r];return void 0===t&&(t=e[$r]=new Set),t}var ii=[],ai=-1;function si(e){return{current:e}}function oi(e){0>ai||(e.current=ii[ai],ii[ai]=null,ai--)}function li(e,t){ai++,ii[ai]=e.current,e.current=t}var ci={},ui=si(ci),hi=si(!1),di=ci;function fi(e,t){var n=e.type.contextTypes;if(!n)return ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function mi(){oi(hi),oi(ui)}function gi(e,t,n){if(ui.current!==ci)throw Error(s(168));li(ui,t),li(hi,n)}function vi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(s(108,X(t)||"Unknown",a));return i({},n,r)}function yi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ci,di=ui.current,li(ui,e),li(hi,hi.current),!0}function _i(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=vi(e,t,di),r.__reactInternalMemoizedMergedChildContext=e,oi(hi),oi(ui),li(ui,e)):oi(hi),li(hi,n)}var xi=null,bi=null,wi=a.unstable_runWithPriority,Si=a.unstable_scheduleCallback,Mi=a.unstable_cancelCallback,Ei=a.unstable_shouldYield,Ti=a.unstable_requestPaint,Ci=a.unstable_now,Ai=a.unstable_getCurrentPriorityLevel,Li=a.unstable_ImmediatePriority,Pi=a.unstable_UserBlockingPriority,Ri=a.unstable_NormalPriority,Di=a.unstable_LowPriority,ki=a.unstable_IdlePriority,Ii={},Ni=void 0!==Ti?Ti:function(){},Oi=null,zi=null,Ui=!1,Fi=Ci(),Bi=1e4>Fi?Ci:function(){return Ci()-Fi};function Vi(){switch(Ai()){case Li:return 99;case Pi:return 98;case Ri:return 97;case Di:return 96;case ki:return 95;default:throw Error(s(332))}}function Hi(e){switch(e){case 99:return Li;case 98:return Pi;case 97:return Ri;case 96:return Di;case 95:return ki;default:throw Error(s(332))}}function Wi(e,t){return e=Hi(e),wi(e,t)}function Gi(e,t,n){return e=Hi(e),Si(e,t,n)}function ji(){if(null!==zi){var e=zi;zi=null,Mi(e)}qi()}function qi(){if(!Ui&&null!==Oi){Ui=!0;var e=0;try{var t=Oi;Wi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Oi=null}catch(n){throw null!==Oi&&(Oi=Oi.slice(e+1)),Si(Li,ji),n}finally{Ui=!1}}}var Xi=b.ReactCurrentBatchConfig;function Yi(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ki=si(null),Zi=null,Ji=null,$i=null;function Qi(){$i=Ji=Zi=null}function ea(e){var t=Ki.current;oi(Ki),e.type._context._currentValue=t}function ta(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function na(e,t){Zi=e,$i=Ji=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ks=!0),e.firstContext=null)}function ra(e,t){if($i!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||($i=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Ji){if(null===Zi)throw Error(s(308));Ji=t,Zi.dependencies={lanes:0,firstContext:t,responders:null}}else Ji=Ji.next=t;return e._currentValue}var ia=!1;function aa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function sa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function oa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function la(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function ca(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ua(e,t,n,r){var a=e.updateQueue;ia=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var c=l,u=c.next;c.next=null,null===o?s=u:o.next=u,o=c;var h=e.alternate;if(null!==h){var d=(h=h.updateQueue).lastBaseUpdate;d!==o&&(null===d?h.firstBaseUpdate=u:d.next=u,h.lastBaseUpdate=c)}}if(null!==s){for(d=a.baseState,o=0,h=u=c=null;;){l=s.lane;var f=s.eventTime;if((r&l)===l){null!==h&&(h=h.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(l=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,l);break e}d=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(l="function"===typeof(p=m.payload)?p.call(f,d,l):p)||void 0===l)break e;d=i({},d,l);break e;case 2:ia=!0}}null!==s.callback&&(e.flags|=32,null===(l=a.effects)?a.effects=[s]:l.push(s))}else f={eventTime:f,lane:l,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===h?(u=h=f,c=d):h=h.next=f,o|=l;if(null===(s=s.next)){if(null===(l=a.shared.pending))break;s=l.next,l.next=null,a.lastBaseUpdate=l,a.shared.pending=null}}null===h&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=h,Uo|=o,e.lanes=o,e.memoizedState=d}}function ha(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var da=(new r.Component).refs;function fa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var pa={isMounted:function(e){return!!(e=e._reactInternals)&&Ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cl(),i=ul(e),a=oa(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),la(e,a),hl(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cl(),i=ul(e),a=oa(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),la(e,a),hl(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cl(),r=ul(e),i=oa(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),la(e,i),hl(e,r,n)}};function ma(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,a))}function ga(e,t,n){var r=!1,i=ci,a=t.contextType;return"object"===typeof a&&null!==a?a=ra(a):(i=pi(t)?di:ui.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?fi(e,i):ci),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=pa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function va(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pa.enqueueReplaceState(t,t.state,null)}function ya(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=da,aa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=ra(a):(a=pi(t)?di:ui.current,i.context=fi(e,a)),ua(e,n,i,r),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(fa(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&pa.enqueueReplaceState(i,i.state,null),ua(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4)}var _a=Array.isArray;function xa(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===da&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ba(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function wa(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Wl(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function o(t){return e&&null===t.alternate&&(t.flags=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Xl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=xa(e,t,n),r.return=e,r):((r=Gl(n.type,n.key,n.props,null,e.mode,r)).ref=xa(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Yl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=jl(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Xl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Gl(t.type,t.key,t.props,null,e.mode,n)).ref=xa(e,null,t),n.return=e,n;case S:return(t=Yl(t,e.mode,n)).return=e,t}if(_a(t)||H(t))return(t=jl(t,e.mode,n,null)).return=e,t;ba(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?n.type===M?h(e,t,n.props.children,r,i):c(e,t,n,r):null;case S:return n.key===i?u(e,t,n,r):null}if(_a(n)||H(n))return null!==i?null:h(e,t,n,r,null);ba(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return e=e.get(null===r.key?n:r.key)||null,r.type===M?h(t,e,r.props.children,i,r.key):c(t,e,r,i);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(_a(r)||H(r))return h(t,e=e.get(n)||null,r,i,null);ba(t,r)}return null}function m(i,s,o,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),s=a(v,s,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===o.length)return n(i,h),c;if(null===h){for(;m<o.length;m++)null!==(h=d(i,o[m],l))&&(s=a(h,s,m),null===u?c=h:u.sibling=h,u=h);return c}for(h=r(i,h);m<o.length;m++)null!==(g=p(h,i,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),c}function g(i,o,l,c){var u=H(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=f(i,m,y.value,c);if(null===_){null===m&&(m=v);break}e&&m&&null===_.alternate&&t(i,m),o=a(_,o,g),null===h?u=_:h.sibling=_,h=_,m=v}if(y.done)return n(i,m),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,c))&&(o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return u}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(i,e)})),u}return function(e,r,a,l){var c="object"===typeof a&&null!==a&&a.type===M&&null===a.key;c&&(a=a.props.children);var u="object"===typeof a&&null!==a;if(u)switch(a.$$typeof){case w:e:{for(u=a.key,c=r;null!==c;){if(c.key===u){switch(c.tag){case 7:if(a.type===M){n(e,c.sibling),(r=i(c,a.props.children)).return=e,e=r;break e}break;default:if(c.elementType===a.type){n(e,c.sibling),(r=i(c,a.props)).ref=xa(e,c,a),r.return=e,e=r;break e}}n(e,c);break}t(e,c),c=c.sibling}a.type===M?((r=jl(a.props.children,e.mode,l,a.key)).return=e,e=r):((l=Gl(a.type,a.key,a.props,null,e.mode,l)).ref=xa(e,r,a),l.return=e,e=l)}return o(e);case S:e:{for(c=a.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(e,r.sibling),(r=i(r,a.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Yl(a,e.mode,l)).return=e,e=r}return o(e)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,a)).return=e,e=r):(n(e,r),(r=Xl(a,e.mode,l)).return=e,e=r),o(e);if(_a(a))return m(e,r,a,l);if(H(a))return g(e,r,a,l);if(u&&ba(e,a),"undefined"===typeof a&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,X(e.type)||"Component"))}return n(e,r)}}var Sa=wa(!0),Ma=wa(!1),Ea={},Ta=si(Ea),Ca=si(Ea),Aa=si(Ea);function La(e){if(e===Ea)throw Error(s(174));return e}function Pa(e,t){switch(li(Aa,t),li(Ca,e),li(Ta,Ea),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}oi(Ta),li(Ta,t)}function Ra(){oi(Ta),oi(Ca),oi(Aa)}function Da(e){La(Aa.current);var t=La(Ta.current),n=pe(t,e.type);t!==n&&(li(Ca,e),li(Ta,n))}function ka(e){Ca.current===e&&(oi(Ta),oi(Ca))}var Ia=si(0);function Na(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Oa=null,za=null,Ua=!1;function Fa(e,t){var n=Vl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Ba(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Va(e){if(Ua){var t=za;if(t){var n=t;if(!Ba(e,t)){if(!(t=jr(n.nextSibling))||!Ba(e,t))return e.flags=-1025&e.flags|2,Ua=!1,void(Oa=e);Fa(Oa,n)}Oa=e,za=jr(t.firstChild)}else e.flags=-1025&e.flags|2,Ua=!1,Oa=e}}function Ha(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Oa=e}function Wa(e){if(e!==Oa)return!1;if(!Ua)return Ha(e),Ua=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Vr(t,e.memoizedProps))for(t=za;t;)Fa(e,t),t=jr(t.nextSibling);if(Ha(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){za=jr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}za=null}}else za=Oa?jr(e.stateNode.nextSibling):null;return!0}function Ga(){za=Oa=null,Ua=!1}var ja=[];function qa(){for(var e=0;e<ja.length;e++)ja[e]._workInProgressVersionPrimary=null;ja.length=0}var Xa=b.ReactCurrentDispatcher,Ya=b.ReactCurrentBatchConfig,Ka=0,Za=null,Ja=null,$a=null,Qa=!1,es=!1;function ts(){throw Error(s(321))}function ns(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function rs(e,t,n,r,i,a){if(Ka=a,Za=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Xa.current=null===e||null===e.memoizedState?Ls:Ps,e=n(r,i),es){a=0;do{if(es=!1,!(25>a))throw Error(s(301));a+=1,$a=Ja=null,t.updateQueue=null,Xa.current=Rs,e=n(r,i)}while(es)}if(Xa.current=As,t=null!==Ja&&null!==Ja.next,Ka=0,$a=Ja=Za=null,Qa=!1,t)throw Error(s(300));return e}function is(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===$a?Za.memoizedState=$a=e:$a=$a.next=e,$a}function as(){if(null===Ja){var e=Za.alternate;e=null!==e?e.memoizedState:null}else e=Ja.next;var t=null===$a?Za.memoizedState:$a.next;if(null!==t)$a=t,Ja=e;else{if(null===e)throw Error(s(310));e={memoizedState:(Ja=e).memoizedState,baseState:Ja.baseState,baseQueue:Ja.baseQueue,queue:Ja.queue,next:null},null===$a?Za.memoizedState=$a=e:$a=$a.next=e}return $a}function ss(e,t){return"function"===typeof t?t(e):t}function os(e){var t=as(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=Ja,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=o=a=null,c=i;do{var u=c.lane;if((Ka&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var h={lane:u,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(o=l=h,a=r):l=l.next=h,Za.lanes|=u,Uo|=u}c=c.next}while(null!==c&&c!==i);null===l?a=r:l.next=o,or(r,t.memoizedState)||(ks=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ls(e){var t=as(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);or(a,t.memoizedState)||(ks=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function cs(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(Ka&e)===e)&&(t._workInProgressVersionPrimary=r,ja.push(t))),e)return n(t._source);throw ja.push(t),Error(s(350))}function us(e,t,n,r){var i=Po;if(null===i)throw Error(s(349));var a=t._getVersion,o=a(t._source),l=Xa.current,c=l.useState((function(){return cs(i,t,n)})),u=c[1],h=c[0];c=$a;var d=e.memoizedState,f=d.refs,p=f.getSnapshot,m=d.source;d=d.subscribe;var g=Za;return e.memoizedState={refs:f,source:t,subscribe:r},l.useEffect((function(){f.getSnapshot=n,f.setSnapshot=u;var e=a(t._source);if(!or(o,e)){e=n(t._source),or(h,e)||(u(e),e=ul(g),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,s=e;0<s;){var l=31-Gt(s),c=1<<l;r[l]|=e,s&=~c}}}),[n,t,r]),l.useEffect((function(){return r(t._source,(function(){var e=f.getSnapshot,n=f.setSnapshot;try{n(e(t._source));var r=ul(g);i.mutableReadLanes|=r&i.pendingLanes}catch(a){n((function(){throw a}))}}))}),[t,r]),or(p,n)&&or(m,t)&&or(d,r)||((e={pending:null,dispatch:null,lastRenderedReducer:ss,lastRenderedState:h}).dispatch=u=Cs.bind(null,Za,e),c.queue=e,c.baseQueue=null,h=cs(i,t,n),c.memoizedState=c.baseState=h),h}function hs(e,t,n){return us(as(),e,t,n)}function ds(e){var t=is();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:ss,lastRenderedState:e}).dispatch=Cs.bind(null,Za,e),[t.memoizedState,e]}function fs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Za.updateQueue)?(t={lastEffect:null},Za.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ps(e){return e={current:e},is().memoizedState=e}function ms(){return as().memoizedState}function gs(e,t,n,r){var i=is();Za.flags|=e,i.memoizedState=fs(1|t,n,void 0,void 0===r?null:r)}function vs(e,t,n,r){var i=as();r=void 0===r?null:r;var a=void 0;if(null!==Ja){var s=Ja.memoizedState;if(a=s.destroy,null!==r&&ns(r,s.deps))return void fs(t,n,a,r)}Za.flags|=e,i.memoizedState=fs(1|t,n,a,r)}function ys(e,t){return gs(516,4,e,t)}function _s(e,t){return vs(516,4,e,t)}function xs(e,t){return vs(4,2,e,t)}function bs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ws(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,vs(4,2,bs.bind(null,t,e),n)}function Ss(){}function Ms(e,t){var n=as();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ns(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Es(e,t){var n=as();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ns(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ts(e,t){var n=Vi();Wi(98>n?98:n,(function(){e(!0)})),Wi(97<n?97:n,(function(){var n=Ya.transition;Ya.transition=1;try{e(!1),t()}finally{Ya.transition=n}}))}function Cs(e,t,n){var r=cl(),i=ul(e),a={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},s=t.pending;if(null===s?a.next=a:(a.next=s.next,s.next=a),t.pending=a,s=e.alternate,e===Za||null!==s&&s===Za)es=Qa=!0;else{if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,l=s(o,n);if(a.eagerReducer=s,a.eagerState=l,or(l,o))return}catch(c){}hl(e,i,r)}}var As={readContext:ra,useCallback:ts,useContext:ts,useEffect:ts,useImperativeHandle:ts,useLayoutEffect:ts,useMemo:ts,useReducer:ts,useRef:ts,useState:ts,useDebugValue:ts,useDeferredValue:ts,useTransition:ts,useMutableSource:ts,useOpaqueIdentifier:ts,unstable_isNewReconciler:!1},Ls={readContext:ra,useCallback:function(e,t){return is().memoizedState=[e,void 0===t?null:t],e},useContext:ra,useEffect:ys,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,gs(4,2,bs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return gs(4,2,e,t)},useMemo:function(e,t){var n=is();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=is();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Cs.bind(null,Za,e),[r.memoizedState,e]},useRef:ps,useState:ds,useDebugValue:Ss,useDeferredValue:function(e){var t=ds(e),n=t[0],r=t[1];return ys((function(){var t=Ya.transition;Ya.transition=1;try{r(e)}finally{Ya.transition=t}}),[e]),n},useTransition:function(){var e=ds(!1),t=e[0];return ps(e=Ts.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=is();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},us(r,e,t,n)},useOpaqueIdentifier:function(){if(Ua){var e=!1,t=function(e){return{$$typeof:N,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Xr++).toString(36))),Error(s(355))})),n=ds(t)[1];return 0===(2&Za.mode)&&(Za.flags|=516,fs(5,(function(){n("r:"+(Xr++).toString(36))}),void 0,null)),t}return ds(t="r:"+(Xr++).toString(36)),t},unstable_isNewReconciler:!1},Ps={readContext:ra,useCallback:Ms,useContext:ra,useEffect:_s,useImperativeHandle:ws,useLayoutEffect:xs,useMemo:Es,useReducer:os,useRef:ms,useState:function(){return os(ss)},useDebugValue:Ss,useDeferredValue:function(e){var t=os(ss),n=t[0],r=t[1];return _s((function(){var t=Ya.transition;Ya.transition=1;try{r(e)}finally{Ya.transition=t}}),[e]),n},useTransition:function(){var e=os(ss)[0];return[ms().current,e]},useMutableSource:hs,useOpaqueIdentifier:function(){return os(ss)[0]},unstable_isNewReconciler:!1},Rs={readContext:ra,useCallback:Ms,useContext:ra,useEffect:_s,useImperativeHandle:ws,useLayoutEffect:xs,useMemo:Es,useReducer:ls,useRef:ms,useState:function(){return ls(ss)},useDebugValue:Ss,useDeferredValue:function(e){var t=ls(ss),n=t[0],r=t[1];return _s((function(){var t=Ya.transition;Ya.transition=1;try{r(e)}finally{Ya.transition=t}}),[e]),n},useTransition:function(){var e=ls(ss)[0];return[ms().current,e]},useMutableSource:hs,useOpaqueIdentifier:function(){return ls(ss)[0]},unstable_isNewReconciler:!1},Ds=b.ReactCurrentOwner,ks=!1;function Is(e,t,n,r){t.child=null===e?Ma(t,null,n,r):Sa(t,e.child,n,r)}function Ns(e,t,n,r,i){n=n.render;var a=t.ref;return na(t,i),r=rs(e,t,n,r,a,i),null===e||ks?(t.flags|=1,Is(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,to(e,t,i))}function Os(e,t,n,r,i,a){if(null===e){var s=n.type;return"function"!==typeof s||Hl(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Gl(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,zs(e,t,s,r,i,a))}return s=e.child,0===(i&a)&&(i=s.memoizedProps,(n=null!==(n=n.compare)?n:cr)(i,r)&&e.ref===t.ref)?to(e,t,a):(t.flags|=1,(e=Wl(s,r)).ref=t.ref,e.return=t,t.child=e)}function zs(e,t,n,r,i,a){if(null!==e&&cr(e.memoizedProps,r)&&e.ref===t.ref){if(ks=!1,0===(a&i))return t.lanes=e.lanes,to(e,t,a);0!==(16384&e.flags)&&(ks=!0)}return Bs(e,t,n,r,a)}function Us(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},_l(t,n);else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},_l(t,e),null;t.memoizedState={baseLanes:0},_l(t,null!==a?a.baseLanes:n)}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,_l(t,r);return Is(e,t,i,n),t.child}function Fs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Bs(e,t,n,r,i){var a=pi(n)?di:ui.current;return a=fi(t,a),na(t,i),n=rs(e,t,n,r,a,i),null===e||ks?(t.flags|=1,Is(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,to(e,t,i))}function Vs(e,t,n,r,i){if(pi(n)){var a=!0;yi(t)}else a=!1;if(na(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),ga(t,n,r),ya(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=ra(c):c=fi(t,c=pi(n)?di:ui.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==c)&&va(t,s,r,c),ia=!1;var d=t.memoizedState;s.state=d,ua(t,r,s,i),l=t.memoizedState,o!==r||d!==l||hi.current||ia?("function"===typeof u&&(fa(t,n,u,r),l=t.memoizedState),(o=ia||ma(t,n,o,r,d,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4)):("function"===typeof s.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4),r=!1)}else{s=t.stateNode,sa(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Yi(t.type,o),s.props=c,h=t.pendingProps,d=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=ra(l):l=fi(t,l=pi(n)?di:ui.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&va(t,s,r,l),ia=!1,d=t.memoizedState,s.state=d,ua(t,r,s,i);var p=t.memoizedState;o!==h||d!==p||hi.current||ia?("function"===typeof f&&(fa(t,n,f,r),p=t.memoizedState),(c=ia||ma(t,n,c,r,d,p,l))?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return Hs(e,t,n,r,a,i)}function Hs(e,t,n,r,i,a){Fs(e,t);var s=0!==(64&t.flags);if(!r&&!s)return i&&_i(t,n,!1),to(e,t,a);r=t.stateNode,Ds.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Sa(t,e.child,null,a),t.child=Sa(t,null,o,a)):Is(e,t,o,a),t.memoizedState=r.state,i&&_i(t,n,!0),t.child}function Ws(e){var t=e.stateNode;t.pendingContext?gi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&gi(0,t.context,!1),Pa(e,t.containerInfo)}var Gs,js,qs,Xs={dehydrated:null,retryLane:0};function Ys(e,t,n){var r,i=t.pendingProps,a=Ia.current,s=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),li(Ia,1&a),null===e?(void 0!==i.fallback&&Va(t),e=i.children,a=i.fallback,s?(e=Ks(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Xs,e):"number"===typeof i.unstable_expectedLoadTime?(e=Ks(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Xs,t.lanes=33554432,e):((n=ql({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,s?(i=Js(e,t,i.children,i.fallback,n),s=t.child,a=e.child.memoizedState,s.memoizedState=null===a?{baseLanes:n}:{baseLanes:a.baseLanes|n},s.childLanes=e.childLanes&~n,t.memoizedState=Xs,i):(n=Zs(e,t,i.children,n),t.memoizedState=null,n))}function Ks(e,t,n,r){var i=e.mode,a=e.child;return t={mode:"hidden",children:t},0===(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=t):a=ql(t,i,0,null),n=jl(n,i,r,null),a.return=e,n.return=e,a.sibling=n,e.child=a,n}function Zs(e,t,n,r){var i=e.child;return e=i.sibling,n=Wl(i,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Js(e,t,n,r,i){var a=t.mode,s=e.child;e=s.sibling;var o={mode:"hidden",children:n};return 0===(2&a)&&t.child!==s?((n=t.child).childLanes=0,n.pendingProps=o,null!==(s=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=s,s.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Wl(s,o),null!==e?r=Wl(e,r):(r=jl(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function $s(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ta(e.return,t)}function Qs(e,t,n,r,i,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.lastEffect=a)}function eo(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Is(e,t,r.children,n),0!==(2&(r=Ia.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$s(e,n);else if(19===e.tag)$s(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(li(Ia,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Na(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Qs(t,!1,i,n,a,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Na(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Qs(t,!0,n,null,a,t.lastEffect);break;case"together":Qs(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function to(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Uo|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Wl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Wl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function no(e,t){if(!Ua)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ro(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return pi(t.type)&&mi(),null;case 3:return Ra(),oi(hi),oi(ui),qa(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Wa(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:ka(t);var a=La(Aa.current);if(n=t.type,null!==e&&null!=t.stateNode)js(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=La(Ta.current),Wa(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Kr]=t,r[Zr]=o,n){case"dialog":Cr("cancel",r),Cr("close",r);break;case"iframe":case"object":case"embed":Cr("load",r);break;case"video":case"audio":for(e=0;e<Sr.length;e++)Cr(Sr[e],r);break;case"source":Cr("error",r);break;case"img":case"image":case"link":Cr("error",r),Cr("load",r);break;case"details":Cr("toggle",r);break;case"input":ee(r,o),Cr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Cr("invalid",r);break;case"textarea":le(r,o),Cr("invalid",r)}for(var c in Me(n,o),e=null,o)o.hasOwnProperty(c)&&(a=o[c],"children"===c?"string"===typeof a?r.textContent!==a&&(e=["children",a]):"number"===typeof a&&r.textContent!==""+a&&(e=["children",""+a]):l.hasOwnProperty(c)&&null!=a&&"onScroll"===c&&Cr("scroll",r));switch(n){case"input":Z(r),re(r,o,!0);break;case"textarea":Z(r),ue(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=zr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(c=9===a.nodeType?a:a.ownerDocument,e===he&&(e=fe(n)),e===he?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Kr]=t,e[Zr]=r,Gs(e,t),t.stateNode=e,c=Ee(n,r),n){case"dialog":Cr("cancel",e),Cr("close",e),a=r;break;case"iframe":case"object":case"embed":Cr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Sr.length;a++)Cr(Sr[a],e);a=r;break;case"source":Cr("error",e),a=r;break;case"img":case"image":case"link":Cr("error",e),Cr("load",e),a=r;break;case"details":Cr("toggle",e),a=r;break;case"input":ee(e,r),a=Q(e,r),Cr("invalid",e);break;case"option":a=ae(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=i({},r,{value:void 0}),Cr("invalid",e);break;case"textarea":le(e,r),a=oe(e,r),Cr("invalid",e);break;default:a=r}Me(n,a);var u=a;for(o in u)if(u.hasOwnProperty(o)){var h=u[o];"style"===o?we(e,h):"dangerouslySetInnerHTML"===o?null!=(h=h?h.__html:void 0)&&ve(e,h):"children"===o?"string"===typeof h?("textarea"!==n||""!==h)&&ye(e,h):"number"===typeof h&&ye(e,""+h):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(l.hasOwnProperty(o)?null!=h&&"onScroll"===o&&Cr("scroll",e):null!=h&&x(e,o,h,c))}switch(n){case"input":Z(e),re(e,r,!1);break;case"textarea":Z(e),ue(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Y(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?se(e,!!r.multiple,o,!1):null!=r.defaultValue&&se(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=zr)}Br(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)qs(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));n=La(Aa.current),La(Ta.current),Wa(t)?(r=t.stateNode,n=t.memoizedProps,r[Kr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Kr]=t,t.stateNode=r)}return null;case 13:return oi(Ia),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Wa(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Ia.current)?0===No&&(No=3):(0!==No&&3!==No||(No=4),null===Po||0===(134217727&Uo)&&0===(134217727&Fo)||ml(Po,Do))),(r||n)&&(t.flags|=4),null);case 4:return Ra(),null===e&&Lr(t.stateNode.containerInfo),null;case 10:return ea(t),null;case 17:return pi(t.type)&&mi(),null;case 19:if(oi(Ia),null===(r=t.memoizedState))return null;if(o=0!==(64&t.flags),null===(c=r.rendering))if(o)no(r,!1);else{if(0!==No||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(c=Na(e))){for(t.flags|=64,no(r,!1),null!==(o=c.updateQueue)&&(t.updateQueue=o,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(c=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,e=c.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return li(Ia,1&Ia.current|2),t.child}e=e.sibling}null!==r.tail&&Bi()>Wo&&(t.flags|=64,o=!0,no(r,!1),t.lanes=33554432)}else{if(!o)if(null!==(e=Na(c))){if(t.flags|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),no(r,!0),null===r.tail&&"hidden"===r.tailMode&&!c.alternate&&!Ua)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Bi()-r.renderingStartTime>Wo&&1073741824!==n&&(t.flags|=64,o=!0,no(r,!1),t.lanes=33554432);r.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=r.last)?n.sibling=c:t.child=c,r.last=c)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Bi(),n.sibling=null,t=Ia.current,li(Ia,o?1&t|2:1&t),n):null;case 23:case 24:return xl(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function io(e){switch(e.tag){case 1:pi(e.type)&&mi();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Ra(),oi(hi),oi(ui),qa(),0!==(64&(t=e.flags)))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return ka(e),null;case 13:return oi(Ia),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return oi(Ia),null;case 4:return Ra(),null;case 10:return ea(e),null;case 23:case 24:return xl(),null;default:return null}}function ao(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function so(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Gs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},js=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,La(Ta.current);var s,o=null;switch(n){case"input":a=Q(e,a),r=Q(e,r),o=[];break;case"option":a=ae(e,a),r=ae(e,r),o=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),o=[];break;case"textarea":a=oe(e,a),r=oe(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=zr)}for(h in Me(n,r),n=null,a)if(!r.hasOwnProperty(h)&&a.hasOwnProperty(h)&&null!=a[h])if("style"===h){var c=a[h];for(s in c)c.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(l.hasOwnProperty(h)?o||(o=[]):(o=o||[]).push(h,null));for(h in r){var u=r[h];if(c=null!=a?a[h]:void 0,r.hasOwnProperty(h)&&u!==c&&(null!=u||null!=c))if("style"===h)if(c){for(s in c)!c.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&c[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(h,n)),n=u;else"dangerouslySetInnerHTML"===h?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(o=o||[]).push(h,u)):"children"===h?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(h,""+u):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(l.hasOwnProperty(h)?(null!=u&&"onScroll"===h&&Cr("scroll",e),o||c===u||(o=[])):"object"===typeof u&&null!==u&&u.$$typeof===N?u.toString():(o=o||[]).push(h,u))}n&&(o=o||[]).push("style",n);var h=o;(t.updateQueue=h)&&(t.flags|=4)}},qs=function(e,t,n,r){n!==r&&(t.flags|=4)};var oo="function"===typeof WeakMap?WeakMap:Map;function lo(e,t,n){(n=oa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Xo||(Xo=!0,Yo=r),so(0,t)},n}function co(e,t,n){(n=oa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return so(0,t),r(i)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Ko?Ko=new Set([this]):Ko.add(this),so(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var uo="function"===typeof WeakSet?WeakSet:Set;function ho(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){zl(e,n)}else t.current=null}function fo(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Yi(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Gr(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(s(163))}function po(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(Il(n,e),kl(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Yi(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&ha(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}ha(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Br(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&wt(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(s(163))}function mo(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,r.style.display=be("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function go(e,t){if(bi&&"function"===typeof bi.onCommitFiberUnmount)try{bi.onCommitFiberUnmount(xi,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!==(4&r))Il(t,n);else{r=t;try{i()}catch(a){zl(r,a)}}n=n.next}while(n!==e)}break;case 1:if(ho(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){zl(t,a)}break;case 5:ho(t);break;case 4:wo(e,t)}}function vo(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function yo(e){return 5===e.tag||3===e.tag||4===e.tag}function _o(e){e:{for(var t=e.return;null!==t;){if(yo(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(ye(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||yo(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?xo(e,n,t):bo(e,n,t)}function xo(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=zr));else if(4!==r&&null!==(e=e.child))for(xo(e,t,n),e=e.sibling;null!==e;)xo(e,t,n),e=e.sibling}function bo(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(bo(e,t,n),e=e.sibling;null!==e;)bo(e,t,n),e=e.sibling}function wo(e,t){for(var n,r,i=t,a=!1;;){if(!a){a=i.return;e:for(;;){if(null===a)throw Error(s(160));switch(n=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===i.tag||6===i.tag){e:for(var o=e,l=i,c=l;;)if(go(o,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===l)break e;for(;null===c.sibling;){if(null===c.return||c.return===l)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}r?(o=n,l=i.stateNode,8===o.nodeType?o.parentNode.removeChild(l):o.removeChild(l)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(go(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function So(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var a=t.updateQueue;if(t.updateQueue=null,null!==a){for(n[Zr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Ee(e,i),t=Ee(e,r),i=0;i<a.length;i+=2){var o=a[i],l=a[i+1];"style"===o?we(n,l):"dangerouslySetInnerHTML"===o?ve(n,l):"children"===o?ye(n,l):x(n,o,l,t)}switch(e){case"input":ne(n,r);break;case"textarea":ce(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(a=r.value)?se(n,!!r.multiple,a,!1):e!==!!r.multiple&&(null!=r.defaultValue?se(n,!!r.multiple,r.defaultValue,!0):se(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,wt(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Ho=Bi(),mo(t.child,!0)),void Mo(t);case 19:return void Mo(t);case 17:return;case 23:case 24:return void mo(t,null!==t.memoizedState)}throw Error(s(163))}function Mo(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new uo),t.forEach((function(t){var r=Fl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Eo(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var To=Math.ceil,Co=b.ReactCurrentDispatcher,Ao=b.ReactCurrentOwner,Lo=0,Po=null,Ro=null,Do=0,ko=0,Io=si(0),No=0,Oo=null,zo=0,Uo=0,Fo=0,Bo=0,Vo=null,Ho=0,Wo=1/0;function Go(){Wo=Bi()+500}var jo,qo=null,Xo=!1,Yo=null,Ko=null,Zo=!1,Jo=null,$o=90,Qo=[],el=[],tl=null,nl=0,rl=null,il=-1,al=0,sl=0,ol=null,ll=!1;function cl(){return 0!==(48&Lo)?Bi():-1!==il?il:il=Bi()}function ul(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Vi()?1:2;if(0===al&&(al=zo),0!==Xi.transition){0!==sl&&(sl=null!==Vo?Vo.pendingLanes:0),e=al;var t=4186112&~sl;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Vi(),0!==(4&Lo)&&98===e?e=Bt(12,al):e=Bt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),al),e}function hl(e,t,n){if(50<nl)throw nl=0,rl=null,Error(s(185));if(null===(e=dl(e,t)))return null;Wt(e,t,n),e===Po&&(Fo|=t,4===No&&ml(e,Do));var r=Vi();1===t?0!==(8&Lo)&&0===(48&Lo)?gl(e):(fl(e,n),0===Lo&&(Go(),ji())):(0===(4&Lo)||98!==r&&99!==r||(null===tl?tl=new Set([e]):tl.add(e)),fl(e,n)),Vo=e}function dl(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function fl(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var l=31-Gt(o),c=1<<l,u=a[l];if(-1===u){if(0===(c&r)||0!==(c&i)){u=t,zt(c);var h=Ot;a[l]=10<=h?u+250:6<=h?u+5e3:-1}}else u<=t&&(e.expiredLanes|=c);o&=~c}if(r=Ut(e,e===Po?Do:0),t=Ot,0===r)null!==n&&(n!==Ii&&Mi(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Ii&&Mi(n)}15===t?(n=gl.bind(null,e),null===Oi?(Oi=[n],zi=Si(Li,qi)):Oi.push(n),n=Ii):14===t?n=Gi(99,gl.bind(null,e)):n=Gi(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),pl.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function pl(e){if(il=-1,sl=al=0,0!==(48&Lo))throw Error(s(327));var t=e.callbackNode;if(Dl()&&e.callbackNode!==t)return null;var n=Ut(e,e===Po?Do:0);if(0===n)return null;var r=n,i=Lo;Lo|=16;var a=Sl();for(Po===e&&Do===r||(Go(),bl(e,r));;)try{Tl();break}catch(l){wl(e,l)}if(Qi(),Co.current=a,Lo=i,null!==Ro?r=0:(Po=null,Do=0,r=No),0!==(zo&Fo))bl(e,0);else if(0!==r){if(2===r&&(Lo|=64,e.hydrate&&(e.hydrate=!1,Gr(e.containerInfo)),0!==(n=Ft(e))&&(r=Ml(e,n))),1===r)throw t=Oo,bl(e,0),ml(e,n),fl(e,Bi()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:Ll(e);break;case 3:if(ml(e,n),(62914560&n)===n&&10<(r=Ho+500-Bi())){if(0!==Ut(e,0))break;if(((i=e.suspendedLanes)&n)!==n){cl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Hr(Ll.bind(null,e),r);break}Ll(e);break;case 4:if(ml(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var o=31-Gt(n);a=1<<o,(o=r[o])>i&&(i=o),n&=~a}if(n=i,10<(n=(120>(n=Bi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*To(n/1960))-n)){e.timeoutHandle=Hr(Ll.bind(null,e),n);break}Ll(e);break;case 5:Ll(e);break;default:throw Error(s(329))}}return fl(e,Bi()),e.callbackNode===t?pl.bind(null,e):null}function ml(e,t){for(t&=~Bo,t&=~Fo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Gt(t),r=1<<n;e[n]=-1,t&=~r}}function gl(e){if(0!==(48&Lo))throw Error(s(327));if(Dl(),e===Po&&0!==(e.expiredLanes&Do)){var t=Do,n=Ml(e,t);0!==(zo&Fo)&&(n=Ml(e,t=Ut(e,t)))}else n=Ml(e,t=Ut(e,0));if(0!==e.tag&&2===n&&(Lo|=64,e.hydrate&&(e.hydrate=!1,Gr(e.containerInfo)),0!==(t=Ft(e))&&(n=Ml(e,t))),1===n)throw n=Oo,bl(e,0),ml(e,t),fl(e,Bi()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ll(e),fl(e,Bi()),null}function vl(e,t){var n=Lo;Lo|=1;try{return e(t)}finally{0===(Lo=n)&&(Go(),ji())}}function yl(e,t){var n=Lo;Lo&=-2,Lo|=8;try{return e(t)}finally{0===(Lo=n)&&(Go(),ji())}}function _l(e,t){li(Io,ko),ko|=t,zo|=t}function xl(){ko=Io.current,oi(Io)}function bl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Wr(n)),null!==Ro)for(n=Ro.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&mi();break;case 3:Ra(),oi(hi),oi(ui),qa();break;case 5:ka(r);break;case 4:Ra();break;case 13:case 19:oi(Ia);break;case 10:ea(r);break;case 23:case 24:xl()}n=n.return}Po=e,Ro=Wl(e.current,null),Do=ko=zo=t,No=0,Oo=null,Bo=Fo=Uo=0}function wl(e,t){for(;;){var n=Ro;try{if(Qi(),Xa.current=As,Qa){for(var r=Za.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}Qa=!1}if(Ka=0,$a=Ja=Za=null,es=!1,Ao.current=null,null===n||null===n.return){No=1,Oo=t,Ro=null;break}e:{var a=e,s=n.return,o=n,l=t;if(t=Do,o.flags|=2048,o.firstEffect=o.lastEffect=null,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l;if(0===(2&o.mode)){var u=o.alternate;u?(o.updateQueue=u.updateQueue,o.memoizedState=u.memoizedState,o.lanes=u.lanes):(o.updateQueue=null,o.memoizedState=null)}var h=0!==(1&Ia.current),d=s;do{var f;if(f=13===d.tag){var p=d.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var m=d.memoizedProps;f=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!h)}}if(f){var g=d.updateQueue;if(null===g){var v=new Set;v.add(c),d.updateQueue=v}else g.add(c);if(0===(2&d.mode)){if(d.flags|=64,o.flags|=16384,o.flags&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var y=oa(-1,1);y.tag=2,la(o,y)}o.lanes|=1;break e}l=void 0,o=t;var _=a.pingCache;if(null===_?(_=a.pingCache=new oo,l=new Set,_.set(c,l)):void 0===(l=_.get(c))&&(l=new Set,_.set(c,l)),!l.has(o)){l.add(o);var x=Ul.bind(null,a,c,o);c.then(x,x)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);l=Error((X(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==No&&(No=2),l=ao(l,o),d=s;do{switch(d.tag){case 3:a=l,d.flags|=4096,t&=-t,d.lanes|=t,ca(d,lo(0,a,t));break e;case 1:a=l;var b=d.type,w=d.stateNode;if(0===(64&d.flags)&&("function"===typeof b.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Ko||!Ko.has(w)))){d.flags|=4096,t&=-t,d.lanes|=t,ca(d,co(d,a,t));break e}}d=d.return}while(null!==d)}Al(n)}catch(S){t=S,Ro===n&&null!==n&&(Ro=n=n.return);continue}break}}function Sl(){var e=Co.current;return Co.current=As,null===e?As:e}function Ml(e,t){var n=Lo;Lo|=16;var r=Sl();for(Po===e&&Do===t||bl(e,t);;)try{El();break}catch(i){wl(e,i)}if(Qi(),Lo=n,Co.current=r,null!==Ro)throw Error(s(261));return Po=null,Do=0,No}function El(){for(;null!==Ro;)Cl(Ro)}function Tl(){for(;null!==Ro&&!Ei();)Cl(Ro)}function Cl(e){var t=jo(e.alternate,e,ko);e.memoizedProps=e.pendingProps,null===t?Al(e):Ro=t,Ao.current=null}function Al(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=ro(n,t,ko)))return void(Ro=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&ko)||0===(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=io(t)))return n.flags&=2047,void(Ro=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Ro=t);Ro=t=e}while(null!==t);0===No&&(No=5)}function Ll(e){var t=Vi();return Wi(99,Pl.bind(null,e,t)),null}function Pl(e,t){do{Dl()}while(null!==Jo);if(0!==(48&Lo))throw Error(s(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var o=e.eventTimes,l=e.expirationTimes;0<a;){var c=31-Gt(a),u=1<<c;i[c]=0,o[c]=-1,l[c]=-1,a&=~u}if(null!==tl&&0===(24&r)&&tl.has(e)&&tl.delete(e),e===Po&&(Ro=Po=null,Do=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=Lo,Lo|=32,Ao.current=null,Ur=Kt,pr(o=fr())){if("selectionStart"in o)l={start:o.selectionStart,end:o.selectionEnd};else e:if(l=(l=o.ownerDocument)&&l.defaultView||window,(u=l.getSelection&&l.getSelection())&&0!==u.rangeCount){l=u.anchorNode,a=u.anchorOffset,c=u.focusNode,u=u.focusOffset;try{l.nodeType,c.nodeType}catch(T){l=null;break e}var h=0,d=-1,f=-1,p=0,m=0,g=o,v=null;t:for(;;){for(var y;g!==l||0!==a&&3!==g.nodeType||(d=h+a),g!==c||0!==u&&3!==g.nodeType||(f=h+u),3===g.nodeType&&(h+=g.nodeValue.length),null!==(y=g.firstChild);)v=g,g=y;for(;;){if(g===o)break t;if(v===l&&++p===a&&(d=h),v===c&&++m===u&&(f=h),null!==(y=g.nextSibling))break;v=(g=v).parentNode}g=y}l=-1===d||-1===f?null:{start:d,end:f}}else l=null;l=l||{start:0,end:0}}else l=null;Fr={focusedElem:o,selectionRange:l},Kt=!1,ol=null,ll=!1,qo=r;do{try{Rl()}catch(T){if(null===qo)throw Error(s(330));zl(qo,T),qo=qo.nextEffect}}while(null!==qo);ol=null,qo=r;do{try{for(o=e;null!==qo;){var _=qo.flags;if(16&_&&ye(qo.stateNode,""),128&_){var x=qo.alternate;if(null!==x){var b=x.ref;null!==b&&("function"===typeof b?b(null):b.current=null)}}switch(1038&_){case 2:_o(qo),qo.flags&=-3;break;case 6:_o(qo),qo.flags&=-3,So(qo.alternate,qo);break;case 1024:qo.flags&=-1025;break;case 1028:qo.flags&=-1025,So(qo.alternate,qo);break;case 4:So(qo.alternate,qo);break;case 8:wo(o,l=qo);var w=l.alternate;vo(l),null!==w&&vo(w)}qo=qo.nextEffect}}catch(T){if(null===qo)throw Error(s(330));zl(qo,T),qo=qo.nextEffect}}while(null!==qo);if(b=Fr,x=fr(),_=b.focusedElem,o=b.selectionRange,x!==_&&_&&_.ownerDocument&&dr(_.ownerDocument.documentElement,_)){null!==o&&pr(_)&&(x=o.start,void 0===(b=o.end)&&(b=x),"selectionStart"in _?(_.selectionStart=x,_.selectionEnd=Math.min(b,_.value.length)):(b=(x=_.ownerDocument||document)&&x.defaultView||window).getSelection&&(b=b.getSelection(),l=_.textContent.length,w=Math.min(o.start,l),o=void 0===o.end?w:Math.min(o.end,l),!b.extend&&w>o&&(l=o,o=w,w=l),l=hr(_,w),a=hr(_,o),l&&a&&(1!==b.rangeCount||b.anchorNode!==l.node||b.anchorOffset!==l.offset||b.focusNode!==a.node||b.focusOffset!==a.offset)&&((x=x.createRange()).setStart(l.node,l.offset),b.removeAllRanges(),w>o?(b.addRange(x),b.extend(a.node,a.offset)):(x.setEnd(a.node,a.offset),b.addRange(x))))),x=[];for(b=_;b=b.parentNode;)1===b.nodeType&&x.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"===typeof _.focus&&_.focus(),_=0;_<x.length;_++)(b=x[_]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Kt=!!Ur,Fr=Ur=null,e.current=n,qo=r;do{try{for(_=e;null!==qo;){var S=qo.flags;if(36&S&&po(_,qo.alternate,qo),128&S){x=void 0;var M=qo.ref;if(null!==M){var E=qo.stateNode;switch(qo.tag){case 5:x=E;break;default:x=E}"function"===typeof M?M(x):M.current=x}}qo=qo.nextEffect}}catch(T){if(null===qo)throw Error(s(330));zl(qo,T),qo=qo.nextEffect}}while(null!==qo);qo=null,Ni(),Lo=i}else e.current=n;if(Zo)Zo=!1,Jo=e,$o=t;else for(qo=r;null!==qo;)t=qo.nextEffect,qo.nextEffect=null,8&qo.flags&&((S=qo).sibling=null,S.stateNode=null),qo=t;if(0===(r=e.pendingLanes)&&(Ko=null),1===r?e===rl?nl++:(nl=0,rl=e):nl=0,n=n.stateNode,bi&&"function"===typeof bi.onCommitFiberRoot)try{bi.onCommitFiberRoot(xi,n,void 0,64===(64&n.current.flags))}catch(T){}if(fl(e,Bi()),Xo)throw Xo=!1,e=Yo,Yo=null,e;return 0!==(8&Lo)||ji(),null}function Rl(){for(;null!==qo;){var e=qo.alternate;ll||null===ol||(0!==(8&qo.flags)?et(qo,ol)&&(ll=!0):13===qo.tag&&Eo(e,qo)&&et(qo,ol)&&(ll=!0));var t=qo.flags;0!==(256&t)&&fo(e,qo),0===(512&t)||Zo||(Zo=!0,Gi(97,(function(){return Dl(),null}))),qo=qo.nextEffect}}function Dl(){if(90!==$o){var e=97<$o?97:$o;return $o=90,Wi(e,Nl)}return!1}function kl(e,t){Qo.push(t,e),Zo||(Zo=!0,Gi(97,(function(){return Dl(),null})))}function Il(e,t){el.push(t,e),Zo||(Zo=!0,Gi(97,(function(){return Dl(),null})))}function Nl(){if(null===Jo)return!1;var e=Jo;if(Jo=null,0!==(48&Lo))throw Error(s(331));var t=Lo;Lo|=32;var n=el;el=[];for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1],o=i.destroy;if(i.destroy=void 0,"function"===typeof o)try{o()}catch(c){if(null===a)throw Error(s(330));zl(a,c)}}for(n=Qo,Qo=[],r=0;r<n.length;r+=2){i=n[r],a=n[r+1];try{var l=i.create;i.destroy=l()}catch(c){if(null===a)throw Error(s(330));zl(a,c)}}for(l=e.current.firstEffect;null!==l;)e=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=e;return Lo=t,ji(),!0}function Ol(e,t,n){la(e,t=lo(0,t=ao(n,t),1)),t=cl(),null!==(e=dl(e,1))&&(Wt(e,1,t),fl(e,t))}function zl(e,t){if(3===e.tag)Ol(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Ol(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ko||!Ko.has(r))){var i=co(n,e=ao(t,e),1);if(la(n,i),i=cl(),null!==(n=dl(n,1)))Wt(n,1,i),fl(n,i);else if("function"===typeof r.componentDidCatch&&(null===Ko||!Ko.has(r)))try{r.componentDidCatch(t,e)}catch(a){}break}}n=n.return}}function Ul(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=cl(),e.pingedLanes|=e.suspendedLanes&n,Po===e&&(Do&n)===n&&(4===No||3===No&&(62914560&Do)===Do&&500>Bi()-Ho?bl(e,0):Bo|=n),fl(e,t)}function Fl(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Vi()?1:2:(0===al&&(al=zo),0===(t=Vt(62914560&~al))&&(t=4194304))),n=cl(),null!==(e=dl(e,t))&&(Wt(e,t,n),fl(e,n))}function Bl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Vl(e,t,n,r){return new Bl(e,t,n,r)}function Hl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Wl(e,t){var n=e.alternate;return null===n?((n=Vl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Gl(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Hl(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case M:return jl(n.children,i,a,t);case O:o=8,i|=16;break;case E:o=8,i|=1;break;case T:return(e=Vl(12,n,t,8|i)).elementType=T,e.type=T,e.lanes=a,e;case P:return(e=Vl(13,n,t,i)).type=P,e.elementType=P,e.lanes=a,e;case R:return(e=Vl(19,n,t,i)).elementType=R,e.lanes=a,e;case z:return ql(n,i,a,t);case U:return(e=Vl(24,n,t,i)).elementType=U,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case A:o=9;break e;case L:o=11;break e;case D:o=14;break e;case k:o=16,r=null;break e;case I:o=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Vl(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function jl(e,t,n,r){return(e=Vl(7,e,r,t)).lanes=n,e}function ql(e,t,n,r){return(e=Vl(23,e,r,t)).elementType=z,e.lanes=n,e}function Xl(e,t,n){return(e=Vl(6,e,null,t)).lanes=n,e}function Yl(e,t,n){return(t=Vl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Kl(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ht(0),this.expirationTimes=Ht(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ht(0),this.mutableSourceEagerHydrationData=null}function Zl(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Jl(e,t,n,r){var i=t.current,a=cl(),o=ul(i);e:if(n){t:{if(Ze(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(pi(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var c=n.type;if(pi(c)){n=vi(n,c,l);break e}}n=l}else n=ci;return null===t.context?t.context=n:t.pendingContext=n,(t=oa(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),la(i,t),hl(i,o,a),o}function $l(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Ql(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ec(e,t){Ql(e,t),(e=e.alternate)&&Ql(e,t)}function tc(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Kl(e,t,null!=n&&!0===n.hydrate),t=Vl(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,aa(t),e[Jr]=n.current,Lr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function nc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function rc(e,t,n,r,i){var a=n._reactRootContainer;if(a){var s=a._internalRoot;if("function"===typeof i){var o=i;i=function(){var e=$l(s);o.call(e)}}Jl(t,s,e,i)}else{if(a=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new tc(e,0,t?{hydrate:!0}:void 0)}(n,r),s=a._internalRoot,"function"===typeof i){var l=i;i=function(){var e=$l(s);l.call(e)}}yl((function(){Jl(t,s,e,i)}))}return $l(s)}function ic(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nc(t))throw Error(s(200));return Zl(e,t,null,n)}jo=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||hi.current)ks=!0;else{if(0===(n&r)){switch(ks=!1,t.tag){case 3:Ws(t),Ga();break;case 5:Da(t);break;case 1:pi(t.type)&&yi(t);break;case 4:Pa(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;li(Ki,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Ys(e,t,n):(li(Ia,1&Ia.current),null!==(t=to(e,t,n))?t.sibling:null);li(Ia,1&Ia.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return eo(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),li(Ia,Ia.current),r)break;return null;case 23:case 24:return t.lanes=0,Us(e,t,n)}return to(e,t,n)}ks=0!==(16384&e.flags)}else ks=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=fi(t,ui.current),na(t,n),i=rs(null,t,r,e,i,n),t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,pi(r)){var a=!0;yi(t)}else a=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,aa(t);var o=r.getDerivedStateFromProps;"function"===typeof o&&fa(t,r,o,e),i.updater=pa,t.stateNode=i,i._reactInternals=t,ya(t,r,e,n),t=Hs(null,t,r,!0,a,n)}else t.tag=0,Is(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"===typeof e)return Hl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===L)return 11;if(e===D)return 14}return 2}(i),e=Yi(i,e),a){case 0:t=Bs(null,t,i,e,n);break e;case 1:t=Vs(null,t,i,e,n);break e;case 11:t=Ns(null,t,i,e,n);break e;case 14:t=Os(null,t,i,Yi(i.type,e),r,n);break e}throw Error(s(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Bs(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 1:return r=t.type,i=t.pendingProps,Vs(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 3:if(Ws(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,sa(e,t),ua(t,r,null,n),(r=t.memoizedState.element)===i)Ga(),t=to(e,t,n);else{if((a=(i=t.stateNode).hydrate)&&(za=jr(t.stateNode.containerInfo.firstChild),Oa=t,a=Ua=!0),a){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(a=e[i])._workInProgressVersionPrimary=e[i+1],ja.push(a);for(n=Ma(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Is(e,t,r,n),Ga();t=t.child}return t;case 5:return Da(t),null===e&&Va(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,Vr(r,i)?o=null:null!==a&&Vr(r,a)&&(t.flags|=16),Fs(e,t),Is(e,t,o,n),t.child;case 6:return null===e&&Va(t),null;case 13:return Ys(e,t,n);case 4:return Pa(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Sa(t,null,r,n):Is(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ns(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 7:return Is(e,t,t.pendingProps,n),t.child;case 8:case 12:return Is(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value;var l=t.type._context;if(li(Ki,l._currentValue),l._currentValue=a,null!==o)if(l=o.value,0===(a=or(l,a)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(l,a):1073741823))){if(o.children===i.children&&!hi.current){t=to(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var c=l.dependencies;if(null!==c){o=l.child;for(var u=c.firstContext;null!==u;){if(u.context===r&&0!==(u.observedBits&a)){1===l.tag&&((u=oa(-1,n&-n)).tag=2,la(l,u)),l.lanes|=n,null!==(u=l.alternate)&&(u.lanes|=n),ta(l.return,n),c.lanes|=n;break}u=u.next}}else o=10===l.tag&&l.type===t.type?null:l.child;if(null!==o)o.return=l;else for(o=l;null!==o;){if(o===t){o=null;break}if(null!==(l=o.sibling)){l.return=o.return,o=l;break}o=o.return}l=o}Is(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(a=t.pendingProps).children,na(t,n),r=r(i=ra(i,a.unstable_observedBits)),t.flags|=1,Is(e,t,r,n),t.child;case 14:return a=Yi(i=t.type,t.pendingProps),Os(e,t,i,a=Yi(i.type,a),r,n);case 15:return zs(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Yi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,pi(r)?(e=!0,yi(t)):e=!1,na(t,n),ga(t,r,i),ya(t,r,i,n),Hs(null,t,r,!0,e,n);case 19:return eo(e,t,n);case 23:case 24:return Us(e,t,n)}throw Error(s(156,t.tag))},tc.prototype.render=function(e){Jl(e,this._internalRoot,null,null)},tc.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Jl(null,e,null,(function(){t[Jr]=null}))},tt=function(e){13===e.tag&&(hl(e,4,cl()),ec(e,4))},nt=function(e){13===e.tag&&(hl(e,67108864,cl()),ec(e,67108864))},rt=function(e){if(13===e.tag){var t=cl(),n=ul(e);hl(e,n,t),ec(e,n)}},it=function(e,t){return t()},Ce=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ni(r);if(!i)throw Error(s(90));J(r),ne(r,i)}}}break;case"textarea":ce(e,n);break;case"select":null!=(t=n.value)&&se(e,!!n.multiple,t,!1)}},ke=vl,Ie=function(e,t,n,r,i){var a=Lo;Lo|=4;try{return Wi(98,e.bind(null,t,n,r,i))}finally{0===(Lo=a)&&(Go(),ji())}},Ne=function(){0===(49&Lo)&&(function(){if(null!==tl){var e=tl;tl=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,fl(e,Bi())}))}ji()}(),Dl())},Oe=function(e,t){var n=Lo;Lo|=2;try{return e(t)}finally{0===(Lo=n)&&(Go(),ji())}};var ac={Events:[ei,ti,ni,Re,De,Dl,{current:!1}]},sc={findFiberByHostInstance:Qr,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},oc={bundleType:sc.bundleType,version:sc.version,rendererPackageName:sc.rendererPackageName,rendererConfig:sc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Qe(e))?null:e.stateNode},findFiberByHostInstance:sc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lc.isDisabled&&lc.supportsFiber)try{xi=lc.inject(oc),bi=lc}catch(ge){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ac,t.createPortal=ic,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return e=null===(e=Qe(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Lo;if(0!==(48&n))return e(t);Lo|=1;try{if(e)return Wi(99,e.bind(null,t))}finally{Lo=n,ji()}},t.hydrate=function(e,t,n){if(!nc(t))throw Error(s(200));return rc(null,e,t,!0,n)},t.render=function(e,t,n){if(!nc(t))throw Error(s(200));return rc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!nc(e))throw Error(s(40));return!!e._reactRootContainer&&(yl((function(){rc(null,null,e,!1,(function(){e._reactRootContainer=null,e[Jr]=null}))})),!0)},t.unstable_batchedUpdates=vl,t.unstable_createPortal=function(e,t){return ic(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!nc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return rc(e,t,n,!1,r)},t.version="17.0.2"},function(e,t,n){"use strict";e.exports=n(31)},function(e,t,n){"use strict";var r,i,a,s;if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var u=null,h=null,d=function(){if(null!==u)try{var e=t.unstable_now();u(!0,e),u=null}catch(n){throw setTimeout(d,0),n}};r=function(e){null!==u?setTimeout(r,0,e):(u=e,setTimeout(d,0))},i=function(e,t){h=setTimeout(e,t)},a=function(){clearTimeout(h)},t.unstable_shouldYield=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var m=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var g=!1,v=null,y=-1,_=5,x=0;t.unstable_shouldYield=function(){return t.unstable_now()>=x},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5};var b=new MessageChannel,w=b.port2;b.port1.onmessage=function(){if(null!==v){var e=t.unstable_now();x=e+_;try{v(!0,e)?w.postMessage(null):(g=!1,v=null)}catch(n){throw w.postMessage(null),n}}else g=!1},r=function(e){v=e,g||(g=!0,w.postMessage(null))},i=function(e,n){y=f((function(){e(t.unstable_now())}),n)},a=function(){p(y),y=-1}}function S(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<T(i,t)))break e;e[r]=t,e[n]=i,n=r}}function M(e){return void 0===(e=e[0])?null:e}function E(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var a=2*(r+1)-1,s=e[a],o=a+1,l=e[o];if(void 0!==s&&0>T(s,n))void 0!==l&&0>T(l,s)?(e[r]=l,e[o]=n,r=o):(e[r]=s,e[a]=n,r=a);else{if(!(void 0!==l&&0>T(l,n)))break e;e[r]=l,e[o]=n,r=o}}}return t}return null}function T(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var C=[],A=[],L=1,P=null,R=3,D=!1,k=!1,I=!1;function N(e){for(var t=M(A);null!==t;){if(null===t.callback)E(A);else{if(!(t.startTime<=e))break;E(A),t.sortIndex=t.expirationTime,S(C,t)}t=M(A)}}function O(e){if(I=!1,N(e),!k)if(null!==M(C))k=!0,r(z);else{var t=M(A);null!==t&&i(O,t.startTime-e)}}function z(e,n){k=!1,I&&(I=!1,a()),D=!0;var r=R;try{for(N(n),P=M(C);null!==P&&(!(P.expirationTime>n)||e&&!t.unstable_shouldYield());){var s=P.callback;if("function"===typeof s){P.callback=null,R=P.priorityLevel;var o=s(P.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?P.callback=o:P===M(C)&&E(C),N(n)}else E(C);P=M(C)}if(null!==P)var l=!0;else{var c=M(A);null!==c&&i(O,c.startTime-n),l=!1}return l}finally{P=null,R=r,D=!1}}var U=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){k||D||(k=!0,r(z))},t.unstable_getCurrentPriorityLevel=function(){return R},t.unstable_getFirstCallbackNode=function(){return M(C)},t.unstable_next=function(e){switch(R){case 1:case 2:case 3:var t=3;break;default:t=R}var n=R;R=t;try{return e()}finally{R=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=U,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=R;R=e;try{return t()}finally{R=n}},t.unstable_scheduleCallback=function(e,n,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:L++,callback:n,priorityLevel:e,startTime:s,expirationTime:l=s+l,sortIndex:-1},s>o?(e.sortIndex=s,S(A,e),null===M(C)&&e===M(A)&&(I?a():I=!0,i(O,s-o))):(e.sortIndex=l,S(C,e),k||D||(k=!0,r(z))),e},t.unstable_wrapCallback=function(e){var t=R;return function(){var n=R;R=t;try{return e.apply(this,arguments)}finally{R=n}}}},,function(e,t,n){"use strict";(function(e){var r=n(35),i=n(36),a=n(37);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!l.TYPED_ARRAY_SUPPORT&&!(this instanceof l))return new l(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=o(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=o(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?o(e,0):d(e,t);if("Buffer"===t.type&&a(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=o(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return V(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return L(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"===typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var a,s=1,o=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(a=n;a<o;a++)if(c(e,a)===c(t,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===l)return u*s}else-1!==u&&(a-=a-u),u=-1}else for(n+l>o&&(n=o-l),a=n;a>=0;a--){for(var h=!0,d=0;d<l;d++)if(c(e,a+d)!==c(t,d)){h=!1;break}if(h)return a}return-1}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!==0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var s=0;s<r;++s){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))return s;e[n+s]=o}return s}function x(e,t,n,r){return W(V(t,e.length-n),e,n,r)}function b(e,t,n,r){return W(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return b(e,t,n,r)}function S(e,t,n,r){return W(H(t),e,n,r)}function M(e,t,n,r){return W(function(e,t){for(var n,r,i,a=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,s,o,l,c=e[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128===(192&(a=e[i+1]))&&(l=(31&c)<<6|63&a)>127&&(u=l);break;case 3:a=e[i+1],s=e[i+2],128===(192&a)&&128===(192&s)&&(l=(15&c)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:a=e[i+1],s=e[i+2],o=e[i+3],128===(192&a)&&128===(192&s)&&128===(192&o)&&(l=(15&c)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?o(e,t):void 0!==n?"string"===typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),o=Math.min(a,s),c=this.slice(r,i),u=e.slice(t,n),h=0;h<o;++h)if(c[h]!==u[h]){a=c[h],s=u[h];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function L(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=B(e[a]);return i}function R(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function D(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,r,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function O(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(e,t,n,r,a){return a||O(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,a){return a||O(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var a=0,s=1,o=0;for(this[t]=255&e;++a<n&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var a=n-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return z(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return z(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},l.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=l.isBuffer(e)?e:V(new l(e,r).toString()),o=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%o]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function W(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(34))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),s=r[0],o=r[1],l=new a(function(e,t,n){return 3*(t+n)/4-n}(0,s,o)),u=0,h=o>0?s-4:s;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===o&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===o&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=16383,o=0,l=n-i;o<l;o+=s)a.push(u(e,o,o+s>l?l:o+s));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)r[o]=s[o],i[s.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,s,o=8*i-r-1,l=(1<<o)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-u)-1,f>>=-u,u+=o;u>0;a=256*a+e[t+h],h+=d,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=r;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),a-=c}return(f?-1:1)*s*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var s,o,l,c=8*a-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(t*l-1)*Math.pow(2,i),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&o,f+=p,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[n+f]=255&s,f+=p,s/=256,c-=8);e[n+f-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},,,,,,,,,function(e,t,n){"use strict";n(16);var r=n(2),i=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;i=a("react.element"),t.Fragment=a("react.fragment")}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:a,_owner:s.current}}t.jsx=c,t.jsxs=c}]]);
</script>    <script>
  (this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],[,,,,,,,,,,,,,,,,,function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/debug_body.193b9327.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/debug_wheel.291c4dc1.obj"},function(e,t,i){},,,,,,,,,,,function(e,t,i){},,,,,,function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/marsrock.055b2928.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/mono_2.a6225cf4.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/mono_wheel.0c7cdca8.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/bus-02.07c5f9f2.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/bus-wheel.32095e6e.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/roadster-07.0d45cf64.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/roadster_wheel_02.bbc40837.obj"},function(e,t,i){},,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var s=i(2),n=i.n(s),a=i(22),r=i.n(a),h=(i(32),i(18),i(1)),o=i(26);class l{constructor(e=null){this.listeners=[],this.value=null,this.default=null,this.value=e}reset(){this.set(this.default)}set(e){this.value!==e&&(this.value=e,this.onChanged(this.value))}onChanged(e){for(let t of this.listeners)t(e)}addListener(e){"function"===typeof e&&(this.listeners.includes(e)||this.listeners.push(e))}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}}var d=new l(!0);var c=window.localStorage.getItem("isDev");var p=new class{constructor(){this.key={},this.mouse={x:window.innerWidth/2,y:window.innerHeight/2},this.listeners={},this.click={left:!1,right:!1},this.onMouseDownBound=this.onMouseDown.bind(this),this.onMouseUpBound=this.onMouseUp.bind(this),this.onMouseMoveBound=this.onMouseMove.bind(this),this.scroll=0,this.scrollDelta=0,this.scrollFactor=-1,this.onScrollBound=this.onScroll.bind(this),this.scrollSense=.05,this.onKeyDownBound=e=>{this.onKeyDown(e)},this.onKeyDown=this.onKeyDownUnlocked,this.onKeyDownNull=()=>{},this.onKeyUpBound=e=>{this.onKeyUp(e)},this.onKeyUp=this.onKeyUpUnlocked,this.onKeyUpNull=()=>{},this.mouseEnabled=!0,this.keysLocked=!1,this.mouseWasEnabled=!0}init(e){this.dom=e,this.dom.addEventListener("mousedown",this.onMouseDownBound,!1),this.dom.addEventListener("mouseup",this.onMouseUpBound,!1),this.dom.addEventListener("mousemove",this.onMouseMoveBound,!1),this.dom.addEventListener("wheel",this.onScrollBound,!1),this.dom.addEventListener("keydown",this.onKeyDownBound,!1),this.dom.addEventListener("keyup",this.onKeyUpBound,!1)}destroy(){this.dom.removeEventListener("mousedown",this.onMouseDownBound,!1),this.dom.removeEventListener("mouseup",this.onMouseUpBound,!1),this.dom.removeEventListener("mousemove",this.onMouseMoveBound,!1),this.dom.removeEventListener("wheel",this.onScrollBound,!1),this.dom.removeEventListener("keydown",this.onKeyDownBound,!1),this.dom.removeEventListener("keyup",this.onKeyUpBound,!1)}addListener(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}removeListener(e,t){if(e in this.listeners){let i=this.listeners[e].indexOf(t);i>=0&&this.listeners[e].splice(i,1)}}onMouseDown(e){this.mouseEnabled&&(0==e.button?this.click.left=!0:2==e.button&&(this.click.right=!0))}onMouseUp(e){this.mouseEnabled&&(0==e.button?this.click.left=!1:2==e.button&&(this.click.right=!1))}onMouseMove(e){this.mouse.x=e.clientX,this.mouse.y=e.clientY}onScroll(e){this.scrollDelta=e.deltaY>0?1:-1,this.scroll+=this.scrollDelta*this.scrollSense,this.scroll=Math.min(Math.max(this.scroll,-1),1)}onKey(e){if(e in this.listeners){for(let t of this.listeners[e])t();return!0}return!1}onKeyDownUnlocked(e){this.key[e.code]=!0,this.onKey(e.code)&&e.preventDefault()}onKeyUpUnlocked(e){this.key[e.code]=!1}resetKeyState(){for(let e in this.key)this.key[e]=!1}setMouseEnabled(e){this.mouseEnabled=e,this.scroll=0,this.click.left=!1,this.click.right=!1}lockKeys(){this.keysLocked||(this.resetKeyState(),this.mouseWasEnabled=this.mouseEnabled,this.setMouseEnabled(!1),this.keysLocked=!0,this.onKeyDown=this.onKeyDownNull,this.onKeyUp=this.onKeyUpNull)}unlockKeys(){this.keysLocked&&(this.keysLocked=!1,this.setMouseEnabled(!0),this.onKeyDown=this.onKeyDownUnlocked,this.onKeyUp=this.onKeyUpUnlocked)}};var u={Forward:"KeyW",Left:"KeyA",Right:"KeyD",Backward:"KeyS",LeftArrow:"ArrowLeft",UpArrow:"ArrowUp",RightArrow:"ArrowRight",DownArrow:"ArrowDown",Handbrake:"Space",BoostAccel:"ShiftLeft",BoostAccel2:"ShiftRight",Auto:"Equal",Mute:"KeyM",PageUp:"PageUp",PageDown:"PageDown",Q:"KeyQ",E:"KeyE",Camera:"KeyC",StickySteer:"IntlBackslash",Shift:"ShiftLeft",SwitchDrive:"KeyB",NodeDebug:"KeyN",Reset:"KeyR",Lights:"KeyL",Headlights:"KeyH",Pause:"KeyP",UI:"KeyU",Debug:"F3",Debug2:"F4",Reload:"F6",StepTicker:"BracketRight",Ackermann:"KeyX",AutoDrive:"KeyF",NextSkin:"KeyG",NextTopo:"KeyH",Esc:"Escape",Any:-1,Fullscreen:"F11",Control:"ControlLeft",T:"KeyT",Tab:"Tab",Plus:"NumpadAdd",Minus:"NumpadSubtract",CameraToggle:"Backquote",ResetCamera:"KeyG",Caps:"CapsLock",Num1:"Digit1"};const g=()=>{let e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(e=!0),e};var m=g()&&null===window.localStorage.getItem("force-allow-mobile");class x{constructor(e){if(this.listeners={any:[]},this.value={},e)for(let t in e)this.value[t]=e[t],this[t]=e[t]}reset(){this.set([])}setMany(e){for(let t in e)console.log("Setting ",t,e[t]),this.set(t,e[t],!0);for(let t in e)console.log("Firing onchanged ",t,this.value[t]),this.onChanged(t,this.value[t])}set(e,t,i=!1){e in this.value&&this.value[e]!==t&&(this.value[e]=t,this[e]=t,i||this.onChanged(e,this.value[e]))}onChanged(e,t){for(let i of this.listeners[e]||[])i(t);for(let i of this.listeners.any||[])i(e)}addListener(e,t){"function"===typeof t&&(e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t))}removeListener(e,t){if(!(e in this.listeners))return;let i=this.listeners[e].indexOf(t);i>=0&&this.listeners[e].splice(i,1)}}const v={AudioLevel:"AudioLevel",Units:"Units",AutoPause:"AutoPause",DoubleTap:"DoubleTap"},w={AudioLevel:.5,Units:0,AutoPause:0,DoubleTap:0};var f=new class extends x{constructor(...e){super(...e),this.value=w,this.loadConfig()}set(e,t){super.set(e,t),window.localStorage.setItem(v[e],t)}loadConfig(){let e,t;for(t in this.value)e=JSON.parse(window.localStorage.getItem(v[t])||w[t]),console.log("GameConfig: Load ",t,e),this.set(t,e)}}(w);const b="no_prompt_ha";var A=new class extends l{constructor(...e){super(...e),this.default=!1,this.value=!1,this.disabled=null!=window.localStorage.getItem(b)}disable(){this.disabled=!0,window.localStorage.setItem(b,!0)}};const y=window.location.pathname.includes("dash");var I=new class{constructor(){this.appTime=0,this.listeners=[],this.stateListeners=[],this.blurListeners=[],this.slowListeners=[],this.slowInterval=20,this.slowTimer=null,this.wasPaused=!1,this.paused=!1,this.blurred=!1,this.playSpeed=1,this.onSplash=!1,this.playLocked=!1,this.tick30Bound=this.tick30.bind(this),this.startTime=Date.now()/1e3,this.playTime=0,this.pTime=this.startTime,this.pSlowTime=this.startTime,p.addListener(u.Pause,(()=>{this.toggle(!0)})),c&&(p.addListener(u.StepTicker,this.tickOnce.bind(this)),p.addListener(u.Plus,(()=>{this.playSpeed+=.25,console.log(this.playSpeed)})),p.addListener(u.Minus,(()=>{this.playSpeed>.3&&(this.playSpeed-=.25),console.log(this.playSpeed)}))),A.addListener((()=>{this.retire(!0)})),window.onblur=()=>{0==f.value.AutoPause&&this.pause()},window.onfocus=()=>{this.wasPaused||this.resume()},document.addEventListener("visibilitychange",(e=>{"visible"==document.visibilityState?(this.blurred=!1,this.updateBlurListeners()):(this.blurred=!0,this.updateBlurListeners())})),m||y||(this.tick(),this.slowTimer=setInterval(this.tick30Bound,this.slowInterval))}toggle(e=!1){this.paused?this.resume(e):(this.wasPaused=!0,this.pause(e))}retire(){this.paused=!0,this.updateStateListeners(),cancelAnimationFrame(this.tickRAF),clearInterval(this.slowTimer),this.tick=()=>{},this.resume=()=>{}}pause(e=!1){this.playLocked=e||this.playLocked,y||this.paused||(this.paused=!0,this.updateStateListeners(),cancelAnimationFrame(this.tickRAF),clearInterval(this.slowTimer))}resume(e=!1){this.playLocked&&!e||y||this.paused&&(this.paused=!1,this.playLocked=!1,this.wasPaused=!1,this.updateStateListeners(),this.pTime=Date.now()/1e3,this.pSlowTime=this.pTime,this.tick(),this.slowTimer=setInterval(this.tick30Bound,this.slowInterval))}tick(){this.tickRAF=requestAnimationFrame((()=>this.tick())),this.time=Date.now()/1e3,this.appTime=this.time-this.startTime,this.dT=this.time-this.pTime,this.dT=this.dT>.1?.1:this.dT,this.dT&&(this.playTime+=this.dT,this.dT*=this.playSpeed,this.updateListeners()),this.pTime=this.time}tick30(){this.slowTime=Date.now()/1e3,this.slowdT=this.slowTime-this.pSlowTime,this.updateSlowListeners(this.slowdT),this.pSlowTime=this.slowTime}tickOnce(){console.log("\n\n ---------- STEP ---------- \n\n"),this.paused=!0,cancelAnimationFrame(this.tickRAF),clearInterval(this.slowTimer),this.time=Date.now()/1e3,this.appTime=this.time-this.startTime,this.dT=.016,this.updateListeners(),this.pTime=this.time,this.tick30()}updateListeners(){this.listeners.map((e=>e(this.dT,this.appTime)))}addListener(e){this.listeners.includes(e)||this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}updateSlowListeners(){this.slowListeners.map((e=>e(this.slowdT,this.appTime)))}addSlowListener(e){this.slowListeners.includes(e)||this.slowListeners.push(e)}removeSlowListener(e){let t=this.slowListeners.indexOf(e);t>=0&&this.slowListeners.splice(t,1)}updateStateListeners(){this.stateListeners.map((e=>e(this.paused)))}addStateListener(e){this.stateListeners.includes(e)||this.stateListeners.push(e)}removeStateListener(e){let t=this.stateListeners.indexOf(e);t>=0&&this.stateListeners.splice(t,1)}updateBlurListeners(){this.blurListeners.map((e=>e(this.blurred)))}addBlurListener(e){this.blurListeners.includes(e)||this.blurListeners.push(e)}removeBlurListener(e){let t=this.blurListeners.indexOf(e);t>=0&&this.blurListeners.splice(t,1)}};const D={};let N=window.location.search.substring(1).split("&");for(let _c of N){let e=_c.split("=");if(e[0].length)try{D[e[0]]=JSON.parse(e[1])}catch(Kc){D[e[0]]=e[1].toString()}}var M=D;let C=1==M.autodrive;C||!1===M.autodrive||(C=null!==window.localStorage.getItem("has-autodrive"));var j=new class extends l{set(e){super.set(e),e?window.localStorage.setItem("has-autodrive",!0):window.localStorage.removeItem("has-autodrive")}}(C);const k={bonk:{src:i.p+"static/media/surface_hit.8d170970.wav",sound:null},autoOn:{src:i.p+"static/media/auto_on.4166c93e.wav",sound:null,vol:.5},autoOff:{src:i.p+"static/media/auto_off.6dfe6c40.wav",sound:null,vol:.5}};var z=new class{constructor(){this.loader=new h.d,this.hasInit=!1,this.muted=!1,this.prevLevel=.5,this.onAutodriveBound=this.onAutodrive.bind(this),this.onLevelChangedBound=this.onLevelChanged.bind(this),this.wasMuted=!1,this.onTickerStateBound=this.onTickerState.bind(this),this.fadeInBound=this.fadeIn.bind(this),this.fadeCounter=0,this.fadeTime=1,this.initListeners=[],this.listener=new h.c,I.addStateListener(this.onTickerStateBound),I.addBlurListener(this.onTickerStateBound),this.listener.setMasterVolume(f.AudioLevel),this.prevLevel=f.AudioLevel,f.addListener(v.AudioLevel,this.onLevelChangedBound),j.addListener(this.onAutodriveBound)}onAutodrive(e){e?this.play("autoOn"):this.play("autoOff")}onLevelChanged(e){this.muted=0==e,this.listener.setMasterVolume(e)}onTickerState(e){I.paused||I.blurred?(this.wasMuted=this.muted,this.listener.setMasterVolume(0)):this.wasMuted||this.listener.setMasterVolume(f.AudioLevel)}init(){if(this.hasInit)return;let e;"running"!==this.listener.context.state&&(this.listener.context.resume(),this.listener.setMasterVolume(0),I.addListener(this.fadeInBound));for(let t in k)e=k[t],this.loadAudio(e);this.hasInit=!0;for(let t of this.initListeners)t()}fadeIn(e){this.fadeCounter+=e;let t=Math.min(f.AudioLevel,this.fadeCounter/this.fadeTime);this.listener.setMasterVolume(t),this.fadeCounter/this.fadeTime>=1&&I.removeListener(this.fadeInBound)}play(e){e in k&&k[e].sound&&(k[e].sound.isPlaying&&k[e].sound.stop(),k[e].sound.play())}loadAudio(e){let t=new h.b(this.listener);this.loader.load(e.src,(i=>{t.setBuffer(i),e.sound=t,e.vol&&t.setVolume(e.vol)}))}getAudio(e,t){let i=new h.b(this.listener);this.loader.load(e,(e=>{i.setBuffer(e),t(i)}))}getPositionalAudio(e,t,i=null){null==i&&(i=new h.M(this.listener)),this.loader.load(e,(e=>{i.setBuffer(e),t(i)}))}mute(){this.muted=!0,this.listener.setMasterVolume(0)}unmute(){this.muted=!1,this.listener.setMasterVolume(1)}toggleMute(){I.paused?this.wasMuted=!this.wasMuted:(this.muted=!this.muted,this.muted&&f.AudioLevel>0&&(this.prevLevel=f.AudioLevel),f.set(v.AudioLevel,this.muted?0:this.prevLevel))}addInitListener(e){this.initListeners.push(e)}};const S="reset",O="modelChanged",L="headlights";class R extends h.G{constructor(){super(),this.listeners={},this.headlightColour=16777215,this.geo=new h.G,this.pPosition=new h.W,this.frontAxlePosition=new h.W,this.fwd=new h.W,this.accel=new h.W,this.pVel=new h.W,this.vel=new h.W,this.velDir=new h.W,this.speed=0,this.steer=0,this.steerL=0,this.steerR=0,this.direction=0,this.drive=0,this.braking=!1,this.handbrake=!1,this.heading=0,this.gradient=0,this.roll=0,this.pitch=0,this.headlights=!0,this.headlightsManual=!1,this.downforce=0,this.brakeForce=0,this.brakeLerp=0,this.slip=0,this.speedLerp=0,this.motionHeading=0,this.wrongWay=!1,this.rockLonTarget=0,this.rockLon=0,this.rockLatTarget=0,this.rockLat=0,this.lights={left:{light:null,target:null},right:{light:null,target:null}},this.hasInit=!1,this.steerDifferential=1,this.rearSteerDifferential=1,this.frSteerDifferential=1,this.intensityFactor=1,this.headlightIntensity=1,this.add(this.geo),this.lightsContainer=new h.G;let e=new h.G,t=new h.T(16777215,1,80,.5,.5,1.8);t.target=e,this.lights.left.light=t,this.lights.left.target=e;let i=new h.G;this.lights.right.target=i;let s=t.clone();s.target=i,this.lights.right.light=s,this.lightsContainer.add(t),this.lightsContainer.add(s),this.lightsContainer.add(e),this.lightsContainer.add(i),this.add(this.lightsContainer),this.setHeadlightColour(this.headlightColour),this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.matrixWorldAutoUpdate=!1,this.hasInit=!0}setHeadlightColour(e){this.headlightColour=e,this.lights.left.light.color.setHex(e),this.lights.right.light.color.setHex(e)}update(){}reset(){this.pPosition.copy(this.position),this.speed=0,this.pVel.set(0,0,0),this.vel.set(0,0,0),this.velDir.set(0,0,0),this.accel.set(0,0,0),this.steer=0,this.steerL=0,this.steerR=0,this.drive=0,this.direction=0,this.braking=!1,this.handbrake=!1,this.downforce=0,this.brakeForce=0,this.brakeLerp=0,this.wrongWay=!1,this.slip=0,this.frontAxlePosition.copy(this.position),this.fireEvent("reset")}updateSteer(){let e=Math.sin(this.steer),t=Math.cos(this.steer)*this.wheels.length*2,i=2*this.wheels.length*e/(t-this.wheels.width*e),s=2*this.wheels.length*e/(t+this.wheels.width*e);this.steerL=Math.atan(i),this.steerR=Math.atan(s),this.frSteerDifferential=this.wheels.length/Math.sin(this.steer)/(this.wheels.length/Math.tan(this.steer))||1,this.bike||(this.steerDifferential=this.wheels.length/Math.sin(this.steerL)/(this.wheels.length/Math.sin(this.steerR))||1,this.rearSteerDifferential=this.wheels.length/i/(this.wheels.length/s)||1,this.frSteerDifferential=this.wheels.length/Math.sin(this.steer)/(this.wheels.length/Math.tan(this.steer))||1,this.steerDifferential*=this.frSteerDifferential,this.rearSteerDifferential/=this.frSteerDifferential)}setModel(e){this.reset(),this.metrics=e.metrics,this.wheels=e.wheels,this.cameras=e.cameras,this.bike=!!e.bike,this.hasInit&&(this.lights.left.light.position.copy(this.metrics.headlightPos),this.lights.left.target.position.copy(this.metrics.headlightPos),this.lights.left.target.position.z+=1,this.lights.left.target.position.y-=.05,this.lights.right.light.position.copy(this.lights.left.light.position),this.lights.right.light.position.x*=-1,this.lights.right.target.position.copy(this.lights.left.target.position),this.lights.right.target.position.x*=-1),this.fireEvent(O)}setHeadlights(e,t=!1){!e&&!t&&this.headlights&&this.headlightsManual||(this.headlightsManual=(this.headlightsManual||t)&&e,this.headlights=e,this.intensityFactor=e?1:0,this.setHeadlightIntensity(this.headlightIntensity),this.fireEvent(L))}setHeadlightIntensity(e){this.headlightIntensity=e,this.lights.right.light.intensity=e*this.intensityFactor,this.lights.left.light.intensity=e*this.intensityFactor}fireEvent(e,t=null){e in this.listeners&&this.listeners[e].map((e=>e(t)))}addListener(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}removeListener(e,t){if(!(e in this.listeners))return;let i=this.listeners[e].indexOf(t);i>=0&&this.listeners[e].splice(i,1)}}var T=new R;const P=.3,G=window.localStorage.getItem("settings-camera-mode")||0;var B="\n\n  uniform sampler2D noiseMap;\n  uniform bool isNight;\n\n  attribute float variant;\n  // attribute vec3 groundNormal;\n  attribute float shadow;\n\n  #define SPRITE_NORMAL vec3(0.0, 1.0, 0.0);\n\n  varying vec2 vUvOffset;\n  varying float vShadow;\n  varying float vNoise;\n\n  varying float vLightGrass;\n  varying float vDarkGrass;\n  #ifdef TREES\n    uniform bool highDef;\n  #endif\n\n";var W="\n\n  // Get uvLookup  from variant\n\n  /* Indexed into the texture as such:\n\n    2 | 3\n    - + -\n    0 | 1\n\n  */\n\n  vShadow = 1.0 - shadow;\n\n  // Common pieces for bush and grass\n  #if defined(GRASS) || defined(BUSH)\n    // We're only interested in the INSTANCE position for this, not vertex pos\n    vec4 wPos = modelMatrix * instanceMatrix * vec4(1.0);\n\n    float fade = texture2D(noiseMap, vec2(\n      wPos.x / 100.0,\n      wPos.z / 100.0\n    )).r;\n\n    float fade0 = texture2D(noiseMap, vec2(\n      wPos.x / 800.0,\n      wPos.z / 800.0\n    )).r;\n\n    float fade1 = texture2D(noiseMap, vec2(\n      wPos.x / 6400.0,\n      wPos.z / 6400.0\n    )).r;\n\n    fade0 = min(max(0.0,(fade0 - 0.25) * 2.0), 1.0);\n    float fade1b = min(max(0.0,(fade1 - 0.25) * 2.0), 1.0);\n\n    float heightVal = min(1.0, wPos.y/100.0);\n\n    vDarkGrass = 1.0;//1.1 - fade1b * 0.1;\n    vLightGrass = max(0.0, fade1b * heightVal * (fade0 + heightVal));\n\n    if(variant < 2.0) {\n      vLightGrass *= variant / 4.0 + 0.5;\n    }\n\n    #ifdef GRASS\n      float vari = 2.0;\n      if(shadow > 0.1) {\n        vari = floor(fade * 2.0) + 2.0;\n      }\n\n    #endif\n\n    #ifdef BUSH\n      float vari = variant; // Use given actual type for bushes maybe?\n    #endif\n\n    vUvOffset.x = mod(vari, 2.0) * 0.5;\n    vUvOffset.y = floor(vari / 2.0) * 0.5;\n\n  #endif\n\n  // Grass specific pieces\n  #ifdef GRASS\n\n    vNoise = fade;\n\n    if((vLightGrass + vNoise / 10.0 > 0.5 || fade < 0.25) && variant > 0.8) {\n      // 0, 0 for lower left, which is the pale hay type\n      vUvOffset *= 0.0;\n    }\n\n    //// HEATHER\n\n    heightVal =\n      min(1.0, wPos.y / 170.0)\n      *\n      fade1\n      *\n      (texture2D(noiseMap, vec2(\n        wPos.x / 1200.0,\n        wPos.z / 1200.0\n      )).r / 2.0 + 0.5);\n\n    heightVal = smoothstep(0.47, 0.53, heightVal) * fade0;\n\n    if(heightVal > 0.5 && variant > 0.8) {\n\n      // Sink the bush at the edges of the heather patch\n      transformed.y -= 1.0 - heightVal;\n\n      vUvOffset.x = 0.5;\n      vUvOffset.y = 0.0;\n      vLightGrass = 1.0 - heightVal;// - 0.5) * 2.0;\n      vDarkGrass = 1.0;\n    }\n\n  #endif\n\n\n  #ifdef TREES\n\n    vec4 wPos = modelMatrix * instanceMatrix * vec4( 1.0 );\n\n    vNoise = texture2D(noiseMap, vec2(\n      wPos.x / 4000.0,\n      wPos.z / 4000.0\n    )).r\n    *\n    texture2D(noiseMap, vec2(\n      wPos.x / 800.0,\n      wPos.z / 800.0\n    )).r;\n    // *\n    // (min(1.0, wPos.y / 25.0)) * 2.0\n    // -\n    // 0.5;\n\n    // vNoise *= 0.4;\n\n    // float vari = texture2D(noiseMap, vec2(\n    //   wPos.x / 200.0,\n    //   wPos.z / 200.0\n    // )).r;\n    //\n    // // Manually sample ranges\n    // if(vari < 0.4) {\n    //   vari = 0.0;\n    // } else if(vari < 0.6) {\n    //   vari = 1.0;\n    // } else {\n    //   vari = 2.0;\n    // }\n\n    // abuse vShadow for more texture\n    if(highDef) {\n      vShadow = texture2D(noiseMap, vec2(\n        wPos.x / 20.0,\n        wPos.z / 20.0\n      )).r - 0.5;\n    }\n\n    vUvOffset.x = mod(variant, 2.0) * 0.5;\n    vUvOffset.y = floor(variant / 2.0) * 0.5;\n\n  #endif\n\n  #ifdef AUTO_NORMAL\n    vNormal = SPRITE_NORMAL;\n  #endif\n";var E="\n  varying vec2 vUvOffset;\n  varying float vShadow;\n  varying float vNoise;\n\n  varying float vLightGrass;\n  varying float vDarkGrass;\n\n  uniform vec4 colouration;\n\n  #ifdef TREES\n    uniform sampler2D mapb;\n    uniform bool highDef;\n  #endif\n";var Z="\n\nvec4 texelColor = texture2D( map, vUv + vUvOffset );\n\n  #ifdef GRASS\n    texelColor += colouration * vLightGrass * vNoise;\n    texelColor.rgb *= vDarkGrass;\n    texelColor.rgb *= vShadow;\n  #endif\n\n  #ifdef BUSH\n    texelColor.rgb *= 1.0 - (vLightGrass * 0.1);\n    texelColor.rgb *= vShadow;\n  #endif\n\n  #ifdef TREES\n    // Possibly use a second set\n    if(highDef == true) {\n      if(vNoise > 0.25) {\n        texelColor = texture2D( mapb, vUv + vUvOffset );\n      }\n      texelColor += colouration * vShadow;\n    }\n  #endif\n\n  diffuseColor *= texelColor;\n";const F=new h.U,H=(e,t=1,i=h.O)=>{let s=F.load(e);return s.wrapS=i,s.wrapT=i,s.anisotropy=t,s},Q=(e,t={})=>{for(let i in t)e.userData[i]={value:t[i]};return e.userData.isNight={value:!1},i=>{for(let s in t)i.uniforms[s]=e.userData[s];i.uniforms.isNight=e.userData.isNight,i.vertexShader=i.vertexShader.replace("#define STANDARD","#define STANDARD\n"+B),i.vertexShader=i.vertexShader.replace("#include <begin_vertex>","#include <begin_vertex>\n"+W),i.fragmentShader=i.fragmentShader.replace("#define STANDARD","#define STANDARD\n"+E),i.fragmentShader=i.fragmentShader.replace("#include <normal_fragment_begin>","\n  float faceDirection = -1.0;\n  vec3 normal = normalize(vNormal);  \n  vec3 geometryNormal = normal;\n"),i.fragmentShader=i.fragmentShader.replace("#include <map_fragment>",Z),i.fragmentShader=i.fragmentShader.replace("#include <lights_fragment_begin>","\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef USE_CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\n#ifdef USE_IRIDESCENCE\n\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\n\tif ( material.iridescenceThickness == 0.0 ) {\n\n\t\tmaterial.iridescence = 0.0;\n\n\t} else {\n\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\n\t}\n\n\tif ( material.iridescence > 0.0 ) {\n\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\n\t\t// Iridescence F0 approximation\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\n\t}\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n/* REFERENCE\n\nvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n  vec3 lVector = spotLight.position - geometry.position;\n  light.direction = normalize( lVector );\n  float angleCos = dot( light.direction, spotLight.direction );\n  float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n  if ( spotAttenuation > 0.0 ) {\n    float lightDistance = length( lVector );\n    light.color = spotLight.color * spotAttenuation;\n    light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n    light.visible = ( light.color != vec3( 0.0 ) );\n  } else {\n    light.color = vec3( 0.0 );\n    light.visible = false;\n  }\n}\n\nstruct SpotLight {\n  vec3 position;\n  \n\t\tvec3 direction;\n  \n\t\tvec3 color;\n  \n\t\tfloat distance;\n  \n\t\tfloat decay;\n  \n\t\tfloat coneCos;\n  \n\t\tfloat penumbraCos;\n  \n\t\n}\n\n*/\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n  #ifdef AUTO_NORMAL\n    geometry.normal = geometry.viewDir;\n  #endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n    // Temper the intensity since we're directly reflecting; 100%  is just too bright\n    spotLight.color *= 0.75;\n    // Extra tempering if autonorm (perfectly vertical)\n    #ifdef AUTO_NORMAL\n      spotLight.color *= 0.33;\n    #endif\n\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\n\t\t// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n  geometry.normal = normal;\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n")}},Y=e=>{e.vertexShader=e.vertexShader.replace("#define STANDARD","#define STANDARD\n"+B),e.vertexShader=e.vertexShader.replace("#include <uv2_vertex>","#include <uv2_vertex>\n"+W),e.fragmentShader=e.fragmentShader.replace("#define STANDARD","#define STANDARD\n"+E),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",Z)},V=(e,t=.75,i=0,s=null,n={},a={})=>{let r=new h.F({map:H(e,i,h.h),alphaTest:t,side:h.k,depthTest:!0,roughness:1,defines:n});return s&&(r.normalMap=H(s,i)),r.onBeforeCompile=Q(r,a),r},U=(e,t=.75,i=0,s=null,n=null,a={},r={})=>{let o=new h.F({map:H(e,i,h.O),alphaTest:t,side:h.k,depthTest:!0,roughness:1,defines:a});return s&&(o.normalMap=H(s,i)),o.onBeforeCompile=Q(o,r),o};var X=H;const J=[{midlineHorizon:2e3,midlineFineHorizon:100,farSize:200,viewDist:200,fwdHorizon:40,rearHorizon:10,nearFwdHorizon:15,wallGenHorizon:65,wallRenderHorizon:20},{midlineHorizon:2e3,midlineFineHorizon:100,farSize:400,viewDist:800,fwdHorizon:90,rearHorizon:15,nearFwdHorizon:25,wallGenHorizon:80,wallRenderHorizon:35},{midlineHorizon:2e3,midlineFineHorizon:110,farSize:700,viewDist:1400,fwdHorizon:180,rearHorizon:20,nearFwdHorizon:30,wallGenHorizon:95,wallRenderHorizon:50},{midlineHorizon:2e3,midlineFineHorizon:125,farSize:1e3,viewDist:2e3,fwdHorizon:250,rearHorizon:30,nearFwdHorizon:40,wallGenHorizon:115,wallRenderHorizon:70},{midlineFineHorizon:50,farSize:1e3,fwdHorizon:10,nearFwdHorizon:10,wallGenHorizon:40,wallRenderHorizon:20}],q=[{medRes:5,nearRes:10},{medRes:8,nearRes:16},{medRes:10,nearRes:20},{medRes:12,nearRes:24}],K=isNaN(parseInt(window.localStorage.getItem("config-view-lod-index")))?2:parseInt(window.localStorage.getItem("config-view-lod-index"));let _=isNaN(parseInt(window.localStorage.getItem("config-detail-lod-index")))?1:parseInt(window.localStorage.getItem("config-detail-lod-index")),$=J[K],ee=q[_];const te=e=>{$=J[e],me=$.farSize,xe=me/10,we=$.viewDist,fe=we/Math.cos(ve*(Math.PI/180)/2*(window.screen.availWidth/window.screen.availHeight)),ae=$.midlineHorizon,oe=$.midlineFineHorizon,Ie=$.fwdHorizon,De=$.rearHorizon,Ce=$.nearFwdHorizon,je=$.rearHorizon,We=$.wallGenHorizon,Ee=$.wallRenderHorizon,be.density=Math.sqrt(5/(we*we))},ie=e=>{ee=q[e],_=e,ye=ee.medRes,Me=ee.nearRes,be=e>1?new h.q(16777215,Math.sqrt(5/(we*we))):new h.p(16777215,.1*we,we)},se=(e,t,i)=>{be.color.setHex(e),be.near=t,be.far=i,be.isFogExp2&&(be.density=Math.sqrt(5/(i*i)))},ne=()=>be;let ae=1500;const re=1e3,he=ae-re;let oe=$.midlineFineHorizon,le=7;const de=e=>{le=e},ce=new h.a(16777215,.1),pe=new h.s(16777215,16777215,.2),ue=new h.j(16777215,.6);ue.sunOffset=new h.W(0,100,0);const ge=new h.i(16777215);let me=$.farSize,xe=me/10;const ve=68;let we=me*Math.floor(2.5),fe=we/Math.cos(ve*(Math.PI/180)/2*(window.screen.availWidth/window.screen.availHeight));let be=new h.p(16777215,.1*we,we);const Ae=10;let ye=ee.medRes,Ie=$.fwdHorizon,De=$.rearHorizon;const Ne=10;let Me=ee.nearRes,Ce=$.nearFwdHorizon,je=De;let ke=1.4;const ze=e=>{ke=e};let Se=.95;const Oe=e=>{Se=e};let Le=.85;const Re=e=>{Le=e};let Te=3;const Pe=e=>{Te=e},Ge=.4,Be=new h.F({map:null,alphaTest:.75});let We=$.wallGenHorizon,Ee=$.wallRenderHorizon;const Ze=30;$.treeRenderHorizon;const Fe=new h.C({depthTest:!1,fog:!0,map:X(null,2)});Fe.userData.nearCol={value:new h.i(0)},Fe.userData.farCol={value:new h.i(65535)},Fe.userData.hasClouds={value:!0},Fe.userData.camPos={value:new h.W},Fe.userData.time={value:0},Fe.onBeforeCompile=e=>(e.uniforms.nearCol=Fe.userData.nearCol,e.uniforms.farCol=Fe.userData.farCol,e.uniforms.hasClouds=Fe.userData.hasClouds,e.uniforms.camPos=Fe.userData.camPos,e.uniforms.time=Fe.userData.time,e.vertexShader=e.vertexShader.replace("#include <uv_pars_vertex>","#include <uv_pars_vertex>\n\n  uniform float time;\n  uniform vec3 camPos;\n\n  varying vec4 wPos;\n  varying vec2 vUUv;\n  varying vec2 vUUUv;\n\n  float skyScale = 7000.0; // Width of sky texture in metres\n  float skyScale2 = 5600.0;\n"),e.vertexShader=e.vertexShader.replace("#include <uv_vertex>","#include <uv_vertex>\n\n  wPos = modelMatrix * vec4( position, 1.0 );\n\n  // Distance (height) from camera to virtual plane\n  // Big hmm here, these values may intersect with road on rare occasions, could min them\n  float h0 = 350.0 - camPos.y;\n  // Distance from camera to image plane\n  float h1 = 450.0 - camPos.y;\n\n  float lowerScale = skyScale2 * h1 / h0;\n  float motionScale = (h1 - h0) / h0;\n\n  vUUv.x = wPos.x + time;\n  vUUv.y = wPos.z + time;\n\n  vUUv /= skyScale;\n\n  vUUUv.x = ((wPos.x + camPos.x * motionScale ) / lowerScale) + (3000.0 + time) / skyScale2;\n  vUUUv.y = ((wPos.z + camPos.z * motionScale ) / lowerScale) + (3000.0 + time) / skyScale2;\n\n"),e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","vFogDepth = -mvPosition.z;\n#ifdef FOG_EXP2\nvFogDepth = max(0.0, (vFogDepth - fogNear) * (fogFar / (fogFar - fogNear)));\n#endif\n"),e.fragmentShader=e.fragmentShader.replace("#include <uv_pars_fragment>","#include <uv_pars_fragment>\n\n  uniform vec3 nearCol;\n  uniform vec3 farCol;\n  uniform bool hasClouds;\n\n  varying vec2 vUUv;\n  varying vec2 vUUUv;\n\n  const highp float NOISE_GRANULARITY = 0.1;\n\n  highp float random(vec2 coords) {\n     return (fract(sin(dot(coords.xy, vec2(12.9898,78.233))) * 43758.5453) * 0.2) - 0.1;\n  }\n"),e.fragmentShader=e.fragmentShader.replace("#include <aomap_fragment>","#include <aomap_fragment>\n\n  float vX = (vUv.x - 0.5) * 5.0;\n  float vY = (vUv.y - 0.5) * 5.0;\n\n  float dist = max(0.0, 1.0 - sqrt((vX * vX) + (vY * vY)));\n\n  // DITHERING - todo only on high qual?\n  // dist += random(vec2(vX, vY));\n\n  vec4 skyCol = vec4(mix(farCol, nearCol, dist*dist), 1.0);\n\n  if(hasClouds) {\n\n    // vec4 upperClouds = texture2D(map, vUUv);\n    // vec4 lowerClouds = texture2D(map, vUUUv);\n    //\n    // if(lowerClouds.a > 0.5) {\n    //   lowerClouds.rgb = mix(lowerClouds.rgb, vec3(1.0, 0.5, 0.28), (lowerClouds.a - 0.5) * 2.0);\n    // }\n    //\n    // vec4 cloudCol = max(upperClouds, lowerClouds);\n\n    vec4 cloudCol = max(texture2D( map, vUUv ), texture2D(map, vUUUv)); // MAX\n    // vec4 cloudCol = texture2D( map, vUUv ) * texture2D(map, vUUUv); // MULTIPLY\n    // vec4 cloudCol = (texture2D(map, vUUv) + texture2D( map, vUUUv )) / 2.0; // AVERAGE\n\n    // Apply colour if we have it?\n\n    diffuseColor = mix(skyCol, cloudCol, cloudCol.a);\n\n  } else {\n    diffuseColor = skyCol;\n  }\n\n"),e);const He=new h.I(ve,1,.25,fe);He.fwd=new h.W(0,0,1);var Qe=He;const Ye=()=>Date.now().toString(16).substring(3);let Ve=Ye(),Ue=0,Xe=window.location.search.substring(1).split("&"),Je=localStorage.getItem("seed");if(Je){console.log("Restoring seed from local storage"),Ve=Je;let e=localStorage.getItem("config-scene-topography")||"normal",t=Ve+"?"+e,i=0;try{i=JSON.parse(localStorage.getItem(t))||0,console.log("Restoring saved progress to node ",i)}catch(Kc){console.warn("Could not load saved progress for seed ",Ve)}Ue=i}if(Xe.length)for(let _c of Xe){let e=_c.split("=");if("seed"==e[0])console.log("Overriding seed with querystring"),Ve=e[1];else if("node"==e[0]){console.log("Overriding start node with querystring");try{Ue=JSON.parse(e[1])}catch(Kc){console.error("Invalid start node param")}}}localStorage.setItem("seed",Ve);const qe=(e=null,t=!1)=>(null===e&&(e=Ye()),(e=e.toString())==Ve||!Ke(e)&&(localStorage.setItem("seed",e),t&&window.location.reload(),Ve=e,!0)),Ke=e=>{let t=e.toString();return!!(t.length<=0||t.includes("?")||t.includes(" "))&&(console.warn("Invalid seed ",t),!0)};Ve=Ve.toString(),console.log("SEED: ",Ve);if(Je=localStorage.getItem("start-node"),Je){console.log("Restoring starting node as ",Je);try{Ue=JSON.parse(Je)}catch(Kc){console.warn("Failed to retrieve intial node from ls")}}localStorage.removeItem("start-node");Ue>0&&(Ue-=5);var _e=i(15);const $e={discretisedTail:null,head:null,tail:null,vehicleIndex:0,vehicleNode:null,initIndex:0},et={},tt=(e,t,i,s=!1,n=!1)=>{for(et.checkNode=i,et.dist=(i.p.x-e)*(i.p.x-e)+(i.p.z-t)*(i.p.z-t),et.closestDist=et.dist,et.closestNode=et.checkNode,et.closestFwdDist=et.dist,et.closestRearDist=et.dist,et.checkInterval=10;et.checkInterval>0;et.checkInterval-=9){for(et.checkMargin=10==et.checkInterval?1.9:1.2,et.closestFwdNode=et.closestNode,et.closestRearNode=et.closestNode,et.lastChance=!1,et.checkCount=0,et.checkNode=et.closestFwdNode;!(et.checkCount>=10||et.checkNode.i+et.checkInterval>$e.tail.i);){if(et.checkInterval>1?et.checkNode=et.checkNode.next.next.next.next.next.next.next.next.next.next:et.checkNode=et.checkNode.next,et.dist=(et.checkNode.p.x-e)*(et.checkNode.p.x-e)+(et.checkNode.p.z-t)*(et.checkNode.p.z-t),et.dist<et.closestDist)et.lastChance=!1,et.closestDist=et.dist,et.closestFwdDist=et.closestDist,et.closestFwdNode=et.checkNode;else if(et.dist<et.closestDist*et.checkMargin)et.lastChance=!1;else{if(et.lastChance)break;et.lastChance=!0}et.checkCount++}for(et.checkNode=et.closestRearNode,et.lastChance=!1,et.checkCount=0;!(et.checkCount>=10||et.checkNode.i-et.checkInterval<$e.head.i);){if(et.checkInterval>1?et.checkNode=et.checkNode.prev.prev.prev.prev.prev.prev.prev.prev.prev.prev:et.checkNode=et.checkNode.prev,et.dist=(et.checkNode.p.x-e)*(et.checkNode.p.x-e)+(et.checkNode.p.z-t)*(et.checkNode.p.z-t),et.dist<et.closestDist)et.lastChance=!1,et.closestDist=et.dist,et.closestRearDist=et.closestDist,et.closestRearNode=et.checkNode;else if(et.dist<et.closestDist*et.checkMargin)et.lastChance=!1;else{if(et.lastChance)break;et.lastChance=!0}et.checkCount++}if(et.closestFwdDist<et.closestRearDist?et.closestNode=et.closestFwdNode:et.closestNode=et.closestRearNode,!s)break}return{n:et.closestNode,d2:et.closestDist}},it=(e,t,i,s=!1,n=!1)=>{var a,r;if(et.side=i.n.x*(t-i.p.z)-i.n.z*(e-i.p.x),n&&console.log(e,t,i.p.x,i.p.z),et.side<0&&(null===(a=i.next)||void 0===a?void 0:a.next))for(et.t=i.next.n.x*(t-i.next.p.z)-i.next.n.z*(e-i.next.p.x);et.t<0&&i.next;)et.side=et.t,i=i.next,et.t=i.next.n.x*(t-i.next.p.z)-i.next.n.z*(e-i.next.p.x);else for(;et.side>0&&i.prev;)i=i.prev,et.side=i.n.x*(t-i.p.z)-i.n.z*(e-i.p.x);if(et.x1=i.p.x,et.z1=i.p.z,et.x2=i.next.p.x,et.z2=i.next.p.z,et.len=(et.x2-et.x1)*(et.x2-et.x1)+(et.z2-et.z1)*(et.z2-et.z1),et.t=((e-et.x1)*(et.x2-et.x1)+(t-et.z1)*(et.z2-et.z1))/et.len,et.t=Math.max(Math.min(et.t,1),0),s&&(null===(r=i.next.ps)||void 0===r?void 0:r.length)){var h,o;if(et.t1=Math.min(.999,et.t)*i.ps.length,et.t2=Math.floor(et.t1),et.t1=et.t1-et.t2,et.pa=i.ps[et.t2],et.na=i.ns[et.t2],et.pb=i.next.p,et.nb=i.next.n,et.t2<i.ps.length-1&&(et.pb=i.ps[et.t2+1],et.nb=i.ns[et.t2+1]),n&&console.log(et.t1,et.t2),void 0===et.na||void 0===et.pa)console.log("UNDEFINED looking up ",e,t),console.log(i),console.log(i.ps),console.log(null===(h=i.ps)||void 0===h?void 0:h.length),console.log(i.ns),console.log(null===(o=i.ns)||void 0===o?void 0:o.length),console.log(et.t1,et.t2);return et.side=et.na.x*(t-et.pa.z)-et.na.z*(e-et.pa.x),et.side<0&&et.t2<i.ps.length-2?et.nb.x*(t-et.pb.z)-et.nb.z*(e-et.pb.x)<0&&(et.t2++,et.pa=i.ps[et.t2],et.pb=i.ps[et.t2+1],et.na=i.ns[et.t2]):et.side>0&&et.t2>0&&(et.t2--,et.pa=i.ps[et.t2],et.pb=i.ps[et.t2+1],et.na=i.ns[et.t2]),et.x1=et.pa.x,et.z1=et.pa.z,et.x2=et.pb.x,et.z2=et.pb.z,et.len=(et.x2-et.x1)*(et.x2-et.x1)+(et.z2-et.z1)*(et.z2-et.z1),et.t1=((e-et.x1)*(et.x2-et.x1)+(t-et.z1)*(et.z2-et.z1))/et.len,et.x3=et.x1+et.t1*(et.x2-et.x1),et.z3=et.z1+et.t1*(et.z2-et.z1),et.x1=et.x3-e,et.z1=et.z3-t,et.side=et.x1*et.na.x+et.z1*et.na.z,{d:Math.sqrt(et.x1*et.x1+et.z1*et.z1),y:et.pa.y+et.t1*(et.pb.y-et.pa.y),da:i.da+et.t*(i.next.da-i.da),s:et.side<0?-1:1,w:i.w+et.t*(i.next.w-i.w),g:i.g+et.t*(i.next.g-i.g),t:et.t,n:i}}return et.x3=et.x1+et.t*(et.x2-et.x1),et.z3=et.z1+et.t*(et.z2-et.z1),et.x1=et.x3-e,et.z1=et.z3-t,et.side=et.x1*i.n.x+et.z1*i.n.z,{d:Math.sqrt(et.x1*et.x1+et.z1*et.z1),y:i.p.y+et.t*(i.next.p.y-i.p.y),da:i.da+et.t*(i.next.da-i.da),s:et.side<0?-1:1,w:i.w+et.t*(i.next.w-i.w),g:i.g+et.t*(i.next.g-i.g),t:et.t,n:i}};var st=$e;const nt=new h.W(0,1,0),at={};class rt{static initialise(e){console.log("Loading near grid cell..."),e()}constructor(e,t,i,s=!1){this.retired=!1,this.isDebug=!1,this.centroid=new h.W,this.genRow=0,this.genIndex=0,this.nodeIndex=0,this.meshReady=!1,this.foliRow=0,this.foliIndex=0,this.foliageReady=!1,this.lod=0,this.tileCoords={x:0,z:0},this.originNode=null,this.isDebug=!1,this.farCell={x:0,z:0},this.initialised=!1,this.getHeight=()=>{},this.lod=e,this.heightmap=i,this.heights=[],this.res=t,this.res1=t+1,this.grads=[],this.norms=new Float32Array(this.res1*this.res1*3),this.verts=new Float32Array(this.res1*this.res1*3),this.roadProx=new Float32Array(this.res1*this.res1),this.treeMask=new Float32Array(this.res1*this.res1),this.curves=new Float32Array(this.res1*this.res1),this.signedRoadProx=[]}initGeneration(e,t,i,s=!1,n){if(this.initialised=!1,this.retired=!1,this.hide(),this.active=!1,this.originNode=e,this.originIndex=e.i,this.coords=t,this.tileCoords={x:t.x%xe,z:t.z%xe},this.heightmap=n,this.tileCoords.x<0&&(this.tileCoords.x+=xe),this.tileCoords.z<0&&(this.tileCoords.z+=xe),this.originPos={x:t.x*Ne,y:0,z:t.z*Ne},this.originPos.y=this.heightmap.getXZ(this.originPos.x,this.originPos.z),this.centroid.set(this.originPos.x+5,this.originPos.y,this.originPos.z+5),this.tileset=i,this.tileIndex=i.nextTileIndex++,this.tileset.registerCallback(this.tileIndex,(e=>{this.tileIndex=e})),this.tileset.setRetireIndex(this.originIndex),0==this.tileIndex&&this.tileset.setOrigin(this.originPos),this.indexOffset=this.tileIndex*this.tileset.vertexCount,this.genRow=0,this.genIndex=0,this.farCell.x=Math.floor(this.originPos.x/me),this.farCell.z=Math.floor(this.originPos.z/me),this.preHeights=[],0==wh.value.detailLodIndex?(this.precomputeHeights(),this.getHeight=this.lookupHeight2):this.getHeight=n.getXZ.bind(n),this.preCurves=[],this.precomputeCurvature(),this.initialised=this.preInitialise(s),this.initialised&&s){for(;!this.generate(););this.display(1==this.lod)}}preInitialise(){return!0}static sharpLerpAB(e,t,i){return(t-e)*i+e}static hockeyLerp(e){if(e>.3333){let t=1-(e-.3333)/.6667;return 1-t*t*.5}return 1.5*e}getNormal(e,t){let i,s;i=e<0?Math.floor((Ne+e%Ne)/Ne*this.res):Math.floor(e%Ne/Ne*this.res),s=t<0?Math.floor((Ne+t%Ne)/Ne*this.res):Math.floor(t%Ne/Ne*this.res);let n=3*(i*this.res1+s);return[this.norms[n],this.norms[n+1],this.norms[n+2]]}getNormalAtIndex(e){}lookupHeight(e,t){return at.tx=(e-this.originPos.x)/Ne*this.res,at.tz=(t-this.originPos.z)/Ne*this.res,at.x=Math.floor(at.tx),at.z=Math.floor(at.tz),at.tx-=at.x,at.tz-=at.z,at.xi=at.x*this.res1,at.zi=at.z,at.c1=this.heights[at.xi+at.zi]*(1-at.tx)+this.heights[at.xi+this.res1+at.zi]*at.tx,at.c2=this.heights[at.xi+at.zi+1]*(1-at.tx)+this.heights[at.xi+this.res1+at.zi+1]*at.tx,at.c1*(1-at.tz)+at.c2*at.tz}lerpHeight(e,t,i){return at.lh=0,i.h=i.n.h+i.t*(i.n.next.h-i.n.h),i.gfa=i.n.gfa+i.t*(i.n.next.gfa-i.n.gfa),i.ga=Math.max(Math.abs(i.g),Math.abs(i.h))/3.6,i.w+=Ge+i.ga,i.y-=.015+.025*i.gfa,i.ga=1-i.ga*i.ga,at.rm=4+16*Math.min(.75,Math.max(.4,i.ga)),i.d<i.w+at.rm?i.d<i.w&&!i.n.bridge?at.lh=i.y:(at.lt=Math.max(0,Math.min(1,2*(i.d-i.w)/at.rm)),at.lt=rt.hockeyLerp(at.lt),at.lh=this.getHeight(e,t),i.n.bridge&&at.lh<0&&(at.lh>-i.y?at.lt=Math.max(at.lt,at.lh/-i.y):at.lt=1),at.lh=at.lh*at.lt+i.y*(1-at.lt)):at.lh=this.getHeight(e,t),at.lh}static lerpHeightGlobal(e,t,i,s){let n=0;if(i.ga=Math.max(Math.abs(i.g),Math.abs(i.n.h))/3.6,i.w+=Ge+i.ga,i.y-=.01+.02*i.n.gfa,i.ga=1-i.ga*i.ga,at.rm=4+16*Math.min(.75,Math.max(.4,i.ga)),i.d<i.w+at.rm)if(i.d<i.w&&!i.n.bridge)n=i.y;else{let a=Math.max(0,Math.min(1,2*(i.d-i.w)/at.rm));a=rt.hockeyLerp(a),n=s(e,t),i.n.bridge&&n<0&&(a=n>-i.y?Math.max(a,n/-i.y):1),n=n*a+i.y*(1-a)}else n=s(e,t);return n}lookupHeight2(e,t){return at.tx=(e-this.originPos.x)/Ne,at.tz=(t-this.originPos.z)/Ne,at.tx<0?(at.tx+=1,at.tz<0?(at.tz+=1,at.c1=this.preHeights[0]*(1-at.tx)+this.preHeights[1]*at.tx,at.c2=this.preHeights[4]*(1-at.tx)+this.preHeights[5]*at.tx):at.tz>1?(at.tz-=1,at.c1=this.preHeights[8]*(1-at.tx)+this.preHeights[9]*at.tx,at.c2=this.preHeights[12]*(1-at.tx)+this.preHeights[13]*at.tx):(at.c1=this.preHeights[4]*(1-at.tx)+this.preHeights[5]*at.tx,at.c2=this.preHeights[8]*(1-at.tx)+this.preHeights[9]*at.tx)):at.tx>1?(at.tx-=1,at.tz<0?(at.tz+=1,at.c1=this.preHeights[2]*(1-at.tx)+this.preHeights[3]*at.tx,at.c2=this.preHeights[6]*(1-at.tx)+this.preHeights[7]*at.tx):at.tz>1?(at.tz-=1,at.c1=this.preHeights[10]*(1-at.tx)+this.preHeights[11]*at.tx,at.c2=this.preHeights[14]*(1-at.tx)+this.preHeights[15]*at.tx):(at.c1=this.preHeights[6]*(1-at.tx)+this.preHeights[7]*at.tx,at.c2=this.preHeights[10]*(1-at.tx)+this.preHeights[11]*at.tx)):at.tz<0?(at.tz+=1,at.c1=this.preHeights[1]*(1-at.tx)+this.preHeights[2]*at.tx,at.c2=this.preHeights[5]*(1-at.tx)+this.preHeights[6]*at.tx):at.tz>1?(at.tz-=1,at.c1=this.preHeights[9]*(1-at.tx)+this.preHeights[10]*at.tx,at.c2=this.preHeights[13]*(1-at.tx)+this.preHeights[14]*at.tx):(at.c1=this.preHeights[5]*(1-at.tx)+this.preHeights[6]*at.tx,at.c2=this.preHeights[9]*(1-at.tx)+this.preHeights[10]*at.tx),at.c1*(1-at.tz)+at.c2*at.tz}generate(){if(!this.initialised)return this.initialised=this.preInitialise(),!1;if(this.genRow>this.res)return!0;let e,t,i,s,n,a,r,h,o;this.genIndex=this.genRow*(this.res+1)*3,h=this.genRow/this.res*10;for(let l=0;l<=this.res;l++)o=l/this.res*10,e=this.genIndex+3*l,t=e/3,a=h+this.originPos.x,r=o+this.originPos.z,n=it(a,r,this.originNode,1==this.lod),n.e=Ge+Math.abs(n.da),this.signedRoadProx[t]=n.d-(n.w+n.e),i=n.d-n.w,s=this.lerpHeight(a,r,n),this.isDebug&&console.log(n.t,n.n.h,n.n.gfa,n.n.next.gfa),this.heights[t]=s,this.roadProx[t]=i,this.treeMask[t]=0,this.verts[e]=a-this.tileset.origin.x,this.verts[e+1]=s-this.tileset.origin.y,this.verts[e+2]=r-this.tileset.origin.z;return this.genRow>0&&(this.computeSquareNormalsRow(this.genRow-1),this.postProcessRow(this.genRow-1)),this.genRow++,this.genRow>this.res&&(this.computeSquareNormalsRow(this.genRow-1),this.centroid.y=(this.heights[0]+this.heights[this.res]+this.heights[this.res*this.res1]+this.heights[this.res1*this.res+this.res])/4,this.centroid.sub(this.tileset.origin),this.postProcessRow(this.genRow-1),this.postProcessCell()),this.genRow>this.res}postProcessRow(e){}postProcessCell(){}computeSquareNormalsRow(e){let t,i,s,n,a,r,o,l,d,c,p=Ne/this.res,u=2*p,g=new h.W,m=new h.W;for(d=e*this.res1,t=0;t<=this.res;t++){r=e*p+this.originPos.x,o=t*p+this.originPos.z,0==t?(r=e*p+this.originPos.x,o=this.originPos.z-p,l=it(r,o,this.originNode,1==this.lod),n=this.lerpHeight(r,o,l)):n=this.heights[d+(t-1)],t==this.res?(r=e*p+this.originPos.x,o=this.originPos.z+(t+1)*p,l=it(r,o,this.originNode,1==this.lod),a=this.lerpHeight(r,o,l)):a=this.heights[d+(t+1)],0==e?(r=this.originPos.x-p,o=t*p+this.originPos.z,l=it(r,o,this.originNode,1==this.lod),i=this.lerpHeight(r,o,l)):i=this.heights[(e-1)*this.res1+t],e==this.res?(r=(e+1)*p+this.originPos.x,o=t*p+this.originPos.z,l=it(r,o,this.originNode,1==this.lod),s=this.lerpHeight(r,o,l)):s=this.heights[(e+1)*this.res1+t],g.set(u,s-i,0),m.set(0,a-n,u),g.cross(m).normalize().negate(),c=3*(d+t),this.norms[c]=g.x,this.norms[c+1]=g.y,this.norms[c+2]=g.z;let h=e/this.res1,x=t/this.res1,v=this.preCurves[0]*(1-h)+this.preCurves[1]*h,w=this.preCurves[2]*(1-h)+this.preCurves[3]*h;this.curves[d+t]=v*(1-x)+w*x,this.grads[d+t]=1-Math.abs(g.dot(nt))}}precomputeHeights(){this.preHeights.length=0;let e,t,i=this.originPos.x,s=this.originPos.z;for(t=-1;t<3;t++)for(e=-1;e<3;e++)this.preHeights.push(this.heightmap.getXZ(i+10*e,s+10*t))}precomputeCurvature(){let e=this.originPos.x,t=this.originPos.z;this.getCurvature(e,t),this.getCurvature(e+10,t),this.getCurvature(e,t+10),this.getCurvature(e+10,t+10)}getCurvature(e,t,i=5){let s=this.heightmap.getXZLayer(e-i,t,0)+this.heightmap.getXZLayer(e+i,t,0)+this.heightmap.getXZLayer(e,t-i,0)+this.heightmap.getXZLayer(e,t+i,0);s=s/4-this.heightmap.getXZ(e,t),this.preCurves.push(.02*s)}display(e=!1){this.active=!0,this.tileset.tileReady(this.tileIndex,this.verts,this.norms,this.curves,this.roadProx,this.treeMask,this.centroid,e)}show(){this.tileset.draw(),this.active=!0}hide(){this.active=!1}retire(){this.tileset.hideTile(this.tileIndex),this.retired=!0}}var ht=rt;class ot extends h.g{constructor(e,t){super();let i,s,n,a,r=[],o=[],l=[],d=[];this.res=e,this.size=t,this.count=(e+1)*(e+1);for(let h=0;h<=e;h++)for(let c=0;c<=e;c++)r.push(h/e*t,0,c/e*t),l.push(0),h<e&&c<e&&(i=h*(e+1)+c,s=h*(e+1)+(c+1),n=(h+1)*(e+1)+c,a=(h+1)*(e+1)+(c+1),o.push(i,s,n),o.push(s,a,n)),d.push(0);this.setIndex(o),this.setAttribute("position",new h.o(new Float32Array(r),3)),this.setAttribute("heightOffset",new h.o(new Float32Array(l),1)),this.attributes.heightOffset.setUsage(h.l),this.setAttribute("normal",new h.o(new Float32Array(r.length),3)),this.attributes.normal.setUsage(h.l),this.setAttribute("curvature",new h.o(new Float32Array(d),1)),this.attributes.curvature.setUsage(h.l)}computeBoundingSphere(){null==this.boundingSphere&&(this.boundingSphere=new h.R(new h.W,0));const e=this.attributes.position.array,t=this.attributes.heightOffset.array;let i=e.length,s=t.length,n=e[i-3]-e[0],a=t[s-1]-t[0],r=e[i-1]-e[2],o=n*n+a*a+r*r,l=this.res*(this.res+1),d=this.res,c=3*l,p=3*d;n=e[p]-e[c],a=t[d]-t[l],r=e[p+2]-e[c+2];let u=n*n+a*a+r*r;u>o?(this.boundingSphere.radius=Math.sqrt(u)/2,this.boundingSphere.center.set((e[c]+e[p])/2,(t[l]+t[d])/2,(e[c+2]+e[p+2])/2)):(this.boundingSphere.radius=Math.sqrt(o)/2,this.boundingSphere.center.set((e[0]+e[i-3])/2,(t[0]+t[s-1])/2,(e[2]+e[i-1])/2)),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}computeTriangleNormals(){const e=this.index,t=this.attributes.position,i=this.attributes.normal,s=new h.W,n=new h.W,a=new h.W,r=new h.W,o=new h.W,l=new h.W,d=new h.W,c=new h.W;let p,u,g;for(let h=0,m=e.count;h<m;h+=3)p=e.getX(h+0),u=e.getX(h+1),g=e.getX(h+2),s.fromBufferAttribute(t,p),n.fromBufferAttribute(t,u),a.fromBufferAttribute(t,g),d.subVectors(a,n),c.subVectors(s,n),d.cross(c),r.fromBufferAttribute(i,p),o.fromBufferAttribute(i,u),l.fromBufferAttribute(i,g),r.add(d),o.add(d),l.add(d),i.setXYZ(p,r.x,r.y,r.z),i.setXYZ(u,o.x,o.y,o.z),i.setXYZ(g,l.x,l.y,l.z);this.normalizeNormals(),this.attributes.normal.needsUpdate=!0}}const lt=new h.W(0,1,0),dt={vecV:new h.W,vecH:new h.W};var ct=class{constructor(e,t){this.isDebug=!1,this.genRow=0,this.genIndex=0,this.nodeIndex=0,this.latestIndex=0,this.overlapIndex=0,this.overlapCells=[],this.needsOverlapRedraw=!1,this.ready=!1,this.originNode=null,this.exitNode=null,this.isDebug=!1,this.res=xe,this.res1=this.res+1,this.res3=3*this.res1,this.size=me,this.heightmap=e,this.heights=[],this.grads=[],this.geo=new ot(this.res,this.size),this.ground=new h.B(this.geo,t),this.verts=this.geo.attributes.position.array,this.heightOffsets=this.geo.attributes.heightOffset.array,this.mesh=new h.G,this.mesh.matrixAutoUpdate=!1,this.mesh.renderOrder=10,this.mesh.add(this.ground),this.mesh.visible=!1}initGeneration(e,t,i,s,n,a,r=!1){this.hide(),this.originNode=i,this.exitNode=s,this.originCoords={x:e,z:t},this.originPos={x:e*this.size,y:0,z:t*this.size},this.heightmap=a,this.mesh.position.copy(this.originPos),this.needsOverlapRedraw=r,this.genRow=0,this.genIndex=0,this.overlapIndex=0,this.overlapCells.length=0,this.overlapTile=null,n&&(this.overlapTile=n,this.overlapCells=Object.keys(this.overlapTile)),this.originPos.y=this.heightmap.getXZ(this.originPos.x,this.originPos.z),this.mesh.position.y=this.originPos.y,this.isDebug=!1,this.ready=!1}resetOverlapMap(e,t){this.exitNode=e,this.overlapIndex=0,this.overlapCells.length=0,this.overlapTile=null,t&&(this.overlapTile=t,this.overlapCells=Object.keys(this.overlapTile))}forceGenerate(){for(;!this.generate(););this.display()}generate(){if(this.genRow<=this.res){for(this.genIndex=this.genRow*this.res1*3,dt.i=0;dt.i<=this.res;dt.i++)dt.index=this.genIndex+3*dt.i,dt.index3=this.genRow*this.res1+dt.i,dt.x=this.verts[dt.index]+this.originPos.x,dt.z=this.verts[dt.index+2]+this.originPos.z,dt.h=this.heightmap.getXZ(dt.x,dt.z),this.heights[dt.index3]=dt.h,this.heightOffsets[dt.index3]=dt.h-this.mesh.position.y;return this.genRow>0&&this.computeSquareNormalsRow(this.genRow-1),this.genRow++,this.genRow>this.res&&(this.computeSquareNormalsRow(this.genRow-1),this.geo.attributes.normal.needsUpdate=!0,this.geo.attributes.curvature.needsUpdate=!0),!1}if(this.overlapIndex<this.overlapCells.length){for(dt.oz in dt.ox=this.overlapCells[this.overlapIndex],this.overlapTile[dt.ox])this.overlapTile[dt.ox][dt.oz]<0||(dt.index=dt.ox*this.res1+1*dt.oz,this.heightOffsets[dt.index]=this.heights[dt.index]-this.mesh.position.y-4*(this.overlapTile[dt.ox][dt.oz]+.75));return this.overlapIndex++,!1}return this.mesh.visible&&this.display(),this.ready=!0,!0}lookupHeight(e,t){return e<0||e>me||t<0||t>me?this.heightmap.getXZ(this.originPos.x+e,this.originPos.z+t):(dt.cx=Math.max(e/10,0),dt.cz=Math.max(t/10,0),dt.ix=Math.min(xe-1,Math.floor(dt.cx)),dt.iz=Math.min(xe-1,Math.floor(dt.cz)),dt.index=this.res1*dt.ix+dt.iz,dt.px=dt.cx-dt.ix,dt.pz=dt.cz-dt.iz,dt.hx=this.heights[dt.index]*(1-dt.px)+this.heights[dt.index+this.res1]*dt.px,dt.hz=this.heights[dt.index+1]*(1-dt.px)+this.heights[dt.index+this.res1+1]*dt.px,dt.hx*(1-dt.pz)+dt.hz*dt.pz)}display(e=!1){if(e&&!this.ready)for(;!this.generate(););this.geo.attributes.heightOffset.needsUpdate=!0,this.geo.computeBoundingSphere(),this.mesh.updateMatrix(),this.show()}retire(){this.hide()}show(){this.mesh.visible=!0}hide(){this.mesh.visible=!1}computeSquareNormalsRow(e){for(dt.d=me/this.res,dt.d2=2*dt.d,dt.normalAttribute=this.geo.attributes.normal,dt.curvatureAttribute=this.geo.attributes.curvature,dt.rowIndex=e*this.res1,dt.j=0;dt.j<=this.res;dt.j++)dt.hAvg=0,dt.tX=e*dt.d+this.originPos.x,dt.tZ=dt.j*dt.d+this.originPos.z,dt.hAvg+=this.heightmap.getXZLayer(dt.tX+5,dt.tZ,0),dt.hAvg+=this.heightmap.getXZLayer(dt.tX-5,dt.tZ,0),dt.hAvg+=this.heightmap.getXZLayer(dt.tX,dt.tZ+5,0),dt.hAvg+=this.heightmap.getXZLayer(dt.tX,dt.tZ-5,0),dt.hAvg=dt.hAvg/4-this.heights[dt.rowIndex+dt.j],0==dt.j?(dt.tX=e*dt.d+this.originPos.x,dt.tZ=this.originPos.z-dt.d,dt.left=this.heightmap.getXZ(dt.tX,dt.tZ)):dt.left=this.heights[dt.rowIndex+(dt.j-1)],dt.j==this.res?(dt.tX=e*dt.d+this.originPos.x,dt.tZ=this.originPos.z+(dt.j+1)*dt.d,dt.right=this.heightmap.getXZ(dt.tX,dt.tZ)):dt.right=this.heights[dt.rowIndex+(dt.j+1)],0==e?(dt.tX=this.originPos.x-dt.d,dt.tZ=dt.j*dt.d+this.originPos.z,dt.up=this.heightmap.getXZ(dt.tX,dt.tZ)):dt.up=this.heights[(e-1)*this.res1+dt.j],e==this.res?(dt.tX=(e+1)*dt.d+this.originPos.x,dt.tZ=dt.j*dt.d+this.originPos.z,dt.down=this.heightmap.getXZ(dt.tX,dt.tZ)):dt.down=this.heights[(e+1)*this.res1+dt.j],dt.vecV.set(dt.d2,dt.down-dt.up,0),dt.vecH.set(0,dt.right-dt.left,dt.d2),dt.vecV.cross(dt.vecH).normalize().negate(),dt.normalAttribute.setXYZ(dt.rowIndex+dt.j,dt.vecV.x,dt.vecV.y,dt.vecV.z),this.grads[dt.rowIndex+dt.j]=1-Math.abs(dt.vecV.dot(lt)),dt.curvatureAttribute.array[dt.rowIndex+dt.j]=.02*dt.hAvg}};class pt{constructor(){this.nearGridCell=ht,this.farGridCell=ct}sanitiseConfig(e){this.skinList.includes(e.value.skin)||(console.log("Scene config not compatible; reverting to default skin"),e.set("skin","default",!0),e.set("weatherIndex",0,!0))}loader(){return 1}updateConfig(e,t){}reset(e,t,i){this.initialise(e,t,i)}initialise(e,t,i){this.seed=e,i()}onMidlineReady(){}onGridReady(){}nextWeather(){}setScene(e){}setWeather(e){}nextSkin(){}nextTopography(){}prepareGeometry(){}update(){}destroy(){}}pt.sceneName="Scene",pt.hasTrees=!0,pt.hasGrass=!0;var ut=class{constructor(e){this.rand=new window.alea(e||Ve)}generate(){}getXZ(e,t){return 0}getCell(e,t){return e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e][t]}clearCache(){if(this.cacheCount<=this.maxCached)return;let e,t;for(e in this.cache){for(t in this.cache[e])if(this.cacheAccess[e][t])this.cacheAccess[e][t]=!1;else if(delete this.cache[e][t],delete this.cacheAccess[e][t],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}}generateCell(e,t){return[]}cacheCell(e,t){this.cacheCount++,this.clearCache();let i=this.generateCell(e,t);e in this.cache||(this.cache[e]={}),this.cache[e][t]=i}destroy(){}};const gt="Hanne!",mt={layer:0,d:0,h:0,sq:0,sqb:0,wx:0,wz:0,ox:0,oz:0,px:0,pz:0,cell:null,ix:0,iz:0,depth:0},xt={...mt},vt={};var wt=class extends ut{constructor(...e){super(...e),this.resolution=5,this.depth=3,this.upscale=2,this.heightScale=1,this.heightOffset=0,this.upscaleType=0,this.controls=[],this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=9,this.qCache={},this.smoothingFunc=()=>{},this.useQuick=!1;let t=e[1]||{};switch(null!==t.heightScale&&(this.heightScale=t.heightScale),null!==t.resolution&&(this.resolution=t.resolution),this.seed=e[0]||gt,this.depth=t.depth||3,this.radiusType=null==t.radiusType?1:t.radiusType,this.upscale=t.upscale||2,this.upscaleType=null==t.upscaleType?0:t.upscaleType,this.upscaleFactor=null==t.upscaleFactor?2:t.upscaleFactor,this.squared=t.squared||!1,this.compound=t.compound||!1,this.depthHeightFactor=t.depthHeightFactor||1,this.smoothLerpIndex=null==t.smoothLerp?2:t.smoothLerp,this.smoothLerpIndex){case 2:this.smoothingFunc=this.smootherLerp;break;case 1:this.smoothingFunc=this.smoothLerp;break;case 0:default:this.smoothingFunc=this.sharpLerp}if(null!=t.resolutions)this.resolutions=t.resolutions,this.resolution=this.resolutions[0],this.depth=this.resolutions.length;else{this.resolutions=[this.resolution];for(let e=0;e<this.depth-1;e++)this.resolutions.push(this.calculateNextDepthResolution(this.resolutions[e],e))}this.controls=[],this.cellScaleMetres=1e3,this.cellScaleWorld=3e3,this.heightOffset=t.heightOffset,this.cacheCell(0,0)}cosLerp(e){return Math.cos(3.1415*e)+1}sharpLerp(e){return 1-e}smoothLerp(e){return-1*(3-2*e)*e*e+1}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpAB(e,t,i){return(t-e)*i+e}smootherLerpAB(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}lerpHeight(e,t,i,s){return(e=(s.x-t)*(s.x-t)+(s.z-i)*(s.z-i))<s.r2?this.smoothingFunc(e/s.r2)*s.y:0}clearCache(){if(!(this.cacheCount<=this.maxCached))for(vt.ox in this.cache){for(vt.oz in this.cache[vt.ox])if(this.cacheAccess[vt.ox][vt.oz])this.cacheAccess[vt.ox][vt.oz]=!1;else if(delete this.cache[vt.ox][vt.oz],delete this.cacheAccess[vt.ox][vt.oz],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}}cacheCell(e,t){for(this.cacheCount++,this.clearCache(),vt.cell=[],vt.hFactor=1,vt.rand=new window.alea(this.seed+e+t),vt.depthRes=this.resolution,vt.layer=[],vt.dhf=this.depthHeightFactor,vt.d=0;vt.d<this.depth;vt.d++){for(vt.depthRes=this.resolutions[vt.d],vt.hFactor=this.resolution/vt.depthRes*vt.dhf,vt.dhf*=this.depthHeightFactor,vt.layer=[],vt.rad=1/vt.depthRes,vt.i=0;vt.i<vt.depthRes;vt.i++){for(vt.subLayer=[],vt.j=0;vt.j<vt.depthRes;vt.j++)vt.h=2*vt.rand()-1,this.squared&&(vt.h<0?vt.h*=-vt.h*(1+vt.h)*4:vt.h*=vt.h*(1-vt.h)*4),vt.h*=vt.hFactor,vt.subLayer.push({x:(vt.i+.5)/vt.depthRes,y:vt.h*this.heightScale,z:(vt.j+.5)/vt.depthRes,r:vt.rad,r2:vt.rad*vt.rad});vt.layer.push(vt.subLayer)}vt.cell.push(vt.layer)}e in this.cache||(this.cache[e]={}),this.cache[e][t]=vt.cell}calculateNextDepthResolution(e,t){switch(this.upscaleType){case 5:let i,s=this.resolution,n=this.resolution;for(let e=0;e<t+1;e++)i=s+n,n=s,s=i;return i;case 4:return e*this.upscaleFactor+(t+1);case 3:return Math.round(e*this.upscaleFactor);case 2:return Math.pow(this.resolution,t+2);case 1:return this.resolution+Math.pow(this.upscale,t+1);case 0:default:return e+this.upscale*(t+1)}}getNextDepthResolution(e,t){return this.resolutions[t+1]}getResolution(e,t){return this.resolutions[t]}getNode(e,t,i,s){}getCell(e,t){return e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e][t]}getQuickCell(e,t){return this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.qCache[e]&&this.qCache[e][t]||this.quickCache(e,t,this.cache[e][t][this.depth-1]),this.qCache[e][t]}quickCache(e,t,i){if(e in this.qCache){if(t in this.qCache[e])return}else this.qCache[e]={};let s=[];this.useQuick=!1;for(let n of i){let i=[];for(let s of n)i.push({x:s.x,y:this.getXZ((e+s.x)*this.cellScaleWorld,(t+s.z)*this.cellScaleWorld),z:s.z,r:s.r,r2:s.r2});s.push(i)}this.useQuick=!0,this.qCache[e][t]=s}getXZQuick(e,t){let i,s,n,a,r,h;return xt.d=0,xt.h=0,xt.wx=e/this.cellScaleWorld,xt.wz=t/this.cellScaleWorld,xt.ox=Math.floor(xt.wx),xt.oz=Math.floor(xt.wz),xt.px=xt.wx-xt.ox,xt.pz=xt.wz-xt.oz,xt.layer=this.getQuickCell(xt.ox,xt.oz),xt.sq=this.getResolution(this.resolution,this.depth-1),xt.sqb=xt.sq-1,xt.ssq=xt.sq,xt.ssqb=xt.sqb,i=xt.px*xt.sq-.5,xt.ix=Math.floor(xt.px*xt.sq-.5),s=xt.pz*xt.sq-.5,xt.iz=Math.floor(xt.pz*xt.sq-.5),i-=xt.ix,s-=xt.iz,xt.ix>=0?(n=xt.iz>=0?xt.layer[xt.ix][xt.iz].y:this.getQuickCell(xt.ox,xt.oz-1)[xt.ix][xt.sqb].y,a=xt.iz<xt.ssqb?xt.layer[xt.ix][xt.iz+1].y:this.getQuickCell(xt.ox,xt.oz+1)[xt.ix][0].y):(n=xt.iz>=0?this.getQuickCell(xt.ox-1,xt.oz)[xt.sqb][xt.iz].y:this.getQuickCell(xt.ox-1,xt.oz-1)[xt.sqb][xt.sqb].y,a=xt.iz<xt.ssqb?this.getQuickCell(xt.ox-1,xt.oz)[xt.sqb][xt.iz+1].y:this.getQuickCell(xt.ox-1,xt.oz+1)[xt.sqb][0].y),xt.ix<xt.ssqb?(r=xt.iz>=0?xt.layer[xt.ix+1][xt.iz].y:this.getQuickCell(xt.ox,xt.oz-1)[xt.ix+1][xt.sqb].y,h=xt.iz<xt.ssqb?xt.layer[xt.ix+1][xt.iz+1].y:this.getQuickCell(xt.ox,xt.oz+1)[xt.ix+1][0].y):(r=xt.iz>=0?this.getQuickCell(xt.ox+1,xt.oz)[0][xt.iz].y:this.getQuickCell(xt.ox+1,xt.oz-1)[0][xt.sqb].y,h=xt.iz<xt.ssqb?this.getQuickCell(xt.ox+1,xt.oz)[0][xt.iz+1].y:this.getQuickCell(xt.ox+1,xt.oz+1)[0][0].y),n=this.sharpLerpAB(n,a,s),r=this.sharpLerpAB(r,h,s),this.sharpLerpAB(n,r,i)}getXZLayer(e,t,i){mt.layer=0,mt.d=0,mt.h=0,mt.sq=this.resolution,mt.sqb=mt.sq-1,mt.wx=e/this.cellScaleWorld,mt.wz=t/this.cellScaleWorld,mt.ox=Math.floor(mt.wx),mt.oz=Math.floor(mt.wz),mt.px=mt.wx-mt.ox,mt.pz=mt.wz-mt.oz,mt.cell=this.getCell(mt.ox,mt.oz);let s=this.depth;mt.depth=0;let n=0;for(mt.layer of mt.cell)if(n++===i){if(mt.depth==s)break;mt.ix=Math.floor(mt.px*mt.sq-.5),mt.iz=Math.floor(mt.pz*mt.sq-.5),mt.th=0,mt.ix>=0?(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz+1,this.getCell(mt.ox,mt.oz-1)[mt.depth][mt.ix][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz-1,this.getCell(mt.ox,mt.oz+1)[mt.depth][mt.ix][0])):(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz,this.getCell(mt.ox-1,mt.oz)[mt.depth][mt.sqb][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz+1,this.getCell(mt.ox-1,mt.oz-1)[mt.depth][mt.sqb][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz,this.getCell(mt.ox-1,mt.oz)[mt.depth][mt.sqb][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz-1,this.getCell(mt.ox-1,mt.oz+1)[mt.depth][mt.sqb][0])),mt.ix<mt.sqb?(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix+1][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz+1,this.getCell(mt.ox,mt.oz-1)[mt.depth][mt.ix+1][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix+1][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz-1,this.getCell(mt.ox,mt.oz+1)[mt.depth][mt.ix+1][0])):(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz,this.getCell(mt.ox+1,mt.oz)[mt.depth][0][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz+1,this.getCell(mt.ox+1,mt.oz-1)[mt.depth][0][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz,this.getCell(mt.ox+1,mt.oz)[mt.depth][0][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz-1,this.getCell(mt.ox+1,mt.oz+1)[mt.depth][0][0])),mt.h+=mt.th,mt.depth++,mt.sq=this.resolutions[mt.depth],mt.sqb=mt.sq-1}else mt.depth++,mt.sq=this.resolutions[mt.depth],mt.sqb=mt.sq-1;return mt.h+this.heightOffset}getXZ(e,t,i){for(mt.layer of(mt.d=0,mt.h=0,mt.heightFactor=1,mt.sq=this.resolution,mt.sqb=mt.sq-1,mt.wx=e/this.cellScaleWorld,mt.wz=t/this.cellScaleWorld,mt.ox=Math.floor(mt.wx),mt.oz=Math.floor(mt.wz),mt.px=mt.wx-mt.ox,mt.pz=mt.wz-mt.oz,mt.cell=this.getCell(mt.ox,mt.oz),i=i||this.depth,mt.depth=0,mt.cell)){if(mt.depth==i)break;mt.ix=Math.floor(mt.px*mt.sq-.5),mt.iz=Math.floor(mt.pz*mt.sq-.5),mt.th=0,mt.ix>=0?(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz+1,this.getCell(mt.ox,mt.oz-1)[mt.depth][mt.ix][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz-1,this.getCell(mt.ox,mt.oz+1)[mt.depth][mt.ix][0])):(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz,this.getCell(mt.ox-1,mt.oz)[mt.depth][mt.sqb][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz+1,this.getCell(mt.ox-1,mt.oz-1)[mt.depth][mt.sqb][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz,this.getCell(mt.ox-1,mt.oz)[mt.depth][mt.sqb][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px+1,mt.pz-1,this.getCell(mt.ox-1,mt.oz+1)[mt.depth][mt.sqb][0])),mt.ix<mt.sqb?(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix+1][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz+1,this.getCell(mt.ox,mt.oz-1)[mt.depth][mt.ix+1][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz,mt.layer[mt.ix+1][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px,mt.pz-1,this.getCell(mt.ox,mt.oz+1)[mt.depth][mt.ix+1][0])):(mt.iz>=0?mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz,this.getCell(mt.ox+1,mt.oz)[mt.depth][0][mt.iz]):mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz+1,this.getCell(mt.ox+1,mt.oz-1)[mt.depth][0][mt.sqb]),mt.iz<mt.sqb?mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz,this.getCell(mt.ox+1,mt.oz)[mt.depth][0][mt.iz+1]):mt.th+=this.lerpHeight(mt.d,mt.px-1,mt.pz-1,this.getCell(mt.ox+1,mt.oz+1)[mt.depth][0][0])),mt.temper=1,mt.depth>0&&(mt.temper=Math.min(Math.max(.25,(mt.h+this.heightOffset+30)/80),1)),mt.h+=mt.th*mt.temper,mt.depth++,mt.sq=this.resolutions[mt.depth],mt.sqb=mt.sq-1}return mt.h+this.heightOffset}},ft=i.p+"static/media/grass_summer_01.bb65c929.webp",bt=i.p+"static/media/gravel_01.72d5f86f.webp",At=i.p+"static/media/rock_06.7e502144.webp",yt=i.p+"static/media/forest_summer_01.629b3e11.webp",It=i.p+"static/media/heather_01.3b4049ea.webp",Dt=i.p+"static/media/sand_01.8bf3d9a0.webp",Nt=i.p+"static/media/road_03.29415d96.webp",Mt=i.p+"static/media/road_03_base.2e84c9f2.webp",Ct=i.p+"static/media/foliage_grass_summer.2ca20eaf.webp",jt=i.p+"static/media/foliage_bush_summer.7d19f331.webp",kt=i.p+"static/media/trees_summer_far_04.9b418c41.webp",zt=i.p+"static/media/trees_summer_near_04.0b483335.webp",St=i.p+"static/media/trees_summer_far_04b.71d33b5e.webp",Ot=i.p+"static/media/trees_summer_near_04b.c599bf59.webp",Lt=i.p+"static/media/trees_autumn_near_01.e4b1c1b7.webp",Rt=i.p+"static/media/trees_autumn_far_01.476e1169.webp",Tt=i.p+"static/media/trees_autumn_near_01b.784c372a.webp",Pt=i.p+"static/media/trees_autumn_far_01b.b7bc28be.webp",Gt=i.p+"static/media/grass_autumn_01.c593833e.webp",Bt=i.p+"static/media/forest_autumn_01.cd958a6a.webp",Wt=i.p+"static/media/foliage_grass_autumn.f92557d8.webp",Et=i.p+"static/media/foliage_bush_autumn.f642e219.webp",Zt=i.p+"static/media/trees_spring_near_01.2740d9e4.webp",Ft=i.p+"static/media/trees_spring_far_01.e5b43ddb.webp",Ht=i.p+"static/media/trees_spring_far_01b.77e3faf6.webp",Qt=i.p+"static/media/trees_spring_near_01b.dc9a1b07.webp",Yt=i.p+"static/media/grass_spring_01.768b870f.webp",Vt=i.p+"static/media/heather_spring_01.73869f54.webp",Ut=i.p+"static/media/foliage_grass_spring.2de5b784.webp",Xt=i.p+"static/media/foliage_bush_spring.53436f47.webp",Jt=i.p+"static/media/snow_01.5d24a4d9.webp",qt=i.p+"static/media/forest_winter.d339edd9.webp",Kt=i.p+"static/media/road_04.3a2daa1d.webp",_t=i.p+"static/media/road_04_base.2ca13356.webp",$t=i.p+"static/media/trees_winter_near_01.bc2b0a44.webp",ei=i.p+"static/media/trees_winter_far_01.22579e5a.webp",ti=i.p+"static/media/trees_winter_near_01b.6c45b1e5.webp",ii=i.p+"static/media/trees_winter_far_01b.d995fc50.webp",si=i.p+"static/media/rock_06_winter.1a82fc8c.webp",ni=i.p+"static/media/foliage_brush_winter.3157e6a1.webp",ai=i.p+"static/media/concrete_01.467e237b.webp",ri=i.p+"static/media/drystone_04.c9668f42.webp",hi=i.p+"static/media/drystone_04_snow.aee09a95.webp",oi=i.p+"static/media/wall_barrier_wood.06bbc7c3.webp",li=i.p+"static/media/wall_barrier_wood_snow.5df52f00.webp",di=i.p+"static/media/clouds_01b.d86e8361.webp",ci=i.p+"static/media/clouds_02.d765d208.webp",pi=i.p+"static/media/clouds_03.0544ea9f.webp",ui=i.p+"static/media/clouds_04.bdcd8039.webp",gi=i.p+"static/media/clouds_sunrise_b.76566df4.webp",mi=i.p+"static/media/clouds_autumn_sunset.97e16563.webp",xi=i.p+"static/media/clouds_winter_sunrise.10f858c5.webp",vi=i.p+"static/media/ambiance_summer_low.2130513f.mp3",wi=i.p+"static/media/ambiance_cloudy.4d5b0a33.mp3",fi=i.p+"static/media/wind_02.deef0e2d.mp3",bi=i.p+"static/media/rock_06_bump.12f4b9f0.webp",Ai=i.p+"static/media/crossfade_fine.0d1ec73b.webp",yi=i.p+"static/media/crossfade_finest.3013f964.webp";var Ii=i.p+"static/media/sea_waves.fba92bab.webp";const Di={treemap:{heightScale:1,heightOffset:1.25,resolutions:[3,13,41],squared:!0,depthHeightFactor:1.8,threshold:.3,threshold2:.6,threshold3:.65},topography:{normal:{heightmap:{heightScale:160,heightOffset:95,resolutions:[3,12,24],compound:!1,squared:!0,depthHeightFactor:1},roadWidth:3,smoothWindow:7},hard:{heightmap:{heightScale:165,heightOffset:120,resolutions:[3,12,24,36],compound:!1,squared:!0,depthHeightFactor:.98},roadWidth:2.8,smoothWindow:5},easy:{heightmap:{heightScale:180,heightOffset:110,resolutions:[3,12],compound:!1,squared:!0,depthHeightFactor:.9},roadWidth:3.2,smoothWindow:7},flat:{heightmap:{heightScale:0,heightOffset:50,resolution:1,depth:1,upscale:1},roadWidth:20,smoothWindow:7}},weathers:{default:{audio:{ambiance:{src:vi,ls:.1,le:.1},wind:{src:fi,ls:.07,le:.07}},water:7048371,waterSkyReflection:10143703,underwater:4215398,col:16121855,hemTop:6710886,hemGround:16777215,skyCol:6859256,skyColFar:13368830,skyMap:di,amb:0,hem:.6,dir:.9,fogNear:.25,fogFar:1,sunPos:[0,100,0]},clear:{col:15794175,skyCol:6859256,skyColFar:13368830,hemTop:13688285,hemGround:6317670,water:7048371,waterSkyReflection:10143703,underwater:4215398,amb:.2,hem:.2,dir:.8,fogNear:.5,fogFar:1,sunPos:[0,100,0]},clearSpring:{col:16777200,skyCol:5815520,skyColFar:11599615,hemTop:12303274,hemGround:8947831,water:8034974,waterSkyReflection:10872550,underwater:4478295,amb:0,hem:.6,dir:.8,fogNear:.1,fogFar:1,sunPos:[0,100,0]},clearAutumn:{col:15794175,skyCol:6859256,skyColFar:13368830,hemTop:11582395,hemGround:8423560,water:7048371,waterSkyReflection:10143703,underwater:4281193,amb:0,hem:.5,dir:.7,fogNear:.2,fogFar:1,sunPos:[0,100,0]},clearSnow:{col:16645887,skyCol:6611189,skyColFar:9627639,skyMap:null,hemTop:11582395,hemGround:10529450,water:9151142,waterSkyReflection:11592172,underwater:4213066,amb:.4,hem:0,dir:.6,fogNear:-.1,fogFar:1},sunrise:{col:16760805,skyCol:14000311,skyColFar:15752863,skyMap:gi,hemTop:16760805,hemGround:7825015,water:11240347,waterSkyReflection:13792927,underwater:4536640,amb:0,hem:.4,dir:.2,fogNear:0,fogFar:1},springSunrise:{col:16763868,skyCol:14517675,skyColFar:16750020,skyMap:gi,hemTop:16770028,hemGround:7825015,water:12682908,waterSkyReflection:14388399,underwater:4537407,amb:0,hem:.5,dir:.25,fogNear:0,fogFar:1},autumnSunrise:{col:15191218,skyCol:12886223,skyColFar:12371399,skyMap:null,hemTop:15191218,water:8285060,waterSkyReflection:9939630,underwater:3748667,hemGround:16777215,amb:0,hem:.4,dir:.1,fogNear:.25,fogFar:1},winterSunrise:{col:16641966,skyCol:7829367,skyColFar:13948336,skyMap:xi,hemTop:13948336,hemGround:5592405,water:8158057,waterSkyReflection:13088880,underwater:4013366,amb:0,hem:.5,dir:.25,fogNear:.25,fogFar:1},sunset:{col:16761489,skyCol:6611189,skyColFar:16769464,skyMap:ui,hemTop:16772047,hemGround:7829367,water:10062204,waterSkyReflection:14595739,underwater:4209463,amb:.2,hem:.4,dir:.3,fogNear:0,fogFar:1},twilight:{col:10650820,skyCol:4539806,skyColFar:10387156,skyMap:pi,hemTop:10650820,hemGround:6710886,water:4868728,waterSkyReflection:8152737,underwater:2829110,amb:0,hem:.4,dir:.2,fogNear:0,fogFar:1,headlights:!0},autumnSunset:{col:16767690,skyCol:7562623,skyColFar:13672883,skyMap:mi,hemTop:15380673,hemGround:6710886,water:5984868,waterSkyReflection:13209736,underwater:3749181,amb:0,hem:.5,dir:.2,fogNear:0,fogFar:1},winterSunset:{col:14849919,skyCol:15267574,skyColFar:16566188,skyMap:null,hemTop:16433573,hemGround:6710886,water:6903885,waterSkyReflection:11903124,underwater:3353897,amb:0,hem:.3,dir:.1,fogNear:0,fogFar:1,headlights:!0},rain:{audio:{ambiance:{src:wi,ls:.1,le:.1}},col:11843770,hemTop:11183520,hemGround:6709334,skyCol:10988204,skyColFar:11843770,skyMap:pi,water:7631213,waterSkyReflection:10330788,underwater:3552307,amb:0,hem:.6,dir:.5,fogNear:0,fogFar:1,dynamicFog:!0},springRain:{audio:{ambiance:{src:wi,ls:.1,le:.1}},col:13750208,hemTop:13421772,hemGround:8947848,skyCol:11381664,skyColFar:13421248,skyMap:di,water:8159347,waterSkyReflection:12304304,underwater:3618868,amb:0,hem:.6,dir:.6,fogNear:0,fogFar:1,dynamicFog:!0},autumnRain:{audio:{ambiance:{src:wi,ls:.1,le:.1}},col:10262415,hemTop:16773350,hemGround:6709334,skyCol:9539465,skyColFar:10263189,skyMap:ci,water:4670524,waterSkyReflection:7696744,underwater:2828839,amb:0,hem:.5,dir:.2,fogNear:0,fogFar:1,dynamicFog:!0},night:{audio:{ambiance:{src:wi,ls:.1,le:.1}},col:1184020,skyCol:1184020,skyColFar:1184020,skyMap:ci,water:131332,waterSkyReflection:1184020,underwater:131332,amb:1.25,hem:0,dir:0,fogNear:.1,fogFar:1,headlights:!0},snow:{audio:{ambiance:{src:wi,ls:.1,le:.1}},col:11772819,skyCol:11246985,skyColFar:11180677,skyMap:pi,water:8353387,waterSkyReflection:10655879,underwater:3552048,hemTop:14275267,hemGround:6709334,amb:0,hem:.6,dir:.3,fogNear:0,fogFar:.75,dynamicFog:!0}},skins:{spring:{name:"spring",weathers:["springSunrise","clearSpring","springRain","autumnSunset","night"],cycles:[["clearSpring","autumnSunset","night","night","springSunrise"],["springRain","autumnSunset","night","night","springSunrise"]],grass:Yt,heather:Vt,foliage:{trees:[Ft,Zt],treesb:[Ht,Qt],grass:Ut,bush:Xt,grassColouration:[20/255,10/255,20/255,0],treeColouration:[-.07,.1,.05,0]}},default:{name:"summer",weathers:["sunrise","clear","rain","sunset","night"],cycles:[["clear","sunset","night","night","sunrise"],["rain","sunset","night","night","sunrise"]],grass:ft,gravel:bt,rock:At,forest:yt,heather:It,water:11057343,sand:Dt,road:Nt,roadBase:Mt,walls:{sea:ai,fence:oi,drystone:ri},foliage:{trees:[kt,zt],treesb:[St,Ot],grass:Ct,bush:jt,grassColouration:[52/255,20/255,36/255,0],treeColouration:[-.05,.1,.1,0]}},autumn:{name:"autumn",weathers:["autumnSunrise","clearAutumn","autumnRain","twilight","night"],cycles:[["clear","twilight","night","night","autumnSunrise"],["autumnRain","twilight","night","night","autumnSunrise"]],grass:Gt,forest:Bt,gravel:bt,foliage:{trees:[Rt,Lt],treesb:[Pt,Tt],grass:Wt,bush:Et,grassColouration:[60/255,25/255,45/255,0],treeColouration:[.1,-.05,0,0]}},winter:{name:"winter",weathers:["winterSunrise","clearSnow","snow","winterSunset","night"],cycles:[["snow","winterSunset","night","night","winterSunrise"],["clearSnow","winterSunset","night","night","winterSunrise"]],grass:Jt,gravel:qt,forest:qt,heather:qt,sand:qt,road:Kt,roadBase:_t,rock:si,water:12110031,foliage:{trees:[ei,$t],treesb:[ii,ti],grass:null,bush:ni,grassColouration:[0,0,0,0],treeColouration:[.15,.15,.15,0]},friction:{road:1.2,side:.8,grass:.6},walls:{drystone:hi,fence:li}}},time:{noon:{}}},Ni=(e,t)=>{ji=Ci[e],zi=ki[e],Oi=Si[e],Ri=Li[e],Bi=Gi[t],Wi=Bi/20,Fi=t>1,0==t?Hi=2:1==t?Hi=Math.floor(fe/100):2==t?Hi=Math.floor(me/50):3==t&&(Hi=Math.floor(me/25)),Qi(t)},Mi=new h.F({map:X(ft,0),displacementMap:X(bi,4)}),Ci=[700,2e3,3500,6e3];let ji=3500;const ki=[200,400,600,800];let zi=400;const Si=[20,50,100,150];let Oi=100;const Li=[15,20,25,30];let Ri=10;const Ti=X(Ai),Pi=[V(null,.75,4,null,{TREES:"",AUTO_NORMAL:""},{noiseMap:Ti,mapb:null,highDef:!0,colouration:[0,0,0,0]}),V(null,.75,4,null,{TREES:"",AUTO_NORMAL:""},{noiseMap:Ti,mapb:null,highDef:!0,colouration:[0,0,0,0]})],Gi=[5e3,1e4,2e4,3e4];let Bi=5e3,Wi=Bi/20;const Ei=[V(null,.75,4,null,{GRASS:"",AUTO_NORMAL:""},{noiseMap:Ti,colouration:[0,0,0,0]}),V(null,.75,4,null,{BUSH:"",AUTO_NORMAL:""},{noiseMap:Ti,colouration:[0,0,0,0]})];Mi.userData.grassMap={value:null},Mi.userData.sandMap={value:null},Mi.userData.rockMap={value:X(bi,4)},Mi.userData.rockBumpMap={value:null},Mi.userData.gravelMap={value:null},Mi.userData.heatherMap={value:null},Mi.userData.forestMap={value:null},Mi.userData.roadBaseMap={value:null},Mi.userData.fadeRockMap={value:X(Ai,4)},Mi.userData.fadeFiner={value:X(yi,4)},Mi.userData.colouration={value:[.18,.08,.1,0]},Mi.onBeforeCompile=e=>(e.uniforms.grassMap=Mi.userData.grassMap,e.uniforms.sandMap=Mi.userData.sandMap,e.uniforms.rockMap=Mi.userData.rockMap,e.uniforms.rockBumpMap=Mi.userData.rockBumpMap,e.uniforms.gravelMap=Mi.userData.gravelMap,e.uniforms.heatherMap=Mi.userData.heatherMap,e.uniforms.forestMap=Mi.userData.forestMap,e.uniforms.roadBaseMap=Mi.userData.roadBaseMap,e.uniforms.fadeRockMap=Mi.userData.fadeRockMap,e.uniforms.fadeFiner=Mi.userData.fadeFiner,e.uniforms.colouration=Mi.userData.colouration,e.vertexShader=e.vertexShader.replace("#include <displacementmap_pars_vertex>","\n\nattribute float heightOffset;\nattribute float roadProximity;\nattribute float treeMask;\nattribute float curvature;\nattribute float grass;\n\nvarying float height;\nvarying float steepness;\nvarying float roadProx;\nvarying float vTreeMask;\nvarying vec2 vWv;\nvarying vec2 vWWv;\nvarying float vCurvature;\nvarying float vGrass;\nvarying float vLightGrass;\nvarying float vDarkGrass;\nvarying float vHeather;\n\nfloat wuvSize = 800.0;\n\nuniform sampler2D displacementMap;\nuniform sampler2D fadeRockMap;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 upvec = vec3(0.0,1.0,0.0);\n\n"),e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","\n\n  vec4 wPos = modelMatrix * vec4( position, 1.0 );\n\n  height = wPos.y + heightOffset;\n\n  // Unclear if worthwhile...\n  // if(abs(wPos.x) > 14000.0) {\n  //   wPos.x = mod(wPos.x, 14000.0);\n  // }\n  // if(abs(wPos.z) > 14000.0) {\n  //   wPos.z = mod(wPos.z, 14000.0);\n  // }\n\n  // Set UVs from world pos\n  vUv.x = wPos.x / 10.0;\n  vUv.y = wPos.z / 10.0;\n\n\n  // 0 is perfectly flat, 1 is 90 degrees\n  steepness = 1.0 - dot(normal, upvec);\n  steepness = clamp(steepness * 2.0, 0.0, 1.0);\n\n  // Anything up to 0.8 is 1\n  // 0.8 down to 0.6\n  // 0.6 and under is 0\n\n  // steepness = 1.0 - clamp((steepness - 0.6) / 0.2, 0.0, 1.0);\n  // steepness = 1.0 - map(steepness, 0.2, 0.7, 0.0, 1.0);\n\n  // steepness = 1.0 - steepness;//clamp((steepness * 2.0), 0.0, 1.0);\n  // steepness = map(steepness, 0.0, 1.0, 0.3, 0.7);\n\n  vWv.x = wPos.x / wuvSize;\n  vWv.y = wPos.z / wuvSize;\n\n  vWWv.x = vWv.x / 8.0;\n  vWWv.y = vWv.y / 8.0;\n\n  // MAGIC NUMBERS TO BE TWEAKED BASED ON HEIGHT PARAMETERS\n  if(curvature > 0.0) {\n    vCurvature = max(-1.0, curvature * -4.0);\n  } else {\n    vCurvature = min(1.0, curvature * -4.0);\n  }\n\n  //// GET FADES\n\n  float fade0 = texture2D(fadeRockMap, vWv).r;\n  float fade1 = texture2D(fadeRockMap, vWWv).r;\n  float fade2 = (texture2D(fadeRockMap,\n    vec2(\n      vWWv.x = wPos.x / 1200.0,\n      vWWv.y = wPos.z / 1200.0\n    )\n  ).r / 2.0) + 0.5;\n\n  //// HEATHER\n\n  vHeather = smoothstep(0.47, 0.53, min(1.0,height / 170.0) * fade1 * fade2);\n\n  //// GRASSES\n\n  // Focus contrast on middle range for sharper edges\n\n  fade0 = min(max(0.0,(fade0 - 0.25) * 2.0), 1.0);\n  fade1 = min(max(0.0,(fade1 - 0.25) * 2.0), 1.0);\n\n  float heightVal = min(1.0, height/100.0);\n  vLightGrass = min(1.0, max(0.0, fade1 * heightVal * (fade0 + heightVal)));\n  if(roadProximity > 0.0 && roadProximity < 2.0) {\n    vLightGrass *= roadProximity / 4.0 + 0.5;\n    vHeather *= roadProximity / 2.0;\n  }\n  vDarkGrass = 1.0;// 1.1 - (fade1 * 0.1);\n\n\n  //// ROAD PROX\n\n  roadProx = roadProximity;\n\n  //// TREE MASK\n\n  vTreeMask = treeMask;\n\n  //// GRASS  FIDDLING\n\n  // if(vCurvature > 0.0) {\n  //   vGrass = grass * vCurvature;\n  // } else {\n  //   vGrass = 0.0;\n  // }\n  // vGrass = grass * min(1.0, height / 100.0);\n\n  vGrass = grass;\n\n  vWWv.x = wPos.x / 400.0;\n  vWWv.y = wPos.z / 400.0;\n\n  transformed += vec3(0.0, heightOffset, 0.0);\n\n  // Experimenting with displacement map\n  transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * steepness * 1.25 );\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","\n\n  varying float height;\n  varying float steepness;\n  varying float roadProx;\n  varying float vTreeMask;\n  varying float vCurvature;\n  varying float vGrass;\n  varying vec2 vWv;\n  varying vec2 vWWv;\n  varying float vLightGrass;\n  varying float vDarkGrass;\n  varying float vHeather;\n\n  uniform sampler2D grassMap;\n  uniform sampler2D sandMap;\n  uniform sampler2D rockMap;\n  uniform sampler2D rockMapBump;\n  uniform sampler2D gravelMap;\n  uniform sampler2D forestMap;\n  uniform sampler2D heatherMap;\n  uniform sampler2D fadeRockMap;\n  uniform sampler2D fadeFiner;\n\n  uniform vec4 colouration;\n\n  vec4 rockTex;\n\n  vec4 terrainBlend(vec4 tx1, float w1, vec4 tx2, float w2, float depth) {\n    // Perform the blending\n    float ma = max(tx1.a + w1, tx2.a + w2) - depth;\n    float b1 = max(tx1.a + w1 - ma, 0.0);\n    float b2 = max(tx2.a + w2 - ma, 0.0);\n\n    return ((tx1 * b1) + (tx2 * b2)) / (b1 + b2);\n  }\n\n  vec4 roadCol = vec4(0.45, 0.45, 0.474, 1.0);\n\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","\n\n  float fade = texture2D(fadeRockMap, vUv).r;\n  float fade1 = texture2D(fadeRockMap, vWv).r;\n  float fade2 = (texture2D(fadeRockMap, vWWv).r / 2.0) + 0.5;\n\n  float heightVal = min(1.0, (height/ 150.0));\n\n  vec4 darkGrass = texture2D(heatherMap, vUv);\n  darkGrass.a = darkGrass.g;\n\n  //// GRASS 1\n\n  vec4 texelColor = texture2D( grassMap, vUv );\n\n  //// LIGHT GRASS\n\n  texelColor += colouration * vLightGrass;\n\n  //// HEATHER\n\n  texelColor = mix(texelColor, darkGrass, vHeather * smoothstep(0.3, 0.7, fade1));\n\n  //// TREE MASK\n\n  texelColor = mix(texelColor, texture2D(forestMap, vUv), vTreeMask);\n  // texelColor.a = 1.0;\n  // vec4 forestCol = texture2D(forestMap, vUv);\n  // forestCol.a = 1.0 + fade * 0.1;//forestCol.r;// - fade * 0.5;\n  // texelColor = terrainBlend(\n  //   texelColor,\n  //   1.0-vTreeMask,\n  //   forestCol,\n  //   vTreeMask + fade * 0.25,\n  //   0.25\n  // );\n  // texelColor.a = 1.0;\n\n  //// DARK GRASS\n\n  texelColor *= vDarkGrass;\n\n  //// SAND BLEND\n\n  if(height < 4.0) {\n    float dark = 1.0 - vTreeMask * 0.3;\n    if(height < 0.0) {\n      texelColor = texture2D(sandMap, vUv) * 0.8333;\n    } else {\n      if(height < 2.0) {\n        dark = min(dark, 1.0 - (2.0 - height) / 12.0);\n      }\n      texelColor = mix(texture2D(sandMap, vUv) * dark, texelColor, height / 4.0);\n    }\n  }\n\n  //// ROADSIDE GRAVEL\n\n  if(roadProx < -0.2) {\n    texelColor = roadCol; // TODO pass in different colour as tex?\n  } else if(roadProx != 0.0 && roadProx < 0.7) {\n\n    float rp = roadProx / 0.7;\n\n    texelColor = mix(\n      texture2D(gravelMap, vUv),\n      texelColor,\n      smoothstep(\n        rp + 0.15,\n        rp - 0.15,\n        fade\n      )\n    );\n    // // Texture blend mode, not worth it\n    // vec4 gravelTex = texture2D(gravelMap, vUv);\n    // // float rp = roadProx / 1.25;\n    // gravelTex.a = gravelTex.r * gravelTex.r;\n    // texelColor.a = fade;\n    //\n    // texelColor = terrainBlend(\n      //   texelColor,\n      //   rp,\n      //   gravelTex,\n      //   1.0-rp,\n      //   0.1\n      // );\n\n\n\n\n  }\n\n  //// STEEPNESS CLIFF\n\n\n  if(roadProx == 0.0) {\n    rockTex = texture2D(rockMap, vWv) * (1.0 - vTreeMask * 0.5);\n    rockTex.a = 1.0 - texture2D(rockMapBump, vWv).r;\n  } else {\n    rockTex = texture2D(rockMap, vUv) * (1.0 - vTreeMask * 0.5);\n    rockTex.a = texture2D(rockMapBump, vUv).r;\n  }\n\n  texelColor.a = 0.2 + fade1 * 0.2;\n  texelColor = terrainBlend(texelColor,0.7, rockTex, steepness, 0.06);\n  texelColor.a = 1.0;\n\n  //// FINAL COMPOSITION\n\n  diffuseColor *= texelColor;\n\n"),e);let Zi=null,Fi=!1,Hi=50;const Qi=e=>{var t;null===(t=Zi)||void 0===t||t.dispose();let i={};e>0&&(i.WATER_WAVES="",e>1&&(i.WATER_DEPTH="")),Zi=new h.C({wireframe:!1}),Zi.defines=i,Zi.userData.camPos={value:new h.W},Zi.userData.skyCol={value:[1,1,1,1]},Zi.userData.waves={value:X(Ii,4)},Zi.userData.sunCol={value:[1,1,1,1]},Zi.userData.time={value:0},Zi.onBeforeCompile=e=>(e.uniforms.camPos=Zi.userData.camPos,e.uniforms.skyCol=Zi.userData.skyCol,e.uniforms.waves=Zi.userData.waves,e.uniforms.sunCol=Zi.userData.sunCol,e.uniforms.time=Zi.userData.time,e.vertexShader=e.vertexShader.replace("#include <color_pars_vertex>","#include <color_pars_vertex>\n\n\n  #ifdef WATER_DEPTH\n\n    attribute float depth;\n\n  #endif\n\n  #ifdef WATER_WAVES\n\n    uniform float time;\n\n    varying vec2 vUw;\n    varying vec2 vUUw;\n    varying vec2 vUUUw;\n\n  #endif\n\n  varying vec4 wPos;\n\n  #ifdef WATER_DEPTH\n\n    varying float vDepth;\n\n  #endif\n\n"),e.vertexShader=e.vertexShader.replace("#include <color_vertex>","#include <color_vertex>\n\n\n  wPos = modelMatrix * vec4( position, 1.0 );\n\n  #ifdef WATER_WAVES\n\n    // 50 and 200 for normal map\n\n\n    vUw.x = (time + wPos.x) / 200.0;\n    vUw.y = (time + wPos.z) / 200.0;\n\n    vUUw.x = (wPos.x - time) / 800.0;\n    vUUw.y = (wPos.z - time) / 800.0;\n\n    vUUUw.x = (wPos.x - time) / 300.0;\n    vUUUw.y = (wPos.z - time) / 300.0;\n  #endif\n\n  #ifdef WATER_DEPTH\n    vDepth = depth;\n  #endif\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","#include <map_pars_fragment>\n\n\n\nuniform vec3 camPos;\nuniform vec4 skyCol;\nuniform vec4 sunCol;\n\n#ifdef WATER_WAVES\n  uniform sampler2D waves;\n\n  varying vec2 vUw;\n  varying vec2 vUUw;\n  varying vec2 vUUUw;\n\n#endif\n\nvarying vec4 wPos;\n\n#ifdef WATER_DEPTH\n  varying float vDepth;\n#endif\n\nvec3 upvec = vec3(0.0,1.0,0.0);\n\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","#include <map_fragment>\n\n\n  #ifdef WATER_DEPTH\n    // Abandon water rendering if it's well under ground\n    if(vDepth > 10.0) {\n      discard;\n    }\n  #endif\n  \n  vec3 camNorm = normalize(vec3(\n    camPos.x - wPos.x,\n    camPos.y - wPos.y,\n    camPos.z - wPos.z\n  ));\n\n  float seaDot = dot(camNorm, upvec);\n\n  #if defined(WATER_WAVES) || defined(WATER_DEPTH)\n\n\n    // Add lightness\n    float wave1 = texture2D(waves, vUw).r + 0.1;\n    float wave2 = texture2D(waves, vUUw).r + 0.1;\n\n    // Add darkness?\n    float wave4 = (texture2D(waves, vUUUw).r + 0.1);\n    float wave5 = (texture2D(waves, vUUw - vUw).r + 0.1);\n\n    //// WAVE RIPPLES\n\n    float darkReflect = 0.0;\n\n    #ifdef WATER_DEPTH\n\n      if(vDepth > -2.0) {\n        if(vDepth > -1.0) {\n          darkReflect = 1.0;\n        } else {\n          darkReflect = (2.0 + vDepth);\n        }\n      }\n\n    #endif\n\n    // Extra dark ripples by sea edge\n    seaDot += wave4 * wave5 * (0.5 + darkReflect / 4.0);\n    // No ripples by sea edge\n    seaDot -= wave1 * wave2 * (1.0 - darkReflect);\n\n    //// EDGE HIGHLIGHT\n\n    #ifdef WATER_DEPTH\n\n      if(vDepth < 0.0) {\n        if(vDepth > -2.0) {\n          seaDot -= (2.0 + vDepth) * 0.05 * (1.0 - wave2);\n        }\n      } else {\n        seaDot -= 0.1 * (1.0 - wave2);\n      }\n    #endif\n\n    //// CLAMP SEADOT\n\n    seaDot = min(max(0.0, seaDot), 1.0);\n\n    //// BLEND SKY WITH DARK BY SEADOT\n\n    float seaDotMix = 1.0 - seaDot;\n    diffuseColor = mix(diffuseColor, skyCol, seaDotMix * seaDotMix);\n\n    //// DARKEN DEPTHS\n\n    #ifdef WATER_DEPTH\n\n      if(vDepth < 0.0) {\n        diffuseColor *= 1.0 - min(1.0, vDepth / -15.0) * 0.2;\n      }\n\n    #endif\n\n    //// HIGHLIGHTS ON SHALLOW ANGLES\n\n    float sunDotMix = 0.0;\n    if(seaDot < 0.125) {\n      sunDotMix = 1.0 - seaDot * 8.0;\n    }\n    diffuseColor = mix(diffuseColor, sunCol, sunDotMix * sunDotMix);\n\n  #else\n    float seaDotMix = 1.0 - seaDot;\n    diffuseColor = mix(diffuseColor, skyCol, seaDotMix * seaDotMix);\n  #endif\n\n  //// FINALISE\n\n  diffuseColor.a = 1.0;\n\n"),e)};Ni(K,_);var Yi=Di;const Vi=[0,180,480,900];var Ui=new class extends l{constructor(...e){super(...e),this.default=0,this.value=0,this.cycleLength=Vi[0]}set(e){this.cycleLength=Vi[e],super.set(e)}};const Xi="1.0.2";let Ji=localStorage.getItem("seen-version");const qi=null!==Ji&&Ji!==Xi,Ki=["Hosting switched to save costs - high-res textures reinstated","Vehicle physics tweaked to reduce slip and improve stability",'Temporary feature: use "?autodrive=true" in the URL will have autodrive initialise enabled','Temporary feature: use "?cruisecontrol=[speed]" in the URL to initialise in cruise control (km per hour)',"Hard roads made slightly wider","Improvements to the autodrive's reset intelligence","Driving backwards discouraged more clearly","Multiple small UX bugs fixed"],_i={targetDate:"mid/late-November",changes:["Controller/wheel support","In-vehicle first-person view","Revamped control panel UI for extra physics/audio/game/control settings","Further bug fixes, including audio issues and environment generation bugs"]};window.localStorage.setItem("seen-version",Xi);const $i=e=>{let t={major:0,minor:0,patch:0,release:10,releaseVersion:10},i=e,s=null;if(e.indexOf("-")>0&&(i=(e=e.split("-"))[0],s=e[1]),i=i.split("."),t.major=parseInt(i[0]),t.minor=parseInt(i[1]),t.patch=parseInt(i[2]),s){s=s.split(".");let e=s[0];t.release="alpha"==e?0:"beta"==e?1:2,t.releaseVersion=parseInt(s[1])}return t};var es=Xi;var ts={version:es,seed:Ve,"draw-calls":0,"heightmap-cache":0,"roadside-objects":0,farcells:0,"farcells-staged":0,"nearcell-staged":0},is=i(10);class ss extends h.G{constructor(...e){super(...e),this.geoSource=null,this.materials={},this.objectType="root",this.worldPosition=new h.W,this.variant=0,this.variantMaterials=[]}initialiseGeometry(e){this.geoSource&&ss.loader.load(this.geoSource,(t=>{t.traverse((e=>{e.isMesh&&(e.userData.matName=e.name.split("_")[1],e.userData.matName in this.materials?e.material=this.materials[e.userData.matName]:e.material=this.materials.default)})),this.add(t),e(this)}))}destroy(){this.traverse((e=>{e.isMesh&&e.geometry.dispose()}))}updatePosition(){this.position.subVectors(this.worldPosition,this.parent.position)}updateRetireIndex(e){this.retireIndex=e+5}setVariant(e){e<0||e>=this.variantMaterials.length?console.warn("No variant index "+e+" found for object type "+this.objectType):(this.variantIndex=e,this.traverse((e=>{e.isMesh&&e.userData.matName in this.variantMaterials[this.variantIndex]&&(e.material=this.variantMaterials[this.variantIndex][e.userData.matName])})))}}ss.loader=new is.a;var ns=ss,as=i.p+"static/media/sign.c5b548a5.obj",rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE2OjI4OjE1WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxNjoyODoxNVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE2OjI4OjE1WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmMThkYjE2OS1mMjY5LTI3NGYtYWMwNC1mYzhmZGIwMmY5M2QiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0MGQyNWZiNi04NDU4LTFjNGUtYjJjNS0wMTExOGEzYzRjMGQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplZjM0ZDlmZi04MWQ5LTdlNGItOGYxMS0zZTFiY2UzMDJjNzUiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplZjM0ZDlmZi04MWQ5LTdlNGItOGYxMS0zZTFiY2UzMDJjNzUiIHN0RXZ0OndoZW49IjIwMjItMDItMDFUMTY6Mjg6MTVaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmYxOGRiMTY5LWYyNjktMjc0Zi1hYzA0LWZjOGZkYjAyZjkzZCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQxNjoyODoxNVoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4VqR/6AAAADElEQVQIHWOo598OAAJWAUbmdvdzAAAAAElFTkSuQmCC";const hs=0,os=1,ls=2,ds=3,cs=5,ps=6,us=8,gs=9,ms=10,xs=11,vs=[{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU5OjA5WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1OTowOVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU5OjA5WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3YzM5YjcwZC00NGU0LTUzNDYtOTEwOS0xMjU3MjhiZjg3OGUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmNDc1ZTE1MS02MmZhLTE4NDItOWM0Mi0yMjdkNzRjOTk4NzQi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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU4OjI0WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1ODoyNFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU4OjI0WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlkMTg2MC02NjVlLTZiNGItODIxMS00YTJmODZjMDY5NTkiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDplOWM1MThkMy1jOWM1LTBkNDAtODZjYS1mNTI3M2QwYjQzODgi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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjEwWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1NDoxMFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjEwWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphNTNlOTZlZC0wNzg5LTc2NDQtYmU3Yi05YjZkYTVjZTk5ZTAiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxNzlkMmIyNi01ZTcwLWJiNGEtODAyMS1jMjE1Y2ZmMmY3ZDgi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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjM4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1NDozOFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjM4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyOTg4MjdkYy01Y2Y1LWIyNGItOGE2ZS03Njk4OTJiYThkZmUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozNTQwZGNiOS04NTBhLWFkNGEtODQyYS0xNzIxMjA4NzA0N2Ii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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGNmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjMzWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDoyNzozM1oiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjMzWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxZWNhNDY1ZC1jOTQyLTBjNDMtOWJkZS1iMzg2YTNkNWU1OGUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2ZDAyZjIxMi00NDRkLTEzNGUtYmU4Yy0xOWI1ZTg4ODFkOGEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NTZjZGY2YS01OTc2LTU3NDQtYjJhMS1jYmIyOTgwNjc1NzUiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo0NTZjZGY2YS01OTc2LTU3NDQtYjJhMS1jYmIyOTgwNjc1NzUiIHN0RXZ0OndoZW49IjIwMjItMDItMDFUMjA6Mjc6MzNaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFlY2E0NjVkLWM5NDItMGM0My05YmRlLWIzODZhM2Q1ZTU4ZSIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzozM1oiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSIhIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIhIi8+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6VGV4dExheWVycz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5dhtDoAAAT3klEQVR42u1dB1hU17aOJkaTm+Sq8ba85OZ9uffl3rwkNsoMZehSpDcBQVREY8MWY8t9scUYTYwxRk1ixR5jbyDNmWEGGDoiIlYsMAxNkTblzKx39qENRoR9mIEZ2Pv7fs8ZmjPn//c6a+291jovAMALBP0X5CIQAZCLQARAQARAQARAQATQN5FsxesI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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHzGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1NDoyMloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjU0OjIyWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiNTZiYjAwNS02YmRjLWY5NDMtYjY4MS02OTQ4MWE2MDY0OTgiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiMWUxMGI5Mi03YTkzLTMwNDAtOGFjMC1hNTE1ODRkZTZlZWIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiNTZiYjAwNS02YmRjLWY5NDMtYjY4MS02OTQ4MWE2MDY0OTgiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTQ6MjJaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMTUlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIxNSUiLz4gPC9yZGY6QmFnPiA8L3Bob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6NmQwMmYyMTItNDQ0ZC0xMzRlLWJlOGMtMTliNWU4ODgxZDhhPC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+vJqQfAAAFd5JREFUeNrtXQlYU9e2rrZ2um2v2t6pr719X+99vbevozIkDGGWeR4EFFERrUNxqlXb3ler1trawVqrtnXEOtWqdaook0lIgDAjIlInqkKYFZkyr3f2weAhJoR9kgCBvb/v95xAwHD+f6+z1tprr/MAADxAMHxBLgIRALkIRAAERAAERAAERAAERABDEFlOPEMYcRcG30MEMPTIR4Q/WfHxJ16VS99bfnHZB4vKV6zkoq9RGNmbGCyFIS+AgbioBjCq+J13F6W7e9046+CkEjg6A0Iq11Ge7h9YXLbkXV/qPQ8TAQw9AaCZ/YwgNFTMd3DSUOegD+n2XLlk3twvqPNHiQCGlgCeE/j6lQudnMEQ+d0isOOoS95e8Al1/hARwNAQwBhJWESKMeKZODPeTnVxxcpgYw4iEcDgF8CI/InRidR9XoMjAISTzq7VFe9/8DQRgHUL4AWhu0cdLvkIfK4j5M2YuaM/rAARgGXwaH507CahozOwEQB9K7DjdlzZsHE8EYB1CuANPs+1nS35CEg8aUGhYks7hEQA5seTkrDwM6aQz4gKVBVr1sQTAViRACTBoT6U46c0hwAQ0jy9K4vjpz1OBGAdAnhG5O33m7nIR8jkOMD5RYtXWsohJAIwHx6kHL+FQhZhnzGkODg2VX7y8V+IAAa3AF4UuHs2mJt8BIGDE4ii445ZwgoQAZgr7IuK/t6UsM+oQzjOXnV1wzduRACDUwA2fGdep6XIp0GJK8XPr8jcYSERgOl4KickNBOX0JwJPiByccOzAvYc1cUPV8wjAhhEAsj1D/QROPFUuAK48eNeqPjP/2Fbgl+5zii9/BgRwOAQwJ+F3r6XcUnMi44F5a3b0FJeDmLKEuD87Fmuozp71qwfzOUQkpIw9sIalR85cRl22OfsAo18AaiUalCrlHB95y78dQIb+7abO5P/TWoCB1YALwlc3ZtxyStPSgJVeztoqF+iof5RtLRAYdwUvHUCKizMmBhzElkBIoCBIf/xvKiYn3DJF7l7wp3z5QBqNTBHS1kZiN088JJDtnaKyvVfxhABDIwA7ATOPBmuAK5+/iWolUrQHRqVCio//Ah7tTDF3e0SCguJAPqX/CfFQSFi7LAvIBhkdfWgRnZfz2i7dAlEmFYgw56jLlqydDURQP+RPyI/LCKcmn1qXAFIjx4HpUIFhoaGsgyXPv0Mf53A3rHp8vqvxxIB9I8A/pbl5X0Nl6SiKVPpsE9jYPZrR8fv1yHHLwCvfIzjAJnTE34kArA8+Q8XTp78KXbY5+IGzRIJ5fj1Tj5tBTRquLl/P7YVOPHmeHnVzmQ3IgDLCuBlgYtbCy45F997H5QyGfRlIImgsLBo8hR8h9Dbp9DawkJrIv8JSUTUQVzyxZ4TaOdOrRP2GTED0CjMgiyeK9b/ddrGVlW+Zu1bRAAWQI6PrxPfiSfHFUDV9z+ABof8u1ZA1dEO5UuW4DuEzq7IP3mYCMC8s/+p7MCgHFwyJCFhIG9oADYDieBO2XkQu3vilY/Zc9XZCxZ8QQRgxrCvJC5+Jpt8f93pM125XpZDpVLB5a/WY1uB4+Ns2qoP/PQiEYB5BPBslodXNS4JpYmzQHnnDpgyUMgok0pBEhiMvasoNSoyhQjAdPIfyZ80eb3QiYcd9t3Kyzca8/dlqKnQsebIEdqiYO0tHGcjv7plSzARgGkCeEXIc23Dnf2/rVwFCrncYMoX1xeQt7ZC8YyZ+LuK3D3KUKUyEQDL1T5JROQvuORn+/hB+7VroDKd+3tWgBJSc04OdvlYmo2tuujDD94jAmABSXCIOxX2KXAFcPPAgfuWek23AhpQdnZAxQf45WPHxts21xw8+CciALzZP0bkH1CKne+fFAeKpmawxFBp1NBacRGyPSfglY/ZO0D69MTdRAB9J39kYezkedhNHXiu0JCRSU1+FVhqaBRquLp5C7YVODretrVq3z5HIoC+CeCFLHdP7KYO599OAhXlrGnAcgP5AiixlBcWgV0+lubnn0sE0JewL2bSJiF2mZcHtJSUgFJjSfq7IgKUVq799RR2WJjB4SrPr/o4iQigdwG8xqapw+XPv6CLOSxLP8MfoCxN6dx52LeCVEfnhqoNG54aLGX2g0oA1Af6Q25YeAruRc31C4COGzegv8et/HwQubpj5wYkMxK3EgHoC/uCQjwFTjzspg41Px+kZ39/D7VMBpUfrcS3AhwHWdXGzS8Plo02g2X2j8329r2EX+YVD7LmZrNk/NiM9stXIBtzVxG91TwkQmhK4ciQEgBKlRZMnrJEyCLsaxQKQa5Sw0ANVGRybes2/I4j9g7qi+vWTSIC6PpjXuS7eWA3dbiwdCkoOzvNsuBjyuisq4e80HD8rWUu7r+jnMewFgDd1GFi7E7s3T0eXnDnwoV+Nf3nzp0zUDPALixETavz3136/nAXwJt8Z5cOXAFc+2YjKPrJ8cvOzgY/f39YuGihwdyAsr0de7Xwblh4u/Hnwy8MSwGgIs/ckFAhqzKv2jpQ9dPsR8T/ccxogwKgRUC5Iaj+QOTiih0WZsXG/TLsBIA84ILomCCBo7MKt8yr9lQKqNT95/hpBXDo8OHes4RyGVx4/wP8HoT2Dopr33/HG1AB9HenC9TUIcvbB7upQ0niTHp3j1qtscg9/urVq6wFoNaooLWqCnu1kG474+NbghMWWrUA0E7awklxK3DDPlSM0ZyTa/akT2pqKowbP44mGeHrDV+zEgAaSrUKqn7Yii2AsxwHdcnaT2YMFwGgpg5NuBepcsUqUJs57EMzXks8E0gUbARAi+D2bciPiMIWwSker6aztGD0kBYAKvPKj4rZh13m5e0DbZcum93xQ6RqSW9ra+smG3n96DUbAaBqpPq0dOywEDWizJ0z99t+F0B/tjtDvfwEzi7YTR1+376dMq9K1rO/rq6ONu26JKKZrhUAeg/TImitALYAUBFpRweUzp6LbQVOcxzabx7Y9/KQFAAK+7KDQrJxL0p+5ESQNzaCGtSsideSiu712pmNBjrX3v9XrlxJfw3NfibhvQlAn9OoLRxpKS7BXi3McqT8gbDwdGMOodUJgG7qEB4ZIcBt6kCZ0frUNGyvHxG7c+fO++7tiGzdjB7zNqAl35gFQOda4aCf0ScE1HLmIovVwgx7jvK3jZsjhpoA/ixk0dTh3LwkULa09LnQAxHPJIdJPPo6c/YzR3x8fI/3MyMBXQEwBcMUjr5K4jvXrkGOjx/+rcBjwsXerEC/CaC+vn6kqQJAYV9RbNxa3CbOqFfP7aIiUCn7XuSpS6SWOEPE6/oD6L26s1lXAMxbBtOH0HeLUFIh643k3SxWC7lw/sNVS4aEBUBhn5BFU4dLa9aCSibDcvyYhGgdO3NnArUi01oJrY+BhKFvb6Gi+RYUxMTidxzhODY3paWPtWoBoH66uRFR2L38UI+ejuvXDTZ10Jp6fYN5H2e+B4kDzVpEKCKtr+Lo7RaArAXyKZiv71stpPyX+oxMFmGhM4inz9ht1QKQBAQ5CFjt7vmJdqIMxe5aM6xviZZpBbRev5ZEXb+AmfDpqwCYkQMSm1ZwuhEGc8jaO+Fc0nz81UJbe9n1vXvtrVIA1Os/igMCC3D/6MK4eMpsNuv1/NHSLJNEQyt0TCvAPNcnAkOhXG+ZQN3PoZs9pAtFGD2J0F3sdkkJdg9C9HyC1MAwka5DOOgFgCpdiibFJbAp82rIPKt39jNnHhP6rADTLDOFgEhC5DGdxd6WedEw5OSh/wPdSlC4ybydXLhwAaYnJICtnR3IGCJQyeTw21r8HoQZtlxN5foN0dYmgOf57p5S7CbOi98BRWubXscPXWTmzDVGoK7ZZ5KEzpm/w1C1T28C0B3l5eUQP3UqjHl6bPfPfLZuXU+rUCPF7kFIh4WeXhV3BPzHLCIA3FDPmAC6dvfEfp6F2dRBjMq8zpXRLdwNDTTjEHG6BOq7lzOtAJrxva0D9GYFjAmgrKwM4uKnwOixY+6zOn999m9wg7FnAWUIq38+xGa1EIrfWbp20FiAhvqG+0QjbWwadffDvSxiUeR59ZuNoJIreq3zQ8RrZ6tuBs+QYAw5euiWwiTLkANnyMMvLS2FSXGT9RLPxBSG+OiwsLWV9nOwVwttOa31Kaeft6gAqAs8ko0A6hoaR9Y1N46kmzqEhiezKfOSUeYRt8hTX+qWTYzf221AN2QsLi6GmEmxRolnIiMzg1FEqoJGgRC7ByFKpPEnTzoy6HyAurpGphi4WS5u7bj5/toTJ1k1dWCGfIasAHPG685ypoCMRQOFRYUQHRONRbwWdvZ2oFAo7uYF1HTLmbJFi1mEhbbKq8m77AeNAOrqe1iM0dn+AQLsbl5vzQHF7dusM3V9sQLa3AHyBVAUgGY7c/b3Jp78gnyImhiFTbou1n+9nuELALRWVGD3IKRvBYGBOeZ8eCWrH6qR1jxSXV39CONrI/PCIxOo2Yy1tw8tl6IyL1N6+RmzAroOoz4gUegOSV4eRERGmEy8Fs8+919QU1PT/fsVahXt92DXD9pyNL99/mW82QWAEw1IpdJROl97XuTlfRW7zGvlKlB1dJicrzdmBZB515cQQsLQJT8nNxfCwsPNRjwTiTMTe+wnaGusB0lQML4V4DrXoEk3WPIAj0jCIz/FDftyfP3oJs7mKuw0Zs616wdoPQBBd5UQCSE4NMQixDMhFAp77C2UHj2Gv6uI66gRJy3+crAI4N9Zbh7YRZ7XdyVjN3HuqxXAKd8SiUQQGBxkceK14Do60MvE3VEBZQGLpyfgN6W2seuoO3bs1YEWwOO5IWHYRZ6FsZNZN3HuixXobWFGO9BM9A8M6Dfimdi8eXOP5FATix6EdCPKqKiUgRTACElQiBcVz3bi5vtRmRdYYHcP07M3ZAX4fD74+vsNCPFaPPf356GWkVtQyxVQ/t77+GGhHUd+c+tWv4ESwOhsX/983A9dNn+hyU2ce9vdo0396iZ2UDLGx9dnQIlnYvbcOT0cwtYrV1jtKkpx97xgSljIlvyHcv0DZ1DOC9bePvTQRrSJEiy4sVPXq09LT4cJ3hMGDfFaoIRSDmX672UINVC1+Tv81UI7e825NWuS+lUApfPmvSn08Kpl081L1dnZL5s6z1A+gaeX16AjnglnFx6dGtbWDLQ3NEFeRCS2CE5yuHWNKace6a88wKO5MbF7cHv55QYGQfu1KouSjhZbUk6fBncPj0FNPBPbtm+/VzmkVEAd9fnZ7CoSz5m3qb8swOt8HmZTB+oPqj5wwGCZlzmIP3XqFLi6u1kN8Vr8/b9fgAZGRKRqa6d3QWMnh2zsOxp+OfKGpQXweG5w6FHsbl7x00De1GQR4k+ePAk8VxerI56JpPnze/xdtyR5rHoQpoXSu4osJwAqVkVhnxw334/KvMwZ9iHijx8/Dk48Z6smXgtURVRQWHDv71MooIJFs4nTNnaqK5u3hZkkgNra2lEG3vyM2MevBLubF3poY2urWYhHqdOjx46Cg5PjkCCeCTcP9x5l8O2//07visbuOOLqXYkTFvaV/IfywiPnU/dyrL19qIliC4rHTQz70IU5fOQwnUYdasQzkbw7ucd+gqpt29n0INQUfLRiqblvAf8QeXjdxC7z+nYTqOVyk4j/+dAh4HA5Q5p4LV785z+g6a6vRD+xrLkR8qOi8ZNDHKdGxfmKMeYSwMOSiTH7cT8Eimc7q6tZEY9i458OHqQraYYD8UwsfmfxvT4DSjlIT5/BDwu5jpAz++3vzCKAXL+AcdiPbOW50sucuKt9aJVsPxUuopr64Ua8FmOfebo7jY12GLe3t0HpnHlswsLO6iOHbE0VwBPioBAR9rZu6gMrbt3CIn7fvn0w3tZm2BLPhNcEr+69Eehwq7AIRG74YSE/iO7DyFoAI4rip04VYjZ1ELt5QFOWqE9hHyJ+z5498KaRkq3hCDQhum8F8k6oXP0xi2YTXEXlpi0RbAXwrNAL3/G7uOIjUBlZi0cVsrt/3A2vv/kGIdsAXvrXS3D7brEsuhWgh2LksthVlOLuUdFbWGhwta9oSvxnQie8pg4o7EPVrobCPjkVEexK3gWvvfE6IbkPWLZ8GWOdQAXX9+xlsauIqzm/evUCXAH8k89zbcVu4rx5C6jv1r/rEr99xw549fXXCLEYePpPz9CbTbU1A6iOoiB2Mn6zCa5DQ8OZtCf6KoBHsyMnHmIT9nXUSHts7ES7Y7du2wb/++orhFCW8Avwv3dNNWybTTiBZNbs7/skgLzQMCehs6sMd7VPevw4tKDn9jEE8OVXX8GChQsJTMSVK1fuWVMqLCxLWoC/TmBn3yndv/df9wmgrrFx5I1a6WN3v/CUOCBIzGZ3j6ypueu5egP8BI+hPpRqDTQXFWPvKkJh4dmwsLO6DuEDUml3/n9kSeLMZbiPbEVhX03mWVCrVDT5KLQbqiJg81d1x/Nm+j/lKioikMnh0rov8BeKbO3Ulzd962XoFvAXgYdXNXbS5+35UJ2aDg15eXCn7Dw0FRbRiYvm0jK60RMKXzqqquBOeTncLi6hvlfYhaKirmNBITRTP9sskVDoOqIy6ebcXGjKzqHOqaM4G5pE4nsQi+kHRqEjeo1226LXjcIsaBAIqNcC+msNmZn084TpYyYfGtIz6D6+DWnUEZ2np0N9airUnUmjcIZCKg1UtYyAzmtPnaardOpOn6HP0fMK6lKo48lT9KbW2l9/pSFF5ydOUEcKx05A7XF0PAa1x47TWVHpL0ep41H6WHPkF5BSqDnS9Zo+P3QYag4foY+oeObm3v1d2Lcfbvy4l8IeCj/C9d0UknfDlW83QbaXN74I/PyKmbuK7iV95r69BrulixG/QMRz7ap3R1uhMR0XAssgk+ugvLzu0/h7PkDTLaSGBzP98B/XTmB9oH2B4ODuHcYP1NbXj6rau/s5kSe++SewTpzhOLRe27L5f7pvAZI1qxMFxEQPn9sAxxGKV3yU2C2AwkWL3xKQCzNswEcPp1iwcDVyBmkBFM+aHZaFuTmRwHpxlrIAeYsW/Qf5AbQASubMeZXPc20nF2d4IIPrICtf/p4vMwx8NDsY/yGOBNYZBaR5TkCVw6N1E0HjBSxWAAmsCBT5v9rYycuWL49Gob+uAB4smjo1/qyzc3sW5sMdCKxj5qe8MU5ZsnTpMlToa2g18KGiadNfF0ZFpp2wse1Ms7EDPscBhFxHEFKeYw9wu45oqRFVoRLcBXW9aDDPTYGe38PXA33fO2vHQfl/OGFr13IiMEh85euNLtqZb6wgZESNIP2V86tWLc+YlrCTPzUhOWvajGTh9EQK03chZE1P2CVMmKHFTgRBF3YIZyTqwYwdWfT3DH3fKLaz/DlLYsA+Ez8xcRvztThx1jZhQuKOzGkJuwTUMWf2nC2SpAXfXPrss/nSlJTXDJWFDejj4wkGHuQiEAGQi0AEQEAEQEAEQEAEQEAEQEAEQDB88P9iFadh23q9iwAAAABJRU5ErkJggg==",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHzGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1Mzo1NloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjUzOjU2WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4YTExMzQzMS00MWJlLTNiNGEtODk1Yy0xODBkOTYzNzdkNmYiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjN2VmYjY3MS0xZGRjLWJkNGYtYWE5NS0xNTU5ZGU0ODczZWMiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo4YTExMzQzMS00MWJlLTNiNGEtODk1Yy0xODBkOTYzNzdkNmYiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTM6NTZaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMjAlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIyMCUi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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGNmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmZGZlMmEwZC0yYzQ5LTNjNDQtYTNmMS00YmJmZDNhYmJjZjIiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1NzMxZDNmYy1mOWY2LTZjNDMtYmYwNy02ZjVjNWE2MjkzNGUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHN0RXZ0OndoZW49IjIwMjItMDItMDFUMjA6Mjc6MTJaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmZkZmUyYTBkLTJjNDktM2M0NC1hM2YxLTRiYmZkM2FiYmNmMiIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSIhIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIhIi8+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6VGV4dExheWVycz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz64/6jGAAAT1klEQVR42u2dB1hU17bHo4nR5Ca5arwtL7l5X+59uTcviY0yQxm6FOlNQBEV0diwxdhyX2wxRhNjjFGTWLHH2BtKc2aYAYaOiIgVCwxDk86UM7Pe2QchMyrCPszADOz9fX/PAKIzZ/3OPmutvfY6LwDAC0R9V+QkEADISSAAEBEAiAgARASA3qlkG157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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHLmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1Mjo1NloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjUyOjU2WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1YjQ3ZTcyNS03MjJjLWY1NGQtOTNkNC05MWI2MDE3MzY2OTAiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo3YTRjZWRiMC0xYjkzLWMwNDMtODJkMC0yMTQ1ZmM5MDllMjciIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YjQ3ZTcyNS03MjJjLWY1NGQtOTNkNC05MWI2MDE3MzY2OTAiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTI6NTZaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMTUlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIxNSUi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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHLmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1MzoxN1oiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjUzOjE3WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiNTk0OGVkNi1mZTViLWE0NGEtYjZlMy04ZDM5ZGJjOTdjMzUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiZDJlYzBkOS00Yjg0LTI4NDAtYWZjOC0wOWM3OTVkMTkyMGQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiNTk0OGVkNi1mZTViLWE0NGEtYjZlMy04ZDM5ZGJjOTdjMzUiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTM6MTdaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMjAlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIyMCUi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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjE1WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDozNToxNVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjE1WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1YjcyNGQ1Yy0xMTE2LTZhNDktYjBlNy01YWNjZDlkZDA2M2MiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmN2ViYTA2Ni1lYmRmLWJiNDgtYWVkYi0zODkzZDdmMDM0MTMi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",.75,0,rs)},{sign:V("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjQxWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDozNTo0MVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjQxWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0ODBhMzZmZS05MDViLTU0NDAtYmE4ZS1jNjNlNDc4ZWRlY2IiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1Nzg2ZDY0Yi0xOTczLTYwNDQtYjdjOS04YmEyZTM0MWQ3MGMi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",.75,0,rs)}],ws=new h.D({color:16777215});var fs=class extends ns{constructor(...e){super(...e),this.geoSource=as,this.objectType="WarningSign",this.variantMaterials=vs,this.materials={pole:ws,sign:this.variantMaterials[0].sign}}},bs=i.p+"static/media/vergemarker.f5ec7eac.obj";const As={white:new h.D({color:16777215,emissive:16777215,emissiveIntensity:.2}),black:new h.D({color:3355443,flatShading:!0}),reflect:new h.D({color:16720418,emissive:16720418,emissiveIntensity:.2})};var ys=class extends ns{constructor(...e){super(...e),this.geoSource=bs,this.objectType="VergeMarker",this.materials=As}};const Is={main:new h.D({color:8947848})};var Ds=class extends ns{constructor(...e){super(...e),this.geoSource=null,this.objectType="BridgeSupport",this.materials=Is}initialiseGeometry(e){super.initialiseGeometry();let t=new h.B(new h.e(2*Te,20,1),this.materials.main);t.position.y=-10.5,this.add(t),e(this)}},Ns=i.p+"static/media/wallcap.aac16301.obj";var Ms=class{constructor(){this.boundingSphere=new h.R,this.bounds={maxX:0,minX:0,maxY:0,minY:0,maxZ:0,minZ:0},this.seg={},this.drawNode=null,this.drawnNode=0}static checkMakeSegment(e){}computeBoundingSphere(){}drawSegment(){}drawNextNode(){}postProcess(){}retire(){this.drawnNode=0}},Cs=i.p+"static/media/concrete_01.76bdb714.jpg";const js=1/6,ks=2*js,zs=151,Ss={};class Os extends Ms{constructor(e=null,t=null){super(),this.mapSource=Cs,this.normSource=null,this.getHeightAt=t,this.material=new h.F({map:null,flatShading:!0}),this.mesh=new h.B(Os.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=X(this.mapSource,4)),this.normSource&&(this.material.normalMap=X(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.lOffset=this.seg.distance<0?js:0,this.uvDist=0,this.ux2=.46153846153846156,this.ux1=1-this.ux2,this.ni=0,this.drawNextNode()}drawNextNode(){for(Ss.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Ss.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Ss.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Ss.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Ss.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Ss.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Ss.dnp.z-this.oz)):(this.bounds.maxX=Ss.dnp.x-this.ox,this.bounds.minX=Ss.dnp.x-this.ox,this.bounds.maxY=Ss.dnp.y,this.bounds.minY=Ss.dnp.y,this.bounds.maxZ=Ss.dnp.z-this.oz,this.bounds.minZ=Ss.dnp.z-this.oz),Ss.j=0;Ss.j<this.drawNode.ps.length;Ss.j+=2)Ss.pj=this.drawNode.ps[Ss.j],Ss.nj=this.drawNode.ns[Ss.j],Ss.x=Ss.pj.x+Ss.nj.x*(this.seg.distance-this.lOffset),Ss.xw=Ss.x+Ss.nj.x*js,Ss.z=Ss.pj.z+Ss.nj.z*(this.seg.distance-this.lOffset),Ss.zw=Ss.z+Ss.nj.z*js,this.posArr[this.pi++]=Ss.x-this.ox-Ss.nj.x*ks,this.posArr[this.pi++]=Ss.pj.y,this.posArr[this.pi++]=Ss.z-this.oz-Ss.nj.z*ks,this.posArr[this.pi++]=Ss.x-this.ox,this.posArr[this.pi++]=Ss.pj.y+1,this.posArr[this.pi++]=Ss.z-this.oz,this.posArr[this.pi++]=Ss.xw-this.ox,this.posArr[this.pi++]=Ss.pj.y+1,this.posArr[this.pi++]=Ss.zw-this.oz,this.posArr[this.pi++]=Ss.xw-this.ox+Ss.nj.x*ks,this.posArr[this.pi++]=Ss.pj.y,this.posArr[this.pi++]=Ss.zw-this.oz+Ss.nj.z*ks,this.seg.contiguousStart||0!=this.ni||0!=Ss.j||(this.posArr[this.pi-11]-=1,this.posArr[this.pi-8]-=1,this.posArr[this.pi-5]-=1,this.posArr[this.pi-2]-=1),this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.uvDist++;return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(Ss.pj=this.drawNode.p,Ss.nj=this.drawNode.n,Ss.x=Ss.pj.x+Ss.nj.x*(this.seg.distance-this.lOffset),Ss.xw=Ss.x+Ss.nj.x*js,Ss.z=Ss.pj.z+Ss.nj.z*(this.seg.distance-this.lOffset),Ss.zw=Ss.z+Ss.nj.z*js,this.posArr[this.pi++]=Ss.x-this.ox-Ss.nj.x*ks,this.posArr[this.pi++]=Ss.pj.y,this.posArr[this.pi++]=Ss.z-this.oz-Ss.nj.z*ks,this.posArr[this.pi++]=Ss.x-this.ox,this.posArr[this.pi++]=Ss.pj.y+1,this.posArr[this.pi++]=Ss.z-this.oz,this.posArr[this.pi++]=Ss.xw-this.ox,this.posArr[this.pi++]=Ss.pj.y+1,this.posArr[this.pi++]=Ss.zw-this.oz,this.posArr[this.pi++]=Ss.xw-this.ox+Ss.nj.x*ks,this.posArr[this.pi++]=Ss.pj.y,this.posArr[this.pi++]=Ss.zw-this.oz+Ss.nj.z*ks,this.seg.contiguousEnd||(this.posArr[this.pi-11]-=1,this.posArr[this.pi-8]-=1,this.posArr[this.pi-5]-=1,this.posArr[this.pi-2]-=1),this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.55,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.45,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.25,this.oz),this.posAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),!0)}computeBoundingSphere(){Ss.minX=this.bounds.minX,Ss.maxX=this.bounds.maxX,Ss.minY=this.bounds.minY,Ss.maxY=this.bounds.maxY,Ss.minZ=this.bounds.minZ,Ss.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(Ss.minX+Ss.maxX)/2,this.boundingSphere.center.y=(Ss.minY+Ss.maxY)/2,this.boundingSphere.center.z=(Ss.minZ+Ss.maxZ)/2,this.boundingSphere.radius=Math.sqrt((Ss.maxX-Ss.minX)*(Ss.maxX-Ss.minX)+(Ss.maxY-Ss.minY)*(Ss.maxY-Ss.minY)+(Ss.maxZ-Ss.minZ)*(Ss.maxZ-Ss.minZ))/2+10}retire(){this.mesh.visible=!1}static getNorms(){let e=[];for(let t=0;t<zs;t++)e.push(1,0,0,0,1,0,0,1,0,-1,0,0);return e}static getGeo(){let e=new h.g;return e.setIndex(Os.getIndex()),e.setAttribute("position",new h.o(new Float32Array(1812),3)),e.attributes.position.setUsage(h.l),e.setAttribute("uv",new h.o(new Float32Array(1208),2)),e.attributes.uv.setUsage(h.l),e}static getIndex(){let e,t,i,s,n,a,r,h,o=[];for(let l=0;l<zs;l++)e=4*l,t=e+1,i=e+2,s=e+3,n=4*(l+1),a=n+1,r=n+2,h=n+3,o.push(e,t,n,t,a,n,t,i,a,i,r,a,i,s,r,s,h,r);return o}}var Ls=Os;var Rs=class{constructor(e,t,i,s){this.startNode=e,this.endNode=t,this.type=i,this.distance=s,this.length=t.i-e.i,this.contiguousStart=!1,this.contiguousEnd=!1}copy(e){this.startNode=e.startNode,this.endNode=e.endNode,this.type=e.type,this.distance=e.distance,this.length=e.length,this.contiguousStart=e.contiguousStart,this.contiguousEnd=e.contiguousEnd}};var Ts=class{constructor(e,t){this.prevRight=new Rs(e,e,-1,0),this.prevLeft=new Rs(e,e,-1,0),this.typeID=t}generateLeft(e){return this.test=this.testLeft,this.prev=this.prevLeft,this.side=-1,this.seg=null,e.i>this.prev.endNode.i&&this.testGenLeft(e)&&(this.seg=this.generate(e),this.seg&&(this.prevLeft=this.seg)),this.seg}testGenLeft(e){return!1}generateRight(e){return this.test=this.testRight,this.prev=this.prevRight,this.side=1,this.seg=null,e.i>this.prev.endNode.i&&this.testGenRight(e)&&(this.seg=this.generate(e),this.seg&&(this.prevRight=this.seg)),this.seg}testGenRight(e){return!1}generate(e){}};var Ps=class{constructor(e=10,t=1,i=0){this.rands=[],this.index=0,this.rand=new window.alea(Ve);for(let s=0;s<e;s++)this.rands.push(this.rand()*t-i);this.count=e,this.index=0}next(){return this.index>=this.count&&(this.index=0),this.rands[this.index++]}};const Gs=1.2,Bs=.3,Ws=.2,Es=new Ps(23,.1),Zs=new Ps(37,.2),Fs=new h.F({map:X(null,4),flatShading:!0}),Hs={};class Qs extends Ts{constructor(...e){super(...e),this.p=new h.W}generate(e){let t=e;for(;t.prev&&this.test(t.prev)&&e.i-t.i<4;)t=t.prev;for(;this.test(e.next)&&e.next.i-t.i<Ze;)e=e.next;if(e.i-t.i<1)return e.i==t.i&&(this.p.copy(e.p),this.p.x+=e.n.x*(Te+1.1)*this.side,this.p.z+=e.n.z*(Te+1.1)*this.side,Xs.addObject(Us.WallCap,this.p,Math.PI-e.a,e.i)),null;let i=new Rs(t,e,this.typeID,this.side<0?-t.dswl:-t.dswr);return this.prev.endNode.i==t.i&&this.prev.type==i.type&&(this.prev.contiguousEnd=!0,i.contiguousStart=!0,i.distance=this.prev.distance),i}testGenLeft(e){return void 0!==e.dsel||void 0!==e.dswl}testGenRight(e){return void 0!==e.dser||void 0!==e.dswr}testGen(e){return void 0!==e.dswl||void 0!==e.dswr}testLeft(e){return void 0!==e.dswl}testRight(e){return void 0!==e.dswr}}var Ys=class extends Ls{constructor(...e){super(...e),this.p=new h.W,this.mesh.material=Fs}getDistFromGradient(e){return Te+1}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.lOffset=this.seg.distance<0?Bs:0,this.uvDist=0,this.ux2=.4444444444444445,this.ux1=1-this.ux2,this.ni=0,this.side=e.distance<0?-1:1,this.h=0,this.d=0,this.drawNextNode()}drawNextNode(){for(Hs.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Hs.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Hs.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Hs.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Hs.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Hs.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Hs.dnp.z-this.oz)):(this.bounds.maxX=Hs.dnp.x-this.ox,this.bounds.minX=Hs.dnp.x-this.ox,this.bounds.maxY=Hs.dnp.y,this.bounds.minY=Hs.dnp.y,this.bounds.maxZ=Hs.dnp.z-this.oz,this.bounds.minZ=Hs.dnp.z-this.oz),this.seg.distance=this.getDistFromGradient(this.drawNode.g)*this.side,Hs.j=0;Hs.j<this.drawNode.ps.length;Hs.j+=2)Hs.pj=this.drawNode.ps[Hs.j],Hs.nj=this.drawNode.ns[Hs.j],Hs.x=Hs.pj.x+Hs.nj.x*(this.seg.distance-this.lOffset+this.d),Hs.xw=Hs.x+Hs.nj.x*Bs,Hs.z=Hs.pj.z+Hs.nj.z*(this.seg.distance-this.lOffset+this.d),Hs.zw=Hs.z+Hs.nj.z*Bs,Hs.y=this.drawNode.ps[Hs.j].y,this.posArr[this.pi++]=Hs.x-this.ox-Hs.nj.x*Ws,this.posArr[this.pi++]=Hs.y,this.posArr[this.pi++]=Hs.z-this.oz-Hs.nj.z*Ws,this.posArr[this.pi++]=Hs.x-this.ox,this.posArr[this.pi++]=Hs.y+Gs+this.h,this.posArr[this.pi++]=Hs.z-this.oz,this.posArr[this.pi++]=Hs.xw-this.ox,this.posArr[this.pi++]=Hs.y+Gs+this.h,this.posArr[this.pi++]=Hs.zw-this.oz,this.posArr[this.pi++]=Hs.xw-this.ox+Hs.nj.x*Ws,this.posArr[this.pi++]=Hs.y,this.posArr[this.pi++]=Hs.zw-this.oz+Hs.nj.z*Ws,this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.uvDist++,this.h=Es.next(),this.d=Zs.next();return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(this.h=0,this.d=0,Hs.pj=this.drawNode.p,Hs.nj=this.drawNode.n,Hs.x=Hs.pj.x+Hs.nj.x*(this.seg.distance-this.lOffset+this.d),Hs.xw=Hs.x+Hs.nj.x*Bs,Hs.z=Hs.pj.z+Hs.nj.z*(this.seg.distance-this.lOffset+this.d),Hs.zw=Hs.z+Hs.nj.z*Bs,Hs.y=Hs.pj.y,this.posArr[this.pi++]=Hs.x-this.ox-Hs.nj.x*Ws,this.posArr[this.pi++]=Hs.y,this.posArr[this.pi++]=Hs.z-this.oz-Hs.nj.z*Ws,this.posArr[this.pi++]=Hs.x-this.ox,this.posArr[this.pi++]=Hs.y+Gs,this.posArr[this.pi++]=Hs.z-this.oz,this.posArr[this.pi++]=Hs.xw-this.ox,this.posArr[this.pi++]=Hs.y+Gs,this.posArr[this.pi++]=Hs.zw-this.oz,this.posArr[this.pi++]=Hs.xw-this.ox+Hs.nj.x*Ws,this.posArr[this.pi++]=Hs.y,this.posArr[this.pi++]=Hs.zw-this.oz+Hs.nj.z*Ws,this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.35,this.oz),this.posAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),this.seg.contiguousStart||(this.p.x=(this.posArr[0]+this.posArr[9])/2+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=(this.posArr[2]+this.posArr[11])/2+this.mesh.position.z,Xs.addObject(Us.WallCap,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i)),this.seg.contiguousEnd||(this.p.x=(this.posArr[this.pi-3]+this.posArr[this.pi-12])/2+this.mesh.position.x,this.p.y=this.posArr[this.pi-2],this.p.z=(this.posArr[this.pi-1]+this.posArr[this.pi-10])/2+this.mesh.position.z,Xs.addObject(Us.WallCap,this.p,Math.PI+Math.PI/2-this.seg.endNode.a,this.seg.endNode.i)),!0)}};const Vs={VergeMarker:{class:ys,geo:null},WarningSign:{class:fs,geo:null},BridgeSupport:{class:Ds,geo:null},WallCap:{class:class extends ns{constructor(...e){super(...e),this.geoSource=Ns,this.objectType="WallCap",this.materials={default:Fs}}},geo:null}},Us={VergeMarker:"VergeMarker",WarningSign:"WarningSign",BridgeSupport:"BridgeSupport",WallCap:"WallCap"};var Xs=new class{constructor(){this.lastRepositionIndex=0,this.pools={},this.active=[],this.loadingQueue=[],this.getHeightAt=()=>{},this.loadCounter=0,this.didLoadBound=this.didLoad.bind(this),this.addObjectBound=this.addObject.bind(this),this.container=new h.G,this.container.matrixAutoUpdate=!1,this.loadingQueue=[]}destroy(){this.loadingQueue.length=0;for(let i in this.pools){var e;for(let e of this.pools[i])e.destroy();null===(e=Vs[i].geo)||void 0===e||e.destroy()}for(let i of this.active){var t;null===(t=i.destroy)||void 0===t||t.call(i)}for(this.container.traverse((e=>{e.isMesh&&(e.geometry.dispose(),e.material.dispose())})),this.active.length=0,this.pools={};this.container.children.length;)this.container.remove(this.container.children[0])}initialise(e){this.getHeightAt=e,this.initLibrary()}initLibrary(){for(let e in Vs)this.loadObject(e),this.pools[e]=[]}loadObject(e){let t=Vs[e],i=new t.class;i.initialiseGeometry((()=>{t.geo=i,this.didLoad()}))}didLoad(){if(this.loadCounter++,this.loadCounter>=Object.keys(Vs).length)for(;this.loadingQueue.length;){let e=this.loadingQueue.pop();this.addObject(...e)}}addCustom(e,t,i,s,n=null){if(n||(n=5),st.vehicleIndex>s+n)return;let a;for(e.keyName=null,e.worldPosition=t.clone(),e.position.subVectors(e.worldPosition,this.container.position),e.rotation.y=i,e.visible=!0,e.retireIndex=s+n,this.container.add(e),a=0;a<this.active.length&&!(this.active[a].retireIndex>e.retireIndex);a++);this.active.splice(a,0,e)}addObject(e,t,i,s,n=null){if(!(e in Vs))return void console.error("Unrecognised roadside object type ",e);if(!Vs[e].geo)return void this.loadingQueue.push([e,t,i,s,n]);let a,r;for(this.pools[e].length?a=this.pools[e].pop():(a=Vs[e].geo.clone(),this.container.add(a),ts["roadside-objects"]++),a.keyName=e,a.worldPosition.copy(t),a.position.subVectors(a.worldPosition,this.container.position),a.rotation.y=i,a.visible=!0,a.retireIndex=s+5,null!==n&&a.setVariant(n),r=0;r<this.active.length&&!(this.active[r].retireIndex>a.retireIndex);r++);return this.active.splice(r,0,a),a}update(){if(this.active.length&&st.vehicleIndex>=this.active[0].retireIndex){let e=this.active.shift();e.visible=!1,e.keyName?this.pools[e.keyName].push(e):this.container.remove(e)}if(this.active.length>30){let e=this.active.shift();e.visible=!1,e.keyName?this.pools[e.keyName].push(e):this.container.remove(e)}if(st.vehicleIndex-this.lastRepositionIndex>100){this.container.position.x=st.vehicleNode.p.x,this.container.position.z=st.vehicleNode.p.z,this.container.updateMatrix();for(let e of this.container.children)e.position.subVectors(e.worldPosition,this.container.position);this.lastRepositionIndex=st.vehicleIndex}}},Js=i.p+"static/media/wall_barrier_02.44c5c0ea.webp",qs=i.p+"static/media/wall_barrier_02_n.0c79c69f.webp";const Ks=.78,_s=151;let $s=.55,en=.68,tn=.88,sn=0,nn=null;const an=U(Js,.75,8,qs,null,{}),rn={};class hn extends Ms{constructor(e=null){super(),this.p=new h.W,this.mapSource=null,this.normSource=null,this.bounds={maxX:0,minX:0,maxY:0,minY:0,maxZ:0,minZ:0},this.material=an,this.mesh=new h.B(hn.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.normAttribute=this.mesh.geometry.attributes.normal,this.normArr=this.normAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=X(this.mapSource,4)),this.normSource&&(this.material.normalMap=X(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.normi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.uvDist=0,this.side=Math.sign(e.distance),this.ni=0,this.drawNextNode()}drawNextNode(){for(rn.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,rn.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,rn.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,rn.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,rn.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,rn.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,rn.dnp.z-this.oz)):(this.bounds.maxX=rn.dnp.x-this.ox,this.bounds.minX=rn.dnp.x-this.ox,this.bounds.maxY=rn.dnp.y,this.bounds.minY=rn.dnp.y,this.bounds.maxZ=rn.dnp.z-this.oz,this.bounds.minZ=rn.dnp.z-this.oz),rn.j=0;rn.j<this.drawNode.ps.length;rn.j+=2)rn.pj=this.drawNode.ps[rn.j],rn.nj=this.drawNode.ns[rn.j],rn.njs={x:rn.nj.x*-this.side,z:rn.nj.z*-this.side},rn.x=rn.pj.x+rn.nj.x*this.seg.distance,rn.x1=rn.x+.1*rn.nj.x*this.side,rn.z=rn.pj.z+rn.nj.z*this.seg.distance,rn.z1=rn.z+.1*rn.nj.z*this.side,this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z1-this.oz,_>2&&(this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+.42900000000000005,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z1-this.oz),_>1&&(this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+.5304000000000001,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z-this.oz),_>0&&(this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+.6864,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z-this.oz),this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+Ks,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z1-this.oz;if(this.ni++,this.drawNode=this.drawNode.next,this.drawNode.i<this.seg.endNode.i)return!1;if(rn.pj=this.drawNode.p,rn.nj=this.drawNode.n,rn.njs={x:rn.nj.x*-this.side,z:rn.nj.z*-this.side},rn.x=rn.pj.x+rn.nj.x*this.seg.distance,rn.z=rn.pj.z+rn.nj.z*this.seg.distance,rn.x1=rn.x+.1*rn.nj.x*this.side,rn.z1=rn.z+.1*rn.nj.z*this.side,this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z1-this.oz,_>2&&(this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+.42900000000000005,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z1-this.oz),_>1&&(this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+.5304000000000001,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z-this.oz),_>0&&(this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+.6864,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z-this.oz),this.normArr[this.pi]=rn.njs.x,this.posArr[this.pi++]=rn.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=rn.pj.y+Ks,this.normArr[this.pi]=rn.njs.z,this.posArr[this.pi++]=rn.z1-this.oz,this.mesh.geometry.setDrawRange(0,5*this.seg.length*(2*(_+1))*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.15,this.oz),this.posAttribute.needsUpdate=!0,this.normAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),!this.seg.contiguousStart)for(this.p.x=this.posArr[0]+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=this.posArr[2]+this.mesh.position.z,Xs.addObject(Us.VergeMarker,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i),rn.ii=0;rn.ii<_+2;rn.ii++)this.posArr[3*rn.ii+1]-=Ks;if(!this.seg.contiguousEnd)for(rn.ii=0;rn.ii<_+2;rn.ii++)this.posArr[this.pi-(3*rn.ii+2)]-=Ks;return!0}retire(){this.mesh.visible=!1}computeBoundingSphere(){rn.minX=this.bounds.minX,rn.maxX=this.bounds.maxX,rn.minY=this.bounds.minY,rn.maxY=this.bounds.maxY,rn.minZ=this.bounds.minZ,rn.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(rn.minX+rn.maxX)/2,this.boundingSphere.center.y=(rn.minY+rn.maxY)/2,this.boundingSphere.center.z=(rn.minZ+rn.maxZ)/2,this.boundingSphere.radius=Math.sqrt((rn.maxX-rn.minX)*(rn.maxX-rn.minX)+(rn.maxY-rn.minY)*(rn.maxY-rn.minY)+(rn.maxZ-rn.minZ)*(rn.maxZ-rn.minZ))/2+10}static getNorms(){let e=[];for(let t=0;t<_s*(_+2);t++)e.push(0,0,1);return e}static getUV(){let e=[];for(let t=0;t<_s;t++)0==_?e.push(t,0,t,1):1==_?e.push(t,0,t,tn,t,1):2==_?e.push(t,0,t,$s,t,tn,t,1):e.push(t,0,t,$s,t,en,t,tn,t,1);return e}static getGeo(){if(null!==nn&&sn==_)return nn.clone();let e=new h.g;e.setIndex(hn.getIndex()),e.setAttribute("position",new h.o(new Float32Array(453*(_+2)),3)),e.attributes.position.setUsage(h.l),e.setAttribute("uv",new h.o(new Float32Array(hn.getUV()),2));let t=new Float32Array(hn.getNorms());return e.setAttribute("normal",new h.o(t,3)),e.attributes.normal.setUsage(h.l),nn=e,sn=_,e}static getIndex(){let e=[];if(0==_){let t,i,s,n;for(let a=0;a<_s;a++)t=2*a,i=t+1,s=2*(a+1),n=s+1,e.push(t,i,s),e.push(i,n,s)}else if(1==_){let t,i,s,n,a,r;for(let h=0;h<_s;h++)t=3*h,i=t+1,s=t+2,n=3*(h+1),a=n+1,r=n+2,e.push(t,i,n,i,a,n,i,s,a,s,r,a)}else if(2==_){let t,i,s,n,a,r,h,o;for(let l=0;l<_s;l++)t=4*l,i=t+1,s=t+2,n=t+3,a=4*(l+1),r=a+1,h=a+2,o=a+3,e.push(t,i,a,i,r,a,i,s,r,s,h,r,s,n,h,n,o,h)}else{let t,i,s,n,a,r,h,o,l,d;for(let c=0;c<_s;c++)t=5*c,i=t+1,s=t+2,n=t+3,a=t+4,r=5*(c+1),h=r+1,o=r+2,l=r+3,d=r+4,e.push(t,i,r,i,h,r,i,s,h,s,o,h,s,n,o,n,l,o,n,a,l,a,d,l)}return e}}class on extends Ts{constructor(...e){super(...e),this.fenceID=4}generate(e){let t=e.prev;for(e=e.next;this.test(t)&&t.prev&&t.i>this.prev.endNode.i&&e.i-t.i<11;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.test(e)&&e.i-t.i<Ze;)e=e.next;let i=this.typeID;wh.value.detailLodIndex>1&&(t.i%2==0||this.prev.endNode.i==t.i&&this.prev.type==this.fenceID)&&(i=this.fenceID);let s=new Rs(t,e,i,(t.w+Ge)*this.side);return this.prev.endNode.i==t.i&&this.prev.type==s.type&&(this.prev.contiguousEnd=!0,s.contiguousStart=!0,s.distance=this.prev.distance),s}testGenLeft(e){return!e.bridge&&null==e.lWallDist&&e.i>=this.prevLeft.endNode.i&&(e.g<-1||e.g<0&&e.da>.2&&e.h<.6)}testGenRight(e){return!e.bridge&&null==e.rWallDist&&e.i>=this.prevRight.endNode.i&&(e.g>1||e.g>0&&e.da<-.2&&e.h<.6)}testLeft(e){return!e.bridge&&e.p.y>3&&(e.g<-.5||e.g<.1&&e.da<-.05&&e.h<.6)}testRight(e){return!e.bridge&&e.p.y>3&&(e.g>.5||e.g>-.1&&e.da>.05&&e.h<.6)}}var ln=hn,dn=i.p+"static/media/wall_barrier_wood_n.f554ec90.webp";let cn=.52,pn=.56,un=.8,gn=.956,mn=0,xn=null;const vn=U(null,.75,8,dn,null,{}),wn={};class fn extends Ms{constructor(e=null){super(),this.p=new h.W,this.postIndex=[],this.fenceIndex=[],this.drawIndex=[],this.fenceIndexTemplate=[],this.mapSource=null,this.normSource=null,this.bounds={maxX:0,minX:0,maxY:0,minY:0,maxZ:0,minZ:0},this.material=vn,this.mesh=new h.B(fn.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.normAttribute=this.mesh.geometry.attributes.normal,this.normArr=this.normAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,this.fenceIndexTemplate=fn.getFenceIndex(),e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=X(this.mapSource,4)),this.normSource&&(this.material.normalMap=X(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.normi=0,this.postI=6*(2*this.seg.length+1)*3,this.postUVI=6*(2*this.seg.length+1)*2,this.postIndex.length=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.uvDist=0,this.side=Math.sign(e.distance),this.ni=0,this.si=0,this.fenceDrawCount=60*this.seg.length,this.fenceVertCount=0,this.fenceIndex.length=0,this.fenceTriangleCount=0,this.postIndexCount=6*(2*this.seg.length+1),this.postDrawCount=0,this.drawNextNode()}updateBounds(){wn.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,wn.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,wn.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,wn.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,wn.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,wn.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,wn.dnp.z-this.oz)):(this.bounds.maxX=wn.dnp.x-this.ox,this.bounds.minX=wn.dnp.x-this.ox,this.bounds.maxY=wn.dnp.y,this.bounds.minY=wn.dnp.y,this.bounds.maxZ=wn.dnp.z-this.oz,this.bounds.minZ=wn.dnp.z-this.oz)}drawFenceVert(e,t,i,s,n=0){this.normArr[this.pi]=wn.njs.x,this.posArr[this.pi++]=e,this.normArr[this.pi]=0,this.posArr[this.pi++]=wn.pj.y+1*t+n,this.normArr[this.pi]=wn.njs.z,this.posArr[this.pi++]=i,this.uvArr[this.ui++]=this.si,this.uvArr[this.ui++]=.4*s}buildNextFenceIndex(){for(wn.fi=3*this.fenceTriangleCount,wn.i=0;wn.i<30;wn.i++)this.fenceIndex.push(this.fenceIndexTemplate[wn.fi+wn.i]);this.fenceTriangleCount+=10}drawFencePost(){wn.xA=wn.x-.02*wn.nj.x*this.side+.06*-wn.nj.z,wn.zA=wn.z-.02*wn.nj.z*this.side+.06*wn.nj.x,wn.xB=wn.x+.11*wn.nj.x*this.side+.06*-wn.nj.z,wn.zB=wn.z+.11*wn.nj.z*this.side+.06*wn.nj.x,wn.xC=wn.x+.11*wn.nj.x*this.side-.06*-wn.nj.z,wn.zC=wn.z+.11*wn.nj.z*this.side-.06*wn.nj.x,wn.xD=wn.x-.02*wn.nj.x*this.side-.06*-wn.nj.z,wn.zD=wn.z-.02*wn.nj.z*this.side-.06*wn.nj.x,wn.njs.x=0,wn.njs.z=0,wn.nup=1,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xA,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zA,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xA,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y+1+.03,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zA,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xB,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zB,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xB,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y+1+.03,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zB,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xC,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zC,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xC,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y+1+.03,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zC,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xD,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zD,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xD,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y+1+.03,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zD,this.normArr[this.postI]=wn.njs.x,this.posArr[this.postI++]=wn.xD,this.normArr[this.postI]=wn.nup,this.posArr[this.postI++]=wn.pj.y+1+.03,this.normArr[this.postI]=wn.njs.z,this.posArr[this.postI++]=wn.zD,this.uvArr[this.postUVI++]=.25,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=.25,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.75,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=.75,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=0,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=0,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.42,this.postIndex.push(this.postIndexCount,this.postIndexCount+3,this.postIndexCount+1,this.postIndexCount,this.postIndexCount+2,this.postIndexCount+3,this.postIndexCount+2,this.postIndexCount+5,this.postIndexCount+3,this.postIndexCount+2,this.postIndexCount+4,this.postIndexCount+5,this.postIndexCount+4,this.postIndexCount+7,this.postIndexCount+5,this.postIndexCount+4,this.postIndexCount+6,this.postIndexCount+7,this.postIndexCount+6,this.postIndexCount+1,this.postIndexCount+7,this.postIndexCount+6,this.postIndexCount,this.postIndexCount+1,this.postIndexCount+1,this.postIndexCount+3,this.postIndexCount+8,this.postIndexCount+3,this.postIndexCount+5,this.postIndexCount+8),this.postIndexCount+=9,this.postDrawCount+=30}drawNextNode(e=!1){for(this.updateBounds(),wn.j=0;wn.j<this.drawNode.ps.length;wn.j+=5)wn.pj=this.drawNode.ps[wn.j],wn.nj=this.drawNode.ns[wn.j],wn.njs={x:wn.nj.x*-this.side,z:wn.nj.z*-this.side},wn.x=wn.pj.x+wn.nj.x*this.seg.distance-this.ox,wn.x1=wn.x+.08*wn.nj.x*this.side,wn.z=wn.pj.z+wn.nj.z*this.seg.distance-this.oz,wn.z1=wn.z+.08*wn.nj.z*this.side,wn.rand=.06*Math.random()-.03,wn.rand2=.06*Math.random()-.03,this.drawFenceVert(wn.x,0,wn.z,0,wn.rand),this.drawFenceVert(wn.x,pn,wn.z,cn,wn.rand),this.drawFenceVert(wn.x1,pn,wn.z1,pn,wn.rand),this.drawFenceVert(wn.x,un,wn.z,un,wn.rand2),this.drawFenceVert(wn.x,1,wn.z,gn,wn.rand2),this.drawFenceVert(wn.x1,1,wn.z1,1,wn.rand2),(this.ni>0||0==wn.j)&&this.buildNextFenceIndex(),(this.ni>0||this.seg.contiguousStart||wn.j>0)&&this.drawFencePost(),this.si++;if(this.ni++,this.drawNode=this.drawNode.next,this.drawNode.i<this.seg.endNode.i)return!1;if(this.updateBounds(),wn.pj=this.drawNode.p,wn.nj=this.drawNode.n,wn.njs={x:wn.nj.x*-this.side,z:wn.nj.z*-this.side},wn.x=wn.pj.x+wn.nj.x*this.seg.distance-this.ox,wn.z=wn.pj.z+wn.nj.z*this.seg.distance-this.oz,wn.x1=wn.x+.1*wn.nj.x*this.side,wn.z1=wn.z+.1*wn.nj.z*this.side,this.drawFenceVert(wn.x,0,wn.z,0),this.drawFenceVert(wn.x,pn,wn.z,cn),this.drawFenceVert(wn.x1,pn,wn.z1,pn),this.drawFenceVert(wn.x,un,wn.z,un),this.drawFenceVert(wn.x,1,wn.z,gn),this.drawFenceVert(wn.x1,1,wn.z1,1),this.buildNextFenceIndex(),this.seg.contiguousEnd&&this.drawFencePost(),this.si++,this.mesh.geometry.setDrawRange(0,this.fenceDrawCount+this.postDrawCount),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.drawIndex=this.fenceIndex.concat(this.postIndex),this.mesh.geometry.setIndex(this.drawIndex),this.mesh.position.set(this.ox,-.15,this.oz),this.posAttribute.needsUpdate=!0,this.normAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),!this.seg.contiguousStart)for(this.p.x=this.posArr[0]+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=this.posArr[2]+this.mesh.position.z,Xs.addObject(Us.VergeMarker,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i),wn.ii=0;wn.ii<6;wn.ii++)this.posArr[3*wn.ii+1]-=1;if(!this.seg.contiguousEnd)for(wn.ii=0;wn.ii<6;wn.ii++)this.posArr[this.pi-(3*wn.ii+2)]-=1;return!0}retire(){this.mesh.visible=!1}computeBoundingSphere(){wn.minX=this.bounds.minX,wn.maxX=this.bounds.maxX,wn.minY=this.bounds.minY,wn.maxY=this.bounds.maxY,wn.minZ=this.bounds.minZ,wn.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(wn.minX+wn.maxX)/2,this.boundingSphere.center.y=(wn.minY+wn.maxY)/2,this.boundingSphere.center.z=(wn.minZ+wn.maxZ)/2,this.boundingSphere.radius=Math.sqrt((wn.maxX-wn.minX)*(wn.maxX-wn.minX)+(wn.maxY-wn.minY)*(wn.maxY-wn.minY)+(wn.maxZ-wn.minZ)*(wn.maxZ-wn.minZ))/2+10}static getNorms(){let e=[];for(let t=0;t<366;t++)e.push(0,0,1);return e}static getUV(){let e=[];for(let t=0;t<61;t++)e.push(t,0,t,cn,t,pn,t,un,t,gn,t,1);return e}static getGeo(){if(null!==xn&&mn==_)return xn.clone();let e=new h.g;return e.setAttribute("position",new h.o(new Float32Array(5490),3)),e.attributes.position.setUsage(h.l),e.setAttribute("uv",new h.o(new Float32Array(3660),2)),e.attributes.uv.setUsage(h.l),e.setAttribute("normal",new h.o(new Float32Array(5490),3)),e.attributes.normal.setUsage(h.l),xn=e,mn=_,e}static getFenceIndex(){let e,t,i,s,n,a,r,h,o,l,d,c,p=[];for(let u=0;u<61;u++)e=6*u,t=e+1,i=e+2,s=e+3,n=e+4,a=e+5,r=6*(u+1),h=r+1,o=r+2,l=r+3,d=r+4,c=r+5,p.push(e,t,r,t,h,r,t,i,h,i,o,h,i,s,o,s,l,o,s,n,l,n,d,l,n,a,d,a,c,d);return p}}var bn=fn;const An=2.3,yn=.3833333333333333,In=.19166666666666665,Dn=new h.F({map:null,flatShading:!0}),Nn={};class Mn extends Ts{generate(e){let t=e.prev;for(e=e.next;this.testGen(t)&&t.prev&&e.i-t.i<4;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.testGen(e)&&e.i-t.i<Ze;)e=e.next;let i=new Rs(t,e,this.typeID,(t.w+0)*this.side);return this.prev.endNode.i==t.i&&this.prev.type==i.type&&(this.prev.contiguousEnd=!0,i.contiguousStart=!0,i.distance=this.prev.distance),i}testGenLeft(e){return e.bridge&&e.i>=this.prev.endNode.i}testGenRight(e){return e.bridge&&e.i>=this.prev.endNode.i}testGen(e){return e.bridge&&e.i>=this.prev.endNode.i}testLeft(e){return e.bridge}testRight(e){return e.bridge}}var Cn=class extends Ls{constructor(...e){super(...e),this.mapSource=Yi.skins.default.walls.sea,this.p=new h.W,this.mesh.material=Dn}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.lOffset=this.seg.distance<0?yn:0,this.uvDist=0,this.ux1=1.15,this.ux2=1.3416666666666666,this.ux3=2.4916666666666663,this.ni=0,this.drawNextNode()}drawNextNode(){for(Nn.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Nn.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Nn.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Nn.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Nn.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Nn.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Nn.dnp.z-this.oz)):(this.bounds.maxX=Nn.dnp.x-this.ox,this.bounds.minX=Nn.dnp.x-this.ox,this.bounds.maxY=Nn.dnp.y,this.bounds.minY=Nn.dnp.y,this.bounds.maxZ=Nn.dnp.z-this.oz,this.bounds.minZ=Nn.dnp.z-this.oz),Nn.j=0;Nn.j<this.drawNode.ps.length;Nn.j+=2)Nn.pj=this.drawNode.ps[Nn.j],Nn.nj=this.drawNode.ns[Nn.j],Nn.x=Nn.pj.x+Nn.nj.x*(this.seg.distance-this.lOffset),Nn.xw=Nn.x+Nn.nj.x*yn,Nn.z=Nn.pj.z+Nn.nj.z*(this.seg.distance-this.lOffset),Nn.zw=Nn.z+Nn.nj.z*yn,this.posArr[this.pi++]=Nn.x-this.ox-Nn.nj.x*In,this.posArr[this.pi++]=Nn.pj.y,this.posArr[this.pi++]=Nn.z-this.oz-Nn.nj.z*In,this.posArr[this.pi++]=Nn.x-this.ox,this.posArr[this.pi++]=Nn.pj.y+An,this.posArr[this.pi++]=Nn.z-this.oz,this.posArr[this.pi++]=Nn.xw-this.ox,this.posArr[this.pi++]=Nn.pj.y+An,this.posArr[this.pi++]=Nn.zw-this.oz,this.posArr[this.pi++]=Nn.xw-this.ox+Nn.nj.x*In,this.posArr[this.pi++]=Nn.pj.y,this.posArr[this.pi++]=Nn.zw-this.oz+Nn.nj.z*In,this.seg.contiguousStart||0!=this.ni||0!=Nn.j||(this.posArr[this.pi-11]-=1.15,this.posArr[this.pi-8]-=1.15,this.posArr[this.pi-5]-=1.15,this.posArr[this.pi-2]-=1.15),this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux3,this.uvArr[this.ui++]=this.uvDist,this.uvDist++;return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(Nn.pj=this.drawNode.p,Nn.nj=this.drawNode.n,Nn.x=Nn.pj.x+Nn.nj.x*(this.seg.distance-this.lOffset),Nn.xw=Nn.x+Nn.nj.x*yn,Nn.z=Nn.pj.z+Nn.nj.z*(this.seg.distance-this.lOffset),Nn.zw=Nn.z+Nn.nj.z*yn,this.posArr[this.pi++]=Nn.x-this.ox-Nn.nj.x*In,this.posArr[this.pi++]=Nn.pj.y,this.posArr[this.pi++]=Nn.z-this.oz-Nn.nj.z*In,this.posArr[this.pi++]=Nn.x-this.ox,this.posArr[this.pi++]=Nn.pj.y+An,this.posArr[this.pi++]=Nn.z-this.oz,this.posArr[this.pi++]=Nn.xw-this.ox,this.posArr[this.pi++]=Nn.pj.y+An,this.posArr[this.pi++]=Nn.zw-this.oz,this.posArr[this.pi++]=Nn.xw-this.ox+Nn.nj.x*In,this.posArr[this.pi++]=Nn.pj.y,this.posArr[this.pi++]=Nn.zw-this.oz+Nn.nj.z*In,this.seg.contiguousEnd||(this.posArr[this.pi-11]-=An,this.posArr[this.pi-8]-=An,this.posArr[this.pi-5]-=An,this.posArr[this.pi-2]-=An),this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.55,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.45,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-1.5,this.oz),this.posAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),this.seg.contiguousStart||(this.p.x=(this.posArr[0]+this.posArr[9])/2+this.mesh.position.x,this.p.y=this.posArr[7]-1.15,this.p.z=(this.posArr[2]+this.posArr[11])/2+this.mesh.position.z,Xs.addObject(Us.VergeMarker,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i)),!0)}};const jn=new h.F({map:null,flatShading:!0});class kn extends Ls{constructor(...e){super(...e),this.mapSource=Yi.skins.default.walls.sea,this.mesh.material=jn}}kn.waterHeight=2.5,kn.waterThreshold=3;class zn extends Ts{constructor(...e){super(...e),this.drystoneID=2}generate(e){let t=e.prev;for(e=e.next;this.test(t)&&t.prev&&e.i-t.i<4&&t.i>this.prev.endNode.i&&e.i-t.i<Ze;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.test(e)&&e.i-t.i<Ze;)e=e.next;let i=this.typeID;(t.i%2==0||this.prev.endNode.i==t.i&&this.prev.type==this.drystoneID)&&(i=this.drystoneID);let s=new Rs(t,e,i,(t.w+1)*this.side);return this.prev.endNode.i>=t.i&&this.prev.type==s.type&&(this.prev.contiguousEnd=!0,s.contiguousStart=!0,s.distance=this.prev.distance),s}testGenLeft(e){return e.i>=this.prev.endNode.i&&this.testGen(e)&&this.testLeft(e)}testGenRight(e){return e.i>=this.prev.endNode.i&&this.testGen(e)&&this.testRight(e)}testGen(e){return!e.bridge&&(e.p.y<=kn.waterHeight||e.i==this.prev.endNode.i&&e.p.y<kn.waterThreshold)}testLeft(e){return!e.bridge&&(e.g<.15||e.p.y<kn.waterThreshold&&e.h<-.5)}testRight(e){return!e.bridge&&(e.g>.15||e.p.y<kn.waterThreshold&&e.h<-.5)}}const Sn={Barrier:0,SeaWall:1,Drystone:2,Bridge:3,Fence:4},On=[ln,kn,Ys,Cn,bn];var Ln=class{constructor(e){this.activeSegments=[],this.prevSegmentsLeft=[],this.prevSegmentsRight=[],this.stagedSegments=[],this.count=0,this.prevWasContiguous=!1,this.getHeightAt=e,this.container=new h.G,this.segments=[],this.initPools()}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}initialise(){this.renderIndex=st.vehicleIndex,this.genNode=st.vehicleNode,this.genIndex=st.vehicleIndex,this.genNodeLeft=st.vehicleNode,this.genNodeRight=st.vehicleNode,this.bridgeWallGenerator=new Mn(st.vehicleNode,Sn.Bridge),this.seaWallGenerator=new zn(st.vehicleNode,Sn.SeaWall),this.seaWallGenerator.drystoneID=Sn.Drystone,this.drystoneGenerator=new Qs(st.vehicleNode,Sn.Drystone,this.getHeightAt),this.barrierGenerator=new on(st.vehicleNode,Sn.Barrier);do{this.updateGeneration()}while(this.genIndex<st.vehicleIndex+We);for(;this.segments.length>0&&st.vehicleIndex+Ee>=this.segments[0].startNode.i;)this.drawNextSegment();do{this.updateStaged()}while(this.stagedSegments.length)}initPools(){this.pools=[];let e,t,i=Object.keys(Sn).length;for(e=0;e<i;e++)t=new On[e](null,this.getHeightAt),this.container.add(t.mesh),this.pools.push([t])}setSkin(e){}handleMidlineReset(){(st.tail.i<this.genNodeLeft.i||st.tail.i<this.genNodeRight.i)&&(console.error("Wall controller must handle reset gracefully"),this.genNodeLeft=st.tail,this.genNodeRight=st.tail,this.renderIndex=st.tail.i)}updateGeneration(){this.genIndex<st.vehicleIndex+We&&this.genIndex++,this.genNodeLeft.i<this.genIndex&&(this.genNodeLeft=this.genNodeLeft.next,this.checkGenerateLeftSegment()),this.genNodeRight.i<this.genIndex&&(this.genNodeRight=this.genNodeRight.next,this.checkGenerateRightSegment())}update(){for(this.updateGeneration();this.segments.length>0&&st.vehicleIndex+Ee>=this.segments[0].startNode.i;)this.drawNextSegment();if(this.activeSegments.length)for(;st.vehicleIndex>this.activeSegments[0].endNode.i+10&&(this.retireSegment(this.activeSegments.shift()),0!=this.activeSegments.length););}updateStaged(){this.stagedSegments.length&&this.stagedSegments[0].drawNextNode()&&(this.stagedSegments.shift(),ts.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")")}checkGenerateLeftSegment(){this.addLeftSegment(this.bridgeWallGenerator.generateLeft(this.genNodeLeft)),this.addLeftSegment(this.seaWallGenerator.generateLeft(this.genNodeLeft)),this.addLeftSegment(this.drystoneGenerator.generateLeft(this.genNodeLeft)),this.addLeftSegment(this.barrierGenerator.generateLeft(this.genNodeLeft))}checkGenerateRightSegment(){this.addRightSegment(this.bridgeWallGenerator.generateRight(this.genNodeRight)),this.addRightSegment(this.seaWallGenerator.generateRight(this.genNodeRight)),this.addRightSegment(this.drystoneGenerator.generateRight(this.genNodeRight)),this.addRightSegment(this.barrierGenerator.generateRight(this.genNodeRight))}addRightSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.rWallDist||t.rWallDist>e.distance)&&(t.rWallDist=e.distance,t.wallSide=-1),t=t.next;this.segments.push(e)}addLeftSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.lWallDist||t.lWallDist>-e.distance)&&(t.lWallDist=-e.distance,t.wallSide=1),t=t.next;this.segments.push(e)}getSegmentObject(e){let t;if(this.pools[e].length)t=this.pools[e].pop();else{t=new(0,On[e])(null,this.getHeightAt),this.container.add(t.mesh)}return t}drawNextSegment(){let e=this.segments.shift(),t=this.getSegmentObject(e.type);t.drawSegment(e)||this.stagedSegments.push(t),e.obj=t,this.activeSegments.push(e),ts.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")"}retireSegment(e){e.obj.retire(),ts.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")",this.pools[e.type].push(e.obj)}};const Rn=1.5*Math.PI;var Tn=class{constructor(){this.root=null,this.turnTail=null,this.gradTail=null,this.chevTail=null,this.placementNode=null,this.placementPos=new h.W,this.lastSignIndex=0,this.lastSignPos=new h.W,this.lastSignRot=0,this.dA=0,this.lastTurnIndex=-10,this.lastTurnType=null,this.lastTurnGeo=null,this.turnDir=0,this.dH=0,this.lastGradIndex=-16,this.lastGradGeo=null,this.taildH=0,this.curHillDir=0,this.onHill=!1,this.steepness=0,this.curHillSteepness=0,this.cA=0,this.lastChevIndex=0,this.chevDir=0}initialise(){for(this.root=st.vehicleNode.next.next.next,this.turnTail=this.root,this.dA=this.root.da,this.gradTail=this.root,this.chevTail=this.root,this.cA=Math.abs(this.root.da);this.turnTail.i<this.root.i+5;)this.turnTail=this.turnTail.next,this.dA+=this.turnTail.da;for(;this.gradTail.i<this.root.i+8;)this.gradTail=this.gradTail.next;for(;this.chevTail.i<this.root.i+4;)this.chevTail=this.chevTail.next,this.cA+=Math.abs(this.chevTail.da);for(;this.root.i<st.vehicleNode.i+25;)this.update()}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}handleMidlineReset(){console.warn("No midline reset handling for SignController")}update(){this.checkPlaceTurnSign(),this.checkPlaceGradientSign(),this.checkPlaceChevron(),this.root=this.root.next}checkPlaceTurnSign(){if(this.dA-=this.root.da,this.turnTail=this.turnTail.next,this.dA+=this.turnTail.da,this.turnDir=this.dA<0?1:-1,Math.abs(this.dA)>.9)if(this.turnTail.i-this.lastTurnIndex>10){if(this.placementNode=this.root.prev.prev.prev,this.placementNode.bridge)return;let s;var e,t,i;if(this.placementNode.da<-.1)s=Rn-(null===(e=this.placementNode.prev)||void 0===e||null===(t=e.prev)||void 0===t||null===(i=t.prev)||void 0===i?void 0:i.a)||this.placementNode.a,this.placementPos.set(this.placementNode.p.x+this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z+this.placementNode.n.z*(this.placementNode.w+1));else s=Rn-this.placementNode.a,this.placementPos.set(this.placementNode.p.x-this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z-this.placementNode.n.z*(this.placementNode.w+1));this.turnTail.i>=this.lastSignIndex&&this.turnTail.i-this.lastSignIndex<5&&this.combineWithLastGradSign(this.turnTail.i,s),this.lastTurnType=this.turnDir<0?hs:os,this.lastTurnIndex=this.turnTail.i,this.lastTurnGeo=Xs.addObject(Us.WarningSign,this.placementPos,s,this.placementNode.i,this.lastTurnType),this.lastSignIndex=this.turnTail.i,this.lastSignPos.copy(this.placementPos),this.lastSignRot=s}else this.lastTurnGeo&&(this.turnDir>0&&this.lastTurnType==hs?(this.lastTurnIndex=this.turnTail.i,this.lastTurnType=ls,this.lastTurnGeo.setVariant(ls)):this.turnDir<0&&this.lastTurnType==os&&(this.lastTurnIndex=this.turnTail.i,this.lastTurnType=ds,this.lastTurnGeo.setVariant(ds)))}combineWithLastGradSign(e,t){this.lastGradGeo&&(this.lastGradGeo.worldPosition.copy(this.placementPos),this.lastGradGeo.worldPosition.y-=.65,this.lastGradGeo.updatePosition(),this.lastGradGeo.updateRetireIndex(e),this.lastGradGeo.rotation.y=t)}checkPlaceGradientSign(){var e;if(this.gradTail=this.gradTail.next,this.dH=this.gradTail.p.y-this.root.p.y,this.climbing=this.dH>0,this.dH=Math.abs(this.dH),this.steepness=this.dH>12?this.dH>16?2:1:0,this.taildH=this.gradTail.p.y-this.gradTail.prev.p.y,this.onHill)this.curHillDir>0&&this.taildH<0||this.curHillDir<0&&this.taildH>0?this.onHill=!1:this.steepness>this.curHillSteepness&&(null===(e=this.lastGradGeo)||void 0===e||e.setVariant(this.curHillDir>0?ps:gs));else if(this.steepness>0&&this.gradTail.i-this.lastGradIndex>16){let e,n;if(this.onHill=!0,this.curHillDir=this.climbing?1:-1,this.curHillSteepness=this.steepness,this.gradTail.i-3-this.lastSignIndex<5)this.lastGradIndex=this.lastSignIndex,this.placementPos.copy(this.lastSignPos),this.placementPos.y-=.65,e=this.lastSignRot;else{if(this.lastGradIndex=this.gradTail.i,this.placementNode=this.root.prev.prev.prev,this.placementNode.bridge)return;var t,i,s;if(e=Rn-this.placementNode.a,this.placementNode.da<-.1)this.placementPos.set(this.placementNode.p.x+this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z+this.placementNode.n.z*(this.placementNode.w+1)),e=Rn-(null===(t=this.placementNode.prev)||void 0===t||null===(i=t.prev)||void 0===i||null===(s=i.prev)||void 0===s?void 0:s.a)||this.placementNode.a;else this.placementPos.set(this.placementNode.p.x-this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z-this.placementNode.n.z*(this.placementNode.w+1));this.lastSignIndex=this.gradTail.i,this.lastSignPos.copy(this.placementPos),this.lastSignRot=e}n=this.climbing?this.steepness>1?ps:cs:this.steepness>1?gs:us,this.lastGradGeo=Xs.addObject(Us.WarningSign,this.placementPos,e,this.placementNode.i,n)}}checkPlaceChevron(){if(this.chevTail=this.chevTail.next,this.chevTail.i-this.lastChevIndex<8)return this.cA-=Math.abs(this.root.da),void(this.cA+=Math.abs(this.chevTail.da));if(this.chevDir=this.chevTail.da<0?1:-1,Math.abs(this.chevTail.da)>.6&&this.cA<.6){var e,t;this.placementNode=this.chevTail,Math.abs(this.placementNode.prev.da)>.25&&(this.placementNode=this.placementNode.prev),this.lastChevIndex=this.chevTail.i;let i=Rn-((null===(e=this.placementNode.prev)||void 0===e||null===(t=e.prev)||void 0===t?void 0:t.a)||this.placementNode.a);this.placementPos.set(this.placementNode.p.x-this.placementNode.n.x*(this.placementNode.w+.7)*this.chevDir,this.placementNode.p.y-.6,this.placementNode.p.z-this.placementNode.n.z*(this.placementNode.w+.7)*this.chevDir),Xs.addObject(Us.WarningSign,this.placementPos,i,this.placementNode.i,this.chevDir<0?ms:xs),this.placementNode.ps?(this.placementPos.set(this.placementNode.ps[4].x-this.placementNode.ns[4].x*(this.placementNode.w+.7)*this.chevDir,this.placementNode.ps[4].y-.6,this.placementNode.ps[4].z-this.placementNode.ns[4].z*(this.placementNode.w+.7)*this.chevDir),Xs.addObject(Us.WarningSign,this.placementPos,i,this.placementNode.i,this.chevDir<0?ms:xs),this.placementNode=this.placementNode.prev,this.placementPos.set(this.placementNode.ps[6].x-this.placementNode.ns[6].x*(this.placementNode.w+.7)*this.chevDir,this.placementNode.ps[6].y-.6,this.placementNode.ps[6].z-this.placementNode.ns[6].z*(this.placementNode.w+.7)*this.chevDir),Xs.addObject(Us.WarningSign,this.placementPos,i,this.placementNode.i,this.chevDir<0?ms:xs)):console.warn("Attempting to place chevron without fine points")}this.cA-=Math.abs(this.root.da),this.cA+=Math.abs(this.chevTail.da)}};const Pn=1.5*Math.PI;class Gn extends h.G{constructor(){super(),this.shadowMat=new h.C({transparent:!0,opacity:.33,color:0}),this.waterOffset=.03,this.p=new h.W,this.originPos=new h.W;this.geo=new h.g,this.geo.setIndex(this.getIndex(26)),this.geo.setAttribute("position",new h.o(new Float32Array(156),3)),this.verts=this.geo.attributes.position.array,this.geo.attributes.position.setUsage(h.l);let e=new h.B(this.geo,this.shadowMat);this.add(e)}drawBridge(e){this.originPos.copy(e.p);let t,i,s,n=0,a=e;for(n=0;n<25&&(this.p.copy(a.p).sub(this.originPos),i=a.n,s=a.w+.6,t=6*n,this.verts[t]=this.p.x+i.x*s,this.verts[t+1]=-this.originPos.y+this.waterOffset,this.verts[t+2]=this.p.z+i.z*s,this.verts[t+3]=this.p.x-i.x*s,this.verts[t+4]=-this.originPos.y+this.waterOffset,this.verts[t+5]=this.p.z-i.z*s,a.bridge);n++)a=a.next;this.geo.setDrawRange(0,6*(n-1)),this.geo.attributes.position.needsUpdate=!0,this.geo.computeBoundingSphere()}getIndex(e){let t,i,s,n,a=[];for(let r=0;r<e-1;r++)t=2*r,i=t+1,s=2*(r+1),n=s+1,a.push(t,s,i),a.push(i,s,n);return a}}class Bn extends h.G{constructor(){super(),this.waterOffset=.03,this.wallMaterial=new h.F({color:12303291,side:h.k,flatShading:!0}),this.p=new h.W,this.originPos=new h.W;this.geo=new h.g,this.geo.setIndex(this.getIndex(25)),this.geo.setAttribute("position",new h.o(new Float32Array(312),3)),this.verts=this.geo.attributes.position.array,this.geo.attributes.position.setUsage(h.l);let e=new h.B(this.geo,this.wallMaterial);this.add(e)}drawBridge(e){this.originPos.copy(e.p);let t,i,s,n=0,a=e;for(n=0;n<25&&(this.p.copy(a.p).sub(this.originPos),i=a.n,s=a.w+.6,t=12*n,this.verts[t]=this.p.x+i.x*s,this.verts[t+1]=this.p.y+1,this.verts[t+2]=this.p.z+i.z*s,this.verts[t+3]=this.p.x+i.x*s,this.verts[t+4]=this.p.y-1,this.verts[t+5]=this.p.z+i.z*s,this.verts[t+6]=this.p.x-i.x*s,this.verts[t+7]=this.p.y-1,this.verts[t+8]=this.p.z-i.z*s,this.verts[t+9]=this.p.x-i.x*s,this.verts[t+10]=this.p.y+1,this.verts[t+11]=this.p.z-i.z*s,a.bridge);n++)a=a.next;this.geo.setDrawRange(0,18*(n-1)),this.geo.attributes.position.needsUpdate=!0,this.geo.computeBoundingSphere()}getIndex(e){let t,i,s,n,a,r,h,o,l=[];for(let d=0;d<e;d++)t=4*d,i=t+1,s=t+2,n=t+3,a=4*(d+1),r=a+1,h=a+2,o=a+3,l.push(t,i,a,i,r,a,i,s,r,s,h,r,s,n,h,n,o,h);return l}}var Wn=class{constructor(){this.root=null,this.tail=null,this.shadowPool=[],this.wallPool=[]}initialise(){for(this.root=st.vehicleNode;this.root.i<st.vehicleNode.i+100;)this.update()}getShadowObject(){if(this.shadowPool.length&&!this.shadowPool[0].visible)return this.shadowPool.shift();{let e=new Gn;return this.shadowPool.push(e),e}}getWallObject(){if(this.wallPool.length&&!this.wallPool[0].visible)return this.wallPool.shift();{let e=new Bn;return this.wallPool.push(e),e}}update(){if(this.root.bridge){let e=this.root.next;for(;e.bridge;)e=e.next;let t=e.i-this.root.i,i=this.getWallObject();i.drawBridge(this.root),Xs.addCustom(i,this.root.p,0,this.root.i,-(Ee-10));let s=this.getShadowObject();s.drawBridge(this.root),Xs.addCustom(s,this.root.p,0,e.i,50);let n=(t+1)%2;for(;this.root.bridge;)n%2==0&&Xs.addObject(Us.BridgeSupport,this.root.p,Pn-this.root.a,this.root.i),this.root=this.root.next,n++}this.root=this.root.next}};const En=.04,Zn=new h.L({color:16777215,fog:!1,size:.04,transparent:!0,opacity:0});Zn.userData.headlightPos={value:new h.W},Zn.userData.headlightDir={value:new h.W},Zn.onBeforeCompile=e=>{e.uniforms.headlightPos=Zn.userData.headlightPos,e.uniforms.headlightDir=Zn.userData.headlightDir,e.vertexShader=e.vertexShader.replace("#include <clipping_planes_pars_vertex>","#include <clipping_planes_pars_vertex>\n\n  uniform vec3 headlightPos;\n  uniform vec3 headlightDir;\n\n  varying float vBrightness;\n"),e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n\n\n  vec4 wPos = modelMatrix * vec4(position, 1.0);\n\n  vec3 carDir = headlightPos - wPos.xyz;\n\n  // Distance to catseyes,\n  float carDist = length(carDir);\n\n  if(carDist < 150.0) {\n    // View distance of 150m\n    float distBrightnessFactor = 1.0 - (carDist - 50.0) / 100.0;\n\n    // Check if car is aiming at the light close enough\n    float angleBrightnessFactor = max(0.0, dot(normal, headlightDir));\n\n    // Check\n    float coneBrightnessFactor = dot(headlightDir, normalize(carDir));\n    coneBrightnessFactor = (coneBrightnessFactor - 0.8) / 0.2;\n\n    // NOTE: Could set the road colour here to save on transparency rendering\n    vBrightness = distBrightnessFactor * angleBrightnessFactor * coneBrightnessFactor;\n  } else {\n    vBrightness = 0.0;\n  }\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <clipping_planes_pars_fragment>","#include <clipping_planes_pars_fragment>\n\n\n  varying float vBrightness;\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <alphatest_fragment>","#include <alphatest_fragment>\n\n\n  diffuseColor.a = vBrightness;\n\n")};const Fn={};var Hn=class{constructor(){this.container=new h.G,this.instances=[],this.eyeOffset=0,this.genNode=null,this.seenIndex=0}initInstances(){for(let e=0;e<2;e++)this.instances.push(this.getInstance())}getInstance(){let e=new h.g;e.setAttribute("position",new h.o(new Float32Array(3*this.pointsCount),3)),e.attributes.position.setUsage(h.l),e.setAttribute("normal",new h.o(new Float32Array(3*this.pointsCount),3)),e.attributes.normal.setUsage(h.l);let t=new h.K(e,Zn);return t.visible=!0,t.frustumCulled=!1,t.matrixAutoUpdate=!1,this.container.add(t),t}initialise(){for(this.eyeSpacing=6.25,this.pointsCount=2*Math.ceil(400/this.eyeSpacing),this.eyeOffset=.25*this.eyeSpacing,this.genNode=st.head,this.seenIndex=st.head.i,this.initInstances(),this.prepNextInstance();this.seenIndex<st.vehicleIndex+56;)this.update()}update(){this.seenIndex<st.vehicleIndex+56&&(this.drawNextNode(),this.genNode=this.genNode.next,this.seenIndex=this.genNode.i,this.curInstance.userData.retireIndex<=st.vehicleIndex&&(this.curInstance.visible=!1)),Zn.userData.headlightDir.value.copy(T.fwd).negate(),Zn.userData.headlightPos.value.copy(T.frontAxlePosition),Zn.uniformsNeedUpdate=!0}drawNextNode(){this.eyeOffset>=0&&this.eyeOffset<10&&(Fn.placementDist=this.eyeOffset,Fn.psA=Math.max(0,Math.floor(Fn.placementDist)),Fn.pa=this.genNode.ps[Fn.psA],Fn.psA<9?Fn.pb=this.genNode.ps[Fn.psA+1]:Fn.pb=this.genNode.next.ps[0],Fn.pLerp=Fn.placementDist-Fn.psA,Fn.p={x:Fn.pa.x*(1-Fn.pLerp)+Fn.pb.x*Fn.pLerp,y:Fn.pa.y*(1-Fn.pLerp)+Fn.pb.y*Fn.pLerp,z:Fn.pa.z*(1-Fn.pLerp)+Fn.pb.z*Fn.pLerp},Fn.n=this.genNode.ns[Fn.psA],Fn.nn={x:Fn.n.x,z:Fn.n.z},this.curNormArr[this.curIndex]=-Fn.n.z,this.curPosArr[this.curIndex++]=Fn.p.x+Fn.nn.x*En-this.curInstanceOffset.x,this.curNormArr[this.curIndex]=0,this.curPosArr[this.curIndex++]=Fn.p.y+.03-this.curInstanceOffset.y,this.curNormArr[this.curIndex]=Fn.n.x,this.curPosArr[this.curIndex++]=Fn.p.z+Fn.nn.z*En-this.curInstanceOffset.z,this.curNormArr[this.curIndex]=-Fn.n.z,this.curPosArr[this.curIndex++]=Fn.p.x-Fn.nn.x*En-this.curInstanceOffset.x,this.curNormArr[this.curIndex]=0,this.curPosArr[this.curIndex++]=Fn.p.y+.03-this.curInstanceOffset.y,this.curNormArr[this.curIndex]=Fn.n.x,this.curPosArr[this.curIndex++]=Fn.p.z-Fn.nn.z*En-this.curInstanceOffset.z,this.curIndex>this.maxIndex-6&&this.cycleInstances(),this.eyeOffset=Fn.placementDist),this.eyeOffset=this.eyeOffset+this.eyeSpacing,this.eyeOffset<10?this.drawNextNode():this.eyeOffset-=10}cycleInstances(){this.curInstance.geometry.attributes.position.needsUpdate=!0,this.curInstance.geometry.attributes.normal.needsUpdate=!0,this.curInstance.updateMatrix(),this.curInstance.visible=!0,this.curInstance.userData.retireIndex=this.genNode.i+3,this.instances.push(this.instances.shift()),this.prepNextInstance()}prepNextInstance(){this.curInstance=this.instances[0],this.curPosArr=this.curInstance.geometry.attributes.position.array,this.curNormArr=this.curInstance.geometry.attributes.normal.array,this.curInstanceOffset={x:0,y:0,z:0},this.genNode&&(this.curInstanceOffset=this.genNode.p),this.curInstance.position.copy(this.curInstanceOffset),this.curIndex=0,this.maxIndex=3*this.pointsCount}};const Qn={},Yn=2*Math.PI;var Vn=class extends ut{constructor(...e){super(...e),this.gradients=[],this.heightOffset=150,this.heightInitial=1,this.resolution=2,this.depth=3,this.upscale=5,this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=12,this.cellScaleMetres=1500,this.cellScaleWorld=1500,this.squared=!1,this.compound=!1,this.useQuick=!1,this.resolutions=[],this.smooth=!1;let t=e[1]||{};if(this.seed=e[0]||"foliage",this.heightScale=t.heightScale||1,this.heightInitial="heightInitial"in t?t.heightInitial:1,this.resolution=t.resolution||5,this.depth=t.depth||3,this.upscale=t.upscale||3,this.heightOffset=t.heightOffset||0,this.upscaleFactor=t.upscaleFactor||2,this.squared=t.squared||!1,this.squareLayers=t.squareLayers||this.depth,this.compound=t.compound||!1,this.threshold=t.threshold||.7,this.threshold2=t.threshold2||.8,this.threshold3=t.threshold3||.9,this.smooth=!!t.smooth,this.gap1=this.threshold2-this.threshold,this.gap2=this.threshold3-this.threshold2,this.gap3=1-this.threshold3,null!=t.resolutions)this.resolutions=t.resolutions,this.resolution=this.resolutions[0],this.depth=this.resolutions.length;else{this.resolutions=[this.resolution];for(let e=0;e<this.depth-1;e++)this.resolutions.push(this.calculateNextDepthResolution(this.resolutions[e],e))}this.cellScaleWorld=this.cellScaleMetres}generateCell(e,t){let i,s,n,a,r=new window.alea(this.seed+e+t),h=this.resolution,o=[],l=[];for(i=0;i<this.depth;i++){for(l=[],s=0;s<h;s++)for(l.push([]),n=0;n<h;n++)a=r()*Yn,l[s].push({x:Math.cos(a),y:Math.sin(a)});o.push(l),h=this.getNextDepthResolution(h,i)}return o}calculateNextDepthResolution(e,t){return Math.round(e*this.upscaleFactor)}getNextDepthResolution(e,t){return this.resolutions[t+1]}dotGridGradient(e,t,i,s,n){return this.grad=e[t][i],(s-t)*this.grad.x+(n-i)*this.grad.y}sharpLerp(e,t,i){return(t-e)*i+e}smoothLerp(e,t,i){return(t-e)*(3-2*i)*i*i+e}smootherLerp(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}getXZ(e,t,i){for(Qn.layer of(Qn.d=0,Qn.h=0,Qn.sq=this.resolution,Qn.sqb=Qn.sq-1,Qn.wx=e/this.cellScaleWorld,Qn.wz=t/this.cellScaleWorld,Qn.ox=Math.floor(Qn.wx),Qn.oz=Math.floor(Qn.wz),Qn.px=Qn.wx-Qn.ox,Qn.pz=Qn.wz-Qn.oz,Qn.cell=this.getCell(Qn.ox,Qn.oz),i=i||this.depth,Qn.depth=0,Qn.h=this.heightInitial,Qn.heightFactor=1,Qn.ch=0,Qn.cell)){if(Qn.depth==i)break;Qn.sx=Qn.px*Qn.sq,Qn.sz=Qn.pz*Qn.sq,Qn.ix=Math.floor(Qn.sx),Qn.ix1=Qn.ix+1,Qn.iz=Math.floor(Qn.sz),Qn.iz1=Qn.iz+1,Qn.qx=Qn.sx-Qn.ix,Qn.qz=Qn.sz-Qn.iz,Qn.n0=this.dotGridGradient(Qn.layer,Qn.ix,Qn.iz,Qn.sx,Qn.sz),Qn.ix1<Qn.sq?Qn.n1=this.dotGridGradient(Qn.layer,Qn.ix1,Qn.iz,Qn.sx,Qn.sz):Qn.n1=this.dotGridGradient(this.getCell(Qn.ox+1,Qn.oz)[Qn.depth],0,Qn.iz,Qn.sx-Qn.sq,Qn.sz),Qn.int0=this.sharpLerp(Qn.n0,Qn.n1,Qn.qx),Qn.iz1<Qn.sq?(Qn.n0=this.dotGridGradient(Qn.layer,Qn.ix,Qn.iz1,Qn.sx,Qn.sz),Qn.ix1<Qn.sq?Qn.n1=this.dotGridGradient(Qn.layer,Qn.ix1,Qn.iz1,Qn.sx,Qn.sz):Qn.n1=this.dotGridGradient(this.getCell(Qn.ox+1,Qn.oz)[Qn.depth],0,Qn.iz1,Qn.sx-Qn.sq,Qn.sz)):(Qn.n0=this.dotGridGradient(this.getCell(Qn.ox,Qn.oz+1)[Qn.depth],Qn.ix,0,Qn.sx,Qn.sz-Qn.sq),Qn.ix1<Qn.sq?Qn.n1=this.dotGridGradient(this.getCell(Qn.ox,Qn.oz+1)[Qn.depth],Qn.ix1,0,Qn.sx,Qn.sz-Qn.sq):Qn.n1=this.dotGridGradient(this.getCell(Qn.ox+1,Qn.oz+1)[Qn.depth],0,0,Qn.sx-Qn.sq,Qn.sz-Qn.sq)),Qn.int1=this.sharpLerp(Qn.n0,Qn.n1,Qn.qx),Qn.heightFactor=1/(Qn.depth+1),Qn.h+=this.sharpLerp(Qn.int0,Qn.int1,Qn.qz)*Qn.heightFactor,Qn.sq=this.getNextDepthResolution(Qn.sq,Qn.depth),Qn.depth++}return this.squared&&(Qn.h<0?Qn.h*=-Qn.h*(1+Qn.h)*4:Qn.h*=Qn.h*(1-Qn.h)*4),Qn.h=Qn.h*this.heightScale+this.heightOffset,this.smooth?Qn.h>this.threshold?Qn.h>this.threshold3?2+(Qn.h-this.threshold3)/this.gap3:Qn.h>this.threshold2?1+(Qn.h-this.threshold2)/this.gap2:(Qn.h-this.threshold)/this.gap1:(Qn.h,0):Qn.h>this.threshold?Qn.h>this.threshold3?3:Qn.h>this.threshold2?2:1:0}getXZLayer(e,t,i){for(Qn.layer of(Qn.d=0,Qn.h=0,Qn.sq=this.resolution,Qn.sqb=Qn.sq-1,Qn.wx=e/this.cellScaleWorld,Qn.wz=t/this.cellScaleWorld,Qn.ox=Math.floor(Qn.wx),Qn.oz=Math.floor(Qn.wz),Qn.px=Qn.wx-Qn.ox,Qn.pz=Qn.wz-Qn.oz,Qn.cell=this.getCell(Qn.ox,Qn.oz),Qn.depth=0,Qn.h=this.heightInitial,Qn.heightFactor=1,Qn.ch=0,Qn.cell))if(Qn.depth<i)Qn.sq=this.getNextDepthResolution(Qn.sq,Qn.depth),Qn.depth++;else{if(Qn.depth==this.depth||Qn.depth>i)break;Qn.sx=Qn.px*Qn.sq,Qn.sz=Qn.pz*Qn.sq,Qn.ix=Math.floor(Qn.sx),Qn.ix1=Qn.ix+1,Qn.iz=Math.floor(Qn.sz),Qn.iz1=Qn.iz+1,Qn.qx=Qn.sx-Qn.ix,Qn.qz=Qn.sz-Qn.iz,Qn.n0=this.dotGridGradient(Qn.layer,Qn.ix,Qn.iz,Qn.sx,Qn.sz),Qn.ix1<Qn.sq?Qn.n1=this.dotGridGradient(Qn.layer,Qn.ix1,Qn.iz,Qn.sx,Qn.sz):Qn.n1=this.dotGridGradient(this.getCell(Qn.ox+1,Qn.oz)[Qn.depth],0,Qn.iz,Qn.sx-Qn.sq,Qn.sz),Qn.int0=this.smootherLerp(Qn.n0,Qn.n1,Qn.qx),Qn.iz1<Qn.sq?(Qn.n0=this.dotGridGradient(Qn.layer,Qn.ix,Qn.iz1,Qn.sx,Qn.sz),Qn.ix1<Qn.sq?Qn.n1=this.dotGridGradient(Qn.layer,Qn.ix1,Qn.iz1,Qn.sx,Qn.sz):Qn.n1=this.dotGridGradient(this.getCell(Qn.ox+1,Qn.oz)[Qn.depth],0,Qn.iz1,Qn.sx-Qn.sq,Qn.sz)):(Qn.n0=this.dotGridGradient(this.getCell(Qn.ox,Qn.oz+1)[Qn.depth],Qn.ix,0,Qn.sx,Qn.sz-Qn.sq),Qn.ix1<Qn.sq?Qn.n1=this.dotGridGradient(this.getCell(Qn.ox,Qn.oz+1)[Qn.depth],Qn.ix1,0,Qn.sx,Qn.sz-Qn.sq):Qn.n1=this.dotGridGradient(this.getCell(Qn.ox+1,Qn.oz+1)[Qn.depth],0,0,Qn.sx-Qn.sq,Qn.sz-Qn.sq)),Qn.int1=this.smootherLerp(Qn.n0,Qn.n1,Qn.qx),Qn.heightFactor=this.resolution/Qn.sq,this.compound&&(Qn.heightFactor*=Qn.h),Qn.h+=this.smootherLerp(Qn.int0,Qn.int1,Qn.qz)*Qn.heightFactor,Qn.sq=this.getNextDepthResolution(Qn.sq,Qn.depth),Qn.depth++}return this.squared&&(Qn.h*=Qn.h),Qn.h+=Qn.ch,Qn.h*this.heightScale+this.heightOffset}smootherLerpW(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpW(e){return 1-e}smoothLerpW(e){return-1*(3-2*e)*e*e+1}};const Un={layer:0,d:0,h:0,sq:0,sqb:0,wx:0,wz:0,ox:0,oz:0,px:0,pz:0,cell:null,ix:0,iz:0,depth:0},Xn={...Un};var Jn=class extends ut{constructor(...e){super(...e),this.resolution=5,this.depth=3,this.upscale=2,this.heightScale=1,this.heightOffset=0,this.upscaleType=0,this.controls=[],this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=9,this.qCache={},this.smoothingFunc=()=>{},this.useQuick=!1;let t=e[1]||{};switch(null!==t.heightScale&&(this.heightScale=t.heightScale),null!==t.resolution&&(this.resolution=t.resolution),this.seed=e[0]||gt,this.depth=t.depth||3,this.radiusType=null==t.radiusType?1:t.radiusType,this.upscale=t.upscale||2,this.upscaleType=null==t.upscaleType?0:t.upscaleType,this.upscaleFactor=null==t.upscaleFactor?2:t.upscaleFactor,this.threshold=t.threshold,this.threshold2=t.threshold2,this.threshold3=t.threshold3,this.squared=t.squared||!1,this.compound=t.compound||!1,this.depthHeightFactor=t.depthHeightFactor||1,this.smoothLerpIndex=null==t.smoothLerp?2:t.smoothLerp,this.smoothLerpIndex){case 2:this.smoothingFunc=this.smootherLerp;break;case 1:this.smoothingFunc=this.smoothLerp;break;case 0:default:this.smoothingFunc=this.sharpLerp}if(null!=t.resolutions)this.resolutions=t.resolutions,this.resolution=this.resolutions[0],this.depth=this.resolutions.length;else{this.resolutions=[this.resolution];for(let e=0;e<this.depth-1;e++)this.resolutions.push(this.calculateNextDepthResolution(this.resolutions[e],e))}this.controls=[],this.cellScaleMetres=1e3,this.cellScaleWorld=3e3,this.heightOffset=t.heightOffset}cosLerp(e){return Math.cos(3.1415*e)+1}sharpLerp(e){return 1-e}smoothLerp(e){return-1*(3-2*e)*e*e+1}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpAB(e,t,i){return(t-e)*i+e}smootherLerpAB(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}lerpHeight(e,t,i,s){return(e=(s.x-t)*(s.x-t)+(s.z-i)*(s.z-i))<s.r2?this.sharpLerp(e/s.r2)*s.y:0}clearCache(){if(this.cacheCount<=this.maxCached)return;let e,t;for(e in this.cache){for(t in this.cache[e])if(this.cacheAccess[e][t])this.cacheAccess[e][t]=!1;else if(delete this.cache[e][t],delete this.cacheAccess[e][t],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}}cacheCell(e,t){let i;this.cacheCount++,this.clearCache();let s=[],n=1,a=new window.alea(this.seed+e+t),r=this.resolution,h=[],o=this.depthHeightFactor;for(i=0;i<this.depth;i++){let e,t,l,d,c;for(r=this.resolutions[i],n=this.resolution/r*o,o*=this.depthHeightFactor,h=[],c=1/r,t=0;t<r;t++){for(e=[],l=0;l<r;l++)d=2*a()-1,this.squared&&(d*=d<0?-d*(1+d)*4:d*(1-d)*4),d*=n,e.push({x:(t+.5)/r,y:d*this.heightScale,z:(l+.5)/r,r:c,r2:c*c});h.push(e)}s.push(h)}e in this.cache||(this.cache[e]={}),this.cache[e][t]=s}calculateNextDepthResolution(e,t){switch(this.upscaleType){case 5:let i,s=this.resolution,n=this.resolution;for(let e=0;e<t+1;e++)i=s+n,n=s,s=i;return i;case 4:return e*this.upscaleFactor+(t+1);case 3:return Math.round(e*this.upscaleFactor);case 2:return Math.pow(this.resolution,t+2);case 1:return this.resolution+Math.pow(this.upscale,t+1);case 0:default:return e+this.upscale*(t+1)}}getNextDepthResolution(e,t){return this.resolutions[t+1]}getResolution(e,t){return this.resolutions[t]}getNode(e,t,i,s){}getCell(e,t){return e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e][t]}getQuickCell(e,t){return this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.qCache[e]&&this.qCache[e][t]||this.quickCache(e,t,this.cache[e][t][this.depth-1]),this.qCache[e][t]}quickCache(e,t,i){if(e in this.qCache){if(t in this.qCache[e])return}else this.qCache[e]={};let s=[];this.useQuick=!1;for(let n of i){let i=[];for(let s of n)i.push({x:s.x,y:this.getXZ((e+s.x)*this.cellScaleWorld,(t+s.z)*this.cellScaleWorld),z:s.z,r:s.r,r2:s.r2});s.push(i)}this.useQuick=!0,this.qCache[e][t]=s}getXZQuick(e,t){let i,s,n,a,r,h;return Xn.d=0,Xn.h=0,Xn.wx=e/this.cellScaleWorld,Xn.wz=t/this.cellScaleWorld,Xn.ox=Math.floor(Xn.wx),Xn.oz=Math.floor(Xn.wz),Xn.px=Xn.wx-Xn.ox,Xn.pz=Xn.wz-Xn.oz,Xn.layer=this.getQuickCell(Xn.ox,Xn.oz),Xn.sq=this.getResolution(this.resolution,this.depth-1),Xn.sqb=Xn.sq-1,Xn.ssq=Xn.sq,Xn.ssqb=Xn.sqb,i=Xn.px*Xn.sq-.5,Xn.ix=Math.floor(Xn.px*Xn.sq-.5),s=Xn.pz*Xn.sq-.5,Xn.iz=Math.floor(Xn.pz*Xn.sq-.5),i-=Xn.ix,s-=Xn.iz,Xn.ix>=0?(n=Xn.iz>=0?Xn.layer[Xn.ix][Xn.iz].y:this.getQuickCell(Xn.ox,Xn.oz-1)[Xn.ix][Xn.sqb].y,a=Xn.iz<Xn.ssqb?Xn.layer[Xn.ix][Xn.iz+1].y:this.getQuickCell(Xn.ox,Xn.oz+1)[Xn.ix][0].y):(n=Xn.iz>=0?this.getQuickCell(Xn.ox-1,Xn.oz)[Xn.sqb][Xn.iz].y:this.getQuickCell(Xn.ox-1,Xn.oz-1)[Xn.sqb][Xn.sqb].y,a=Xn.iz<Xn.ssqb?this.getQuickCell(Xn.ox-1,Xn.oz)[Xn.sqb][Xn.iz+1].y:this.getQuickCell(Xn.ox-1,Xn.oz+1)[Xn.sqb][0].y),Xn.ix<Xn.ssqb?(r=Xn.iz>=0?Xn.layer[Xn.ix+1][Xn.iz].y:this.getQuickCell(Xn.ox,Xn.oz-1)[Xn.ix+1][Xn.sqb].y,h=Xn.iz<Xn.ssqb?Xn.layer[Xn.ix+1][Xn.iz+1].y:this.getQuickCell(Xn.ox,Xn.oz+1)[Xn.ix+1][0].y):(r=Xn.iz>=0?this.getQuickCell(Xn.ox+1,Xn.oz)[0][Xn.iz].y:this.getQuickCell(Xn.ox+1,Xn.oz-1)[0][Xn.sqb].y,h=Xn.iz<Xn.ssqb?this.getQuickCell(Xn.ox+1,Xn.oz)[0][Xn.iz+1].y:this.getQuickCell(Xn.ox+1,Xn.oz+1)[0][0].y),n=this.sharpLerpAB(n,a,s),r=this.sharpLerpAB(r,h,s),this.sharpLerpAB(n,r,i)}getXZLayer(e,t,i){Un.layer=0,Un.d=0,Un.h=0,Un.sq=this.resolution,Un.sqb=Un.sq-1,Un.wx=e/this.cellScaleWorld,Un.wz=t/this.cellScaleWorld,Un.ox=Math.floor(Un.wx),Un.oz=Math.floor(Un.wz),Un.px=Un.wx-Un.ox,Un.pz=Un.wz-Un.oz,Un.cell=this.getCell(Un.ox,Un.oz);let s=this.depth;Un.depth=0;let n=0;for(Un.layer of Un.cell)if(n++===i){if(Un.depth==s)break;Un.ix=Math.floor(Un.px*Un.sq-.5),Un.iz=Math.floor(Un.pz*Un.sq-.5),Un.th=0,Un.ix>=0?(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz+1,this.getCell(Un.ox,Un.oz-1)[Un.depth][Un.ix][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz-1,this.getCell(Un.ox,Un.oz+1)[Un.depth][Un.ix][0])):(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz,this.getCell(Un.ox-1,Un.oz)[Un.depth][Un.sqb][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz+1,this.getCell(Un.ox-1,Un.oz-1)[Un.depth][Un.sqb][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz,this.getCell(Un.ox-1,Un.oz)[Un.depth][Un.sqb][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz-1,this.getCell(Un.ox-1,Un.oz+1)[Un.depth][Un.sqb][0])),Un.ix<Un.sqb?(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix+1][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz+1,this.getCell(Un.ox,Un.oz-1)[Un.depth][Un.ix+1][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix+1][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz-1,this.getCell(Un.ox,Un.oz+1)[Un.depth][Un.ix+1][0])):(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz,this.getCell(Un.ox+1,Un.oz)[Un.depth][0][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz+1,this.getCell(Un.ox+1,Un.oz-1)[Un.depth][0][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz,this.getCell(Un.ox+1,Un.oz)[Un.depth][0][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz-1,this.getCell(Un.ox+1,Un.oz+1)[Un.depth][0][0])),Un.h+=Un.th,Un.depth++,Un.sq=this.resolutions[Un.depth],Un.sqb=Un.sq-1}else Un.depth++,Un.sq=this.resolutions[Un.depth],Un.sqb=Un.sq-1;return Un.h+this.heightOffset}getXZ(e,t,i){for(Un.layer of(Un.d=0,Un.h=0,Un.heightFactor=1,Un.sq=this.resolution,Un.sqb=Un.sq-1,Un.wx=e/this.cellScaleWorld,Un.wz=t/this.cellScaleWorld,Un.ox=Math.floor(Un.wx),Un.oz=Math.floor(Un.wz),Un.px=Un.wx-Un.ox,Un.pz=Un.wz-Un.oz,Un.cell=this.getCell(Un.ox,Un.oz),i=i||this.depth,Un.depth=0,Un.cell)){if(Un.depth==i)break;Un.ix=Math.floor(Un.px*Un.sq-.5),Un.iz=Math.floor(Un.pz*Un.sq-.5),Un.th=0,Un.ix>=0?(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz+1,this.getCell(Un.ox,Un.oz-1)[Un.depth][Un.ix][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz-1,this.getCell(Un.ox,Un.oz+1)[Un.depth][Un.ix][0])):(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz,this.getCell(Un.ox-1,Un.oz)[Un.depth][Un.sqb][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz+1,this.getCell(Un.ox-1,Un.oz-1)[Un.depth][Un.sqb][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz,this.getCell(Un.ox-1,Un.oz)[Un.depth][Un.sqb][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px+1,Un.pz-1,this.getCell(Un.ox-1,Un.oz+1)[Un.depth][Un.sqb][0])),Un.ix<Un.sqb?(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix+1][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz+1,this.getCell(Un.ox,Un.oz-1)[Un.depth][Un.ix+1][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz,Un.layer[Un.ix+1][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px,Un.pz-1,this.getCell(Un.ox,Un.oz+1)[Un.depth][Un.ix+1][0])):(Un.iz>=0?Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz,this.getCell(Un.ox+1,Un.oz)[Un.depth][0][Un.iz]):Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz+1,this.getCell(Un.ox+1,Un.oz-1)[Un.depth][0][Un.sqb]),Un.iz<Un.sqb?Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz,this.getCell(Un.ox+1,Un.oz)[Un.depth][0][Un.iz+1]):Un.th+=this.lerpHeight(Un.d,Un.px-1,Un.pz-1,this.getCell(Un.ox+1,Un.oz+1)[Un.depth][0][0])),Un.h+=Un.th,Un.depth++,Un.sq=this.resolutions[Un.depth],Un.sqb=Un.sq-1}return Un.h+=this.heightOffset,Un.h>this.threshold?Un.h>this.threshold3?(Un.th*=Un.th,Un.th>.11?Un.th>.13?2:1:0):Un.h>this.threshold2?1:2:3}};var qn=new class{constructor(){this.lib={trees:{},brush:{}},this.randMaps={trees:[[],[],[]],brush:[]},this.stagedTiles={trees:{},brush:{}},this.hasTrees=!0,this.hasGrass=!0,this.rand=new window.alea(Ve),this.rands=[],this.randIndex=0,this.farTreeInstancePool=[],this.buildLibrary(),this.buildRandMaps(),this.buildRands()}buildMap(e){this.treeMap=new Jn(Ve,e),this.grassMap=new Vn(Ve,{heightScale:2,heightOffset:.5,heightInitial:0,resolutions:[5],threshold:.05,threshold2:.25,threshold3:.5,smooth:!0})}buildRandMaps(){let e,t,i;for(e=1;e<=8;e++)for(i=0;i<this.randMaps.trees.length;i++){let e=[],s=Math.ceil(1.4*(i+this.rand())),n=.05,a=1-2*n;for(t=0;t<s;t++)e.push(n+this.rand()*a,n+this.rand()*a);this.randMaps.trees[i].push(e)}}buildRands(){for(let e=0;e<101;e++)this.rands.push(this.rand())}getRand(){return this.randIndex>=this.rands.length&&(this.randIndex=0),this.rands[this.randIndex++]}getTreesAt(e,t){return this.t=this.treeMap.getXZ(e,t),this.t?this.getSeededTreeMap(this.t,(e+t)/10):null}getSeededTreeMap(e,t){return this.randMaps.trees[e-1][7&t]}getTreeMap(e){return this.randMaps.trees[e-1][Math.floor(8*this.getRand())]}buildLibrary(){let e=new h.g,t=new Float32Array([-.5,0,0,-.5,1,0,.5,1,0,.5,0,0,0,0,.5,0,1,.5,0,1,-.5,0,0,-.5]);e.setAttribute("position",new h.o(t,3));let i=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]);e.setAttribute("normal",new h.o(i,3));let s=new Float32Array([0,0,0,.49,.5,.49,.5,0,0,0,0,.49,.5,.49,.5,0]);e.setAttribute("uv",new h.o(s,2));e.setIndex([0,1,2,0,2,3,4,5,6,4,6,7]),this.baseGeo=e;let n=e.clone();n.scale(8,8,8),this.lib.trees.far={geo:n,mat:Pi[0]};let a=e.clone(),r=new Float32Array([0,0,0,.49,.25,.49,.25,0,.25,0,.25,.49,.5,.49,.5,0]);a.setAttribute("uv",new h.o(r,2));let o=a.clone();o.scale(8,8,8),this.lib.trees.near={geo:o,mat:Pi[1]};let l=e.clone();l.scale(1.6,1.6,1.6),this.lib.brush.grass={geo:l,mat:Ei[0]};let d=a.clone();d.scale(1.6,1.6,1.6),this.lib.brush.bush={geo:d,mat:Ei[1]}}getGrassInstance(e){let t=new h.u(this.lib.brush.grass.geo.clone(),this.lib.brush.grass.mat,e);return t.matrixAutoUpdate=!1,t.geometry.setAttribute("variant",new h.t(new Float32Array(e),1)),t.instanceVariant=t.geometry.attributes.variant,t.instanceVariant.setUsage(h.l),t.geometry.setAttribute("shadow",new h.t(new Float32Array(e),1)),t.instanceShadow=t.geometry.attributes.shadow,t.instanceShadow.setUsage(h.l),t.position.y=-.1,t.instanceMatrix.setUsage(h.l),t}getBushInstance(e){let t=new h.u(this.lib.brush.bush.geo.clone(),this.lib.brush.bush.mat,e);return t.matrixAutoUpdate=!1,t.geometry.setAttribute("variant",new h.t(new Float32Array(e),1)),t.instanceVariant=t.geometry.attributes.variant,t.instanceVariant.setUsage(h.l),t.geometry.setAttribute("shadow",new h.t(new Float32Array(e),1)),t.instanceShadow=t.geometry.attributes.shadow,t.instanceShadow.setUsage(h.l),t.position.y=-.1,t.instanceMatrix.setUsage(h.l),t}prepareTreeInstance(e,t,i=!0){e.geometry.setAttribute("variant",new h.t(new Float32Array(t),1)),e.instanceVariant=e.geometry.attributes.variant,e.instanceVariant.setUsage(h.l),i&&(e.geometry.setAttribute("shadow",new h.t(new Float32Array(t),1)),e.instanceShadow=e.geometry.attributes.shadow,e.instanceShadow.setUsage(h.l)),e.position.y=-.5,e.instanceMatrix.setUsage(h.l)}getNearTreeDetailInstance(e){let t=new h.u(this.lib.trees.detail.geo.clone(),this.lib.trees.detail.mat,e);return t.matrixAutoUpdate=!1,t.frustumCulled=!0,this.prepareTreeInstance(t,e,!1),t}getNearTreeInstance(e){let t=new h.u(this.lib.trees.near.geo.clone(),this.lib.trees.near.mat,e);return t.matrixAutoUpdate=!1,this.prepareTreeInstance(t,e,!1),t}returnFarTreeInstance(e){e.visible=!1,e.count=0,this.farTreeInstancePool.push(e)}getFarTreeInstance(e){if(this.farTreeInstancePool.length)return this.farTreeInstancePool.pop();let t=new h.u(this.lib.trees.far.geo.clone(),this.lib.trees.far.mat,e);return t.matrixAutoUpdate=!1,t.frustumCulled=!0,this.prepareTreeInstance(t,e,!1),t}};const Kn=new h.A;class _n{constructor(){this.initNodeIndex=0,this.retireNodeIndex=-1,this.showNodeIndex=0}}var $n=class{constructor(e,t,i=50,s=null){this.lodInstances=[[],[]],this.stagedInstances=[[],[]],this.activeInstances=[[],[]],this.currentInstances=[],this.minRenderDist=50,this.maxInstanceRange=50,this.debug=!1,this.skipLod=null,this.instanceCounter=0,this.container=new h.G,this.instanceType=e,this.skipLod=s,this.instanceCount=t,this.minRenderDist=i,this.maxInstanceRange=i}revert(e,t){this.instanceCount=e||this.instanceCount,this.minRenderDist=t||this.minRenderDist,this.maxInstanceRange=this.minRenderDist,this.destroy(),this.lodInstances[0].length=0,this.lodInstances[1].length=0,this.stagedInstances[0].length=0,this.stagedInstances[1].length=0,this.activeInstances[0].length=0,this.activeInstances[1].length=0,this.initialise()}reset(){for(let e of this.currentInstances)null!=e&&(e.index=0,e.showNodeIndex=0,e.retireNodeIndex=0,e.initNodeIndex=0,e.mesh.count=0,e.mesh.visible=!1);this.lodInstances[0].length=0,this.lodInstances[1].length=0,this.stagedInstances[0].length=0,this.stagedInstances[1].length=0,this.activeInstances[0].length=0,this.activeInstances[1].length=0}destroy(){this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()})),this.container.clear()}initialise(){0!==this.skipLod&&(ts["instance-"+this.instanceType.typeName+"-0"]=1,this.currentInstances[0]=this.getInstance(st.head.p)),1!==this.skipLod&&(ts["instance-"+this.instanceType.typeName+"-1"]=1,this.currentInstances[1]=this.getInstance(st.head.p))}initInstance(e){}getInstance(e=null){let t=new this.instanceType;return t.mesh.matrixAutoUpdate=!1,e&&(t.mesh.position.copy(e),t.mesh.updateMatrix()),t.mesh.visible=!1,t.iid=this.instanceCounter++,this.container.add(t.mesh),t}addInstance(e,t,i,s,n,a=null,r=0){let h=this.currentInstances[e];0==h.index?this.stageInstance(e,h,s,n):h.retireNodeIndex=s+3,Kn.makeTranslation(-h.mesh.position.x,-h.mesh.position.y,-h.mesh.position.z),t.premultiply(Kn),h.mesh.setMatrixAt(h.index,t),h.index++,h.index>=this.instanceCount&&this.cycleInstances(e)}stageInstance(e,t,i,s){t.initNodeIndex=i,t.showNodeIndex=i-this.minRenderDist,t.retireNodeIndex=i+this.maxInstanceRange+3,t.mesh.position.copy(s),t.mesh.updateMatrix(),this.stagedInstances[e].push(t)}updateInstanceState(e){e.mesh.instanceMatrix.needsUpdate=!0,e.mesh.count=Math.min(this.instanceCount,Math.max(0,e.index))}updateCurrentInstance(e){let t=this.currentInstances[e];st.vehicleIndex>=t.showNodeIndex&&this.updateInstanceState(t)}initialiseVisible(){let e,t;do{e=this.stagedInstances[0].length,t=this.stagedInstances[1].length,this.updateVisible()}while(e!=this.stagedInstances[0].length||t!==this.stagedInstances[1].length)}updateVisible(){0!==this.skipLod&&(this.t=this.stagedInstances[0],this.t.length&&st.vehicleIndex>=this.t[0].showNodeIndex&&(this.updateInstanceState(this.t[0]),this.t[0].mesh.visible=!0,this.activeInstances[0].push(this.t.shift())),this.t=this.activeInstances[0],this.t.length&&this.t[0].retireNodeIndex<=st.vehicleIndex&&(this.t[0].mesh.visible=!1,this.lodInstances[0].push(this.activeInstances[0].shift())),this.currentInstances[0].index&&st.vehicleIndex>=this.currentInstances[0].initNodeIndex&&this.cycleInstances(0),ts["instance-"+this.instanceType.typeName+"-0"]=this.activeInstances[0].length+"("+this.stagedInstances[0].length+")"),1!==this.skipLod&&(this.t=this.stagedInstances[1],this.t.length&&st.vehicleIndex>=this.t[0].showNodeIndex&&(this.updateInstanceState(this.t[0]),this.t[0].mesh.visible=!0,this.activeInstances[1].push(this.t.shift())),this.t=this.activeInstances[1],this.t.length&&this.t[0].retireNodeIndex<=st.vehicleIndex&&(this.t[0].mesh.visible=!1,this.lodInstances[1].push(this.activeInstances[1].shift())),this.currentInstances[1].index&&st.vehicleIndex>=this.currentInstances[1].initNodeIndex&&this.cycleInstances(1),ts["instance-"+this.instanceType.typeName+"-1"]=this.activeInstances[1].length+"("+this.stagedInstances[1].length+")")}cycleInstances(e){let t=this.currentInstances[e];t.mesh.count!=t.index&&this.updateInstanceState(t),this.lodInstances[e].length?t=this.lodInstances[e].pop():(t=this.getInstance(),ts["instance-"+this.instanceType.typeName+"-"+e]=this.activeInstances[e].length+"("+(this.stagedInstances[e].length+1)+")"),t.index=0,t.mesh.count=0,t.mesh.visible=!1,this.currentInstances[e]=t}};const ea=new h.A;var ta=class extends $n{addInstance(e,t,i,s,n,a=null,r=null){this.temp=this.currentInstances[e],0==this.temp.index?this.stageInstance(e,this.temp,s,n):s>this.temp.retireNodeIndex&&(this.temp.retireNodeIndex=s),ea.makeTranslation(-this.temp.mesh.position.x,-this.temp.mesh.position.y,-this.temp.mesh.position.z),t.premultiply(ea),this.temp.mesh.setMatrixAt(this.temp.index,t),this.temp.mesh.instanceVariant.array[this.temp.index]=i,null!==r&&(this.temp.mesh.instanceShadow.array[this.temp.index]=r),this.temp.index++,this.temp.index>=this.instanceCount&&this.cycleInstances(e,s,n)}updateInstanceState(e){e.mesh.instanceMatrix.needsUpdate=!0,e.mesh.instanceVariant.needsUpdate=!0,e.mesh.instanceShadow&&(e.mesh.instanceShadow.needsUpdate=!0),e.mesh.count=Math.min(this.instanceCount,Math.max(0,e.index))}updateCurrentInstance(e){let t=this.currentInstances[e];st.vehicleIndex>=t.showNodeIndex&&t.mesh.count<t.index&&this.updateInstanceState(t)}cycleInstances(e){let t=this.currentInstances[e];t.retireNodeIndex+=5,t.mesh.count!=t.index&&this.updateInstanceState(t),this.lodInstances[e].length?t=this.lodInstances[e].pop():(t=this.getInstance(),ts["instance-"+this.instanceType.typeName+"-"+e]=this.activeInstances[e].length+"("+this.stagedInstances[e].length+")"),t.index=0,t.mesh.count=0,t.mesh.visible=!1,this.currentInstances[e]=t}};class ia extends _n{constructor(){super(),this.index=0,this.mesh=qn.getNearTreeInstance(zi),this.retireNodeIndex=-1,this.showNodeIndex=0}}ia.typeName="trees";var sa=new ta(ia,zi,Oi,1);class na extends _n{constructor(){super(),this.index=0,this.mesh=qn.getGrassInstance(Bi),this.mesh.receiveShadow=wh.value.detailLodIndex>0,this.retireNodeIndex=-1,this.showNodeIndex=0}}na.typeName="grass";var aa=new ta(na,Bi,Ri);class ra extends _n{constructor(){super(),this.index=0,this.mesh=qn.getBushInstance(Wi),this.mesh.receiveShadow=wh.value.detailLodIndex>1,this.retireNodeIndex=-1,this.showNodeIndex=0}}ra.typeName="bush";var ha=new ta(ra,Wi,Ri,0);const oa={},la=new h.G,da=new Ps(157),ca=new Ps(157,1,.5),pa=new Ps(103,6.28),ua=new Ps(101,4),ga=new Ps(101,.4),ma={};class xa extends ht{constructor(...e){super(...e),this.treeDensity=!1,this.forceTrees=!1,this.trees=[],this.treeMaskCorners=[],this.treeDensity=0,this.renderFoliage=!0}display(...e){super.display(...e),1==this.lod&&this.tileset.mesh.visible&&(aa.updateCurrentInstance(1),ha.updateCurrentInstance(1))}preInitialise(e){var t;if(this.forceTrees=e,this.trees.length=0,this.renderFoliage=wh.value.detailLodIndex>0,ma.treeMask=null===(t=oa[this.farCell.x])||void 0===t?void 0:t[this.farCell.z],!ma.treeMask)return!1;ma.res1=xe+1,ma.treeIndex=this.tileCoords.x*ma.res1+this.tileCoords.z,this.treeMaskCorners[0]=ma.treeMask[ma.treeIndex],this.treeMaskCorners[1]=ma.treeMask[ma.treeIndex+ma.res1],this.treeMaskCorners[2]=ma.treeMask[ma.treeIndex+1],this.treeMaskCorners[3]=ma.treeMask[ma.treeIndex+1+ma.res1],this.treeDensity=this.treeMaskCorners.reduce(((e,t)=>e+t),0)/4;let i=qn.getTreesAt(this.originPos.x,this.originPos.z);if(i){let e,t,s;for(t=0;t<i.length;t+=2)s=pa.next(),e={position:[i[t],i[t+1]],rotation:s,type:Math.round(s/2)},s=it(e.position[0]*Ne+this.originPos.x,e.position[1]*Ne+this.originPos.z,this.originNode,!1),s.e=Ge+Math.abs(s.da),s.d-(s.w+s.e)>2&&this.trees.push(e)}else if(this.originNode.dswl||this.originNode.dswr){let e=it(this.originPos.x+5,this.originPos.z+5,this.originNode);if(e.d<e.w+4&&(e.s>0&&this.originNode.dswl||e.s<0&&this.originNode.dswr)){let t=(e.w+2-e.d)/10;t>0&&t<.2&&this.trees.push({position:[.5-t*this.originNode.n.x*e.s,.5-t*this.originNode.n.z*e.s],rotation:15*t,type:Math.floor(12*t)})}}return!0}postProcessRow(e){this.placeGrassRow(e)}postProcessCell(){if(0==this.lod||this.forceTrees){let e,t,i;for(let s of this.trees)e=Math.floor(s.position[0]*this.res),t=Math.floor(s.position[1]*this.res),i=e*this.res1+t,this.grads[i]<.2&&this.heights[i]>1&&(la.position.set((this.coords.x+s.position[0])*Ne,this.heights[i]-(.5+this.grads[i]),(this.coords.z+s.position[1])*Ne),ma.tms=.15*(3*this.treeDensity-1)+1,ma.hb=ma.tms+(ga.next()-.2)*ma.tms,la.scale.set(ma.hb,ma.hb,ma.hb),la.rotation.y=s.rotation,la.updateMatrix(),sa.addInstance(0,la.matrix,s.type,this.originIndex,la.position))}}nearestTreeDist(e,t){let i,s=-1;for(let n of this.trees)i=(n.position[0]-e)*(n.position[0]-e)+(n.position[1]-t)*(n.position[1]-t),(i<s||s<0)&&(s=i);return s}placeGrassRow(e){for(ma.j=0;ma.j<=this.res;ma.j++)if(ma.ind=e*this.res1+ma.j,ma.h=this.heights[ma.ind],ma.r=this.signedRoadProx[ma.ind],ma.n=[this.norms[3*ma.ind],this.norms[3*ma.ind+1],this.norms[3*ma.ind+2]],ma.az=e/this.res,ma.ax=ma.j/this.res,ma.ma=this.treeMaskCorners[2]*ma.ax+this.treeMaskCorners[0]*(1-ma.ax),ma.mb=this.treeMaskCorners[3]*ma.ax+this.treeMaskCorners[1]*(1-ma.ax),ma.tm=ma.mb*ma.az+ma.ma*(1-ma.az),ma.r<2&&(ma.tm*=ma.r/2),this.treeMask[ma.ind]=ma.tm,this.renderFoliage&&(ma.grassProb=ma.j<this.res1&&ma.r>.2&&ma.r<20?ma.h>2?this.grads[ma.ind]<.2?1:.4-this.grads[ma.ind]:ma.h-1:0,ma.grassProb>da.next())){if(ma.r<Ge?ma.h-=Ge-ma.r:ma.h-=ma.r/20,la.position.set((this.coords.x+ma.az)*Ne+ca.next(),ma.h-this.grads[ma.ind]/2+.2*ca.next(),(this.coords.z+ma.ax)*Ne+ca.next()),la.rotation.y=pa.next(),ma.treeProx=this.nearestTreeDist(ma.az,ma.ax),ma.treeProx<0?ma.treeProx=0:(ma.treeProx=.25-Math.min(.25,ma.treeProx/.25),ma.r<4&&(ma.treeProx*=ma.r/4)),this.treeMask[ma.ind]=Math.max(this.treeMask[ma.ind],4*ma.treeProx),ma.treeProx=this.treeMask[ma.ind]/2+Math.abs(this.grads[ma.ind]/2),ma.bushProb=this.treeDensity+.008,ma.bushProb<.5&&(this.originNode.dswl||this.originNode.dswr)&&ma.r>1&&ma.r<1.6&&(ma.side=-this.originNode.n.z*(this.originPos.z+10*ma.az-this.originNode.p.z)-this.originNode.n.x*(this.originPos.x+10*ma.ax-this.originNode.p.x),(this.originNode.dswl&&ma.side>0||this.originNode.dswr&&ma.side<0)&&(ma.bushProb+=.33),ma.bushProb>1&&(ma.bushProb=1)),ma.r<.5||ma.r>4?ma.bushProb=0:ma.r<1?ma.bushProb*=4*(ma.r-.5):ma.r<2?ma.bushProb*=2:ma.r<4&&(ma.bushProb*=4-ma.r),ma.bushProb*=.25,1==this.lod&&ma.bushProb>Math.random()){la.scale.x=la.scale.y=la.scale.z=Math.min(ma.r,1+this.treeDensity*ga.next()),la.rotation.y=pa.next(),la.updateMatrix(),ha.addInstance(1,la.matrix,Math.floor(ua.next()),this.originIndex,la.position,ma.n,ma.treeProx);continue}la.scale.y=1,ma.r>1?ma.r>2?la.scale.y+=.5*this.treeDensity:la.scale.y+=(ma.r-1)*this.treeDensity*.5:la.scale.y=Math.max(.75,ma.r),la.scale.x=la.scale.z=la.scale.y,la.updateMatrix(),aa.addInstance(this.lod,la.matrix,ma.r,this.originIndex,la.position,ma.n,ma.treeProx)}}}xa.paved=!0;var va=xa;const wa={size:1e3,nodes:[[0,0],[200,0],[400,0],[600,0],[750,0],[1e3,0],[0,200],[200,100],[400,100],[550,200],[750,200],[1e3,150],[0,300],[200,300],[300,300],[500,300],[800,350],[1e3,350],[0,500],[150,500],[300,450],[500,450],[600,450],[800,450],[1e3,500],[0,700],[150,700],[300,700],[300,650],[400,650],[600,650],[700,650],[800,650],[1e3,650],[0,850],[200,850],[300,850],[400,850],[500,850],[700,800],[850,800],[1e3,800],[0,1e3],[200,1e3],[300,1e3],[500,1e3],[700,1e3],[850,1e3],[1e3,1e3]],fields:[{nodes:[0,1,7,6],center:[100,75],radius2:25625,radius:160.0781059358212,walls:[0,1,2,3]},{nodes:[1,2,8,7],center:[300,50],radius2:12500,walls:[4,5,6,1],radius:111.80339887498948},{nodes:[2,3,9,8],center:[487.5,75],radius2:19531.25,walls:[7,8,9,5],radius:139.75424859373686},{nodes:[3,4,10,9],center:[662.5,100],radius2:22656.25,walls:[10,11,12,8],radius:150.5199322349037},{nodes:[4,5,11,10],center:[875,87.5],radius2:28281.25,walls:[13,14,15,11],radius:168.17030058842138},{nodes:[6,7,13,12],center:[100,225],radius2:25625,walls:[2,16,17,18],radius:160.0781059358212},{nodes:[7,8,14,13],center:[275,200],radius2:25625,walls:[6,19,20,16],radius:160.0781059358212},{nodes:[8,9,15,14],center:[437.5,225],radius2:24531.25,walls:[9,21,22,19],radius:156.62455107677084},{nodes:[9,10,16,15],center:[650,262.5],radius2:30156.25,walls:[12,23,24,21],radius:173.65554986812256},{nodes:[10,11,17,16],center:[887.5,262.5],radius2:25312.5,walls:[15,25,26,23],radius:159.0990257669732},{nodes:[12,13,19,18],center:[87.5,400],radius2:22656.25,walls:[17,27,28,29],radius:150.5199322349037},{nodes:[13,14,20,19],center:[237.5,387.5],radius2:20312.5,walls:[20,30,31,27],radius:142.52192813739225},{nodes:[14,15,21,20],center:[400,375],radius2:15625,walls:[22,32,33,30],radius:125},{nodes:[15,16,23,22,21],center:[640,400],radius2:29600,walls:[24,34,35,36,32],radius:172.04650534085255},{nodes:[16,17,24,23],center:[900,412.5],radius2:17656.25,walls:[26,37,38,34],radius:132.87682265918312},{nodes:[18,19,26,25],center:[75,600],radius2:15625,walls:[28,39,40,41],radius:125},{nodes:[19,20,28,27,26],center:[240,600],radius2:26100,walls:[31,42,43,44,39],radius:161.55494421403512},{nodes:[20,21,29,28],center:[375,550],radius2:25625,walls:[33,45,46,42],radius:160.0781059358212},{nodes:[21,22,30,29],center:[525,550],radius2:25625,walls:[36,47,48,45],radius:160.0781059358212},{nodes:[22,23,32,31,30],center:[700,570],radius2:24400,walls:[35,49,50,51,47],radius:156.20499351813308},{nodes:[23,24,33,32],center:[900,562.5],radius2:22656.25,walls:[38,52,53,49],radius:150.5199322349037},{nodes:[25,26,35,34],center:[87.5,775],radius2:18281.25,walls:[40,54,55,56],radius:135.2081728298996},{nodes:[26,27,36,35],center:[237.5,775],radius2:13281.25,walls:[44,57,58,54],radius:115.2443057161611},{nodes:[27,28,29,37,36],center:[340,740],radius2:15700,walls:[43,46,59,60,57],radius:125.29964086141668},{nodes:[29,30,38,37],center:[475,750],radius2:25625,walls:[48,61,62,59],radius:160.0781059358212},{nodes:[30,31,39,38],center:[625,737.5],radius2:28281.25,walls:[51,63,64,61],radius:168.17030058842138},{nodes:[31,32,40,39],center:[762.5,725],radius2:13281.25,walls:[50,65,66,63],radius:115.2443057161611},{nodes:[32,33,41,40],center:[912.5,725],radius2:18281.25,walls:[53,67,68,65],radius:135.2081728298996},{nodes:[34,35,43,42],center:[100,925],radius2:15625,walls:[55,69,70,71],radius:125},{nodes:[35,36,37,44,43],center:[280,910],radius2:18e3,walls:[58,60,72,73,69],radius:134.16407864998737},{nodes:[37,38,45,44],center:[425,925],radius2:21250,walls:[62,74,75,72],radius:145.7737973711325},{nodes:[38,39,46,45],center:[600,912.5],radius2:22656.25,walls:[64,76,77,74],radius:150.5199322349037},{nodes:[39,40,47,46],center:[775,900],radius2:15625,walls:[66,78,79,76],radius:125},{nodes:[40,41,48,47],center:[925,900],radius2:15625,walls:[68,80,81,78],radius:125}],walls:[[0,0,200,0],[200,0,200,100],[200,100,0,200],[0,200,0,0],[200,0,400,0],[400,0,400,100],[400,100,200,100],[400,0,600,0],[600,0,550,200],[550,200,400,100],[600,0,750,0],[750,0,750,200],[750,200,550,200],[750,0,1e3,0],[1e3,0,1e3,150],[1e3,150,750,200],[200,100,200,300],[200,300,0,300],[0,300,0,200],[400,100,300,300],[300,300,200,300],[550,200,500,300],[500,300,300,300],[750,200,800,350],[800,350,500,300],[1e3,150,1e3,350],[1e3,350,800,350],[200,300,150,500],[150,500,0,500],[0,500,0,300],[300,300,300,450],[300,450,150,500],[500,300,500,450],[500,450,300,450],[800,350,800,450],[800,450,600,450],[600,450,500,450],[1e3,350,1e3,500],[1e3,500,800,450],[150,500,150,700],[150,700,0,700],[0,700,0,500],[300,450,300,650],[300,650,300,700],[300,700,150,700],[500,450,400,650],[400,650,300,650],[600,450,600,650],[600,650,400,650],[800,450,800,650],[800,650,700,650],[700,650,600,650],[1e3,500,1e3,650],[1e3,650,800,650],[150,700,200,850],[200,850,0,850],[0,850,0,700],[300,700,300,850],[300,850,200,850],[400,650,400,850],[400,850,300,850],[600,650,500,850],[500,850,400,850],[700,650,700,800],[700,800,500,850],[800,650,850,800],[850,800,700,800],[1e3,650,1e3,800],[1e3,800,850,800],[200,850,200,1e3],[200,1e3,0,1e3],[0,1e3,0,850],[400,850,300,1e3],[300,1e3,200,1e3],[500,850,500,1e3],[500,1e3,300,1e3],[700,800,700,1e3],[700,1e3,500,1e3],[850,800,850,1e3],[850,1e3,700,1e3],[1e3,800,1e3,1e3],[1e3,1e3,850,1e3]],nodeToFields:[[0],[0,1],[1,2],[2,3],[3,4],[4],[0,5],[0,1,5,6],[1,2,6,7],[2,3,7,8],[3,4,8,9],[4,9],[5,10],[5,6,10,11],[6,7,11,12],[7,8,12,13],[8,9,13,14],[9,14],[10,15],[10,11,15,16],[11,12,16,17],[12,13,17,18],[13,18,19],[13,14,19,20],[14,20],[15,21],[15,16,21,22],[16,22,23],[16,17,23],[17,18,23,24],[18,19,24,25],[19,25,26],[19,20,26,27],[20,27],[21,28],[21,22,28,29],[22,23,29],[23,24,29,30],[24,25,30,31],[25,26,31,32],[26,27,32,33],[27,33],[28],[28,29],[29,30],[30,31],[31,32],[32,33],[33]]};var fa=wa;let ba=me,Aa=2*ba*3;const ya=1.45,Ia=Te+1.25,Da=new Ps(97),Na=new h.F({map:X(null),side:h.k,flatShading:!0,emissiveIntensity:.01}),Ma={};class Ca extends h.g{constructor(){super(),this.wallMap=[],this.curVertIndex=0,this.curIndex=0;let e=2*ba*3;this.setIndex(new Float32Array(2*(ba-1))),this.setAttribute("position",new h.o(new Float32Array(e),3)),this.attributes.position.setUsage(h.l);let t=[],i=0;for(let s=0;s<e;s+=6)t.push(0,i,.45,i),i+=2;this.setAttribute("uv",new h.o(new Float32Array(t),2)),this.attributes.uv.setUsage(h.l),this.matrixAutoUpdate=!1,this.setDrawRange(0,0)}}var ja=class{constructor(e,t,i,s,n){this.verts=[],this.index=[],this.wallMap=[],this.wallsToDraw=[],this.fieldMap=[],this.leftWallNodes=[],this.rightWallNodes=[],this.curWallIndex=0,this.curVertIndex=0,this.curUVIndex=0,this.curIndex=0,this.fieldMapOffset=new h.V,this.getXZ=()=>{},this.getXZQuick=()=>{},this.addTree=()=>{},this.initialised=!1,this.initCounter=0,this.ready=!1,this.renderWalls=!0,this.distantResolution=20,this.fieldChance=0,this.getXZ=e,this.getXZQuick=t,this.getTreeDensity=i,this.addTree=s,ba=me,Aa=2*ba*3,this.renderWalls=n,this.geo=new Ca,this.verts=this.geo.attributes.position.array,this.uvs=this.geo.attributes.uv.array,this.index=[],this.mesh=new h.B(this.geo,Na),this.mesh.visible=!1,Ma.na=new h.V,Ma.nb=new h.V,Ma.t=new h.V,Ma.ti=new h.V,Ma.nextVert=new h.V}initialise(e,t=null,i=null,s=!1,n=!0){if(this.originPos=e,this.debug=s,t&&i){if(n)for(this.originNode=t,Ma.midNodeIndex=(i.i-t.i)/2,Ma.i=0;Ma.i<Ma.midNodeIndex&&this.originNode.next;Ma.i++)this.originNode=this.originNode.next;this.entryNode=t,this.exitNode=i,this.distantResolution=10,this.checkBothDirections=i.i-t.i>.15*me||!n}else this.originNode=null,this.entryNode=null,this.exitNode=null,this.distantResolution=20;this.wallMap.length=0,this.fieldMap.length=0,this.skippedNodes=[],this.wallsToDraw.length=0,this.wallTileOffsets=[],this.wallOffsets=[],this.skippedFieldNodes=[],this.skippedFieldNodeIDs=[],this.skippedFieldNodeOffset=[],this.leftWallNodes.length=0,this.rightWallNodes.length=0,this.index.length=0,this.curWallIndex=0,this.curVertIndex=0,this.curUVIndex=0,this.curIndex=0,n&&this.geo.setDrawRange(0,0),this.fieldMapOffset.x=this.originPos.x%1e3,this.fieldMapOffset.z=this.originPos.z%1e3,this.fieldMapOffset.x<0&&(this.fieldMapOffset.x+=1e3),this.fieldMapOffset.z<0&&(this.fieldMapOffset.z+=1e3),this.initialised=!1,this.initCounter=0,this.ready=!1}continueInitialise(){if(this.initCounter<fa.fields.length){if(Ma.fi=this.initCounter,Ma.f=fa.fields[this.initCounter++],Ma.fX=Ma.f.center[0]-this.fieldMapOffset.x,Ma.fZ=Ma.f.center[1]-this.fieldMapOffset.z,Ma.tX=0,Ma.tZ=0,Ma.fX<0&&(Ma.fX+=1e3,Ma.tX=1e3),Ma.fZ<0&&(Ma.fZ+=1e3,Ma.tZ=1e3),Ma.tX-=this.fieldMapOffset.x,Ma.tZ-=this.fieldMapOffset.z,Ma.debug=this.debug&&(24==Ma.fi||25==Ma.fi),Ma.fX<me&&Ma.fZ<me){for(Ma.fn of Ma.f.nodes)if(Ma.fnn=fa.nodes[Ma.fn],Ma.fnX=Ma.fnn[0]-this.fieldMapOffset.x,Ma.fnZ=Ma.fnn[1]-this.fieldMapOffset.z,Ma.fnX<0&&(Ma.fnX+=1e3),Ma.fnZ<0&&(Ma.fnZ+=1e3),Ma.fnX>me||Ma.fnZ>me)return;if(Ma.h=this.getXZQuick(Ma.fX,Ma.fZ),Ma.h>10&&Ma.h<100&&0==this.getTreeDensity(Ma.fX,Ma.fZ))if(Ma.fX+=this.originPos.x,Ma.fZ+=this.originPos.z,this.originNode)if(this.checkBothDirections?(Ma.rd=tt(Ma.fX,Ma.fZ,this.entryNode,!0,Ma.debug),Ma.rd2=tt(Ma.fX,Ma.fZ,this.exitNode,!0,Ma.debug),Ma.rd.d2>Ma.rd2.d2&&(Ma.rd=Ma.rd2)):Ma.rd=tt(Ma.fX,Ma.fZ,this.originNode,!0,Ma.debug),Ma.rd.d2>Ma.f.radius2)for(Ma.w of Ma.f.walls)this.wallMap[Ma.w]||(this.wallMap[Ma.w]=!0,this.wallOffsets.push([Ma.tX,Ma.tZ]),this.wallsToDraw.push(fa.walls[Ma.w]),this.fieldMap[Ma.fi]=!0);else for(Ma.sni of Ma.f.nodes)this.skippedFieldNodes[Ma.sni]=Ma.rd.n,this.skippedFieldNodeIDs[Ma.sni]=!0,this.skippedFieldNodeOffset[Ma.sni]=[Ma.tX,Ma.tZ];else for(Ma.w of Ma.f.walls)this.wallMap[Ma.w]||(this.wallMap[Ma.w]=!0,this.wallOffsets.push([Ma.tX,Ma.tZ]),this.wallsToDraw.push(fa.walls[Ma.w]),this.fieldMap[Ma.fi]=!0)}}else{for(Ma.rightIndex=-1,Ma.leftIndex=-1,Ma.ni=0;Ma.ni<fa.nodes.length;Ma.ni++)if(this.skippedFieldNodeIDs[Ma.ni])for(Ma.fi of fa.nodeToFields[Ma.ni])if(this.fieldMap[Ma.fi]){if(Ma.node=fa.nodes[Ma.ni],Ma.offset=this.skippedFieldNodeOffset[Ma.ni],Ma.rd=it(Ma.node[0]+Ma.offset[0]+this.originPos.x,Ma.node[1]+Ma.offset[1]+this.originPos.z,this.skippedFieldNodes[Ma.ni]),Ma.rd.d>fa.fields[Ma.fi].radius||Ma.rd.s<0&&Ma.rd.n.g<-1.5||Ma.rd.s>0&&Ma.rd.n.g>1.5)break;if(Ma.doBreak=!1,Ma.rd.s<0){for(Ma.rwn of this.rightWallNodes)if(1==Math.abs(Ma.rd.n.i-Ma.rwn.i)){Ma.doBreak=!0;break}if(Ma.doBreak)break;this.rightWallNodes.push(Ma.rd.n),Ma.rightIndex=this.wallsToDraw.length}else{for(Ma.lwn of this.leftWallNodes)if(1==Math.abs(Ma.rd.n.i-Ma.lwn.i)){Ma.doBreak=!0;break}if(Ma.doBreak)break;this.leftWallNodes.push(Ma.rd.n),Ma.leftIndex=this.wallsToDraw.length}Ma.d=Ia+.1,Ma.na.set(Ma.rd.n.p.x-Ma.rd.n.n.x*Ma.d*Ma.rd.s,Ma.rd.n.p.z-Ma.rd.n.n.z*Ma.d*Ma.rd.s),this.wallsToDraw.push([Ma.node[0],Ma.node[1],Ma.na.x-this.originPos.x-Ma.offset[0],Ma.na.y-this.originPos.z-Ma.offset[1],Ma.rd.n]),this.wallOffsets.push(Ma.offset);break}1==this.rightWallNodes.length&&(this.wallsToDraw.splice(Ma.rightIndex,1),this.wallOffsets.splice(Ma.rightIndex,1),Ma.rightIndex<Ma.leftIndex&&Ma.leftIndex--),1==this.leftWallNodes.length&&(this.wallsToDraw.splice(Ma.leftIndex,1),this.wallOffsets.splice(Ma.leftIndex,1)),this.initialised=!0,this.ready=this.curWallIndex>=this.wallsToDraw.length}}buildNextWall(){if(this.initialised){if(this.curVertIndex>=Aa||this.curWallIndex>=this.wallsToDraw.length||!this.renderWalls)return this.ready=!0,void this.finalise();for(Ma.cwi=this.wallsToDraw.length-1-this.curWallIndex,Ma.nodes=this.wallsToDraw[Ma.cwi],Ma.offset=this.wallOffsets[Ma.cwi],Ma.na.set(Ma.nodes[0],Ma.nodes[1]),Ma.nb.set(Ma.nodes[2],Ma.nodes[3]),Ma.d=Ma.na.distanceTo(Ma.nb),Ma.t.subVectors(Ma.nb,Ma.na).normalize(),Ma.ti.set(-Ma.t.y,Ma.t.x),Ma.fieldToTile={x:Ma.offset[0],z:Ma.offset[1]},Ma.fieldToWorld={x:Ma.fieldToTile.x+this.originPos.x,z:Ma.fieldToTile.z+this.originPos.z},Ma.refreshIndex=!0,Ma.n=Ma.nodes[4],Ma.nearWall=!!Ma.n,Ma.distanceBetween=0,Ma.minDist=Ma.n?1:10,Ma.hOffset=this.originPos.y+.6,Ma.doBreak=!1;;){if(Ma.d<Ma.minDist?(Ma.na.copy(Ma.nb),Ma.hOffset+=.2,Ma.distanceBetween=Ma.d,Ma.doBreak=!0):(Ma.na.x+=Ma.t.x*Ma.distanceBetween,Ma.na.y+=Ma.t.y*Ma.distanceBetween),Ma.nextVert.copy(Ma.na),Ma.nearWall&&Ma.d<15?(Ma.rd=it(Ma.nextVert.x+Ma.fieldToWorld.x,Ma.nextVert.y+Ma.fieldToWorld.z,Ma.n),Ma.h=ht.lerpHeightGlobal(Ma.nextVert.x+Ma.fieldToWorld.x,Ma.nextVert.y+Ma.fieldToWorld.z,Ma.rd,this.getXZ)):Ma.h=this.getXZQuick(Ma.nextVert.x+Ma.fieldToTile.x,Ma.nextVert.y+Ma.fieldToTile.z),Ma.nextVert.x+=Ma.fieldToTile.x,Ma.nextVert.y+=Ma.fieldToTile.z,Ma.byWater=Ma.h<5,Ma.h-=Ma.hOffset,Ma.nearWall&&wh.value.detailLodIndex>0?(this.verts[this.curVertIndex++]=Ma.nextVert.x+.2*Ma.ti.x,this.verts[this.curVertIndex++]=Ma.h,this.verts[this.curVertIndex++]=Ma.nextVert.y+.2*Ma.ti.y,this.verts[this.curVertIndex++]=Ma.nextVert.x+.1*Ma.ti.x,this.verts[this.curVertIndex++]=Ma.h+ya,this.verts[this.curVertIndex++]=Ma.nextVert.y+.1*Ma.ti.y,this.verts[this.curVertIndex++]=Ma.nextVert.x-.1*Ma.ti.x,this.verts[this.curVertIndex++]=Ma.h+ya,this.verts[this.curVertIndex++]=Ma.nextVert.y-.1*Ma.ti.y,this.verts[this.curVertIndex++]=Ma.nextVert.x-.2*Ma.ti.x,this.verts[this.curVertIndex++]=Ma.h,this.verts[this.curVertIndex++]=Ma.nextVert.y-.2*Ma.ti.y,this.uvs[this.curUVIndex++]=0,this.uvs[this.curUVIndex++]=.46*Ma.d,this.uvs[this.curUVIndex++]=.44,this.uvs[this.curUVIndex++]=.46*Ma.d,this.uvs[this.curUVIndex++]=.56,this.uvs[this.curUVIndex++]=.46*Ma.d,this.uvs[this.curUVIndex++]=1,this.uvs[this.curUVIndex++]=.46*Ma.d,Ma.refreshIndex||(Ma.ii=this.curIndex-4,this.index.push(Ma.ii,Ma.ii+5,Ma.ii+1,Ma.ii,Ma.ii+4,Ma.ii+5,Ma.ii+1,Ma.ii+6,Ma.ii+2,Ma.ii+1,Ma.ii+5,Ma.ii+6,Ma.ii+2,Ma.ii+7,Ma.ii+3,Ma.ii+2,Ma.ii+6,Ma.ii+7)),this.curIndex+=4,Ma.refreshIndex=!1):Ma.byWater?Ma.refreshIndex=!0:(this.verts[this.curVertIndex++]=Ma.nextVert.x,this.verts[this.curVertIndex++]=Ma.h,this.verts[this.curVertIndex++]=Ma.nextVert.y,this.verts[this.curVertIndex++]=Ma.nextVert.x,this.verts[this.curVertIndex++]=Ma.h+ya,this.verts[this.curVertIndex++]=Ma.nextVert.y,this.uvs[this.curUVIndex++]=0,this.uvs[this.curUVIndex++]=.46*Ma.d,this.uvs[this.curUVIndex++]=.46,this.uvs[this.curUVIndex++]=.46*Ma.d,Ma.refreshIndex||(Ma.ii=this.curIndex-2,this.index.push(Ma.ii,Ma.ii+3,Ma.ii+1,Ma.ii,Ma.ii+2,Ma.ii+3)),this.curIndex+=2,Ma.refreshIndex=!1),Ma.n?(Ma.distanceBetween=Math.min(10,Math.max(2,Ma.d/2)),!Ma.byWater&&Ma.d>20&&Da.next()<.1&&this.addTree(Ma.nextVert.x,Ma.h,Ma.nextVert.y)):(Ma.distanceBetween=this.distantResolution,!Ma.byWater&&Da.next()<.2&&this.addTree(Ma.nextVert.x,Ma.h,Ma.nextVert.y)),Ma.d-=Ma.distanceBetween,this.curVertIndex>=Aa){this.curWallIndex=this.wallsToDraw.length;break}if(Ma.doBreak)break}this.curWallIndex++,this.ready=this.curWallIndex>=this.wallsToDraw.length,this.ready&&this.finalise()}else this.continueInitialise()}finalise(){if(this.leftWallNodes.length>1)for(this.leftWallNodes=this.leftWallNodes.sort(((e,t)=>e.i<t.i?-1:1)),Ma.ci=0;Ma.ci<this.leftWallNodes.length-1;Ma.ci++){var e;if(Ma.curNode=this.leftWallNodes[Ma.ci],Ma.target=this.leftWallNodes[Ma.ci+1],Ma.target.i-Ma.curNode.i<30)for(;Ma.curNode.i<=Ma.target.i;)Ma.curNode.dswl=Ia,Ma.curNode=Ma.curNode.next;else(null===(e=Ma.curNode.prev)||void 0===e?void 0:e.dswl)||(Ma.curNode.dsel=!0)}if(this.rightWallNodes.length>1)for(this.rightWallNodes=this.rightWallNodes.sort(((e,t)=>e.i<t.i?-1:1)),Ma.ci=0;Ma.ci<this.rightWallNodes.length-1;Ma.ci++){var t;if(Ma.curNode=this.rightWallNodes[Ma.ci],Ma.target=this.rightWallNodes[Ma.ci+1],Ma.target.i-Ma.curNode.i<30)for(;Ma.curNode.i<=Ma.target.i;)Ma.curNode.dswr=-Ia,Ma.curNode=Ma.curNode.next;else(null===(t=Ma.curNode.prev)||void 0===t?void 0:t.dswr)||(Ma.curNode.dser=!0)}this.geo.attributes.position.needsUpdate=!0,this.geo.attributes.uv.needsUpdate=!0,this.geo.setDrawRange(0,this.index.length),this.geo.setIndex(this.index),this.mesh.updateMatrix(),this.mesh.visible=!0}};const ka=new h.G,za=new Ps(103,2*Math.PI),Sa=new Ps(51,.4),Oa={vecV:new h.W,vecH:new h.W};var La=class extends ct{constructor(...e){super(...e),this.maxTreeCount=5120,this.treeMapRows=[],this.treeInstanceIndex=0,this.treeMap=[],this.currentTreeInstance=0,this.treeInstances=[],this.farWallRenderer=null,this.ready=!1,this.isDebug=!1,this.treeGenIndex=0,this.treeMapTile=null,this.nearestNode=null,this.sea=null,this.seaRes=10,this.seaDepth=null,this.seaDepthIndex=0,this.seaRow=0,this.maxTreeCount=ji,this.treeInstances.push(qn.getFarTreeInstance(this.maxTreeCount)),this.trees=this.treeInstances[0],this.trees.count=0,this.geo.setAttribute("treeMask",new h.o(new Float32Array(this.geo.count),1)),this.geo.attributes.treeMask.setUsage(h.l),this.treeMask=this.geo.attributes.treeMask.array,this.geo.setAttribute("grass",new h.o(new Float32Array(this.geo.count),1)),this.geo.attributes.grass.setUsage(h.l),this.grassArr=this.geo.attributes.grass.array,this.mesh.add(this.trees),this.renderFarWalls=wh.value.detailLodIndex>0,this.farWallRenderer=new ja(((e,t)=>this.heightmap.getXZ(e,t)),((e,t)=>this.lookupHeight(e,t)),((e,t)=>this.lookupTreemapDensity(e,t)),((e,t,i)=>this.addWallTree(e,t,i)),this.renderFarWalls),this.renderFarWalls&&this.mesh.add(this.farWallRenderer.mesh)}initGeneration(e,t,i,s,n,a,r){super.initGeneration(e,t,i,s,n,a,r),this.treeInstanceIndex=0,this.treeGenIndex=0;for(let h of this.treeInstances)h.count=0,h.visible=!1;this.currentTreeInstance=0,this.trees=this.treeInstances[this.currentTreeInstance],this.trees.visible=!0,oa[e]||(oa[e]={}),oa[e][t]=null,Fi?(this.sea||(this.sea=this.getSeaMesh(),this.mesh.add(this.sea)),this.seaDepth=this.sea.geometry.attributes.depth.array,this.seaDepthIndex=0,this.seaRow=0,this.sea.visible=!0,this.sea.position.y=-this.mesh.position.y):(this.sea&&(this.sea.visible=!1),this.seaRow=Hi+1),this.farWallRenderer.initialise(this.originPos,i,s,this.debug),(e+t)%3==0&&(this.farWallRenderer.ready=!0)}resetOverlapMap(e,t){super.resetOverlapMap(e,t),this.treeInstanceIndex=0,this.treeGenIndex=0,this.currentTreeInstance=0,this.trees=this.treeInstances[this.currentTreeInstance],this.trees.visible=!0,this.farWallRenderer.initialise(this.originPos,this.originNode,e,this.debug,!1),(this.originCoords.x+this.originCoords.z)%3==0&&(this.farWallRenderer.ready=!0)}getSeaMesh(){let e=new h.J(this.size,this.size,Hi,Hi);e.setAttribute("depth",new h.o(new Float32Array((Hi+1)*(Hi+1)),1)),e.attributes.depth.setUsage(h.l);let t=new h.B(e,Zi);return t.position.x+=this.size/2,t.position.z+=this.size/2,t.rotation.x=-Math.PI/2,t}generate(){if(this.genRow<=this.res){for(this.genIndex=this.genRow*this.res1*3,Oa.i=0;Oa.i<=this.res;Oa.i++)Oa.index=this.genIndex+3*Oa.i,Oa.index3=this.genRow*this.res1+Oa.i,Oa.x=this.verts[Oa.index]+this.originPos.x,Oa.z=this.verts[Oa.index+2]+this.originPos.z,Oa.h=this.heightmap.getXZ(Oa.x,Oa.z),this.heights[Oa.index3]=Oa.h,this.heightOffsets[Oa.index3]=Oa.h-this.mesh.position.y,this.treeMask[Oa.index3]=0,this.treeMap[Oa.index3]=qn.treeMap.getXZ(Oa.x,Oa.z),Oa.h<100?this.grassArr[Oa.index3]=qn.grassMap.getXZ(Oa.x,Oa.z)/3*(Oa.h/100):this.grassArr[Oa.index3]=qn.grassMap.getXZ(Oa.x,Oa.z)/3;return this.genRow>0&&this.computeSquareNormalsRow(this.genRow-1),this.genRow++,this.genRow>this.res&&(this.computeSquareNormalsRow(this.genRow-1),this.geo.attributes.normal.needsUpdate=!0,this.geo.attributes.curvature.needsUpdate=!0,this.geo.attributes.grass.needsUpdate=!0),!1}if(this.overlapIndex<this.overlapCells.length){for(Oa.oz in Oa.ox=this.overlapCells[this.overlapIndex],this.overlapTile[Oa.ox])this.overlapTile[Oa.ox][Oa.oz]<0||(Oa.index=Oa.ox*this.res1+1*Oa.oz,this.heightOffsets[Oa.index]=this.heights[Oa.index]-this.mesh.position.y-(5+2*this.overlapTile[Oa.ox][Oa.oz]));return this.overlapIndex++,!1}if(this.treeGenIndex<this.res)return this.computeTreeRow(this.treeGenIndex),this.treeGenIndex++,!1;if(!this.farWallRenderer.ready)return this.farWallRenderer.buildNextWall(),!1;if(this.seaRow<=Hi){for(Oa.genIndex=this.seaRow*(Hi+1),Oa.i=0;Oa.i<=Hi;Oa.i++)this.seaDepth[Oa.genIndex+Oa.i]=this.lookupHeight(Oa.i/Hi*this.size,this.seaRow/Hi*this.size);return this.seaRow++,!1}return this.readyTrees(),this.geo.attributes.treeMask.needsUpdate=!0,Fi&&(this.sea.geometry.attributes.depth.needsUpdate=!0),oa[this.originCoords.x][this.originCoords.z]=this.treeMask,this.mesh.visible&&this.display(),this.ready=!0,!0}lookupTreemapDensity(e,t){return e<0||e>this.size||t<0||t>this.size?0:(Oa.cx=Math.max(e/10,0),Oa.cz=Math.max(t/10,0),Oa.ix=Math.min(this.size-1,Math.floor(Oa.cx)),Oa.iz=Math.min(this.size-1,Math.floor(Oa.cz)),Oa.index=this.res1*Oa.ix+Oa.iz,this.treeMask[Oa.index])}addWallTree(e,t,i){ka.position.set(e,t-1,i),ka.rotation.y=za.next(),ka.scale.set(.75,.75,.75),ka.updateMatrix(),this.trees.setMatrixAt(this.treeInstanceIndex,ka.matrix),this.trees.instanceVariant.array[this.treeInstanceIndex]=0,ka.rotation.y>2.1&&(ka.rotation.y>4.2?this.trees.instanceVariant.array[this.treeInstanceIndex]=2:this.trees.instanceVariant.array[this.treeInstanceIndex]=3),this.treeInstanceIndex++,this.treeInstanceIndex>=this.maxTreeCount&&this.getNewTreeInstance()}readyTrees(){this.trees.instanceMatrix.needsUpdate=!0,this.trees.instanceVariant.needsUpdate=!0,this.trees.count=Math.min(this.maxTreeCount,Math.max(0,this.treeInstanceIndex))}getNewTreeInstance(){if(this.readyTrees(),this.currentTreeInstance++,this.treeInstances.length<=this.currentTreeInstance){let e=qn.getFarTreeInstance(this.maxTreeCount);this.mesh.add(e),this.treeInstances.push(e)}this.trees=this.treeInstances[this.currentTreeInstance],this.trees.count=0,this.trees.visible=!0,this.treeInstanceIndex=0}computeTreeRow(e){for(Oa.i=0;Oa.i<this.res;Oa.i++)if(this.treeInstanceIndex>=this.maxTreeCount&&this.getNewTreeInstance(),Oa.index=e*this.res1*3+3*Oa.i,Oa.index3=e*this.res1+Oa.i,Oa.tm=this.treeMap[Oa.index3],0!=Oa.tm&&(Oa.doContinue=!1,this.heights[Oa.index3]<0&&(this.treeMask[Oa.index3]=0,Oa.doContinue=!0),this.heights[Oa.index3+1]<0&&(this.treeMask[Oa.index3+1]=0,Oa.doContinue=!0),this.heights[Oa.index3+this.res1]<0&&(this.treeMask[Oa.index3+this.res1]=0,Oa.doContinue=!0),this.heights[Oa.index3+1+this.res1]<0&&(this.treeMask[Oa.index3+1+this.res1]=0,Oa.doContinue=!0),!Oa.doContinue))if(this.grads[Oa.index]>.2)this.treeMask[Oa.index3]=0,this.treeMask[Oa.index3+1]=0,this.treeMask[Oa.index3+this.res1]=0,this.treeMask[Oa.index3+1+this.res1]=0;else{Oa.tx=e,Oa.tz=Oa.i,Oa.jInit=0,this.overlapTile&&Oa.tx+1 in this.overlapTile&&Oa.tz+1 in this.overlapTile[Oa.tx+1]&&(Oa.jInit=100),Oa.treePositions=qn.getTreeMap(Oa.tm);for(Oa.j=Oa.jInit;Oa.j<Oa.treePositions.length;Oa.j+=2)Oa.ox=Oa.treePositions[Oa.j],Oa.oz=Oa.treePositions[Oa.j+1],Oa.ha=Oa.ox*this.heightOffsets[Oa.index3+this.res1]+(1-Oa.ox)*this.heightOffsets[Oa.index3],Oa.hb=Oa.ox*this.heightOffsets[Oa.index3+1+this.res1]+(1-Oa.ox)*this.heightOffsets[Oa.index3+1],ka.position.set(10*Oa.ox+10*Oa.tx,Oa.oz*Oa.hb+(1-Oa.oz)*Oa.ha,10*Oa.oz+10*Oa.tz),ka.rotation.y=za.next(),Oa.tms=.15*(Oa.tm-1)+1,Oa.hb=Oa.tms+(Sa.next()-.2)*Oa.tms,ka.scale.set(Oa.hb,Oa.hb,Oa.hb),ka.updateMatrix(),this.trees.setMatrixAt(this.treeInstanceIndex,ka.matrix),this.trees.instanceVariant.array[this.treeInstanceIndex]=0,ka.rotation.y>2.1&&(ka.rotation.y>4.2?this.trees.instanceVariant.array[this.treeInstanceIndex]=2:this.trees.instanceVariant.array[this.treeInstanceIndex]=3),this.treeInstanceIndex++,this.treeInstanceIndex>=this.maxTreeCount&&this.getNewTreeInstance();Oa.hb=Oa.tm/3,this.treeMask[Oa.index3]=Math.max(Oa.hb,this.treeMask[Oa.index3]),this.treeMask[Oa.index3+1]=Math.max(Oa.hb,this.treeMask[Oa.index3+1]),this.treeMask[Oa.index3+this.res1]=Math.max(Oa.hb,this.treeMask[Oa.index3+this.res1]),this.treeMask[Oa.index3+1+this.res1]=Math.max(Oa.hb,this.treeMask[Oa.index3+1+this.res1])}}display(e=!1){super.display(e);for(let t of this.treeInstances)t.visible&&(t.geometry.boundingSphere=this.geo.boundingSphere.clone());this.farWallRenderer.geo.boundingSphere=this.geo.boundingSphere.clone(),this.sea&&(this.sea.geometry.boundingSphere={center:{x:0,y:0,z:0},radius:this.geo.boundingSphere.radius})}retire(){super.retire(),this.resetTrees(),delete oa[this.originCoords.x][this.originCoords.z],Object.keys(oa[this.originCoords.x]).length||delete oa[this.originCoords.x]}resetTrees(){for(;this.treeInstances.length>1;)qn.returnFarTreeInstance(this.treeInstances.pop());this.treeInstances[0].visible=!1}};class Ra extends pt{constructor(e){super(),this.nearGridCell=va,this.farGridCell=La,this.groundMaterial=Mi,this.skinList=Object.keys(Yi.skins),this.skinIndex=0,this.weatherList=Object.keys(Yi.weathers),this.curWeatherIndex=0,this.skinWeatherList=[],this.weatherOverride=!1,this.cycleWeathers=!1,this.weatherCycles=[],this.weatherCycleIndex=0,this.weatherCycleCurrentIndex=0,this.weatherCycleInterval=0,this.weatherCycleCounter=0,this.colorsA={col:new h.i,hemTop:new h.i,hemGround:new h.i,water:new h.i,waterSkyReflection:new h.i,underwater:new h.i,skyCol:new h.i,skyColFar:new h.i},this.colorsB={col:new h.i,hemTop:new h.i,hemGround:new h.i,water:new h.i,waterSkyReflection:new h.i,underwater:new h.i,skyCol:new h.i,skyColFar:new h.i},this.weatherBlend={amb:0,dir:0,hem:0,fogNear:0,fogFar:0,col:new h.i,hemTop:new h.i,hemGround:new h.i,water:new h.i,waterSkyReflection:new h.i,underwater:new h.i,skyCol:new h.i,skyColFar:new h.i},this.topoList=Object.keys(Yi.topography),this.topoIndex=0,this.ambiantAudio=null,this.windAudio=null,this.cachedTextures={default:{}},this.onWeatherCycleChangedBound=this.onWeatherCycleChanged.bind(this),this.loadState={init:!1,walls:!1,reset:!0,progress:0},this.lastVehicleIndex=0,this.seaDepth=null,this.fogHeight=0,this.dynamicFog=!1,this.fogUpdate=!1,this.inWater=!1,this.lerpOffset=0,this.lerpCounter=0,this.timeInterval=1,this.weatherType=0,this.curWeatherIndex=0,this.audioLerp=0,this.tCol=new h.i,this.getHeightAt=e,this.container=new h.G,this.config=Yi,Xs.initialise(e),this.container.add(Xs.container),this.wallController=new Ln(this.getHeightAt),this.container.add(this.wallController.container),this.signController=new Tn,this.bridgeController=new Wn(this.getHeightAt),this.catsEyesController=new Hn,this.container.add(this.catsEyesController.container),this.container.add(sa.container),wh.value.detailLodIndex>0&&(this.container.add(aa.container),this.container.add(ha.container)),qn.buildMap(Yi.treemap),sa.reset(),aa.reset(),ha.reset(),T.addListener(L,this.onHeadlightsChanged.bind(this)),Ui.addListener(this.onWeatherCycleChangedBound),this.onWeatherCycleChanged()}onWeatherCycleChanged(e){var t;if(0!=Ui.cycleLength&&(null===(t=this.skin)||void 0===t?void 0:t.cycles)){for(this.cycleWeathers||(this.weatherCycleIndex=0),this.cycleWeathers=!0,this.weatherCycles=this.skin.cycles,this.weatherCycleIndex=0;this.weatherCycleIndex<this.weatherCycles.length&&(this.weatherCycleCurrentList=this.weatherCycles[this.weatherCycleIndex],this.weatherCycleCurrentIndex=this.weatherCycleCurrentList.indexOf(this.skinWeatherList[this.curWeatherIndex]),!(this.weatherCycleCurrentIndex>=0));this.weatherCycleIndex++);this.weatherCycleCurrentIndex<0&&(this.weatherCycleCurrentIndex=0),this.weatherCycleInterval=Ui.cycleLength/this.weatherCycleCurrentList.length,this.weatherCycleCounter=0,this.prepWeatherBlend()}else this.cycleWeathers=!1}updateConfig(e,t){Ni(e,t)}sanitiseConfig(e,t=!1){!t&&this.skinList.includes(e.value.skin)||(e.set("skin","default",!0),e.set("weatherIndex",1,!0))}destroy(){Xs.destroy(),this.ambientAudio.stop(),this.windAudio.stop(),this.container.traverse((e=>{e.geometry&&e.geometry.dispose()})),this.container.clear();for(let e in this.cachedTextures)for(let t in this.cachedTextures[e])if(this.cachedTextures[e][t].isTexture)this.cachedTextures[e][t].dispose();else for(let i in this.cachedTextures[e][t])this.cachedTextures[e][t][i].isTexture&&this.cachedTextures[e][t][i].dispose();delete this.cachedTextures,sa.destroy(),aa.destroy(),ha.destroy()}loader(){return 1}initialise(e,t,i){this.seed=e;let s=t.topography;this.topoIndex=this.topoList.indexOf(s),delete this.heightmap,this.heightmap=new wt(e,Yi.topography[s].heightmap),de(Yi.topography[s].smoothWindow),Pe(Yi.topography[s].roadWidth),Fi||this.initSea(),i()}onMidlineReady(){this.lastVehicleIndex=st.vehicleIndex,this.signController.initialise(),this.bridgeController.initialise(),this.catsEyesController.initialise(),sa.revert(zi,Oi),aa.revert(Bi,Ri),ha.revert(Wi,Ri),this.sea&&(this.sea.position.x=st.vehicleNode.p.x,this.sea.position.z=st.vehicleNode.p.z)}onGridReady(){this.wallController.initialise(),ha.initialiseVisible(),aa.initialiseVisible(),sa.initialiseVisible()}handleMidlineReset(){this.wallController.handleMidlineReset()}initSea(){let e=2*fe,t=new h.J(e,e,Hi,Hi);this.sea=new h.B(t,Zi),this.sea.rotation.x=-Math.PI/2,this.sea.frustumCulled=!1,this.container.add(this.sea)}destroySea(){this.sea&&(this.sea.geometry.dispose(),this.container.remove(this.sea),this.sea=null)}update(e){var t;this.lastVehicleIndex<st.vehicleIndex&&(this.lastVehicleIndex++,this.wallController.update(),this.signController.update(),this.bridgeController.update(),Xs.update(),aa.updateVisible(),ha.updateVisible(),sa.updateVisible(),this.sea&&(this.sea.position.x=st.vehicleNode.p.x,this.sea.position.z=st.vehicleNode.p.z)),this.catsEyesController.update(),this.wallController.updateStaged(),(null===(t=Qe.parent)||void 0===t?void 0:t.position)?(Zi.userData.camPos.value.copy(Qe.parent.position),Fe.userData.camPos.value.copy(Qe.parent.position)):(Zi.userData.camPos.value.copy(Qe.position),Fe.userData.camPos.value.copy(Qe.position)),Zi.userData.time.value=2*I.appTime,Zi.uniformsNeedUpdate=!0,this.cycleWeathers?this.updateWeather(e):this.dynamicFog&&this.fogUpdate&&(this.dynamicFogNear=1-Math.min(1,T.position.y/200),this.dynamicFogFar=.2+.8*this.dynamicFogNear,se(this.weather.col,we*this.weather.fogNear*this.dynamicFogNear,Math.max(50,we*this.weather.fogFar*this.dynamicFogFar))),this.fogUpdate=!this.fogUpdate,Qe.position.y<0?(this.inWater=!0,this.underwaterCol=this.weather.underwater,this.cycleWeathers&&(this.underwaterCol=this.weatherBlend.underwater.getHex()),ge.setHex(this.underwaterCol),this.fogVis=2*Math.max(0,8+Qe.position.y),se(this.underwaterCol,-30+this.fogVis,10+this.fogVis)):this.inWater&&(this.inWater=!1,this.cycleWeathers||(ge.setHex(this.weather.col),this.cycleWeathers?this.updateWeather(e):this.dynamicFog&&this.fogUpdate?(this.dynamicFogNear=1-Math.min(1,T.position.y/200),this.dynamicFogFar=.2+.8*this.dynamicFogNear,se(this.weather.col,we*this.weather.fogNear*this.dynamicFogNear,Math.max(50,we*this.weather.fogFar*this.dynamicFogFar))):se(this.weather.col,we*this.weather.fogNear,we*this.weather.fogFar)))}smoothLerp(e){return-1*(3-2*e)*e*e+1}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e*-1+1}prepWeatherBlend(){this.weatherCycleCurrentIndex>=this.weatherCycleCurrentList.length&&(this.weatherCycleIndex=(this.weatherCycleIndex+1)%this.weatherCycles.length,this.weatherCycleCurrentList=this.weatherCycles[this.weatherCycleIndex],this.weatherCycleCurrentIndex=0),this.wA=Yi.weathers[this.weatherCycleCurrentList[this.weatherCycleCurrentIndex]],this.weatherCycleCurrentIndex==this.weatherCycleCurrentList.length-1?this.wB=Yi.weathers[this.weatherCycles[(this.weatherCycleIndex+1)%this.weatherCycles.length][0]]:this.wB=Yi.weathers[this.weatherCycleCurrentList[this.weatherCycleCurrentIndex+1]],this.colorsA.col.setHex(this.wA.col),this.colorsA.hemTop.setHex(this.wA.hemTop),this.colorsA.hemGround.setHex(this.wA.hemGround),this.colorsA.water.setHex(this.wA.water),this.colorsA.waterSkyReflection.setHex(this.wA.waterSkyReflection),this.colorsA.underwater.setHex(this.wA.underwater),this.colorsA.skyCol.setHex(this.wA.skyCol),this.colorsA.skyColFar.setHex(this.wA.skyColFar),this.colorsB.col.setHex(this.wB.col),this.colorsB.hemTop.setHex(this.wB.hemTop),this.colorsB.hemGround.setHex(this.wB.hemGround),this.colorsB.water.setHex(this.wB.water),this.colorsB.waterSkyReflection.setHex(this.wB.waterSkyReflection),this.colorsB.underwater.setHex(this.wB.underwater),this.colorsB.skyCol.setHex(this.wB.skyCol),this.colorsB.skyColFar.setHex(this.wB.skyColFar)}updateWeather(e){this.weatherCycleCounter+=e,this.weatherCycleCounter>this.weatherCycleInterval&&(this.weatherCycleCounter-=this.weatherCycleInterval,this.weatherCycleCurrentIndex++,this.prepWeatherBlend(this.wA,this.wB));let t=this.weatherCycleCounter/this.weatherCycleInterval;t=this.smoothLerp(1-t);let i=1-t;this.weatherBlend.amb=this.wA.amb*i+this.wB.amb*t,this.weatherBlend.dir=this.wA.dir*i+this.wB.dir*t,this.weatherBlend.hem=this.wA.hem*i+this.wB.hem*t,this.weatherBlend.fogNear=this.wA.fogNear*i+this.wB.fogNear*t,this.weatherBlend.fogFar=this.wA.fogFar*i+this.wB.fogFar*t,this.weatherBlend.col.copy(this.colorsA.col).lerp(this.colorsB.col,t),this.weatherBlend.hemTop.copy(this.colorsA.hemTop).lerp(this.colorsB.hemTop,t),this.weatherBlend.hemGround.copy(this.colorsA.hemGround).lerp(this.colorsB.hemGround,t),this.weatherBlend.water.copy(this.colorsA.water).lerp(this.colorsB.water,t),this.weatherBlend.waterSkyReflection.copy(this.colorsA.waterSkyReflection).lerp(this.colorsB.waterSkyReflection,t),this.weatherBlend.underwater.copy(this.colorsA.underwater).lerp(this.colorsB.underwater,t),this.weatherBlend.skyCol.copy(this.colorsA.skyCol).lerp(this.colorsB.skyCol,t),this.weatherBlend.skyColFar.copy(this.colorsA.skyColFar).lerp(this.colorsB.skyColFar,t),ce.intensity=this.weatherBlend.amb,ce.color.copy(this.weatherBlend.col),Na.emissive.copy(ce.color),pe.intensity=this.weatherBlend.hem,pe.color.copy(this.weatherBlend.hemTop),pe.groundColor.copy(this.weatherBlend.hemGround),ue.intensity=this.weatherBlend.dir,ue.color.copy(this.weatherBlend.col),ue.sunOffset.fromArray([0,100,0]),ge.copy(this.weatherBlend.col),T.headlightsManual||(this.wA.headlights&&!this.wB.headlights?T.setHeadlights(t<.5):!this.wA.headlights&&this.wB.headlights&&T.setHeadlights(t>.5)),T.headlights&&this.updateHeadlightIntensity(),this.wA.dynamicFog||this.wB.dynamicFog?(this.vehicleFogLerp=Math.min(1,T.position.y/200),this.wA.dynamicFog&&!this.wB.dynamicFog?this.dynamicFogNear=1-this.vehicleFogLerp*i:this.wB.dynamicFog&&!this.wA.dynamicFog?this.dynamicFogNear=1-this.vehicleFogLerp*t:this.dynamicFogNear=1-this.vehicleFogLerp,this.dynamicFogFar=.2+.8*this.dynamicFogNear,se(this.weatherBlend.col.getHex(),we*this.weatherBlend.fogNear*this.dynamicFogNear,Math.max(50,we*this.weatherBlend.fogFar*this.dynamicFogFar))):se(this.weatherBlend.col.getHex(),we*this.weatherBlend.fogNear,we*this.weatherBlend.fogFar),Fe.userData.hasClouds.value=!1,Fe.userData.nearCol.value.copy(this.weatherBlend.skyCol),Fe.userData.farCol.value.copy(this.weatherBlend.skyColFar),Fe.uniformsNeedUpdate=!0,Zi.color.copy(this.weatherBlend.water),Zi.userData.sunCol.value=this.hexToArray(this.weatherBlend.col.getHex()),Zi.userData.skyCol.value=this.hexToArray(this.weatherBlend.waterSkyReflection.getHex()),Zi.uniformsNeedUpdate=!0}updateHeadlightIntensity(){T.setHeadlightIntensity(Math.max(.25,3.25-2.5*(ue.intensity+pe.intensity)))}onHeadlightsChanged(){this.catsEyesController.container.visible=T.headlights}nextSkin(){this.setSkin(this.skinList[++this.skinIndex%this.skinList.length]),this.onWeatherCycleChanged(Ui.value)}setTopography(e){window.localStorage.setItem("config-scene-topography",e)}nextTopography(){this.setTopography(this.topoList[++this.topoIndex%this.topoList.length])}loadGroundMaterialSkin(e,t,i,s,n=4){this.skin[e]?(i[e]||(i[e]=X(this.skin[e],n)),Mi.userData[t].value=i[e]):(s[e]||(s[e]=X(Yi.skins.default[e],n)),Mi.userData[t].value=s[e])}getSkinName(e){var t;return(null===(t=Yi.skins[e])||void 0===t?void 0:t.name)||e}setScene(e){this.setSkin(e.skin),this.setWeatherIndex(e.weatherIndex%this.skinWeatherList.length),this.onWeatherCycleChanged(Ui.value)}setSkin(e){this.skinName=e;let t=Yi.skins.default;this.skin=Yi.skins[e],this.cachedTextures[e]||(this.cachedTextures[e]={});let i=this.cachedTextures[e],s=this.cachedTextures.default;this.loadGroundMaterialSkin("grass","grassMap",i,s,2),this.loadGroundMaterialSkin("forest","forestMap",i,s),this.loadGroundMaterialSkin("heather","heatherMap",i,s),this.loadGroundMaterialSkin("gravel","gravelMap",i,s),this.loadGroundMaterialSkin("rock","rockMap",i,s),this.loadGroundMaterialSkin("sand","sandMap",i,s),this.loadGroundMaterialSkin("roadBase","roadBaseMap",i,s),this.skin.road?(i.road||(i.road=X(this.skin.road,8)),Be.map=i.road):(s.road||(s.road=X(t.road,8)),Be.map=s.road),Mi.userData.colouration.value=t.foliage.grassColouration,Ei[0].userData.colouration.value=t.foliage.grassColouration,Ei[1].userData.colouration.value=t.foliage.grassColouration,Pi[0].userData.colouration.value=t.foliage.treeColouration,Pi[1].userData.colouration.value=t.foliage.treeColouration,this.skin.foliage&&(this.skin.foliage.trees?(i.foliage||(i.foliage={}),i.foliage.trees||(i.foliage.trees=[X(this.skin.foliage.trees[0],4),X(this.skin.foliage.trees[1],4)]),Pi[0].map=i.foliage.trees[0],Pi[1].map=i.foliage.trees[1],this.skin.foliage.treesb&&wh.value.detailLodIndex>0?(i.foliage.treesb||(i.foliage.treesb=[X(this.skin.foliage.treesb[0],4),X(this.skin.foliage.treesb[1],4)]),Pi[0].userData.mapb.value=i.foliage.treesb[0],Pi[1].userData.mapb.value=i.foliage.treesb[1],Pi[0].userData.highDef.value=!0,Pi[1].userData.highDef.value=!0):(Pi[0].userData.mapb.value=null,Pi[1].userData.mapb.value=null,Pi[0].userData.highDef.value=!1,Pi[1].userData.highDef.value=!1)):(s.foliage||(s.foliage={}),s.foliage.trees||(s.foliage.trees=[X(t.foliage.trees[0],4),X(t.foliage.trees[1],4)]),Pi[0].map=s.foliage.trees[0],Pi[1].map=s.foliage.trees[1]),"grass"in this.skin.foliage?(i.foliage||(i.foliage={}),i.foliage.grass||(i.foliage.grass=X(this.skin.foliage.grass,4)),Ei[0].map=i.foliage.grass):(s.foliage||(s.foliage={}),s.foliage.grass||(s.foliage.grass=X(t.foliage.grass,4)),Ei[0].map=s.foliage.grass),"bush"in this.skin.foliage?(i.foliage||(i.foliage={}),i.foliage.bush||(i.foliage.bush=X(this.skin.foliage.bush,4)),Ei[1].map=i.foliage.bush):(s.foliage||(s.foliage={}),s.foliage.bush||(s.foliage.bush=X(t.foliage.bush,4)),Ei[1].map=s.foliage.bush),this.skin.foliage.grassColouration&&(Mi.userData.colouration.value=this.skin.foliage.grassColouration,Ei[0].userData.colouration.value=this.skin.foliage.grassColouration,Ei[1].userData.colouration.value=this.skin.foliage.grassColouration),this.skin.foliage.treeColouration&&(Pi[0].userData.colouration.value=this.skin.foliage.treeColouration,Pi[1].userData.colouration.value=this.skin.foliage.treeColouration)),Mi.uniformsNeedUpdate=!0,Ei[0].uniformsNeedUpdate=!0,Ei[1].uniformsNeedUpdate=!0,Pi[0].uniformsNeedUpdate=!0,Pi[1].uniformsNeedUpdate=!0,this.skin.walls?(i.walls||(i.walls={}),s.walls||(s.walls={}),jn.visible=!0,"sea"in this.skin.walls?(null==this.skin.walls.sea&&(jn.visible=!1),i.walls.sea||(i.walls.sea=X(this.skin.walls.sea,4)),jn.map=i.walls.sea):(s.walls.sea||(s.walls.sea=X(t.walls.sea,4)),jn.map=s.walls.sea),Dn.visible=!0,this.skin.walls.sea?(i.walls.sea||(i.walls.sea=X(this.skin.walls.sea,4)),Dn.map=i.walls.sea):(s.walls.sea||(s.walls.sea=X(t.walls.sea,4)),Dn.map=s.walls.sea),Fs.visible=!0,"drystone"in this.skin.walls?(null==this.skin.walls.drystone&&(Fs.visible=!1),i.walls.drystone||(i.walls.drystone=X(this.skin.walls.drystone,4)),Fs.map=i.walls.drystone):(s.walls.drystone||(s.walls.drystone=X(t.walls.drystone,4)),Fs.map=s.walls.drystone),"fence"in this.skin.walls?(i.walls.fence||(i.walls.fence=X(this.skin.walls.fence,4)),vn.map=i.walls.fence):(s.walls.fence||(s.walls.drystone=X(t.walls.fence,4)),vn.map=s.walls.fence)):(s.walls||(s.walls={}),s.walls.drystone||(s.walls.drystone=X(t.walls.drystone,4)),Fs.map=s.walls.drystone,s.walls.fence||(s.walls.fence=X(t.walls.fence,4)),vn.map=s.walls.fence,s.walls.sea||(s.walls.sea=X(t.walls.sea,4)),jn.map=s.walls.sea,Dn.map=s.walls.sea),Na.map=Fs.map,this.skin.friction?(ze(this.skin.friction.road),Oe(this.skin.friction.side),Re(this.skin.friction.grass)):(ze(1.4),Oe(.95),Re(.85)),this.weatherOverride=!1,this.skin.weathers?(this.weatherOverride=!0,this.skinWeatherList=this.skin.weathers,this.setWeather(this.skinWeatherList[this.curWeatherIndex%this.skinWeatherList.length])):this.setWeather(this.weatherList[this.curWeatherIndex%this.weatherList.length]),this.onWeatherCycleChanged(Ui.value)}setWeatherIndex(e){this.curWeatherIndex=e,this.weatherOverride?this.setWeather(this.skinWeatherList[e]):this.setWeather(this.weatherList[e])}nextWeather(){this.weatherOverride?this.setWeather(this.skinWeatherList[++this.curWeatherIndex%this.skinWeatherList.length]):this.setWeather(this.weatherList[++this.curWeatherIndex%this.weatherList.length])}updateAudio(){var e,t;this.t=Math.min(1,T.speed/35),this.t*=this.t,this.audioLerp=.9*this.audioLerp+.1*this.t,null===(e=this.ambientAudio)||void 0===e||e.setVolume(1-this.audioLerp),null===(t=this.windAudio)||void 0===t||t.setVolume(.8*this.audioLerp)}hexToArray(e){return this.tCol.setHex(e).toArray().concat(1)}setWeather(e){var t,i,s,n;this.weather=Yi.weathers[e],this.weatherB=Yi.weathers.sunset;let a=Yi.weathers.default,r=(null===(t=this.weather)||void 0===t||null===(i=t.audio)||void 0===i?void 0:i.ambiance)||a.audio.ambiance;z.getAudio(r.src,(e=>{this.ambientAudio&&this.ambientAudio.stop(),e.setLoop(!0),e.setLoopStart(r.ls),e.setLoopEnd(e.buffer.duration-r.le),this.ambientAudio=e,e.setVolume(0),e.play()}));let h=(null===(s=this.weather)||void 0===s||null===(n=s.audio)||void 0===n?void 0:n.wind)||a.audio.wind;z.getAudio(h.src,(e=>{this.windAudio&&this.windAudio.stop(),e.setLoop(!0),e.setLoopStart(h.ls),e.setLoopEnd(e.buffer.duration-h.le),this.windAudio=e,e.setVolume(0),e.play()})),ce.intensity=this.weather.amb,ce.color.setHex(this.weather.col),Na.emissive.copy(ce.color),pe.intensity=this.weather.hem,pe.color.setHex(this.weather.hemTop||this.weather.col),pe.groundColor.setHex(this.weather.hemGround||this.weather.col),ue.intensity=this.weather.dir,ue.color.setHex(this.weather.col),ue.sunOffset.fromArray(this.weather.sunPos||[0,100,0]),ge.setHex(this.weather.col),T.setHeadlightColour(16777215),se(this.weather.col,we*this.weather.fogNear,we*this.weather.fogFar),this.dynamicFog=!!this.weather.dynamicFog,this.cachedTextures[e]||(this.cachedTextures[e]={});let o=this.cachedTextures[e],l=this.cachedTextures.default;Fe.userData.hasClouds.value=!0,"skyMap"in this.weather?null==this.weather.skyMap?Fe.userData.hasClouds.value=!1:(o.skyMap||(o.skyMap=X(this.weather.skyMap,2)),Fe.map=o.skyMap):(l.skyMap||(l.skyMap=X(a.skyMap,2)),Fe.map=l.skyMap),this.weather.skyCol?(Fe.userData.nearCol.value.setHex(this.weather.skyCol),Fe.userData.farCol.value.setHex(this.weather.skyColFar)):(Fe.userData.nearCol.value.setHex(a.skyCol),Fe.userData.farCol.value.setHex(a.skyColFar)),Fe.uniformsNeedUpdate=!0,Zi.visible=!0,"water"in this.weather?(null==this.weather.water&&(Zi.visible=!1),Zi.color.setHex(this.weather.water),Zi.userData.sunCol.value=this.hexToArray(this.weather.col),Zi.userData.skyCol.value=this.hexToArray(this.weather.waterSkyReflection||a.waterSkyReflection),Zi.uniformsNeedUpdate=!0):Zi.color.setHex(a.water),T.setHeadlights(!!this.weather.headlights),this.onWeatherCycleChanged(Ui.value)}}Ra.config=Yi,Ra.sceneName="Peaks";var Ta=Ra;const Pa={},Ga=2*Math.PI;var Ba=class extends ut{constructor(...e){super(...e),this.gradients=[],this.scale=4e3,this.heightOffset=150,this.heightInitial=1,this.resolution=2,this.depth=3,this.upscale=5,this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=15,this.craterLayers=3,this.craterDepth=2,this.craterCache={},this.cellScaleMetres=1500,this.cellScaleWorld=1e3,this.squared=!1,this.compound=!1,this.useQuick=!1;let t=e[1]||{};this.seed=e[0]||Ve,this.heightScale=t.heightScale||1,this.heightInitial=t.heightInitial||1,this.resolution=t.resolution||5,this.depth=t.depth||3,this.upscale=t.upscale||3,this.heightOffset=t.heightOffset||0,this.upscaleFactor=t.upscaleFactor||2,this.craterLayers=null==t.craterLayers?2:t.craterLayers,this.craterProb=t.craterProb||.33,this.craterDepth=t.craterDepth||2,this.squared=t.squared||!1,this.squareLayers=t.squareLayers||this.depth,this.compound=t.compound||!1,this.cellScaleWorld=this.cellScaleMetres}clearCache(){if(this.cacheCount<=this.maxCached)return;let e,t;for(e in this.cache){for(t in this.cache[e])if(this.cacheAccess[e][t])this.cacheAccess[e][t]=!1;else if(delete this.cache[e][t],delete this.cacheAccess[e][t],e in this.craterCache&&delete this.craterCache[e][t],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}ts["heightmap-cache"]=this.cacheCount}checkCellCrater(e,t,i,s,n){var a;return this.craterCache[e]&&this.craterCache[e][t]||this.cacheCellCraters(e,t),null===(a=this.craterCache[e][t][n][Math.floor(i*(2*(n+1)))])||void 0===a?void 0:a[Math.floor(s*(2*(n+1)))]}cacheCellCraters(e,t){let i,s,n,a,r,h,o,l,d,c,p,u,g=[],m=0,x=new window.alea(""+this.seed+e+t);for(let v=0;v<this.craterLayers;v++){for(i={},s=2*(v+1),n=1/(2*s),h=1/s/2,o=h/2,r=h-o,m=this.craterProb*s*s,a=0;a<m;a++)c=o+x()*r,l=h-c,d=-l/2,p=Math.floor(x()*s),u=Math.floor(x()*s),i[p]||(i[p]={}),i[p][u]={x:p/s+n+(x()*l+d),y:-(1+x())*this.craterDepth,z:u/s+n+(x()*l+d),r:c,r2:c*c,r3:c*c*c*.512};g.push(i)}return this.craterCache[e]||(this.craterCache[e]={}),this.craterCache[e][t]=g,g}generateCell(e,t){let i,s,n,a,r=new window.alea(this.seed+e+t),h=this.resolution,o=[],l=[];for(i=0;i<this.depth;i++){for(l=[],s=0;s<h;s++)for(l.push([]),n=0;n<h;n++)a=r()*Ga,l[s].push({x:Math.cos(a),y:Math.sin(a)});o.push(l),h=this.getNextDepthResolution(h,i)}return o}getNextDepthResolution(e,t){return Math.round(e*this.upscaleFactor)}dotGridGradient(e,t,i,s,n){return this.grad=e[t][i],(s-t)*this.grad.x+(n-i)*this.grad.y}sharpLerp(e,t,i){return(t-e)*i+e}smoothLerp(e,t,i){return(t-e)*(3-2*i)*i*i+e}smootherLerp(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}getXZ(e,t,i){for(Pa.layer of(Pa.d=0,Pa.h=0,Pa.sq=this.resolution,Pa.sqb=Pa.sq-1,Pa.wx=e/this.cellScaleWorld,Pa.wz=t/this.cellScaleWorld,Pa.ox=Math.floor(Pa.wx),Pa.oz=Math.floor(Pa.wz),Pa.px=Pa.wx-Pa.ox,Pa.pz=Pa.wz-Pa.oz,Pa.cell=this.getCell(Pa.ox,Pa.oz),i=i||this.depth,Pa.depth=0,Pa.h=this.heightInitial,Pa.heightFactor=1,Pa.ch=0,Pa.cell)){if(Pa.depth==i)break;Pa.sx=Pa.px*Pa.sq,Pa.sz=Pa.pz*Pa.sq,Pa.ix=Math.floor(Pa.sx),Pa.ix1=Pa.ix+1,Pa.iz=Math.floor(Pa.sz),Pa.iz1=Pa.iz+1,Pa.qx=Pa.sx-Pa.ix,Pa.qz=Pa.sz-Pa.iz,Pa.n0=this.dotGridGradient(Pa.layer,Pa.ix,Pa.iz,Pa.sx,Pa.sz),Pa.ix1<Pa.sq?Pa.n1=this.dotGridGradient(Pa.layer,Pa.ix1,Pa.iz,Pa.sx,Pa.sz):Pa.n1=this.dotGridGradient(this.getCell(Pa.ox+1,Pa.oz)[Pa.depth],0,Pa.iz,Pa.sx-Pa.sq,Pa.sz),Pa.int0=this.smootherLerp(Pa.n0,Pa.n1,Pa.qx),Pa.iz1<Pa.sq?(Pa.n0=this.dotGridGradient(Pa.layer,Pa.ix,Pa.iz1,Pa.sx,Pa.sz),Pa.ix1<Pa.sq?Pa.n1=this.dotGridGradient(Pa.layer,Pa.ix1,Pa.iz1,Pa.sx,Pa.sz):Pa.n1=this.dotGridGradient(this.getCell(Pa.ox+1,Pa.oz)[Pa.depth],0,Pa.iz1,Pa.sx-Pa.sq,Pa.sz)):(Pa.n0=this.dotGridGradient(this.getCell(Pa.ox,Pa.oz+1)[Pa.depth],Pa.ix,0,Pa.sx,Pa.sz-Pa.sq),Pa.ix1<Pa.sq?Pa.n1=this.dotGridGradient(this.getCell(Pa.ox,Pa.oz+1)[Pa.depth],Pa.ix1,0,Pa.sx,Pa.sz-Pa.sq):Pa.n1=this.dotGridGradient(this.getCell(Pa.ox+1,Pa.oz+1)[Pa.depth],0,0,Pa.sx-Pa.sq,Pa.sz-Pa.sq)),Pa.int1=this.smootherLerp(Pa.n0,Pa.n1,Pa.qx),Pa.heightFactor=this.resolution/Pa.sq,this.compound&&(Pa.heightFactor*=Pa.h),Pa.cl=1,Pa.depth<this.craterLayers&&(Pa.craterFactor=1/(2*(Pa.depth+1)),Pa.c=this.checkCellCrater(Pa.ox,Pa.oz,Pa.px,Pa.pz,Pa.depth),Pa.c&&(Pa.d=(Pa.c.x-Pa.px)*(Pa.c.x-Pa.px)+(Pa.c.z-Pa.pz)*(Pa.c.z-Pa.pz),Pa.d<Pa.c.r2&&(Pa.ch-=Pa.c.y*(1-this.smoothLerpW(1-Pa.d/Pa.c.r2))*Pa.craterFactor*.5*Pa.cl,Pa.d*=Math.sqrt(Pa.d),Pa.d<Pa.c.r3&&(Pa.d=Pa.d/Pa.c.r3,Pa.ch+=Pa.c.y*(1-this.smootherLerpW(1-Pa.d))*Pa.craterFactor*Pa.cl,Pa.cl=Math.min(Pa.cl,Pa.d))))),Pa.h+=this.smootherLerp(Pa.int0,Pa.int1,Pa.qz)*Pa.heightFactor*Pa.cl,Pa.sq=this.getNextDepthResolution(Pa.sq,Pa.depth),Pa.depth++}return this.squared&&(Pa.h*=Pa.h),Pa.h+=Pa.ch,Pa.h*this.heightScale+this.heightOffset}getXZLayer(e,t,i){for(Pa.layer of(Pa.d=0,Pa.h=0,Pa.sq=this.resolution,Pa.sqb=Pa.sq-1,Pa.wx=e/this.cellScaleWorld,Pa.wz=t/this.cellScaleWorld,Pa.ox=Math.floor(Pa.wx),Pa.oz=Math.floor(Pa.wz),Pa.px=Pa.wx-Pa.ox,Pa.pz=Pa.wz-Pa.oz,Pa.cell=this.getCell(Pa.ox,Pa.oz),Pa.depth=0,Pa.h=this.heightInitial,Pa.heightFactor=1,Pa.ch=0,Pa.cell))if(Pa.depth<i)Pa.sq=this.getNextDepthResolution(Pa.sq,Pa.depth),Pa.depth++;else{if(Pa.depth==this.depth||Pa.depth>i)break;Pa.sx=Pa.px*Pa.sq,Pa.sz=Pa.pz*Pa.sq,Pa.ix=Math.floor(Pa.sx),Pa.ix1=Pa.ix+1,Pa.iz=Math.floor(Pa.sz),Pa.iz1=Pa.iz+1,Pa.qx=Pa.sx-Pa.ix,Pa.qz=Pa.sz-Pa.iz,Pa.n0=this.dotGridGradient(Pa.layer,Pa.ix,Pa.iz,Pa.sx,Pa.sz),Pa.ix1<Pa.sq?Pa.n1=this.dotGridGradient(Pa.layer,Pa.ix1,Pa.iz,Pa.sx,Pa.sz):Pa.n1=this.dotGridGradient(this.getCell(Pa.ox+1,Pa.oz)[Pa.depth],0,Pa.iz,Pa.sx-Pa.sq,Pa.sz),Pa.int0=this.smootherLerp(Pa.n0,Pa.n1,Pa.qx),Pa.iz1<Pa.sq?(Pa.n0=this.dotGridGradient(Pa.layer,Pa.ix,Pa.iz1,Pa.sx,Pa.sz),Pa.ix1<Pa.sq?Pa.n1=this.dotGridGradient(Pa.layer,Pa.ix1,Pa.iz1,Pa.sx,Pa.sz):Pa.n1=this.dotGridGradient(this.getCell(Pa.ox+1,Pa.oz)[Pa.depth],0,Pa.iz1,Pa.sx-Pa.sq,Pa.sz)):(Pa.n0=this.dotGridGradient(this.getCell(Pa.ox,Pa.oz+1)[Pa.depth],Pa.ix,0,Pa.sx,Pa.sz-Pa.sq),Pa.ix1<Pa.sq?Pa.n1=this.dotGridGradient(this.getCell(Pa.ox,Pa.oz+1)[Pa.depth],Pa.ix1,0,Pa.sx,Pa.sz-Pa.sq):Pa.n1=this.dotGridGradient(this.getCell(Pa.ox+1,Pa.oz+1)[Pa.depth],0,0,Pa.sx-Pa.sq,Pa.sz-Pa.sq)),Pa.int1=this.smootherLerp(Pa.n0,Pa.n1,Pa.qx),Pa.heightFactor=this.resolution/Pa.sq,this.compound&&(Pa.heightFactor*=Pa.h),Pa.cl=1,Pa.depth<this.craterLayers&&(Pa.craterFactor=1/(2*(Pa.depth+1)),Pa.c=this.checkCellCrater(Pa.ox,Pa.oz,Pa.px,Pa.pz,Pa.depth),Pa.c&&(Pa.d=(Pa.c.x-Pa.px)*(Pa.c.x-Pa.px)+(Pa.c.z-Pa.pz)*(Pa.c.z-Pa.pz),Pa.d<Pa.c.r2&&(Pa.ch-=Pa.c.y*(1-this.smoothLerpW(1-Pa.d/Pa.c.r2))*Pa.craterFactor*.5*Pa.cl,Pa.d*=Math.sqrt(Pa.d),Pa.d<Pa.c.r3&&(Pa.d=Pa.d/Pa.c.r3,Pa.ch+=Pa.c.y*(1-this.smootherLerpW(1-Pa.d))*Pa.craterFactor*Pa.cl,Pa.cl=Math.min(Pa.cl,Pa.d))))),Pa.h+=this.smootherLerp(Pa.int0,Pa.int1,Pa.qz)*Pa.heightFactor*Pa.cl,Pa.sq=this.getNextDepthResolution(Pa.sq,Pa.depth),Pa.depth++}return this.squared&&(Pa.h*=Pa.h),Pa.h+=Pa.ch,Pa.h*this.heightScale+this.heightOffset}smootherLerpW(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpW(e){return 1-e}smoothLerpW(e){return-1*(3-2*e)*e*e+1}},Wa=i.p+"static/media/road_offworld.235fa320.webp",Ea=i.p+"static/media/mars_road_base.4b28c294.webp",Za=i.p+"static/media/mars_surface.4083a724.webp",Fa=i.p+"static/media/mars_subsurface.d95fa5d1.webp",Ha=i.p+"static/media/mars_surface_bump.65340168.webp",Qa=i.p+"static/media/mars_cliff_bump.8e6fa674.webp",Ya=i.p+"static/media/mars_shale.9fd99ef9.webp",Va=i.p+"static/media/mars_shale_bump.c92f843f.webp",Ua=i.p+"static/media/mars_rubble.c8241124.webp",Xa=i.p+"static/media/mars_rubble_bump.80ebc535.webp",Ja=i.p+"static/media/mars_rock.75c6c859.webp",qa=i.p+"static/media/mars_rock_bump.15322551.webp",Ka=i.p+"static/media/mars_cliff.3ae2933c.webp",_a=i.p+"static/media/mars_barrier_wide.d7dc8819.webp",$a=i.p+"static/media/venus_road_base.20746f01.webp",er=i.p+"static/media/venus_surface.38f0fb31.webp",tr=i.p+"static/media/venus_shale.bafde95f.webp",ir=i.p+"static/media/venus_rubble.1f56f6fb.webp",sr=i.p+"static/media/venus_rock.c3115f27.webp",nr=i.p+"static/media/venus_cliff.fbb8e3df.webp",ar=i.p+"static/media/road_venus.61168361.webp",rr=i.p+"static/media/venus_barrier_wide.1b943c45.webp",hr=i.p+"static/media/moon_surface.f0a08f87.webp",or=i.p+"static/media/moon_rock.47e45865.webp",lr=i.p+"static/media/moon_gravel.b53b019d.webp",dr=i.p+"static/media/moon_shale.07a93da8.webp",cr=i.p+"static/media/moon_cliff.4bb9ff9d.webp",pr=i.p+"static/media/road_moon.c594cb0f.webp",ur=i.p+"static/media/clouds_01.e03e365b.webp",gr=i.p+"static/media/clouds_02.840643a8.webp",mr=i.p+"static/media/ambiance_offworld.41a010f6.mp3",xr=i.p+"static/media/wind_offworld_02.5468adb6.mp3",vr=i.p+"static/media/crossfade_fine.0d1ec73b.webp",wr=i.p+"static/media/crossfade_finest.da758a11.webp";const fr={topography:{normal:{heightmap:{heightScale:50,heightOffset:500,heightInitial:1.1,resolution:1,craterLayers:2,craterDepth:.75,upscaleFactor:2.5,depth:4,midlineDepth:5,squared:!0,compound:!0},roadWidth:3,smoothWindow:7},hard:{heightmap:{heightScale:40,heightOffset:500,heightInitial:1,resolution:2,craterLayers:3,craterDepth:1.5,upscaleFactor:2,depth:5,midlineDepth:5,squared:!0,compound:!1},roadWidth:2.8,smoothWindow:5},easy:{heightmap:{heightScale:45,heightOffset:500,heightInitial:1.5,resolution:2,craterLayers:2,craterDepth:.75,upscaleFactor:2,depth:3,midlineDepth:5,squared:!1,compound:!0},roadWidth:3.2,smoothWindow:7},flat:{heightmap:{heightScale:0,heightOffset:50,resolution:1,depth:1,upscale:1},roadWidth:20,smoothWindow:7}},weathers:{default:{audio:{ambiance:{src:mr,ls:.1,le:.1},wind:{src:xr,ls:.07,le:.07}},water:11378325,col:16121855,hemTop:6710886,hemGround:16777215,skyCol:5197130,skyColFar:15904116,skyMap:ur,amb:.2,hem:.3,dir:.5,fogNear:0,fogFar:1,sunPos:[0,100,0]},mars:{audio:{ambiance:{src:mr,ls:.1,le:.1},wind:{src:xr,ls:.07,le:.07}},col:16758891,skyCol:11378567,skyColFar:16761989,skyMap:null,hemTop:16769727,hemGround:0,water:11378325,amb:.4,hem:.2,dir:.5,fogNear:-.05,fogFar:1,sunPos:[0,100,-75]},marsRise:{col:5338516,skyCol:2368806,skyColFar:5338516,skyMap:null,amb:0,hem:.25,dir:.25,headlights:!0,headlightColour:9694965,fogNear:-.1,fogFar:1,sunPos:[0,100,200]},marsNight:{col:1579803,skyCol:1183766,skyColFar:1579803,skyMap:null,amb:.7,hem:.5,dir:.2,headlights:!0,headlightColour:9694965},venus:{audio:{ambiance:{src:mr,ls:.1,le:.1},wind:{src:xr,ls:.1,le:.1}},col:14729798,skyCol:12624422,skyColFar:12624422,skyMap:gr,water:null,amb:0,hem:.5,dir:.5,fogNear:-.1,fogFar:.5},venusSet:{col:6049571,skyCol:2366739,skyColFar:6049571,skyMap:gr,water:null,amb:.2,hem:.6,dir:.2,fogNear:-.2,fogFar:.5,headlights:!0,headlightColour:16773557},moon:{audio:{ambiance:{src:null,ls:.1,le:.1},wind:{src:null,ls:.07,le:.07}},col:1118480,skyCol:1118480,skyColFar:1118480,skyMap:null,hemTop:16777215,hemGround:0,water:null,amb:2,hem:0,dir:15,fogNear:.25,fogFar:1,sunPos:[-25,100,75]}},skins:{default:{name:"mars",weathers:["mars","marsRise"],surface:Za,subSurface:Fa,gravel:Ea,gravelBump:Qa,rock:Ja,cliff:Ka,shale:Ya,shaleBump:Va,rubble:Ua,rubbleBump:Xa,road:Wa,roadBase:Ea,friction:{road:.99,side:.95,grass:.9},walls:{barrier:_a}},venus:{name:"venus",weathers:["venus","venusSet"],surface:$a,subSurface:er,gravel:er,cliff:nr,rock:sr,shale:tr,rubble:ir,road:ar,roadBase:er,water:null,friction:{road:.99,side:.95,grass:.9},walls:{barrier:rr}},moon:{name:"moon",weathers:["moon"],surface:hr,subSurface:or,gravel:lr,cliff:cr,rock:or,shale:dr,rubble:null,road:pr,roadBase:lr,water:null,friction:{road:.99,side:.9,grass:.8},walls:{barrier:rr}}}};let br=new h.F({map:X(Za,0)});br.userData.surfaceMap={value:null},br.userData.surfaceBump={value:X(Ha,0)},br.userData.subSurfaceMap={value:null},br.userData.shaleMap={value:null},br.userData.shaleBump={value:X(Va,4)},br.userData.rockMap={value:null},br.userData.rockBump={value:X(qa,0)},br.userData.cliffMap={value:null},br.userData.cliffBump={value:X(Qa,0)},br.userData.gravelMap={value:null},br.userData.roadBaseMap={value:null},br.userData.fadeRockMap={value:X(vr,4)},br.userData.fadeFiner={value:X(wr,4)},br.onBeforeCompile=e=>(e.uniforms.surfaceMap=Ar.userData.surfaceMap,e.uniforms.surfaceBump=Ar.userData.surfaceBump,e.uniforms.subSurfaceMap=Ar.userData.subSurfaceMap,e.uniforms.shaleMap=Ar.userData.shaleMap,e.uniforms.shaleBump=Ar.userData.shaleBump,e.uniforms.rockMap=Ar.userData.rockMap,e.uniforms.rockBump=Ar.userData.rockBump,e.uniforms.cliffMap=Ar.userData.cliffMap,e.uniforms.cliffBump=Ar.userData.cliffBump,e.uniforms.gravelMap=Ar.userData.gravelMap,e.uniforms.roadBaseMap=Ar.userData.roadBaseMap,e.uniforms.fadeRockMap=Ar.userData.fadeRockMap,e.uniforms.fadeFiner=Ar.userData.fadeFiner,e.vertexShader=e.vertexShader.replace("#include <displacementmap_pars_vertex>","\n\nattribute float heightOffset;\nattribute float roadProximity;\nattribute float curvature;\nattribute vec2 wuv;\n\nvarying float height;\nvarying float steepness;\nvarying float roadProx;\nvarying float vCurvature;\nvarying vec2 vWv;\nvarying vec2 vWWv;\n\nuniform sampler2D displacementMap;\nuniform sampler2D fadeFiner;\n\nfloat wuvSize = 150.0;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 upvec = vec3(0.0,1.0,0.0);\n\n"),e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","\n\n  vec4 wPos = modelMatrix * vec4( position, 1.0 );\n  height = wPos.y + heightOffset;\n\n  vUv.x = wPos.x / 10.0;\n  vUv.y = wPos.z / 10.0;\n\n\n  // 0 is perfectly flat, 1 is 90 degrees\n  steepness = 1.0 - dot(normal, upvec);\n  steepness = clamp(steepness * 4.0, 0.0, 1.0);\n\n  // Anything up to 0.8 is 1\n  // 0.8 down to 0.6\n  // 0.6 and under is 0\n\n  // steepness = 1.0 - clamp((steepness - 0.6) / 0.2, 0.0, 1.0);\n  // steepness = 1.0 - map(steepness, 0.2, 0.7, 0.0, 1.0);\n\n  // steepness = 1.0 - steepness;//clamp((steepness * 2.0), 0.0, 1.0);\n  // steepness = map(steepness, 0.0, 1.0, 0.3, 0.7);\n\n  if(roadProximity < 0.0) {\n    roadProx = -roadProximity * 2.0;\n  } else {\n    roadProx = 0.0;\n  }\n  // roadProx = roadProximity;\n\n  // if(roadProx > -1.0) {\n  //   transformed.y += texture2D( fadeFiner, vUv ).r * 0.1;\n  // }\n\n  // MAGIC NUMBERS TO BE TWEAKED BASED ON HEIGHT PARAMETERS\n  if(curvature > 0.0) {\n    vCurvature = min(1.0, curvature * 5.0);\n  } else {\n    vCurvature = max(-1.0, curvature * 5.0);\n  }\n\n  // TODO PASS IN SCALE AS UNIFORM\n  vWv.x = wPos.x / wuvSize;\n  vWv.y = wPos.z / wuvSize;\n\n  vWWv.x = vWv.x / 10.0;\n  vWWv.y = vWv.y / 10.0;\n\n  transformed += vec3(0.0, heightOffset, 0.0);\n\n  // Experimenting with displacement map\n  if(steepness > 0.3) {\n    transformed += normalize( objectNormal ) * ( texture2D( fadeFiner, vUv ).x * (steepness-0.3) * 0.5 );\n  }\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","\n\n  varying float height;\n  varying float steepness;\n  varying float roadProx;\n  varying float vCurvature;\n  varying vec2 vWv;\n  varying vec2 vWWv;\n\n  uniform sampler2D surfaceMap;\n  uniform sampler2D subSurfaceMap;\n  uniform sampler2D surfaceBump;\n  uniform sampler2D shaleMap;\n  uniform sampler2D shaleBump;\n  uniform sampler2D rockMap;\n  uniform sampler2D rockBump;\n  uniform sampler2D cliffMap;\n  uniform sampler2D cliffBump;\n  uniform sampler2D gravelMap;\n  uniform sampler2D gravelBump;\n  uniform sampler2D roadBaseMap;\n  uniform sampler2D fadeRockMap;\n  uniform sampler2D fadeFiner;\n\n\n  vec4 terrainBlend(vec4 tx1, float w1, vec4 tx2, float w2, float depth) {\n    // Perform the blending\n    float ma = max(tx1.a + w1, tx2.a + w2) - depth;\n    float b1 = max(tx1.a + w1 - ma, 0.0);\n    float b2 = max(tx2.a + w2 - ma, 0.0);\n\n    return ((tx1 * b1) + (tx2 * b2)) / (b1 + b2);\n  }\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","\n\n  vec4 texelColor = texture2D( surfaceMap, vUv );\n\n  // Prep textures ahead of blending\n  vec4 surfaceTex = texture2D(surfaceMap, vUv); //vec4(0.7,0.7,0.0,1.0);\n  vec4 subSurfaceTex = texture2D(subSurfaceMap, vUv); //vec4(0.5,0.5,0.0,1.0);\n  vec4 shaleTex = texture2D(shaleMap, vUv);\n\n  vec4 rockTex = texture2D(rockMap, vUv); //vec4(0.3,0.3,0.1,1.0);\n\n  vec4 gravelTex = texture2D(gravelMap, vUv);\n  vec4 cliffTex = texture2D(cliffMap, vUv); //vec4(0.15,0.15,0.0,1.0);\n\n  // Get our fades at different scales\n  float fade0 = texture2D( fadeRockMap, vUv ).r;\n  float fade1 = texture2D( fadeRockMap, vWv ).r;\n  float fade2 = texture2D( fadeRockMap, vWWv ).r;\n\n  // Set alphas from maps etc.\n  float rockFade = texture2D(rockBump, vWv).r;\n  rockTex.a = texture2D(rockBump, vUv).r;\n  gravelTex.a = texture2D(gravelBump, vUv).r;\n  cliffTex.a = texture2D(cliffBump, vUv).r;\n  surfaceTex.a = texture2D(surfaceBump, vUv).r;\n  shaleTex.a = texture2D(shaleBump, vUv).r;\n\n  subSurfaceTex.a = fade1;\n\n  float roadProx2 = 1.0 - max(0.0, min(1.0, roadProx*0.25));\n\n  float w;\n\n  //// SAND/SURFACE\n\n  texelColor = mix(surfaceTex, subSurfaceTex, max(0.0,vCurvature-0.5)*fade2);\n\n  //// SHALE\n\n  if(vCurvature >= fade2) {\n    w = (vCurvature - fade2 * fade1) * roadProx2;\n\n    if(fade1 > 0.5) {\n      w *= 1.0 - (fade1 - 0.5) * 2.0;\n    }\n\n    w = min(0.6, w);\n    texelColor.a = 0.5;\n    texelColor = terrainBlend(texelColor, 1.0 - w, shaleTex, w, 0.1);\n  } else if(fade2 > 0.25) {\n    w = (fade2 - 0.25) * roadProx2;\n    texelColor = terrainBlend(texelColor, 1.0 - w, shaleTex, w, 0.1);\n  }\n\n  //// ROCK OUTCROPS\n\n  w = max(-0.8, ((vCurvature - fade2) * max(0.5, fade1))) * roadProx2;\n  rockTex.a -= rockFade;\n\n  if(w < 0.0) {\n    texelColor.a = 0.25 + fade2; //max(0.75, fade1);\n    texelColor = terrainBlend(texelColor, 1.0+w, rockTex, -w, 0.2);\n  } else if(fade1 > 0.5) {\n    texelColor.a = 0.25 + fade2;\n    w = (fade1 - 0.5) * 2.0;\n    texelColor = terrainBlend(texelColor, 1.0-w, rockTex, w, 0.2);\n  }\n\n  //// CLIFFS\n\n  if(steepness > 0.2) {\n    w = (steepness-0.2) + fade1 * 0.2;\n    texelColor = terrainBlend(texelColor, 1.0-w, cliffTex, w, 0.2);\n  }\n\n  //// ROAD PROXIMITY\n\n  if(roadProx > 0.0) {\n    w = min(1.0, (roadProx/2.5) - fade1*fade0);\n    texelColor = terrainBlend(texelColor, 1.0-w, gravelTex, w, 0.5);\n  }\n\n  texelColor.a = 1.0;\n\n  diffuseColor *= texelColor;\n\n"),e);const Ar=br,yr=(e,t)=>{Mr=Nr[Math.floor((e+t)/2)],Dr=Ir[e],Cr=ye,kr()},Ir=[5,10,15,20];let Dr=10;const Nr=[500,1e3,2e3,3e3];let Mr=1e3;let Cr=32;const jr=[],kr=()=>{jr.length=0;let e,t=new window.alea("bump");for(let i=0;i<Cr;i++){e=[];for(let i=0;i<Cr;i++)e.push(.1*t());e.push(e[0]),jr.push(e)}jr.push(jr[0])};yr(K,_),kr();var zr=fr;var Sr={rock:{src:i(38),obj:null}};var Or=class{constructor(e,t){this.loader=new is.a,this.assetCount=Object.keys(e).length,this.loadCount=0,this.onComplete=t,this.loadedAssets={};for(let i in e)this.loader.load(e[i].src.default,(e=>{this.loadedAssets[i]=e,this.onLoaded(i)}))}onLoaded(e){++this.loadCount>=this.assetCount&&this.onComplete(this.loadedAssets)}},Lr=i.p+"static/media/marsmarker.6a313c62.obj";const Rr={black:new h.D({color:5588019}),reflect:new h.D({color:2293725,emissive:2293725,emissiveIntensity:.2})};var Tr=class extends ns{constructo
r(...e){super(...e),this.geoSource=Lr,this.objectType="VergeMarker",this.materials=Rr}},Pr=i.p+"static/media/marsbarrier.c460e93d.obj";const Gr={black:new h.D({color:5588019}),reflect:new h.D({color:2293725,emissive:2293725,emissiveIntensity:.75})};const Br={VergeMarker:{class:Tr,geo:null},BarrierMarker:{class:class extends ns{constructor(...e){super(...e),this.geoSource=Pr,this.objectType="BarrierMarker",this.materials=Gr}},geo:null}},Wr="BarrierMarker";var Er=new class{constructor(){this.lastRepositionIndex=0,this.pools={},this.active=[],this.loadingQueue=[],this.getHeightAt=()=>{},this.loadCounter=0,this.didLoadBound=this.didLoad.bind(this),this.addObjectBound=this.addObject.bind(this),this.container=new h.G,this.container.matrixAutoUpdate=!1,this.loadingQueue=[]}destroy(){this.loadingQueue.length=0;for(let t in this.pools){var e;for(let e of this.pools[t])e.destroy();null===(e=Br[t].geo)||void 0===e||e.destroy()}for(let t of this.active)t.destroy();for(this.active.length=0,this.pools={};this.container.children.length;)this.container.remove(this.container.children[0])}initialise(e){this.getHeightAt=e,this.initLibrary()}reset(e){this.getHeightAt=e}initLibrary(){for(let e in Br)this.loadObject(e),this.pools[e]=[]}loadObject(e){let t=Br[e],i=new t.class;i.initialiseGeometry((()=>{t.geo=i,this.didLoad()}))}didLoad(){if(this.loadCounter++,this.loadCounter>=Object.keys(Br).length)for(;this.loadingQueue.length;){let e=this.loadingQueue.pop();this.addObject(...e)}}addCustom(e,t,i,s,n=null){if(n||(n=5),st.vehicleIndex>s+n)return;let a;for(e.keyName=null,e.worldPosition=t.clone(),e.position.subVectors(e.worldPosition,this.container.position),e.rotation.y=i,e.visible=!0,e.retireIndex=s+n,this.container.add(e),a=0;a<this.active.length&&!(this.active[a].retireIndex>e.retireIndex);a++);this.active.splice(a,0,e)}addObject(e,t,i,s,n=null){if(!(e in Br))return void console.error("Unrecognised roadside object type ",e);if(!Br[e].geo)return void this.loadingQueue.push([e,t,i,s,n]);let a,r;for(this.pools[e].length?a=this.pools[e].pop():(a=Br[e].geo.clone(),this.container.add(a),ts["roadside-objects"]++),a.keyName=e,a.worldPosition.copy(t),a.position.subVectors(a.worldPosition,this.container.position),a.rotation.y=i,a.visible=!0,a.retireIndex=s+5,null!==n&&a.setVariant(n),r=0;r<this.active.length&&!(this.active[r].retireIndex>a.retireIndex);r++);return this.active.splice(r,0,a),a}update(){if(this.active.length&&st.vehicleIndex>=this.active[0].retireIndex){let e=this.active.shift();e.visible=!1,e.keyName?this.pools[e.keyName].push(e):this.container.remove(e)}if(st.vehicleIndex-this.lastRepositionIndex>100){this.container.position.x=st.vehicleNode.p.x,this.container.position.z=st.vehicleNode.p.z,this.container.updateMatrix();for(let e of this.container.children)e.position.subVectors(e.worldPosition,this.container.position);this.lastRepositionIndex=st.vehicleIndex}}};const Zr=.8,Fr=151,Hr=.65,Qr=((e,t=.75,i=0,s=null,n=null,a=!1)=>{let r=new h.F({map:H(e,i,h.O),alphaTest:t,side:h.k,depthTest:!0,roughness:1,flatShading:!0});return s&&(r.normalMap=H(s,i)),r.onBeforeCompile=Y,r})(null,.75,8,null,null,!0),Yr={};class Vr extends Ms{constructor(e=null){super(),this.p=new h.W,this.ni=0,this.mapSource=null,this.normSource=null,this.material=Qr,this.mesh=new h.B(Vr.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=X(this.mapSource,4)),this.normSource&&(this.material.normalMap=X(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ni=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.uvDist=0,this.side=Math.sign(e.distance),this.drawNextNode()}drawNextNode(){for(Yr.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Yr.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Yr.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Yr.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Yr.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Yr.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Yr.dnp.z-this.oz)):(this.bounds.maxX=Yr.dnp.x-this.ox,this.bounds.minX=Yr.dnp.x-this.ox,this.bounds.maxY=Yr.dnp.y,this.bounds.minY=Yr.dnp.y,this.bounds.maxZ=Yr.dnp.z-this.oz,this.bounds.minZ=Yr.dnp.z-this.oz),Yr.j=0;Yr.j<this.drawNode.ps.length;Yr.j+=2)Yr.pj=this.drawNode.ps[Yr.j],Yr.nj=this.drawNode.ns[Yr.j],Yr.x=Yr.pj.x+Yr.nj.x*this.seg.distance,Yr.x1=Yr.x+.1*Yr.nj.x*this.side,Yr.z=Yr.pj.z+Yr.nj.z*this.seg.distance,Yr.z1=Yr.z+.1*Yr.nj.z*this.side,this.posArr[this.pi++]=Yr.x1-this.ox,this.posArr[this.pi++]=Yr.pj.y,this.posArr[this.pi++]=Yr.z1-this.oz,this.posArr[this.pi++]=Yr.x-this.ox,this.posArr[this.pi++]=Yr.pj.y+.52,this.posArr[this.pi++]=Yr.z-this.oz,this.posArr[this.pi++]=Yr.x-this.ox,this.posArr[this.pi++]=Yr.pj.y+.7200000000000001,this.posArr[this.pi++]=Yr.z-this.oz,this.posArr[this.pi++]=Yr.x1-this.ox,this.posArr[this.pi++]=Yr.pj.y+Zr,this.posArr[this.pi++]=Yr.z1-this.oz;return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(Yr.pj=this.drawNode.p,Yr.nj=this.drawNode.n,Yr.x=Yr.pj.x+Yr.nj.x*this.seg.distance,Yr.z=Yr.pj.z+Yr.nj.z*this.seg.distance,Yr.x1=Yr.x+.1*Yr.nj.x*this.side,Yr.z1=Yr.z+.1*Yr.nj.z*this.side,this.posArr[this.pi++]=Yr.x1-this.ox,this.posArr[this.pi++]=Yr.pj.y,this.posArr[this.pi++]=Yr.z1-this.oz,this.posArr[this.pi++]=Yr.x-this.ox,this.posArr[this.pi++]=Yr.pj.y+.52,this.posArr[this.pi++]=Yr.z-this.oz,this.posArr[this.pi++]=Yr.x-this.ox,this.posArr[this.pi++]=Yr.pj.y+.7200000000000001,this.posArr[this.pi++]=Yr.z-this.oz,this.posArr[this.pi++]=Yr.x1-this.ox,this.posArr[this.pi++]=Yr.pj.y+Zr,this.posArr[this.pi++]=Yr.z1-this.oz,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.1,this.oz),this.posAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),this.seg.contiguousStart||(this.p.x=this.posArr[0]+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=this.posArr[2]+this.mesh.position.z,Er.addObject(Wr,this.p,Math.PI+Math.PI/2*this.side-this.seg.startNode.a,this.seg.startNode.i)),!0)}retire(){this.mesh.visible=!1}computeBoundingSphere(){Yr.minX=this.bounds.minX,Yr.maxX=this.bounds.maxX,Yr.minY=this.bounds.minY,Yr.maxY=this.bounds.maxY,Yr.minZ=this.bounds.minZ,Yr.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(Yr.minX+Yr.maxX)/2,this.boundingSphere.center.y=(Yr.minY+Yr.maxY)/2,this.boundingSphere.center.z=(Yr.minZ+Yr.maxZ)/2,this.boundingSphere.radius=Math.sqrt((Yr.maxX-Yr.minX)*(Yr.maxX-Yr.minX)+(Yr.maxY-Yr.minY)*(Yr.maxY-Yr.minY)+(Yr.maxZ-Yr.minZ)*(Yr.maxZ-Yr.minZ))/2+10}static getNorms(){let e=[];for(let t=0;t<Fr;t++)e.push(0,1,0,0,1,0,0,1,0,0,1,0);return e}static getUV(){let e=[],t=0;for(let i=0;i<Fr;i++)t=.4*i,e.push(t,0,t,Hr,t,.9,t,1);return e}static getGeo(){let e=new h.g;e.setIndex(Vr.getIndex()),e.setAttribute("position",new h.o(new Float32Array(1812),3)),e.attributes.position.setUsage(h.l),e.setAttribute("uv",new h.o(new Float32Array(Vr.getUV()),2));let t=new Float32Array(Vr.getNorms());return e.setAttribute("normal",new h.o(t,3)),e}static getIndex(){let e,t,i,s,n,a,r,h,o=[];for(let l=0;l<Fr;l++)e=4*l,t=e+1,i=e+2,s=e+3,n=4*(l+1),a=n+1,r=n+2,h=n+3,o.push(e,t,n,t,a,n,t,i,a,i,r,a,i,s,r,s,h,r);return o}}class Ur extends Ts{generate(e){let t=e.prev;for(e=e.next;this.test(t)&&t.prev&&t.i>this.prev.endNode.i;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.test(e)&&e.i-t.i<Ze;)e=e.next;let i=new Rs(t,e,this.typeID,(t.w+Ge)*this.side);return this.prev.endNode.i==t.i&&this.prev.type==i.type&&(this.prev.contiguousEnd=!0,i.contiguousStart=!0,i.distance=this.prev.distance),i}testGenLeft(e){return!e.bridge&&null==e.lWallDist&&e.i>=this.prevLeft.endNode.i&&(e.g<-1.25||e.g<0&&e.da>.25&&e.h<.6)}testGenRight(e){return!e.bridge&&null==e.rWallDist&&e.i>=this.prevRight.endNode.i&&(e.g>1.25||e.g>0&&e.da<-.25&&e.h<.6)}testLeft(e){return!e.bridge&&e.p.y>3&&(e.g<-.75||e.g<.1&&e.da<-.05&&e.h<.6)}testRight(e){return!e.bridge&&e.p.y>3&&(e.g>.75||e.g>-.1&&e.da>.05&&e.h<.6)}}const Xr={Barrier:0},Jr=[Vr];var qr=class{constructor(e){this.stagedSegments=[],this.activeSegments=[],this.count=0,this.prevWasContiguous=!1,this.getHeightAt=e,this.container=new h.G,this.segments=[],this.initPools()}initialise(){this.renderIndex=st.vehicleIndex,this.genNode=st.vehicleNode,this.genIndex=st.vehicleIndex,this.genNodeLeft=st.vehicleNode,this.genNodeRight=st.vehicleNode,this.barrierGenerator=new Ur(st.vehicleNode,Xr.Barrier),this.segments.length=0;do{this.updateGeneration()}while(this.genIndex<st.vehicleIndex+We);for(;this.segments.length>0&&st.vehicleIndex+Ee>=this.segments[0].startNode.i;)this.drawNextSegment();do{this.updateStaged()}while(this.stagedSegments.length)}reset(e){this.getHeightAt=e,this.resetPools(),this.initialise()}initPools(){this.pools=[];let e,t,i=Object.keys(Xr).length;for(e=0;e<i;e++)t=new Jr[e](null,this.getHeightAt),this.container.add(t.mesh),this.pools.push([t])}resetPools(){for(;this.activeSegments.length;)this.retireSegment(this.activeSegments.shift())}setSkin(e){}handleMidlineReset(){(st.tail.i<this.genNodeLeft.i||st.tail.i<this.genNodeRight.i)&&(console.error("Wall controller must handle reset gracefully"),this.genNodeLeft=st.tail,this.genNodeRight=st.tail,this.renderIndex=st.tail.i)}updateGeneration(){this.genIndex++,this.genNodeLeft.i<this.genIndex&&(this.genNodeLeft=this.genNodeLeft.next,this.checkGenerateLeftSegment()),this.genNodeRight.i<this.genIndex&&(this.genNodeRight=this.genNodeRight.next,this.checkGenerateRightSegment())}update(){for(this.updateGeneration();this.segments.length>0&&st.vehicleIndex+Ee>=this.segments[0].startNode.i;)this.drawNextSegment();if(this.activeSegments.length)for(;st.vehicleIndex>this.activeSegments[0].endNode.i+10&&(this.retireSegment(this.activeSegments.shift()),0!=this.activeSegments.length););}updateStaged(){this.stagedSegments.length&&this.stagedSegments[0].drawNextNode()&&(this.stagedSegments.shift(),ts.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")")}checkGenerateLeftSegment(){this.addLeftSegment(this.barrierGenerator.generateLeft(this.genNodeLeft))}checkGenerateRightSegment(){this.addRightSegment(this.barrierGenerator.generateRight(this.genNodeRight))}addRightSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.rWallDist||t.rWallDist>e.distance)&&(t.rWallDist=e.distance,t.wallSide=-1),t=t.next;this.segments.push(e)}addLeftSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.lWallDist||t.lWallDist>-e.distance)&&(t.lWallDist=-e.distance,t.wallSide=1),t=t.next;this.segments.push(e)}getSegmentObject(e){let t;if(this.pools[e].length)t=this.pools[e].pop();else{t=new(0,Jr[e])(null,this.getHeightAt),this.container.add(t.mesh)}return t}drawNextSegment(){let e=this.segments.shift(),t=this.getSegmentObject(e.type);t.drawSegment(e)||this.stagedSegments.push(t),e.obj=t,this.activeSegments.push(e),ts.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")"}retireSegment(e){e.obj.retire(),this.pools[e.type].push(e.obj),ts.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")"}};const Kr=new h.F({map:null});const _r=new class{constructor(){this.loader=new is.a,this.meshes=[],this.template=null;let e=X(Xa);Kr.map=e,Kr.bumpMap=e,Kr.bumpScale=.02}getInstancedMesh(e){let t=new h.u(Sr.rock.geo.clone(),Kr,e);return t.matrixAutoUpdate=!1,t.instanceMatrix.setUsage(h.l),this.template||this.meshes.push(),t}};class $r extends _n{constructor(){super(),this.index=0,this.mesh=_r.getInstancedMesh(Mr),this.mesh.receiveShadow=!0,this.retireNodeIndex=-1,this.showNodeIndex=0}}$r.typeName="rubble",$r.rubbleController=_r;var eh=new $n($r,Mr,Dr);const th=new h.G,ih=new Ps(119),sh=new Ps(47,6.28),nh=new Ps(119,.7,-.1),ah={},rh=(e,t,i,s)=>(ah.x=Math.round((e-i.x)/Ne*Cr),ah.z=Math.round((t-i.z)/Ne*Cr),ah.x<0?ah.x+=Cr:ah.x>=Cr&&(ah.x-=Cr),ah.z<0?ah.z+=Cr:ah.z>=Cr&&(ah.z-=Cr),jr[ah.x][ah.z]);class hh extends ht{constructor(...e){super(...e),this.rubbleProb=.05,this.rubbleProb=100/(this.res1*this.res1)}lerpHeight(e,t,i){i.ga=Math.abs(i.g),i.w+=Ge+.25*i.ga;let s=0,n=16*(1-Math.max(.25,Math.min(.5,.25*i.ga)));if(i.d<i.w+n)if(i.d<i.w)s=i.y,i.d<i.w-1?s+=.15*rh(e,t,this.originPos,this.res):s+=rh(e,t,this.originPos,this.res)*(1-(i.w-i.d));else{let a=Math.max(0,Math.min(1,(i.d-i.w)/n));a=hh.hockeyLerp(a),s=this.heightmap.getXZ(e,t),s=s*a+i.y*(1-a)+rh(e,t,this.originPos,this.res)*Math.max(0,Math.min(1,1-(i.d-i.w)/n))}else s=this.heightmap.getXZ(e,t);return s}postProcessRow(e){eh.active&&this.placeRubbleRow(e)}placeRubbleRow(e){let t,i,s,n,a,r;for(let h=0;h<this.res;h++)t=e*this.res1+h,s=this.heights[t],i=this.signedRoadProx[t],n=[this.norms[3*t],this.norms[3*t+1],this.norms[3*t+2]],a=i>.2&&i<20?this.grads[t]<.1?1:.1-this.grads[t]:0,r=nh.next(),a*=Math.abs(this.curves[t]),a*this.rubbleProb>ih.next()&&(s-=i<Ge?Ge-i:i/20*.2,s-=.1*r,th.position.set((this.coords.x+e/this.res)*Ne+(ih.next()-.5),s-this.grads[t]/2,(this.coords.z+h/this.res)*Ne+(ih.next()-.5)),th.scale.set(r,r,r),th.rotation.y=sh.next(),th.rotation.x=sh.next(),th.updateMatrix(),eh.addInstance(this.lod,th.matrix,0,this.originIndex,th.position,n))}postProcessCell(){}display(){super.display(),1==this.lod&&this.tileset.mesh.visible&&eh.updateCurrentInstance(1)}}hh.paved=!1;var oh=hh;var lh=class extends ct{},dh=i.p+"static/media/earthrise.c3eff6a4.webp";class ch extends pt{constructor(e){super(),this.groundMaterial=Ar,this.nearGridCell=oh,this.farGridCell=lh,this.skinList=Object.keys(zr.skins),this.skinIndex=0,this.weatherList=Object.keys(zr.weathers),this.weatherIndex=0,this.skinWeatherList=[],this.weatherOverride=!1,this.topoList=Object.keys(zr.topography),this.topoIndex=0,this.ambiantAudio=null,this.windAudio=null,this.cachedTextures={default:{}},this.hasRubble=!0,this.lastVehicleIndex=0,this.loadState={init:!1,assets:!1,walls:!1,reset:!0,progress:0},this.p=new h.W,this.curWeatherIndex=0,this.audioLerp=0,this.getHeightAt=e,this.container=new h.G,this.config=zr}updateConfig(e,t){yr(e,t),eh.revert(Mr,Dr)}destroy(){var e,t;Er.destroy(),null===(e=this.ambientAudio)||void 0===e||e.stop(),null===(t=this.windAudio)||void 0===t||t.stop(),this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()})),this.container.clear();for(let i in this.cachedTextures)for(let e in this.cachedTextures[i])if(this.cachedTextures[i][e].isTexture)this.cachedTextures[i][e].dispose();else for(let t in this.cachedTextures[i][e])this.cachedTextures[i][e][t].isTexture&&this.cachedTextures[i][e][t].dispose();delete this.cachedTextures,this.destroyAssets(),eh.destroy()}initialise(e,t,i){var s;this.seed=e;let n=t.topography;this.topoIndex=this.topoList.indexOf(n),null===(s=this.heightmap)||void 0===s||s.destroy(),this.heightmap=new Ba(e,zr.topography[n].heightmap),this.loadState.init=!1,this.loadState.progress=0,de(zr.topography[n].smoothWindow),Pe(zr.topography[n].roadWidth),this.hasRubble=wh.value.detailLodIndex>0,this.loadState.assets||new Or(Sr,this.onAssetsLoaded.bind(this)),i()}onGridReady(){eh.updateVisible()}reset(e,t,i){this.loadState.reset=!1,this.initialise(e,t,(()=>{this.loadState.init=!0,i()}))}destroyAssets(){for(let e in Sr)Sr[e].geo.dispose()}onAssetsLoaded(e){for(let t in Sr)Sr[t].geo=e[t].children[0].geometry;eh.revert(Mr,Dr),this.loadState.assets=!0}loader(){return this.loadState.init?this.loadState.assets?this.loadState.walls?(this.loadState.reset||(this.lastVehicleIndex=st.vehicleIndex,this.wallController.reset(this.getHeightAt),Er.reset(this.getHeightAt),this.loadState.reset=!0),eh.revert(Mr,Dr),1):(this.wallController=new qr(this.getHeightAt),this.wallController.initialise(),this.container.add(this.wallController.container),this.loadState.walls=!0,.9):(this.loadState.walls=!1,.7):(this.lastVehicleIndex=st.vehicleIndex,this.earthrise||(this.earthrise=new h.B(new h.J(10,10),new h.C({map:X(dh),fog:!1,depthTest:!1,alphaTest:.5,side:h.k})),this.earthrise.renderOrder=-1,this.earthrise.rotation.y=-Math.PI/2,this.container.add(this.earthrise)),Er.initialise(this.getHeightAt),this.container.add(Er.container),this.hasRubble&&this.container.add(eh.container),eh.active=this.hasRubble,this.loadState.init=!0,.3)}handleMidlineReset(){this.wallController.handleMidlineReset()}update(){if(this.earthrise.visible&&(this.earthrise.position.x=Qe.position.x+100,this.earthrise.position.y=Qe.position.y+15,this.earthrise.position.z=Qe.position.z),st.vehicleIndexDidChange)do{this.lastVehicleIndex++,this.wallController.update(),Er.update(),this.hasRubble&&eh.updateVisible()}while(this.lastVehicleIndex<st.vehicleIndex);this.wallController.updateStaged()}nextSkin(){this.setSkin(this.skinList[++this.skinIndex%this.skinList.length])}setTopography(e){window.localStorage.setItem("config-scene-topography",e)}nextTopography(){this.setTopography(this.topoList[++this.topoIndex%this.topoList.length])}loadGroundMaterialSkin(e,t,i,s,n=4){this.skin[e]?(i[e]||(i[e]=X(this.skin[e],n)),Ar.userData[t].value=i[e]):(s[e]||(s[e]=X(zr.skins.default[e],n)),Ar.userData[t].value=s[e])}getSkinName(e){var t;return(null===(t=zr.skins[e])||void 0===t?void 0:t.name)||e}setScene(e){this.setSkin(e.skin),this.setWeatherIndex(e.weatherIndex%this.skinWeatherList.length)}sanitiseConfig(e){super.sanitiseConfig(e),e.set("weatherIndex",0,!0)}setSkin(e){this.skinName=e,this.earthrise.visible="moon"==e;let t=zr.skins.default;this.skin=zr.skins[e],this.cachedTextures[e]||(this.cachedTextures[e]={});let i=this.cachedTextures[e],s=this.cachedTextures.default;this.loadGroundMaterialSkin("surface","surfaceMap",i,s),this.loadGroundMaterialSkin("subSurface","subSurfaceMap",i,s),this.loadGroundMaterialSkin("shale","shaleMap",i,s,8),this.loadGroundMaterialSkin("gravel","gravelMap",i,s),this.loadGroundMaterialSkin("rock","rockMap",i,s),this.loadGroundMaterialSkin("cliff","cliffMap",i,s),this.loadGroundMaterialSkin("roadBase","roadBaseMap",i,s),Ar.uniformsNeedUpdate=!0,this.skin.road?(i.road||(i.road=X(this.skin.road,8)),Be.map=i.road):(s.road||(s.road=X(t.road,8)),Be.map=s.road),this.skin.rubble?(i.rubble||(i.rubble=X(this.skin.rubble,2)),eh.container.visible=!0,Kr.map=i.rubble):eh.container.visible=!1,this.skin.walls?(i.walls||(i.walls={}),s.walls||(s.walls={}),Qr.visible=!0,"barrier"in this.skin.walls?(null==this.skin.walls.barrier&&(Qr.visible=!1),i.walls.barrier||(i.walls.barrier=X(this.skin.walls.barrier,4)),Qr.map=i.walls.barrier):(s.walls.barrer||(s.walls.barrier=X(t.walls.barrier,4)),Qr.map=s.walls.barrier)):(s.walls||(s.walls={}),s.walls.barrier||(s.walls.barrier=X(t.walls.barrier,4)),Qr.map=s.walls.barrier),this.skin.friction?(ze(this.skin.friction.road),Oe(this.skin.friction.side),Re(this.skin.friction.grass)):(ze(1.4),Oe(.95),Re(.85)),this.weatherOverride=!1,this.skin.weathers?(this.weatherOverride=!0,this.skinWeatherList=this.skin.weathers,this.setWeather(this.skinWeatherList[this.curWeatherIndex%this.skinWeatherList.length])):this.setWeather(this.weatherList[this.curWeatherIndex%this.weatherList.length])}setWeatherIndex(e){this.curWeatherIndex=e,this.weatherOverride?this.setWeather(this.skinWeatherList[e]):this.setWeather(this.weatherList[e])}nextWeather(){this.weatherOverride?this.setWeather(this.skinWeatherList[++this.weatherIndex%this.skinWeatherList.length]):this.setWeather(this.weatherList[++this.weatherIndex%this.weatherList.length])}updateAudio(){var e,t;this.t=Math.min(1,T.speed/35),this.t*=this.t,this.audioLerp=.9*this.audioLerp+.1*this.t,null===(e=this.ambientAudio)||void 0===e||e.setVolume(1-this.audioLerp),null===(t=this.windAudio)||void 0===t||t.setVolume(.8*this.audioLerp)}setWeather(e){var t,i,s,n;this.weather=zr.weathers[e];let a=zr.weathers.default;this.ambientAudio&&this.ambientAudio.stop();let r=(null===(t=this.weather)||void 0===t||null===(i=t.audio)||void 0===i?void 0:i.ambiance)||a.audio.ambiance;null!==r.src&&z.getAudio(r.src,(e=>{this.ambientAudio&&this.ambientAudio.stop(),e.setLoop(!0),e.setLoopStart(r.ls),e.setLoopEnd(e.buffer.duration-r.le),this.ambientAudio=e,e.setVolume(0),e.play()})),this.windAudio&&this.windAudio.stop();let h=(null===(s=this.weather)||void 0===s||null===(n=s.audio)||void 0===n?void 0:n.wind)||a.audio.wind;null!==h.src&&z.getAudio(h.src,(e=>{e.setLoop(!0),e.setLoopStart(h.ls),e.setLoopEnd(e.buffer.duration-h.le),this.windAudio=e,e.setVolume(0),e.play()})),ce.intensity=this.weather.amb,ce.color.setHex(this.weather.col),pe.intensity=this.weather.hem,pe.color.setHex(this.weather.hemTop||this.weather.col),pe.groundColor.setHex(this.weather.hemGround||this.weather.col),ue.intensity=this.weather.dir,ue.color.setHex(this.weather.col),ue.sunOffset.fromArray(this.weather.sunPos||[0,100,0]),T.setHeadlightColour(this.weather.headlightColour||16777215),ge.setHex(this.weather.col),se(this.weather.col,we*this.weather.fogNear,we*this.weather.fogFar),this.cachedTextures[e]||(this.cachedTextures[e]={});let o=this.cachedTextures[e],l=this.cachedTextures.default;Fe.userData.hasClouds.value=!0,"skyMap"in this.weather?null==this.weather.skyMap?Fe.userData.hasClouds.value=!1:(o.skyMap||(o.skyMap=X(this.weather.skyMap,2)),Fe.map=o.skyMap):(l.skyMap||(l.skyMap=X(a.skyMap,2)),Fe.map=l.skyMap),this.weather.skyCol?(Fe.userData.nearCol.value.setHex(this.weather.skyCol),Fe.userData.farCol.value.setHex(this.weather.skyColFar)):(Fe.userData.nearCol.value.setHex(a.skyCol),Fe.userData.farCol.value.setHex(a.skyColFar)),T.setHeadlights(!!this.weather.headlights)}}ch.config=zr,ch.sceneName="Planet",ch.hasTrees=!1,ch.hasGrass=!1;const ph={Hills:Ta,Planet:ch},uh=["Hills","Planet"],gh=["easy","normal","hard"],mh=[.5,.75,1,1.5],xh={seed:"seed",sceneName:"config-scene-name",topography:"config-scene-topography",skin:"config-scene-skin",weatherIndex:"config-scene-weather-index",viewLodIndex:"config-view-lod-index",detailLodIndex:"config-detail-lod-index",antialias:"config-antialias",renderScale:"config-render-scale"},vh={seed:Ve,sceneName:"Hills",topography:"normal",skin:"default",weatherIndex:1,viewLodIndex:2,detailLodIndex:1,antialias:!0,renderScale:2};var wh=new class extends x{constructor(){super(),this.value={...vh},this.initialValue={...vh},this.initialNode=0,this.accumulatedProgress=0,this.sceneMeta={},this.buildSceneMeta(),this.loadConfig(),this.loadProgress();let e=window.location.search.substring(1).split("&");for(let t of e){let e=t.split("=");if("node"==e[0])try{let t=parseInt(e[1]);!isNaN(t)&&t>0&&(this.initialNode=t,console.log("Overwriting initial node from QS: ",e[1]))}catch(Kc){console.error("Failed to load initial node from QS:",e[1])}else"topo"==e[0]&&(gh.includes(e[1])||"flat"===e[1]?(this.set("topography",e[1],!0),console.log("Overwriting topography from QS: ",e[1])):(console.warn("Invalid topo parameter; reverting to 'normal'"),this.set("topography","normal",!0)))}}resetMemory(){console.log("Resetting config to defaults");for(let e in this.value)window.localStorage.setItem(xh[e],vh[e])}buildSceneMeta(){let e,t={current:vh.sceneName,hasCycles:!1,scenes:{}};for(let i in ph){e=ph[i].config,t.scenes[i]={topography:Object.keys(e.topography),skins:Object.keys(e.skins)};let s={},n={};for(let a in e.skins)s[a]=e.skins[a].weathers.slice(),n[a]=e.skins[a].name,t.scenes[i].hasCycles=t.hasCycles||void 0!==e.skins[a].cycles;t.scenes[i].skinWeathers=s,t.scenes[i].skinNames=n}return this.sceneMeta=t,this.sceneMeta}set(e,t,i=!1){i||!d.value?(super.set(e,t,i),window.localStorage.setItem(xh[e],t)):console.warn("Preventing config update to "+e+" during load")}loadConfig(){let e,t;for(t in this.value){if(e=window.localStorage.getItem(xh[t])||vh[t],"sceneName"==t)e in ph||(console.warn("Loaded unrecognsied scene name "+e+", restoring default"),e=vh.sceneName),this.sceneMeta.current=e;else try{e=JSON.parse(e)}catch(Kc){}console.log("SceneConfig: Load ",t,e),this.set(t,e,!0),this.initialValue[t]=e}}revertProgress(){this.saveProgress(0,0),this.saveProgress=()=>{}}saveProgress(e=0,t=null){let i=this.getConfigKey();window.localStorage.setItem(i+"_node",Math.max(0,e-5)),null!==t&&window.localStorage.setItem(i+"_progress",t)}loadProgress(){this.convertLegacyProgress(),this.initialNode=0,this.accumulatedProgress=0;let e=this.getConfigKey(),t=e+"_node";if(localStorage.getItem(t)){let e=parseInt(localStorage.getItem(t));e&&(this.initialNode=e)}let i=e+"_progress";if(localStorage.getItem(i)){let e=parseInt(localStorage.getItem(i));e&&(this.accumulatedProgress=e)}if(localStorage.getItem("restore-progress")){let e=0;try{e=parseInt(localStorage.getItem("restore-progress")),e>0&&(this.accumulatedProgress+=e,localStorage.setItem(i,this.accumulatedProgress),console.log("Storing accumulated progress ",e,this.accumulatedProgress))}catch(Kc){}localStorage.removeItem("restore-progress")}console.log("Loaded node and progress "+this.initialNode+", "+this.accumulatedProgress+" for confKey "+e)}convertLegacyProgress(){try{let e,t,i,s,n=JSON.parse(localStorage.getItem("analytics_seeds")),a=["easy","normal","hard"];for(t of n)if(t)for(i of(e=t.toString(),a))s=e+"?"+i,localStorage.getItem(s)&&(console.log("Converting legacy progress for seed ",e,i),localStorage.setItem(e+"_Hills_"+i+"_node",localStorage.getItem(s)),localStorage.removeItem(s))}catch(Kc){}}getConfigKey(){return this.value.seed+"_"+this.value.sceneName+"_"+this.value.topography}},fh=i.p+"static/media/rolling_06.84342ca7.mp3",bh=i.p+"static/media/veh_accel_06.8478c426.mp3",Ah=i.p+"static/media/veh_car.9991c48a.svg",yh=i.p+"static/media/veh_bus.9b1fce50.svg",Ih=i.p+"static/media/veh_bike.af1bd6f4.svg",Dh=i.p+"static/media/roadster-07b_map.17a06a45.jpg";const Nh={Chase:{pitch:{near:.3,far:.2},yOffset:{near:.8,far:1},posOffset:[0,0,1.4],range:{near:4,far:4.75},farSpeed:45,smoothFactor:1.5},ChaseFar:{pitch:{near:.25,far:.15},yOffset:{near:1,far:2},posOffset:[0,0,1.4],range:{near:6,far:9},farSpeed:45,smoothFactor:1.25},FirstPerson:{pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:[0,.4,3],range:{near:.75,far:.75},farSpeed:45,smoothFactor:.3},Bonnet:{pitch:{near:.05,far:.05},yOffset:{near:.6,far:.6},posOffset:[0,.4,3.4],range:{near:0,far:0},farSpeed:45,smoothFactor:.3,hideVehicle:!0}},Mh={Debug:{enabled:!1,name:"Debug",skins:[],bodyObj:i(19),wheelObj:i(20),icon:Ah,audio:{roll:fh,engine:bh},wheels:{tyreWidth:.1,width:1.36,length:2.75,radius:.342665,circumference:2.1,travel:.07},metrics:{shadowMapSize:4,accel:9,reverse:5,jerk:48,brake:8,mass:700,maxSteer:.68,axleHeight:.342665,dampening:.04,rockFactor:4,drag:.001,topSpeed:45,rollResistance:.06,steerInterval:1,slipBase:.1,slipMod:.05,aeroFactor:.5,headlightPos:{x:.64,y:.7,z:3.1}},cameras:Nh},Bike:{enabled:!1,name:"Bike",skins:[],bike:!0,bodyObj:i(39),wheelObj:i(40),icon:Ih,audio:{roll:fh,engine:bh},materials:{},wheels:{tyreWidth:.077,width:0,length:1.95,radius:.26,circumference:1.63,travel:.07},metrics:{shadowMapSize:4,steerSpeed:1.57,accel:11,reverse:5,jerk:48,brake:8,mass:700,steerAccel:8,maxSteer:.4,dampening:.08,rockFactor:5,drag:.001,topSpeed:53,rollResistance:.04,steerInterval:1.8,slipBase:1,slipMod:0,aeroFactor:.4,headlightPos:{x:.3,y:.75,z:2.25}},cameras:{Chase:{pitch:{near:.3,far:.2},yOffset:{near:.8,far:1},posOffset:[0,0,1],range:{near:3.5,far:4.5},farSpeed:50,smoothFactor:.85,hideVehicle:!1},ChaseFar:{pitch:{near:.25,far:.15},yOffset:{near:1,far:2},posOffset:[0,0,1],range:{near:6,far:9},farSpeed:50,smoothFactor:.65},FirstPerson:{pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:[0,.4,2.3],range:{near:.75,far:.75},farSpeed:50,smoothFactor:.2,hideVehicle:!0}}},Bus:{enabled:!0,name:"Coach",skins:[],bodyObj:i(41),wheelObj:i(42),icon:yh,audio:{roll:fh,engine:bh},wheels:{tyreWidth:.2,width:2.24,length:5.47,radius:.3955,circumference:2.485,travel:.16},metrics:{shadowMapSize:8,steerSpeed:.45,accel:6,reverse:5,jerk:6,brake:4,mass:1400,steerAccel:6,maxSteer:.65,axleHeight:.3955,dampening:.06,rockFactor:5,drag:.002,topSpeed:32,rollResistance:.03,steerInterval:2,slipBase:1,slipMod:.25,aeroFactor:0,headlightPos:{x:.75,y:.75,z:7.25}},cameras:{Chase:{pitch:{near:.35,far:.3},yOffset:{near:1.6,far:2.6},posOffset:[0,0,2.7],range:{near:9,far:11},farSpeed:30,smoothFactor:1.6},ChaseFar:{pitch:{near:.4,far:.3},yOffset:{near:2,far:4},posOffset:[0,0,2.7],range:{near:14,far:16},farSpeed:30,smoothFactor:1.4},FirstPerson:{pitch:{near:.05,far:.05},yOffset:{near:1.8,far:1.8},posOffset:[0,0,6.6],range:{near:.75,far:.75},farSpeed:30,smoothFactor:.4,hideVehicle:!0}}},Roadster:{enabled:!0,name:"Roadster",bodyObj:i(43),wheelObj:i(44),map:Dh,icon:Ah,audio:{roll:fh,engine:bh},wheels:{tyreWidth:.1,width:1.36,length:2.75,radius:.342665,circumference:2.1,travel:.07},skins:{basic:{body:16316664}},metrics:{shadowMapSize:4,steerSpeed:1.57,accel:9,reverse:5,jerk:48,brake:8,mass:700,steerAccel:12,maxSteer:.68,axleHeight:.342665,dampening:.04,rockFactor:4,drag:.001,topSpeed:45,rollResistance:.06,steerInterval:1,slipBase:.2,slipMod:.1,aeroFactor:.4,headlightPos:{x:.64,y:.7,z:3.1}},cameras:Nh},Rover:{enabled:!1,name:"Rover",skins:[],bodyObj:i(19),wheelObj:i(20),icon:Ah,audio:{roll:fh,engine:bh},materials:{},wheels:{tyreWidth:.25,width:2,length:3,radius:.4,circumference:2.513,travel:.15},metrics:{shadowMapSize:4,steerSpeed:1.57,accel:7,reverse:5,jerk:48,brake:8,mass:700,steerAccel:12,maxSteer:.68,axleHeight:.4,dampening:.03,rockFactor:5,drag:.001,topSpeed:35,rollResistance:.06,steerInterval:1,slipBase:.1,slipMod:.05,aeroFactor:.5,headlightPos:{x:.64,y:.7,z:3.1}},cameras:Nh}};const Ch={Roadster:Mh.Roadster,Bike:Mh.Bike,Coach:Mh.Bus},jh=1;const kh=0,zh=1,Sh=2,Oh={type:"config-vehicle-type",mode:"config-vehicle-mode",input:"config-vehicle-input"},Lh={type:"Roadster",mode:0,input:0};var Rh=new class extends x{constructor(){super(),this.value=Lh,this.loadConfig()}set(e,t){super.set(e,t),window.localStorage.setItem(Oh[e],t)}resetMemory(){for(let e in this.value)window.localStorage.setItem(Oh[e],Lh[e])}loadConfig(){let e,t;for(t in this.value)e=window.localStorage.getItem(Oh[t])||Lh[t],isNaN(parseInt(e))||(e=parseInt(e)),this[t]=e,console.log("VehicleConfig: Load ",t,e),this.set(t,e)}};const Th="analytics_returningPlayer",Ph="analytics_lastActive",Gh={newUser:null==localStorage.getItem(Th),lastActiveTime:localStorage.getItem(Ph)};var Bh=Gh;var Wh=new class{constructor(){this.speed=0,this.dist=0}cosntructor(){this.reset()}reset(){this.speed=0,this.dist=0}};const Eh=[.44704,.277778],Zh=[90*Eh[0],150*Eh[1]];var Fh=new class extends l{getConversion(e){this.conversion=Eh[e],this.default=Zh[e],null!=this.value&&this.set(5*Math.round(this.value/this.conversion/5)*this.conversion)}constructor(){super(),this.default=Zh[0],this.value=JSON.parse(window.localStorage.getItem("cruise-control")),this.conversion=Eh[f.Units],this.getConversionBound=this.getConversion.bind(this),this.vehicleTypeChangedBound=this.vehicleTypeChanged.bind(this),M.cruisecontrol&&!isNaN(M.cruisecontrol)&&this.set(M.cruisecontrol/3.6),f.addListener(v.Units,this.getConversionBound),Rh.addListener("type",this.vehicleTypeChangedBound)}vehicleTypeChanged(e){this.default=Math.min(Zh[f.Units],T.metrics.topSpeed),null!==this.value&&this.set(this.default)}set(e){if(this.value!==e){if(T.metrics&&e>T.metrics.topSpeed)e=T.metrics.topSpeed;else if(e<0)return;null!=e&&(e=Math.max(Math.min(50,e),0),e=5*Math.round(e/this.conversion/5)*this.conversion),window.localStorage.setItem("cruise-control",e),this.value=e,this.onChanged(this.value)}}inc5(){this.set(this.value+5*this.conversion)}dec5(){this.set(this.value-5*this.conversion)}};var Hh=new class extends l{},Qh=new l(null);const Yh="https://34.250.221.219:443",Vh="initialise",Uh="feedback",Xh="analytics_returningPlayer",Jh="analytics_totalTime",qh="analytics_totalDist",Kh="analytics_seeds",_h="analytics_disable",$h="analytics_lastVisit",eo="analytics_lastActive",to="analytics_revisits",io="analytics_sessions",so="analytics_stickySteer";var no=new class{constructor(){this.socket=null,this.connected=!1,this.playerProfile={},this.midlineLoadTime=0,this.envLoadTime=0,this.startTime=Date.now(),this.onTickerStateChangedBound=this.onTickerStateChanged.bind(this),this.onCruiseTargetBound=this.onCruiseTarget.bind(this),this.doInitialiseAnalytics=!1,this.analyticsInitialised=!1,I.addStateListener(this.onTickerStateChangedBound),Fh.addListener(this.onCruiseTargetBound),j.addListener((e=>{this.sendUpdate("autodrive",e)})),this.loadPlayerProfile(),this.initialiseConnection()}onTickerStateChanged(e){this.connected&&this.sendUpdate("paused",e)}onCruiseTarget(e){this.connected&&this.sendUpdate("cruiseControl",e)}checkLocation(e){var t=new XMLHttpRequest;t.open("GET","https://ipapi.co/json"),t.setRequestHeader("Content-Type","application/json"),t.timeout=3e3,t.send(null),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status)try{var i=JSON.parse(t.response);console.log("Analytics: Got location of ",i.country_name),e({country:i.country,city:i.city,region:i.region})}catch(Kc){e({country:"unknown",city:"unknown",region:"unknown"})}}}initialiseConnection(){if(window.localStorage.getItem("analytics-disabled"))return console.log("Analytics: Disabled; will not connect"),window.localStorage.removeItem("unsent-feedback"),void(this.socket={emit:()=>{}});this.connected||(console.log("Analytics: Initialising socket"),this.socket=Object(_e.a)(Yh,{reconnection:!1,rejectUnauthorized:!1}),this.socket.on("connect",(()=>{console.log("Analytics: Connected"),this.connected=!0,this.doInitialiseAnalytics&&this.initialiseAnalytics(),g()&&this.sendUpdate("mobile",!0)})),this.socket.on("pre_initialise",(e=>{Qh.set(e.cumulativeMeters);let t=document.getElementById("splash-player-count");t&&e.playerCount&&(t.innerHTML=e.playerCount+" playing &#183; "),e.latestVersion&&((e,t)=>{if(e===t)return 0;let i=$i(t),s=$i(e);return 1e5*s.major+1e4*s.minor+1e3*s.patch+10*s.release+s.releaseVersion>1e5*i.major+1e4*i.minor+1e3*i.patch+10*i.release+i.releaseVersion?1:-1})(e.latestVersion,es)>0&&(console.log("! Version out of date - prompting refresh"),document.getElementById("update-alert").style.display="block")})),this.socket.on("connect_error",(e=>{console.error("Analytics: Connection failed"),console.error(e),this.connected=!1})),Hh.set(this.socket))}initialiseAnalytics(){if(this.getStorage(_h))return;if(this.analyticsInitialised)return;if(window.onbeforeunload=()=>this.savePlayerProfile(),!this.connected)return void(this.doInitialiseAnalytics=!0);let e={sceneConfig:{seed:Ve,...wh.value,initNode:wh.initialNode,accumProg:wh.accumulatedProgress},vehConfig:Rh.value,playerProfile:this.playerProfile};"default"==wh.value.skin&&("Planet"==wh.value.sceneName?e.sceneConfig.skin="mars":e.sceneConfig.skin="summer"),window.localStorage.getItem("analytics-nowrite")&&(e.playerProfile.noWriteAnalytics=!0),this.socket.emit(Vh,e),this.sendCachedFeedback(),this.analyticsInitialised=!0}loadPlayerProfile(){let e={totalTime:0,totalDist:0,seeds:[],browser:this.checkBrowser(),resolution:{w:window.screen.width,h:window.screen.height},midlineLoadTime:this.midlineLoadTime,envLoadTime:this.envLoadTime,visitTime:Date.now(),revisitCount:0,isRevisit:!1,lastVisit:null,cameraMode:"Chase",isMobile:g(),version:es,sessionCount:1,stickySteerCount:0,pixelRatio:window.devicePixelRatio};if(e.returningPlayer=!Bh.newUser,e.totalTime=0,e.returningPlayer)if(e.totalTime=this.getStorage(Jh,parseInt)||0,e.totalDist=this.getStorage(qh,parseInt)||0,e.seeds=this.getStorage(Kh)||[],e.lastVisit=this.getStorage($h,parseInt)||null,e.lastActive=this.getStorage(eo,parseInt)||null,e.revisitCount=this.getStorage(to,parseInt)||0,e.sessionCount=this.getStorage(io,parseInt)||1,e.stickySteerCount=this.getStorage(so,parseInt)||0,e.sessionCount++,e.lastActive){Date.now()-e.lastActive>3e4&&(e.revisitCount++,e.isRevisit=!0)}else e.revisitCount++,e.isRevisit=!0;return this.playerProfile=e,this.recordSeed(Ve),this.playerProfile}recordSeed(e){this.playerProfile.seeds.includes(e)||this.playerProfile.seeds.push(e)}savePlayerProfile(){this.playerProfile&&(this.playerProfile.totalDist+=Wh.dist,this.setStorage(Xh,!0),this.setStorage(Jh,Math.floor(this.playerProfile.totalTime+1e3*I.playTime)),this.setStorage(qh,this.playerProfile.totalDist),this.setStorage(Kh,this.playerProfile.seeds),this.setStorage($h,this.playerProfile.visitTime),this.setStorage(eo,Date.now()),this.setStorage(to,this.playerProfile.revisitCount),this.setStorage(io,this.playerProfile.sessionCount),this.setStorage(so,this.playerProfile.stickySteerCount))}sendFeedback(e){if(this.connected)this.sendUpdate(Uh,e);else{let t=[];if(window.localStorage.getItem("unsent-feedback"))try{t=JSON.parse(window.localStorage.getItem("unsent-feedback"))}catch(Kc){t=[]}t.push(e),window.localStorage.setItem("unsent-feedback",JSON.stringify(t))}}sendCachedFeedback(){let e=[];if(window.localStorage.getItem("unsent-feedback"))try{e=JSON.parse(window.localStorage.getItem("unsent-feedback"));for(let t of e)this.sendUpdate(Uh,t)}catch(Kc){console.error("Could not write unsent feedback from prior session")}window.localStorage.removeItem("unsent-feedback")}sendUpdate(e,t){var i;null===(i=this.socket)||void 0===i||i.emit(e,t)}getStorage(e,t=null){let i=null;try{i=JSON.parse(window.localStorage.getItem(e)),"function"===typeof t&&(i=t(i))}catch(Kc){console.warn("Could not parse analytics item ",e),console.log(window.localStorage.getItem(e)),console.log(Kc),window.localStorage.removeItem(e)}return i}setStorage(e,t){void 0!==t&&("number"===typeof t&&isNaN(t)?console.warn("Attempting to store NaN value ",e):window.localStorage.setItem(e,JSON.stringify(t)))}checkBrowser(){return-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":-1!=navigator.userAgent.indexOf("Edg")?"Edge":-1!=navigator.userAgent.indexOf("Chrome")?"Chrome":-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?"IE":"unknown"}logStickySteer(){this.playerProfile.stickySteerCount++,this.sendUpdate("stickySteer",this.playerProfile.stickySteerCount)}};var ao=new h.P;const ro=new h.C({color:110832,fog:!1,depthTest:!1});h.G;class ho extends h.G{constructor(e){super();let t=new h.S(.5,8,8);this.mesh=new h.B(t,ro.clone()),(null===e||void 0===e?void 0:e.scale)&&this.scale.set(e.scale,e.scale,e.scale),(null===e||void 0===e?void 0:e.color)&&this.mesh.material.color.setHex(e.color),this.add(this.mesh),ao.add(this)}}const oo=Math.floor(le/2);let lo=!1;const co=10,po=(wh.value.topography,.463),uo=10,go=2,mo=.18,xo={},vo={vecA:new h.W,vecB:new h.W};var wo=class{constructor(e=!1){this.lineMat=new h.w({color:16724787}),this.lineIndex=0,this.head=null,this.tail=null,this.discretisedTail=null,this.origin=new h.W,this.prevOriginSide=0,this.originOverflow=0,this.antiTarget=new h.W,this.antiTargetRevert=40,this.antiTargetRange=0,this.antiTargetDebug=lo?new ho({color:16711935,scale:10}):null,this.antiTargetTrigger=0,this.antiTargetTriggerPoint=new h.W,this.antiTargetTriggerCount=0,this.antiWeight=0,this.antiResetIndex=0,this.maxRetractIndex=0,this.bridging=!1,this.antiBridgePoint=new h.W,this.bridge={landing:new h.W,distance:0,spawnNode:null},this.turnTrackers=[{i:0,m:15,r:15,n:null,a:3.3,da:0,o:0},{i:1,m:30,r:10,n:null,a:3.3,da:0,o:.5},{i:2,m:60,r:15,n:null,a:3.4,da:0,o:.75},{i:3,m:120,r:20,n:null,a:3.6,da:0,o:.8}],this.trackIndex=null,this.vehicleDebug=lo?new ho({color:16711680,scale:.5}):null,this.antiDir=new h.W,this.originDir=new h.W(0,0,1),this.midlineDir=new h.W,this.midlineOrth=new h.W,this.hasInitGeneration=!1,this.generationResets=0,this.hasInitSmoothing=!1,this.hasInitDiscretisation=!1,this.loaderIteration=0,this.tVec=new h.W,this.h1=0,this.h2=0,this.feelDir=new h.W(1,0,.5),this.feelLeft=lo?new ho({color:255,scale:1}):null,this.feelRight=lo?new ho({color:16711680,scale:1}):null,this.prevT=0,this.byWater=!1,this.waterFactor=0,this.closestApproach=0,this.trackRevertCount=0,this.allowEmergencyBridge=!1,this.landing=new h.W,this.smoothWindowHead=null,this.doUpdate=0,this.didExtend=!1,this.lineOrigin=new h.W,this.container=new h.G,lo=!1,lo&&(this.lineArr=new Float32Array(15e4),this.lineGeo=new h.g,this.lineGeo.setAttribute("position",new h.f(this.lineArr,3)),this.lineGeo.attributes.position.updateRange.count=0,this.line=new h.v(this.lineGeo,this.lineMat),this.container.add(this.line))}initialise(e,t,i){return this.heightmap=t,this.hasInitGeneration=!1,this.generationResets=0,this.hasInitSmoothing=!1,this.hasInitDiscretisation=!1,this.loaderIteration=0,this.maxResets=wh.initialNode/30+50,st.vehicleIndex=0,st.vehicleIndexDidChange=!0,this.reset(e,i)}loader(){if(!this.hasInitGeneration){if(st.tail.i<wh.initialNode+ae){if(this.extendMidline()||this.generationResets++,320==this.antiTargetRevert||this.generationResets>this.maxResets||null==st.tail.prev){if(this.generationResets=0,this.antiTargetRevert=15,console.error("Bad seed ",st.head.a),delete st.head.next,st.head.next=null,st.head.a+=this.rand(),st.head.a>6.28)return-1;for(xo.tracker of(this.originDir.set(Math.cos(st.head.a),0,Math.sin(st.head.a)),st.tail=st.head,this.smoothWindowHead=st.head,this.turnTrackers))xo.tracker.n=st.head,xo.tracker.da=0;this.resetBridgeState(),this.bridging=!1,this.trackRevertCount=0,this.antiTargetRevert=0}}else{for(this.hasInitGeneration=!0,xo.n=st.head,xo.i=0;xo.i<=oo;xo.i++)xo.h={i:0-(xo.i+1),p:st.head.p.clone(),c:st.head.c.clone(),h:0,next:xo.n,prev:null},xo.n.prev=xo.h,xo.n=xo.n.prev;this.smoothWindowHead=xo.n}return st.tail.i-st.head.i>ae&&(st.head=st.head.next,delete st.head.prev,st.head.prev=null,st.vehicleNode=st.head),st.tail.i/(wh.initialNode+ae)*.8}return this.hasInitSmoothing?this.hasInitDiscretisation?void 0:st.discretisedTail.i<st.vehicleIndex+oe?(this.discretiseNext(),.9+st.discretisedTail.i/(st.vehicleIndex+oe)*.0999):(this.hasInitDiscretisation=!0,1):(this.smoothWindowHead.i<st.tail.i-le?this.smoothHeight():(this.hasInitSmoothing=!0,delete st.head.prev,this.resetDiscretised()),.8+this.smoothWindowHead.i/(st.tail.i-le)*.1)}finalise(){for(st.vehicleNode=st.head,xo.i=0;xo.i<5;xo.i++)st.vehicleNode=st.vehicleNode.next;st.vehicleIndex=st.vehicleNode.i,st.vehicleIndexDidChange=!0}destroy(){this.revert(),lo&&this.lineGeo.dispose()}revert(){for(xo.t of(delete st.head,delete st.discretisedTail,delete st.tail,delete st.vehicleNode,this.turnTrackers))xo.t.n=null}reset(e,t){for(xo.tracker of(this.revert(),this.rand=new window.alea(e),st.head={i:0,p:new h.W(t.x,this.heightmap.getXZ(t.x,t.z,this.heightmap.midlineDepth),t.z),n:{x:1,z:0},a:Math.PI/2,da:0,t:0,c:new h.W,w:Te,g:0,gfa:0,h:0,ps:null,ns:null,next:null,prev:null},st.tail=st.head,st.vehicleNode=st.head,st.vehicleIndex=st.head.i,st.vehicleIndexDidChange=!0,this.originDir.set(Math.cos(st.head.a),0,Math.sin(st.head.a)),this.origin.copy(st.head.p),lo&&(this.lineOrigin.copy(this.origin),this.line.position.copy(this.lineOrigin),this.line.position.y=0),this.smoothWindowHead=st.head,this.turnTrackers))xo.tracker.n=st.head,xo.tracker.da=0}processCurve(e,t,i,s,n=!1){for(xo.ps=[],xo.ns=[],xo.i=0;xo.i<s;xo.i++)xo.t=xo.i/s,xo.ti=1-xo.t,xo.x=xo.ti*xo.ti*e.p.x+2*xo.ti*xo.t*t.x+xo.t*xo.t*i.p.x,xo.z=xo.ti*xo.ti*e.p.z+2*xo.ti*xo.t*t.z+xo.t*xo.t*i.p.z,xo.ps.push({x:xo.x,y:xo.ti*xo.ti*e.p.y+2*xo.ti*xo.t*t.y+xo.t*xo.t*i.p.y,z:xo.z}),n&&xo.i>0&&(xo.dx=xo.x-xo.ps[xo.i-1].x,xo.dz=xo.z-xo.ps[xo.i-1].z,xo.dxz=Math.sqrt(xo.dx*xo.dx+xo.dz*xo.dz),xo.ns.push({x:-xo.dz/xo.dxz,z:xo.dx/xo.dxz}));return n&&(xo.dx=i.x-xo.ps[s-1].x,xo.dz=i.z-xo.ps[s-1].z,xo.dxz=Math.sqrt(xo.dx*xo.dx+xo.dz*xo.dz),xo.ns.push({x:-xo.dz/xo.dxz,z:xo.dx/xo.dxz})),{ps:xo.ps,ns:xo.ns}}stitchNormals(e,t){let i,s,n,a=e.ps[e.ps.length-2];i=t.ps[0].x-a.x,s=t.ps[0].z-a.z,n=Math.sqrt(i*i+s*s),e.ns[e.ps.length-1]={x:-s/n,z:i/n},a=e.ps[e.ps.length-1],i=t.ps[1].x-a.x,s=t.ps[1].z-a.z,n=Math.sqrt(i*i+s*s),t.ns[0]={x:-s/n,z:i/n};for(let r=1;r<t.ps.length-1;r++)i=t.ps[r+1].x-t.ps[r-1].x,s=t.ps[r+1].z-t.ps[r-1].z,n=Math.sqrt(i*i+s*s),t.ns[r]={x:-s/n,z:i/n}}resetDiscretised(){st.discretisedTail=st.head,st.vehicleIndex=st.head.i,st.vehicleNode=st.head,xo.head=st.head,xo.pc=this.processCurve(xo.head,xo.head.c,xo.head.next,10,!0),st.head.ps=xo.pc.ps,st.head.ns=xo.pc.ns,st.vehicleNode=st.head}discretiseNext(){xo.nextTail=st.discretisedTail.next,xo.pc=this.processCurve(xo.nextTail,xo.nextTail.c,xo.nextTail.next,10),this.stitchNormals(st.discretisedTail,xo.pc),xo.nextTail.ps=xo.pc.ps,xo.nextTail.ns=xo.pc.ns,st.discretisedTail=xo.nextTail}drawFeelers(e){this.feelLeft.position.copy(st.tail.p),this.feelRight.position.copy(st.tail.p);let t=Math.cos(st.tail.a-po)*e+st.tail.p.x,i=Math.sin(st.tail.a-po)*e+st.tail.p.z;this.feelLeft.position.set(t,this.heightmap.getXZ(t,i,this.heightmap.midlineDepth),i),t=Math.cos(st.tail.a+po)*e+st.tail.p.x,i=Math.sin(st.tail.a+po)*e+st.tail.p.z,this.feelRight.position.set(t,this.heightmap.getXZ(t,i,this.heightmap.midlineDepth),i)}extendMidline(){if(this.didExtend=!0,lo&&this.lineIndex>=15e4)return;for(vo.tracker of(st.tail.i>ae&&st.tail.i-st.vehicleIndex<re&&!this.allowEmergencyBridge&&!this.bridging&&(console.warn("Midline stuck; safe horizon no longer safe. Allowing emergency bridge"),this.allowEmergencyBridge=!0),xo.feelDist=co*(1+this.waterFactor),xo.feelL=this.heightmap.getXZ(Math.cos(st.tail.a-po)*xo.feelDist+st.tail.p.x,Math.sin(st.tail.a-po)*xo.feelDist+st.tail.p.z,this.heightmap.midlineDepth),xo.feelR=this.heightmap.getXZ(Math.cos(st.tail.a+po)*xo.feelDist+st.tail.p.x,Math.sin(st.tail.a+po)*xo.feelDist+st.tail.p.z,this.heightmap.midlineDepth),xo.feelA=this.heightmap.getXZ(st.tail.p.x,st.tail.p.z,this.heightmap.midlineDepth),xo.feelA=Math.max(xo.feelA,go),this.waterFactor=0,this.byWater=!1,(xo.feelR<2*go||xo.feelL<2*go)&&(this.byWater=!0),xo.feelAvg=(xo.feelR+xo.feelL)/2,xo.feelAvg<3*go&&(xo.feelAvg>go?this.waterFactor=1-(xo.feelAvg-go)/(2*go):this.waterFactor=1),xo.feelDif=(xo.feelR-xo.feelL)/2,xo.gradLat=(xo.feelL-xo.feelR)/xo.feelDist,xo.gradLat/=mo,xo.gradLon=(xo.feelAvg-xo.feelA)/xo.feelDist,xo.gradLon/=mo,xo.bT=0,0!==xo.feelDif&&(xo.bT=(xo.feelAvg-xo.feelA)/xo.feelDif),xo.bT=Math.max(Math.min(xo.bT,1),-1),this.midlineDir.set(Math.cos(st.tail.a),0,Math.sin(st.tail.a)),this.midlineOrth.set(-this.midlineDir.z,0,this.midlineDir.x),vo.originDot=Math.max(Math.min(1,this.midlineDir.dot(this.originDir)),-1),vo.originSide=-1*this.midlineOrth.dot(this.originDir),0!=vo.originSide&&(vo.originSide/=Math.abs(vo.originSide)),vo.originSide==this.prevOriginSide&&this.originOverflow>1.5&&(1==vo.originSide?vo.originSide=-2:vo.originSide=2),vo.originSide!==this.prevOriginSide?vo.originSide>this.prevOriginSide?this.prevT<0?(this.originOverflow+=this.prevT,this.originOverflow>0?(vo.originSide=this.prevOriginSide,vo.originDot=-1):this.originOverflow=0):this.prevT>0&&(this.originOverflow+=this.prevT,vo.originSide=this.prevOriginSide,vo.originDot=-1):this.prevT>0?(this.originOverflow-=this.prevT,this.originOverflow>0?(vo.originSide=this.prevOriginSide,vo.originDot=-1):this.originOverflow=0):this.prevT<0&&(this.originOverflow-=this.prevT,vo.originSide=this.prevOriginSide,vo.originDot=-1):this.originOverflow=0,this.prevOriginSide=vo.originSide,vo.originAng=Math.acos(vo.originDot),xo.gradLeft=(xo.feelL-xo.feelA)/xo.feelDist/mo,xo.gradRight=(xo.feelR-xo.feelA)/xo.feelDist/mo,xo.maxT=1,xo.minT=-1,xo.gradLeftAbs=Math.abs(xo.gradLeft),xo.gradRightAbs=Math.abs(xo.gradRight),(xo.gradLeftAbs>1||xo.gradRightAbs>1)&&(xo.gradDif=(xo.gradLeft-xo.gradRight)/2,xo.gradAvg=(xo.gradLeft+xo.gradRight)/2,xo.gradLeft>1&&xo.gradRight>1||xo.gradLeft<-1&&xo.gradRight<-1?xo.gradLeftAbs<xo.gradRightAbs?(xo.maxT=1,xo.minT=1):(xo.maxT=-1,xo.minT=-1):(xo.gradLeftAbs>1&&(xo.gradLeft<0?xo.maxT=(1+xo.gradAvg)/Math.abs(xo.gradDif):xo.maxT=(1-xo.gradAvg)/Math.abs(xo.gradDif)),xo.gradRightAbs>1&&(xo.gradRight<0?xo.minT=(1+xo.gradAvg)/Math.abs(xo.gradDif):xo.minT=(1-xo.gradAvg)/Math.abs(xo.gradDif),xo.minT*=-1))),xo.gradAvg=(Math.abs(xo.gradLat)+Math.abs(xo.gradLon))/2,xo.maxDif=.5+.5*Math.abs(xo.gradAvg),xo.maxT*=1.5,xo.minT*=1.5,xo.maxT>0&&(xo.maxT=Math.min(xo.maxT,this.prevT+xo.maxDif)),xo.minT<0&&(xo.minT=Math.max(xo.minT,this.prevT-xo.maxDif)),this.byWater&&(xo.gradLat<0?xo.maxT>0&&(xo.maxT*=1-this.waterFactor):xo.minT<0&&(xo.minT*=1-this.waterFactor)),xo.bT=Math.max(Math.min(xo.maxT,xo.bT),xo.minT),!this.bridging&&this.byWater&&(vo.originSide<0&&xo.gradLat>0||vo.originSide>0&&xo.gradLat<0)&&(this.tVec.set(0,0,0),(0==this.originOverflow&&this.allowEmergencyBridge||xo.gradLon<-.3&&Math.abs(xo.gradLat)<1)&&(this.tVec.x=this.midlineDir.x,this.tVec.z=this.midlineDir.z,this.tVec.normalize(),this.testForBridge(st.tail.prev,1,this.tVec)),this.tVec.x=st.tail.prev.n.x*-vo.originSide,this.tVec.z=st.tail.prev.n.z*-vo.originSide,this.tVec.normalize(),this.testForBridge(st.tail.prev,1,this.tVec),this.allowEmergencyBridge&&(this.tVec.x+=this.midlineDir.x,this.tVec.z+=this.midlineDir.z,this.tVec.normalize(),this.testForBridge(st.tail.prev,1,this.tVec))),xo.gradLon2=xo.gradLon*xo.gradLon,xo.gradLon2<=1?(!this.byWater||xo.gradLon>0)&&(xo.bT*=Math.abs(xo.gradLon2)):xo.bT<0?xo.bT=xo.minT:xo.bT=xo.maxT,xo.bT=Math.max(Math.min(xo.maxT,xo.bT),xo.minT),this.antiWeight=0,this.antiTargetRange>0&&(vo.d=st.tail.p.x-this.antiTarget.x,vo.d=vo.d*vo.d+(st.tail.p.z-this.antiTarget.z)*(st.tail.p.z-this.antiTarget.z),this.antiDir.set(this.antiTarget.x-st.tail.p.x,0,this.antiTarget.z-st.tail.p.z),this.antiDir.normalize(),vo.antiDot=this.midlineDir.dot(this.antiDir),vo.d<this.antiTargetRange?(this.antiWeight=1-vo.d/this.antiTargetRange,vo.antiSide=this.midlineOrth.dot(this.antiDir),vo.antiRedirect=2*po*vo.antiSide,vo.antiAdjust=(vo.antiDot+1)/2,this.antiWeight*=vo.antiAdjust,vo.antiRedirect=Math.max(Math.min(xo.maxT,vo.antiRedirect),xo.minT),xo.bT=this.antiWeight*vo.antiRedirect+(1-this.antiWeight)*xo.bT):vo.antiDot<-.707&&(this.antiTargetRange=0,this.trackIndex=null,this.trackRevertCount=0)),vo.originAdjust=(1-(vo.originDot+1)/2)*(1-this.waterFactor*this.waterFactor),vo.originAdjust*=1-this.antiWeight,vo.originRedirect=vo.originAng*vo.originSide/po,vo.originRedirect=Math.max(Math.min(xo.maxT,vo.originRedirect),xo.minT),xo.bT=vo.originAdjust*vo.originRedirect+(1-vo.originAdjust)*xo.bT,vo.shouldBridge=!this.bridging&&this.byWater&&this.bridge.spawnNode&&st.tail.i-this.bridge.spawnNode.i<150&&(this.originOverflow>0||this.allowEmergencyBridge),this.turnTrackers))if(vo.tracker.da+=st.tail.da,vo.tracker.n.i<=st.tail.i-vo.tracker.m&&(vo.tracker.da-=vo.tracker.n.da,vo.tracker.n=vo.tracker.n.next),Math.abs(vo.tracker.da)>vo.tracker.a&&(this.byWater||vo.originDot<vo.tracker.o)||vo.shouldBridge){for(this.bridging&&(vo.shouldBridge=!1,this.bridging=!1,this.bridge.spawnNode=null),vo.shouldBridge||this.trackRevertCount++,(vo.shouldBridge||this.trackRevertCount>5&&this.bridge.spawnNode&&st.tail.i-this.bridge.spawnNode.i<this.antiTargetRevert)&&(this.bridging=!0,this.improveBridgeStartNode(),this.bridge.landing.y=(this.bridge.spawnNode.p.y+this.bridge.landing.y)/2,this.bridge.height=this.bridge.landing.y),this.didExtend=!1,vo.revertDistance=0,this.bridging?(this.trackIndex=null,this.antiTargetRange=0,this.antiTargetTrigger=st.tail.i,vo.revertDistance=st.tail.i-this.bridge.spawnNode.i):Math.abs(this.antiResetIndex-st.tail.i)<2*vo.tracker.m||this.trackIndex==vo.tracker.i&&this.antiWeight>0?(this.antiTargetTriggerCount++,this.antiTargetRevert+=this.antiTargetTriggerCount*vo.tracker.r,st.tail.i-this.antiTargetRevert<this.maxRetractIndex&&(this.antiTarget.copy(st.tail.p),this.antiTargetRevert=st.tail.i-this.maxRetractIndex,console.warn("Max revert; allowing emergency bridge"),this.allowEmergencyBridge=!0),vo.revertDistance=this.antiTargetRevert):(this.trackIndex=vo.tracker.i,this.antiTarget.copy(st.tail.p),this.antiTargetRevert=vo.tracker.m,this.antiTargetTrigger=st.tail.i,this.antiTargetTriggerPoint.copy(this.antiTarget),this.antiTargetTriggerCount=0,vo.revertDistance=this.antiTargetRevert),vo.resetIndex=st.tail.i-vo.revertDistance;st.tail.i>vo.resetIndex;){var e;if(!st.tail.bridge&&(null===(e=st.tail.prev)||void 0===e?void 0:e.bridge)){for(vo.bn=st.tail.prev;null===(t=vo.bn)||void 0===t?void 0:t.bridge;){var t;vo.bn=vo.bn.prev}if(vo.bn.i<vo.resetIndex)break;this.antiBridgePoint.copy(st.tail.p)}if(null==st.tail.prev||st.tail.i-st.head.i<le)break;st.tail=st.tail.prev,delete st.tail.next,st.tail.next=null}if(this.smoothWindowHead.i>st.tail.i-le)for(vo.startI=0,this.smoothWindowHead.i<=st.tail.i?vo.startI=Math.max(0,st.tail.i-this.smoothWindowHead.i):(this.smoothWindowHead=st.tail,this.smoothWindowHead.p.y+=this.smoothWindowHead.h),vo.i=vo.startI;vo.i<=le;vo.i++)this.smoothWindowHead.prev&&(this.smoothWindowHead=this.smoothWindowHead.prev,this.smoothWindowHead.p.y+=this.smoothWindowHead.h);for(vo.tracker2 of(this.bridging||(this.antiTargetRange=4*this.antiTarget.distanceToSquared(st.tail.p),this.antiResetIndex=st.tail.i),!this.bridging&&this.bridge.spawnNode&&this.bridge.spawnNode.i>st.tail.i&&this.resetBridgeState(),st.vehicleIndex>st.tail.i&&(st.vehicleIndex=st.tail.i,st.vehicleNode=st.tail),this.hasInitGeneration&&st.tail.i-re+100<st.vehicleIndex&&(console.error("Midline reset violation"),console.log(st.vehicleIndex,st.tail.i)),this.turnTrackers))for(vo.tracker2.n=st.tail,vo.tracker2.da=st.tail.da,vo.i=0;vo.i<vo.tracker2.m&&vo.tracker2.n.prev;vo.i++)vo.tracker2.n=vo.tracker2.n.prev,vo.tracker2.da+=vo.tracker2.n.da;return this.prevT=st.tail.t,this.waterFactor=Math.max(Math.min(1,1-(st.tail.p.y-go)/(2*go)),0),"o"in st.tail?st.tail.o<0?(this.prevOriginSide=-1,this.originOverflow=-st.tail.o):(this.prevOriginSide=1,this.originOverflow=st.tail.o):(this.midlineDir.set(Math.cos(st.tail.a),0,Math.sin(st.tail.a)),this.midlineOrth.set(-this.midlineDir.z,0,this.midlineDir.x),vo.originDot=this.midlineDir.dot(this.originDir),vo.originSide=-1*this.midlineOrth.dot(this.originDir),0!=vo.originSide&&(vo.originSide/=Math.abs(vo.originSide)),this.prevOriginSide=vo.originSide,this.originOverflow=0),!1}this.bridging&&(vo.vecA.set(this.bridge.landing.x-st.tail.p.x,0,this.bridge.landing.z-st.tail.p.z).normalize(),vo.vecB.set(st.tail.p.x-st.tail.prev.p.x,0,st.tail.p.z-st.tail.prev.p.z).normalize(),st.tail.p.distanceTo(this.bridge.landing)<10&&(this.bridging=!1,this.allowEmergencyBridge=!1,this.resetBridgeState()),xo.dot=Math.min(vo.vecA.dot(vo.vecB),1),xo.side=(this.bridge.landing.x-st.tail.p.x)*vo.vecB.z-(this.bridge.landing.z-st.tail.p.z)*vo.vecB.x,xo.side=xo.side<0?-1:1,xo.bT=Math.min(Math.max(Math.acos(xo.dot),-1.5),1.5)*xo.side),this.prevT=xo.bT,xo.bDir=st.tail.a-xo.bT*po,xo.bDir<-Math.PI?xo.bDir+=2*Math.PI:xo.bDir>Math.PI&&(xo.bDir-=2*Math.PI),vo.cDist=.5*uo,vo.x=Math.cos(st.tail.a)*vo.cDist+st.tail.p.x,vo.z=Math.sin(st.tail.a)*vo.cDist+st.tail.p.z,vo.roadSinkFactor=.1*(1-this.waterFactor),st.tail.c.x=vo.x,st.tail.c.y=st.tail.p.y,st.tail.c.z=vo.z,vo.nx=vo.x-st.tail.p.x,vo.nz=vo.z-st.tail.p.z,vo.nxz=Math.sqrt(vo.nx*vo.nx+vo.nz*vo.nz),st.tail.n={x:-vo.nz/vo.nxz,z:vo.nx/vo.nxz},vo.x=Math.cos(xo.bDir)*vo.cDist+vo.x,vo.z=Math.sin(xo.bDir)*vo.cDist+vo.z;let i={i:st.tail.i+1,p:new h.W(vo.x,(this.bridging?this.bridge.height:Math.max(this.heightmap.getXZ(vo.x,vo.z,this.heightmap.midlineDepth),go))-vo.roadSinkFactor,vo.z),a:xo.bDir,da:xo.bT*po,h:0,c:new h.W,t:xo.bT,n:{x:0,z:1},w:Te,g:xo.gradLat,gfa:Math.abs(xo.gradLon),next:null,prev:st.tail};return this.bridging&&(i.bridge=!0),st.tail.c.y=(st.tail.c.y+i.p.y)/2,this.originOverflow>0&&(i.o=this.originOverflow*vo.originSide),st.tail.next=i,isNaN(vo.x)?(console.log("NAN x AT INDEX "+i.i),console.log("bT ",xo.bT),console.log("bDir ",xo.bDir),console.log("E.originDot ",vo.originDot),console.log("originAdjust ",vo.originAdjust),console.log("OriginRedirect ",vo.originRedirect),console.log("OriginSide ",vo.originSide),console.log("originAng ",vo.originAng),console.log("Origindir ",this.originDir),console.log("Min max ",xo.minT,xo.maxT),console.log("Gradlat, lon ",xo.gradLat,xo.gradLon),console.log("gradAVg ",xo.gradAvg),console.log("antiWeight ",this.antiWeight),console.log("feelL, feelR ",xo.feelL,xo.feelR),console.log("feelAvg ",xo.feelAvg),console.log("feelDif ",xo.feelDif),console.log("waterFactor ",this.waterFactor),console.log("maxDif ",xo.maxDif),!1):(lo&&this.drawPoints(st.tail),st.tail=i,this.maxRetractIndex=Math.max(this.maxRetractIndex,st.tail.i-he),st.tail.i>1640&&st.tail.i,!0)}resetBridgeState(){this.bridge.spawnNode=null,this.bridge.distance=0,this.bridge.landing.set(0,0,0)}improveBridgeStartNode(){let e,t,i=this.bridge.spawnNode.prev,s=this.bridge.spawnNode.p.distanceToSquared(this.bridge.landing),n=new h.V,a=new h.V;a.x=i.p.x-i.prev.p.x,a.y=i.p.z-i.prev.p.z,a.normalize(),n.set(this.bridge.landing.x-i.p.x,this.bridge.landing.z-i.p.z).normalize(),t=a.dot(n);let r=a.dot(n);for(let h=0;h<20&&i.prev&&!(Math.abs(i.p.y-this.bridge.landing.y)>2);h++)e=i.p.distanceToSquared(this.bridge.landing),a.x=i.p.x-i.prev.p.x,a.y=i.p.z-i.prev.p.z,a.normalize(),n.set(this.bridge.landing.x-i.p.x,this.bridge.landing.z-i.p.z).normalize(),t=a.dot(n),(e<s||s<0)&&t>-.1&&(s=e,this.bridge.spawnNode=i),t>r&&e<1.2*s&&(r=t,this.bridge.spawnNode=i),i=i.prev}testForBridge(e,t,i){this.landing=new h.W;let s=0,n=250,a=5,r=n/2;if(this.allowEmergencyBridge)do{this.landing.x=e.p.x+i.x*n*t,this.landing.z=e.p.z+i.z*n*t,this.landing.y=this.heightmap.getXZ(this.landing.x,this.landing.z,this.heightmap.midlineDepth),n+=250,a+=1}while(this.landing.y<2);else if(this.landing.x=e.p.x+i.x*n*t,this.landing.z=e.p.z+i.z*n*t,this.landing.y=this.heightmap.getXZ(this.landing.x,this.landing.z,this.heightmap.midlineDepth),this.landing.y<2)return this.landing.y=0,null;for(let h=0;h<a;h++)this.landing.x=e.p.x+i.x*r*t,this.landing.z=e.p.z+i.z*r*t,this.landing.y=this.heightmap.getXZ(this.landing.x,this.landing.z,this.heightmap.midlineDepth),this.landing.y<2?(s=r,r=.5*s+.5*n):(n=r,r=.5*s+.5*n);return r<40||this.landing.distanceTo(this.antiBridgePoint)<100?null:(!this.bridge.spawnNode||e.i-this.bridge.spawnNode.i>20||r<this.bridge.distance)&&this.checkBridgeQuality(e.p,this.landing)?(this.bridge.spawnNode=e,this.bridge.distance=r,this.bridge.landing.copy(this.landing),this.landing):null}checkBridgeQuality(e,t){let i=e.clone().add(t).multiplyScalar(.5);if(this.heightmap.getXZ(i.x,i.z,this.heightmap.midlineDepth)>-2)return!1;let s=t.clone().sub(e);if(s.y=0,s.normalize(),0==this.originOverflow&&s.dot(this.originDir)<0)return!1;s.y=s.x,s.x=-s.z,s.z=s.y;let n=e.distanceTo(i)/2,a=s.clone().multiplyScalar(n).add(i);return!(this.heightmap.getXZ(a.x,a.z,this.heightmap.midlineDepth)>0)&&(a=s.multiplyScalar(-n).add(i),!(this.heightmap.getXZ(a.x,a.z,this.heightmap.midlineDepth)>0))}smoothHeight(){for(vo.avg=0,vo.n=this.smoothWindowHead,vo.i=0;vo.i<le;vo.i++)vo.avg+=vo.n.p.y,vo.n=vo.n.next,vo.i<=oo&&(vo.s=vo.n);vo.avg/=le,vo.r=vo.s.prev,vo.q=vo.r.prev,vo.s.h=vo.s.p.y-vo.avg,vo.hAngle=(vo.avg-(vo.q.p.y-vo.q.h))/20,vo.r.c.y=vo.r.p.y-vo.r.h+5*vo.hAngle,this.smoothWindowHead.p.y-=this.smoothWindowHead.h,this.smoothWindowHead=this.smoothWindowHead.next}update(){return st.tail.i<st.vehicleIndex+ae?(this.extendMidline(),this.smoothHeight()):st.tail.i-st.head.i>ae&&(xo.n=st.head.next,delete st.head,st.head=xo.n,st.head.prev=null),st.discretisedTail.i<st.vehicleIndex+oe?this.discretiseNext():st.discretisedTail.i-st.head.i>oe&&(xo.n=st.head.next,delete st.head,st.head=xo.n,st.head.prev=null),this.didExtend}drawFine(e){let t;for(;null===(i=e.next)||void 0===i?void 0:i.ps;){var i;for(t of e.ps)this.lineArr[this.lineIndex++]=t.x,this.lineArr[this.lineIndex++]=t.y+1,this.lineArr[this.lineIndex++]=t.z;e=e.next}this.lineGeo.setDrawRange(0,this.lineIndex/3),this.lineGeo.attributes.position.needsUpdate=!0,this.lineGeo.computeBoundingSphere()}drawPoints(e){let t,i,s,n,a;for(;e.next;){for(s of(t=new h.N(e.p,e.c,e.next.p),i=t.getPoints(1),i))n=s.x-this.line.position.x,a=s.z-this.line.position.z,this.lineArr[this.lineIndex++]=n,this.lineArr[this.lineIndex++]=Math.max(2,this.heightmap.getXZ(s.x,s.z,this.heightmap.midlineDepth))+1,this.lineArr[this.lineIndex++]=a;e=e.next}this.lineGeo.setDrawRange(0,this.lineIndex/3),this.lineGeo.attributes.position.needsUpdate=!0,this.lineGeo.computeBoundingSphere()}};class fo{static getUVs(e){let t=[],i=Math.floor(100/(2*Te));i=16;for(let s=0;s<=e;s++)t.push(1,s/e*16),t.push(0,s/e*16);return t}constructor(e,t=!1){this.genNode=null,this.genIndex=0,this.nodeIndex=0,this.originPos=new h.W,this.numPoints=10,this.isCoarse=!1,this.p=new h.W,this.numPoints=e,this.isCoarse=t,this.geo=new h.g,this.geo.setIndex(fo.getIndex(e+1)),this.geo.setAttribute("position",new h.o(new Float32Array(2*(e+1)*3),3)),this.verts=this.geo.attributes.position.array,this.geo.attributes.position.setUsage(h.l);let i=fo.getUVs(e);this.geo.setAttribute("uv",new h.o(new Float32Array(i),2)),this.mesh=new h.B(this.geo,Be),this.mesh.matrixAutoUpdate=!1,this.mesh.receiveShadow=!0,this.mesh.visible=!1}initialise(e){for(this.initGeneration(e);!this.generate(););this.display()}initGeneration(e,t=0){this.midlineNode=e,this.genNode=e,this.originPos.copy(e.p),this.mesh.position.copy(this.originPos),this.genIndex=0,this.nodeIndex=0}generate(){let e,t;this.isCoarse?(this.p.copy(this.genNode.p).sub(this.originPos),e=this.genNode.n,t=this.genNode.w):(this.nodeIndex>=this.genNode.ps.length&&(this.nodeIndex=0,this.genNode=this.genNode.next),this.p.copy(this.genNode.ps[this.nodeIndex]).sub(this.originPos),e=this.genNode.ns[this.nodeIndex],t=this.genNode.w);let i=6*this.genIndex;return this.verts[i]=this.p.x+e.x*t,this.verts[i+1]=this.p.y+.01,this.verts[i+2]=this.p.z+e.z*t,this.verts[i+3]=this.p.x-e.x*t,this.verts[i+4]=this.p.y+.01,this.verts[i+5]=this.p.z-e.z*t,this.genIndex++,this.isCoarse?this.genIndex<=this.numPoints&&(this.genNode=this.genNode.next):this.nodeIndex+=1,this.genIndex==this.numPoints+1}display(){this.geo.attributes.position.needsUpdate=!0,this.geo.computeVertexNormals(),this.geo.computeBoundingSphere(),this.mesh.updateMatrix(),this.show()}show(){this.mesh.visible=!0}hide(){this.mesh.visible=!1}retire(){this.hide()}static getIndex(e){let t,i,s,n,a=[];for(let r=0;r<e-1;r++)t=2*r,i=t+1,s=2*(r+1),n=s+1,a.push(t,s,i),a.push(i,s,n);return a}}fo.mat=new h.D({color:8947848});var bo=class{constructor(){this.nearSegs=[],this.farSegs=[],this.seenIndex=0,this.nearIndex=0,this.nearCheck=15,this.nextNearReady=!1,this.farIndex=0,this.farCheck=45,this.nextFarReady=!1,this.container=new h.G,this.initSegs(),this.nearIndex=0,this.farIndex=0}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}handleMidlineReset(){st.tail.i<this.farIndex&&console.error("Road controller cannot handle reset gracefully")}initSegs(){let e;for(e=0;e<10;e++){let e=new fo(10,!0);this.container.add(e.mesh),this.farSegs.push(e)}for(this.farSegs[1].initialise(st.head),this.farSegs[0].initialise(this.farSegs[1].genNode),this.farSegs[0].hide(),this.farSegs[1].hide(),this.farSegs[9].initGeneration(this.farSegs[0].genNode),e=0;e<4;e++){let e=new fo(100);this.container.add(e.mesh),this.nearSegs.push(e)}this.nearSegs[1].initialise(st.head),this.nearSegs[0].initialise(this.nearSegs[1].genNode),this.nearSegs[3].initGeneration(this.nearSegs[0].genNode)}update(){if(this.nextNearReady||(this.nextNearReady=this.nearSegs[3].generate()),this.nearIndex-st.vehicleIndex<this.nearCheck){for(;!this.nextNearReady;)this.nextNearReady=this.nearSegs[3].generate();this.nearSegs.unshift(this.nearSegs.pop()),this.nearSegs[0].display(),this.nearIndex=this.nearSegs[0].genNode.i,this.nearSegs[3].retire(),this.nearSegs[3].initGeneration(this.nearSegs[0].genNode),this.nextNearReady=!1}if(this.nextFarReady){if(this.farIndex-st.vehicleIndex<this.farCheck){this.farSegs.unshift(this.farSegs.pop()),this.farSegs[0].display(),this.farIndex=this.farSegs[0].genNode.i,this.farSegs[9].retire(),this.farSegs[9].initGeneration(this.farSegs[0].genNode),this.nextFarReady=!1;let e=Math.floor(4.5)-1;this.farSegs[e].hide(),this.farSegs[e+3].show()}}else this.nextFarReady=this.farSegs[9].generate()}};class Ao extends h.g{updateHeights(){this.attributes.heightOffset.needsUpdate=!0}drawCount(e){this.setDrawRange(0,e*this.res*this.res*6),this.attributes.position.needsUpdate=!0,this.attributes.normal.needsUpdate=!0,this.attributes.heightOffset.needsUpdate=!0,this.attributes.roadProximity.needsUpdate=!0,this.attributes.treeMask.needsUpdate=!0,this.attributes.curvature.needsUpdate=!0}constructor(e,t,i){super(),this.tileIndexSize=0,this.centroid=new h.W;let s=t+1;this.res=t;let n,a,r,o,l=s*s*i,d=[],c=[],p=[],u=0;for(let h=0;h<i;h++){for(let e=0;e<=t;e++)for(let i=0;i<=t;i++)d.push(i/t,e/t),c.push(i/t/10,e/t/10),e<t&&i<t&&(n=e*s+i+u,a=e*s+(i+1)+u,r=(e+1)*s+i+u,o=(e+1)*s+(i+1)+u,p.push(n,a,r),p.push(a,o,r));u+=s*s}this.setIndex(p),this.setAttribute("position",new h.o(new Float32Array(3*l),3)),this.attributes.position.setUsage(h.l),this.setAttribute("normal",new h.o(new Float32Array(3*l),3)),this.attributes.normal.setUsage(h.l),this.setAttribute("heightOffset",new h.o(new Float32Array(l),1)),this.attributes.heightOffset.setUsage(h.l),this.setAttribute("roadProximity",new h.o(new Float32Array(l),1)),this.attributes.roadProximity.setUsage(h.l),this.setAttribute("treeMask",new h.o(new Float32Array(l),1)),this.attributes.treeMask.setUsage(h.l),this.setAttribute("curvature",new h.o(new Float32Array(l),1)),this.attributes.curvature.setUsage(h.l),this.setAttribute("uv",new h.o(new Float32Array(d),2)),this.setAttribute("wuv",new h.o(new Float32Array(c),2))}computeBoundingSphere(e=null){if(null==this.boundingSphere&&(this.boundingSphere=new h.R(new h.W,0)),null==e)return;let t;for(t of(this.boundingSphere.center.set(0,0,0),e))t&&this.boundingSphere.center.add(t);this.boundingSphere.center.multiplyScalar(1/e.length);let i,s=0;for(t of e)i=t.distanceToSquared(this.boundingSphere.center),i>s&&(s=i);this.boundingSphere.radius=Math.sqrt(s)+10}}var yo=class{constructor(e,t,i,s,n){this.indexCallbacks=[],this.redrawTilesets={},this.redrawCells=[],this.centroids=[],this.centroid=new h.W,this.origin=new h.W,this.lod=e,this.res=t,this.id=s,0==this.lod?this.tileCount=i*i*4:this.tileCount=i*i*1,this.vertexCount=(t+1)*(t+1),this.nextTileIndex=0,this.maxTileIndex=this.tileCount-1,this.readyCount=0,this.drawCount=0,this.retireIndex=De,this.geo=new Ao(e,t,this.tileCount),this.mesh=new h.B(this.geo,n),this.showHeight=new Float32Array((t+1)*(t+1)),this.hideHeight=new Float32Array((t+1)*(t+1));for(let a=0;a<this.hideHeight.length;a++)this.hideHeight[a]=-5,this.showHeight[a]=0;this.mesh.visible=!1,this.mesh.receiveShadow=!0,this.mesh.matrixAutoUpdate=!1,this.posArr=this.geo.attributes.position.array,this.normArr=this.geo.attributes.normal.array,this.curveArr=this.geo.attributes.curvature.array,this.heightOffsetArr=this.geo.attributes.heightOffset.array,this.roadProxArr=this.geo.attributes.roadProximity.array,this.treeMaskArr=this.geo.attributes.treeMask.array,this.vec3Count=3*this.vertexCount,this.floatCount=this.vertexCount}reset(){this.nextTileIndex=0,this.retireIndex=De,this.readyCount=0,this.drawCount=0,this.indexCallbacks.length=0,this.mesh.visible=!1,this.redrawTilesets={},this.redrawCells.length=0,this.centroids.length=0,this.geo.drawCount(this.nextTileIndex)}registerCallback(e,t){this.indexCallbacks[e]=t}setOrigin(e){this.origin.copy(e),this.mesh.position.copy(this.origin)}setRetireIndex(e){this.retireIndex=Math.max(this.retireIndex,e+De)}tileReady(e,t,i,s,n,a,r,h){this.posArr.set(t,e*t.length),this.normArr.set(i,e*i.length),this.curveArr.set(s,e*s.length),this.heightOffsetArr.set(this.showHeight,e*this.showHeight.length),this.roadProxArr.set(n,e*n.length),this.treeMaskArr.set(a,e*a.length),this.centroids[e]=r,this.readyCount++,this.drawCount++,(this.readyCount==this.tileCount||h)&&this.draw()}registerRedrawCell(e){this.redrawCells.push(e)}registerRedraw(e){e.id in this.redrawTilesets||(this.redrawTilesets[e.id]=e)}hideTile(e){this.heightOffsetArr.set(this.hideHeight,e*this.floatCount)}draw(){if(this.redrawCells.length){let e;for(e of this.redrawCells)e.retire(),this.registerRedraw(e.tileset);for(e in this.redrawTilesets)this.redrawTilesets[e].update()}this.mesh.visible=!0,this.geo.drawCount(this.drawCount),this.geo.computeBoundingSphere(this.centroids),this.mesh.updateMatrix()}update(){this.geo.updateHeights()}},Io=i.p+"static/media/road-despawns.677d3840.webp";const Do={};var No=class{constructor(e,t,i){this.cells=[[],[]],this.lods=[{res:ye,node:null,horizon:Ie,tileSize:5,tiles:Math.floor(2.5),prevCheck:{x:0,z:0}},{res:Me,node:null,horizon:Ce,tileSize:3,tiles:Math.floor(1.5),prevCheck:{x:0,z:0}}],this.tilesets=[[],[]],this.stagedCells=[],this.loadedCells={},this.activeCells={},this.counts=[0,0],this.nearNode=null,this.medIndex=0,this.medNode=null,this.seenIndex=-1,this.rearNode=null,this.prevCheckCell={x:0,z:0},this.heightmap=e,this.container=new h.G,this.container.matrixAutoUpdate=!1,this.despawnBarrier=new h.B(new h.J(4,1),new h.C({map:X(Io,16),alphaTest:.5})),this.container.add(this.despawnBarrier),this.groundMaterial=t,this.resetLodConfig(),this.cellClass=i,this.cellClass.initialise((()=>{this.initialise()})),this.seenIndex=st.head.i}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}loader(){return this.progressNodes(!0,1)?(this.lods[1].node.i-this.seenIndex)/this.lods[1].horizon*.5:this.progressNodes(!0,0,0)?.5+(this.lods[0].node.i-this.seenIndex)/this.lods[0].horizon*.5:1}resetLodConfig(){this.lods=[{res:ye,node:null,horizon:Ie,tileSize:5,tiles:Math.floor(2.5),prevCheck:{x:0,z:0}},{res:Me,node:null,horizon:Ce,tileSize:3,tiles:Math.floor(1.5),prevCheck:{x:0,z:0}}]}reset(e){this.heightmap=e,this.nearNode=st.head,this.seenIndex=st.head.i,this.resetLodConfig();for(let t of this.cells)for(let e of t)e.retire();for(let t of this.stagedCells)t.retire(),this.cells[t.lod].push(t);this.stagedCells.length=0,delete this.activeCells,this.activeCells={},delete this.loadedCells,this.loadedCells={};for(let t of this.tilesets)for(let e of t)e.reset();this.initialise()}handleMidlineReset(){st.tail.i<this.lods[0].node.i&&console.error("Near grid cannot reset gracefully")}testGround(e,t,i){let s=Math.floor(e/Ne),n=Math.floor(t/Ne);if(null==i&&(i={n:[0,1,0]}),i.f=Le,i.r=!1,i.w=!1,this.activeCells[s]&&this.activeCells[s][n]){i.n=this.loadedCells[s][n].getNormal(e,t);let a=it(e,t,this.loadedCells[s][n].originNode,!0);return a.n.lWallDist&&1==a.s&&(i.w=!0,i.wi=Math.floor(100*a.n.lWallDist),!0===i.insideWall?i.wd=a.d-(a.n.lWallDist-.2):!1===i.insideWall?i.wd=a.d-(a.n.lWallDist+.2):i.wd=a.d-a.n.lWallDist,i.ws=a.s,i.wn=a.n.n),a.n.rWallDist&&-1==a.s&&(i.w=!0,i.wi=-1*Math.floor(100*a.n.rWallDist),!0===i.insideWall?i.wd=a.d-(a.n.rWallDist-.2):!1===i.insideWall?i.wd=a.d-(a.n.rWallDist+.2):i.wd=a.d-a.n.rWallDist,i.wn=a.n.n,i.ws=a.s),a.d<a.w?(this.cellClass.paved?i.h=a.y:i.h=this.loadedCells[s][n].lookupHeight(e,t),i.f=ke,i.r=!0):(a.d<a.w+Ge&&(i.f=Se),i.h=this.loadedCells[s][n].lookupHeight(e,t)),i}return i.h=this.heightmap.getXZ(e,t),i.n.length=0,i.n.push(0,1,0),i}testHeight(e,t){let i=Math.floor(e/Ne),s=Math.floor(t/Ne);if(this.loadedCells[i]&&this.loadedCells[i][s]){let n=it(e,t,this.loadedCells[i][s].originNode,!0);return n.d<n.w?n.y:this.loadedCells[i][s].lerpHeight(e,t,n)}return this.heightmap.getXZ(e,t)}getCoords(e){return{x:Math.floor(e.x/Ne),y:0,z:Math.floor(e.z/Ne)}}getOrigin(e){return{x:Math.floor(e.x/Ne)*Ne,y:0,z:Math.floor(e.z/Ne)*Ne}}getCell(e,t){let i=this.cells[e];if(i.length&&(i[i.length-1].retired||this.seenIndex-i[i.length-1].originIndex>je)){var s,n;let e=i.pop();return(null===(s=this.loadedCells[e.coords.x])||void 0===s?void 0:s[e.coords.z])&&this.loadedCells[e.coords.x][e.coords.z].lod==e.lod&&(delete this.loadedCells[e.coords.x][e.coords.z],t!=e.coords.x&&0==Object.keys(this.loadedCells[e.coords.x]).length&&delete this.loadedCells[e.coords.x]),(null===(n=this.activeCells[e.coords.x])||void 0===n?void 0:n[e.coords.z])&&this.activeCells[e.coords.x][e.coords.z].lod==e.lod&&((!this.rearNode||e.originNode.i>this.rearNode.i)&&(this.rearNode=e.originNode,this.despawnBarrier.position.copy(this.rearNode.next.p),this.despawnBarrier.position.y+=1,this.despawnBarrier.rotation.y=.5*Math.PI-this.rearNode.next.a),delete this.activeCells[e.coords.x][e.coords.z],t!==e.coords.x&&0==Object.keys(this.activeCells[e.coords.x]).length&&delete this.activeCells[e.coords.x]),e}{let t=new this.cellClass(e,this.lods[e].res,this.heightmap);return this.counts[e]++,t}}getTileset(e){let t,i=this.tilesets[e];if(i.length){if(t=i[0],t.nextTileIndex<=t.maxTileIndex)return t;if(i.length>1&&(t=i[i.length-1],this.seenIndex>=t.retireIndex))return i.unshift(i.pop()),i[0].reset(),i[0]}return t=new yo(e,this.lods[e].res,this.lods[e].tileSize,i.length,this.groundMaterial),this.container.add(t.mesh),i.unshift(t),ts["nearcell-"+e]=i.length,i[0]}initialise(){let e,t;for(this.despawnBarrier.position.copy(st.head.p),this.despawnBarrier.position.y+=1,this.despawnBarrier.rotation.y=.5*Math.PI-st.head.a,e=1;e>=0;e--){let i,s,n,a,r,h;t=this.lods[e],t.node=st.head,i=this.getCoords(t.node.p);let o=t.tiles;for(s=-o;s<=o;s++)for(a=i.x+s,n=-o;n<=o;n++)r=i.z+n,a in this.loadedCells||(this.loadedCells[a]={}),r in this.loadedCells[a]&&this.loadedCells[a][r].lod,h=this.getCell(e),h.initGeneration(t.node,{x:a,z:r},this.getTileset(e),!0,this.heightmap),this.cells[e].unshift(h),this.loadedCells[a][r]=h,a in this.activeCells||(this.activeCells[a]={}),this.activeCells[a][r]=h;t.prevCheck.x=i.x,t.prevCheck.z=i.z}}progressNodes(e=!1,t=0,i=1){let s,n;for(Do.finished=0,Do.l=i;Do.l>=t;Do.l--)if(Do.lod=this.lods[Do.l],Do.lod.node.i>=this.seenIndex+Do.lod.horizon)Do.finished++;else if(Do.lod.node=Do.lod.node.next,Do.cs=this.getCoords(Do.lod.node.p),Do.cs.x!=Do.lod.prevCheck.x||Do.cs.z!=Do.lod.prevCheck.z){for(Do.dx=Do.cs.x-Do.lod.prevCheck.x,Do.dz=Do.cs.z-Do.lod.prevCheck.z,Do.tf=Do.lod.tiles,Do.i=-Do.tf;Do.i<=Do.tf;Do.i++)0!==Do.dx&&(s=Do.cs.x+Do.dx*Do.tf,n=Do.cs.z+Do.i,s in this.loadedCells||(this.loadedCells[s]={}),(!(n in this.loadedCells[s])||this.loadedCells[s][n].lod<Do.l)&&(Do.c=this.getCell(Do.l,s),Do.c.initGeneration(Do.lod.node,{x:s,z:n},this.getTileset(Do.l),e,this.heightmap),this.hadLoadedLod=!1,this.loadedCells[s][n]&&this.loadedCells[s][n].lod<Do.l&&(this.hadLoadedLod=!0),this.loadedCells[s][n]=Do.c,e?(this.hadLoadedLod,this.cells[Do.l].unshift(Do.c),s in this.activeCells?this.activeCells[s][n]&&Do.c.tileset.registerRedrawCell(this.activeCells[s][n]):this.activeCells[s]={},this.activeCells[s][n]=Do.c):this.stagedCells.unshift(Do.c))),0!==Do.dz&&(s=Do.cs.x+Do.i,n=Do.cs.z+Do.dz*Do.tf,s in this.loadedCells||(this.loadedCells[s]={}),(!(n in this.loadedCells[s])||this.loadedCells[s][n].lod<Do.l)&&(Do.c=this.getCell(Do.l,s),Do.c.initGeneration(Do.lod.node,{x:s,z:n},this.getTileset(Do.l),e,this.heightmap),this.hadLoadedLod=!1,this.loadedCells[s][n]&&this.loadedCells[s][n].lod<Do.l&&(this.hadLoadedLod=!0),this.loadedCells[s][n]=Do.c,e?(this.hadLoadedLod,this.cells[Do.l].unshift(Do.c),s in this.activeCells?this.activeCells[s][n]&&Do.c.tileset.registerRedrawCell(this.activeCells[s][n]):this.activeCells[s]={},this.activeCells[s][n]=Do.c):this.stagedCells.unshift(Do.c)));Do.lod.prevCheck.x=Do.cs.x,Do.lod.prevCheck.z=Do.cs.z}return Do.finished<2-t}update(){if(this.seenIndex<st.vehicleIndex)this.seenIndex++,this.progressNodes();else if(this.stagedCells.length)for(Do.canPop=!0,Do.max=this.stagedCells.length/2+3,Do.s=this.stagedCells.length-1;Do.s>=0&&!(--Do.max<=0);Do.s--)if(this.stagedCells[Do.s].generate()&&Do.canPop){if(Do.c=this.stagedCells.pop(),this.cells[Do.c.lod].unshift(Do.c),this.activeCells[Do.c.coords.x]){if(this.activeCells[Do.c.coords.x][Do.c.coords.z]){if(!(this.activeCells[Do.c.coords.x][Do.c.coords.z].lod<Do.c.lod)){Do.c.retire();continue}Do.c.tileset.registerRedrawCell(this.activeCells[Do.c.coords.x][Do.c.coords.z])}}else this.activeCells[Do.c.coords.x]={};Do.c.display(),this.activeCells[Do.c.coords.x][Do.c.coords.z]=Do.c}else Do.canPop=!1;ts["nearcell-staged"]=this.stagedCells.length}};let Mo=250,Co=50;const jo=Math.floor(2),ko={},zo={},So={},Oo={};class Lo{constructor(e,t,i){this.retiredCells=[],this.loadedCells={},this.seenCells={},this.tf=Math.floor(2.5),this.prevTile={x:-99999,z:-99999},this.overlapCheckTile={x:0,z:0},this.overlapPrevCheck={x:-99999,z:-99999},this.overlapRedrawTiles=[],this.stagedTilesets=[],this.stagingCells=[],this.preStagedCells=[],this.upcomingTilesets=[],this.loadState={init:!1,overlap:!1,tileset:!1},this.preStagedCellMap={},this.cellCount=0,this.heightmap=e,this.groundMaterial=t,this.container=new h.G,this.cellClass=i,this.container.matrixAutoUpdate=!1,this.seenIndex=st.vehicleIndex-1,this.initialise()}destroy(){this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()})),this.container.clear()}reset(e){this.heightmap=e,this.seenIndex=st.head.i;let t=Object.keys(ko);for(let s of t)delete ko[s];this.upcomingTilesets.length=0,this.stagedTilesets.length=0,this.prevTile.x=-9999,this.prevTile.z=-9999;let i=Object.keys(this.loadedCells);for(let s of i){let e=Object.keys(this.loadedCells[s]);for(let t of e)this.retireCell(s,t)}this.stagingCells.length=0,this.initialise()}loader(){return this.stagingCells.length?(this.stagingCells[0].generate()&&this.stagingCells.shift(),(this.stageInitCount-this.stagingCells.length)/this.stageInitCount):1}initialise(){Mo=Math.min(me/10*2.5,990),Co=Math.max(10,Mo/4);let e=Object.keys(ko);for(let i of e)delete ko[i];let t=Object.keys(zo);for(let i of t)delete zo[i],delete So[i];for(this.checkNode=st.vehicleNode,this.checkIndex=this.checkNode.i,this.seenIndex=st.vehicleIndex-1,this.initialiseOverlapMap(),this.checkInitialTileset(this.checkNode),this.checkStageTileset();this.preStagedCells.length;)Oo.psc=this.preStagedCells.shift(),delete this.preStagedCellMap[this.getCellKey(Oo.psc[0],Oo.psc[1])],this.stageCell(Oo.psc);this.stageInitCount=this.stagingCells.length,this.checkDrawTileset()}handleMidlineReset(){if(this.checkIndex>st.tail.i)throw console.error("Midline reset will affect fargrid lookahead"),this.checkNode=st.vehicleNode,this.checkIndex=st.vehicleIndex,new Error("Midline stuck at node "+st.tail.i);if(this.overlapCheckNode.i>=st.tail.i){let e=Object.keys(zo);for(let t of e){let e=Object.keys(zo[t]);for(let i of e)zo[t][i].i>st.tail.i&&(delete zo[t][i],delete So[t][i])}this.overlapCheckNode=st.tail}this.seenIndex=Math.min(st.vehicleIndex,this.seenIndex)}retireCell(e,t){this.seenCells[e]&&(delete this.seenCells[e][t],0==Object.keys(this.seenCells[e]).length&&delete this.seenCells[e]);let i=this.loadedCells[e][t];delete this.loadedCells[e][t],0==Object.keys(this.loadedCells[e]).length&&delete this.loadedCells[e],i.retire(),this.retiredCells.push(i)}checkActiveCell(e,t){var i,s;let n=Math.floor(e/me),a=Math.floor(t/me);return!!(null===(i=this.loadedCells[n])||void 0===i||null===(s=i[a])||void 0===s?void 0:s.mesh.visible)}addOverlap(e,t,i,s,n=null,a=1){ko[e]||(ko[e]={}),ko[e][t]||(ko[e][t]={}),ko[e][t][i]||(ko[e][t][i]={}),(!ko[e][t][i][s]||ko[e][t][i][s]<a)&&(ko[e][t][i][s]=a),null!==n&&(!ko[e][t][i][n]||ko[e][t][i][n]<a)&&(ko[e][t][i][n]=a),zo[e]||(zo[e]={},So[e]={}),zo[e][t]||(zo[e][t]=this.overlapCheckNode),So[e][t]=this.overlapCheckNode}applyTileOverlap(e,t,i,s,n){let a=i+1,r=s+1;this.addOverlap(e,t,i,s,r,n),this.addOverlap(e,t,a,s,r,n),0==i?(this.addOverlap(e-1,t,xe,s,s+1,n),0==s?this.addOverlap(e-1,t-1,xe,xe,null,n):r==xe&&this.addOverlap(e-1,t+1,xe,0,null,n)):a==xe&&(this.addOverlap(e+1,t,0,s,s+1,n),0==s?this.addOverlap(e+1,t-1,0,xe,null,n):r==xe&&this.addOverlap(e+1,t+1,0,0,null,n)),0==s?(this.addOverlap(e,t-1,i,xe,null,n),this.addOverlap(e,t-1,i+1,xe,null,n)):r==xe&&(this.addOverlap(e,t+1,i,0,null,n),this.addOverlap(e,t+1,i+1,0,null,n))}initialiseOverlapMap(){this.overlapCheckNode=st.head;let e=Math.floor(this.overlapCheckNode.p.x/Ae),t=Math.floor(this.overlapCheckNode.p.z/Ae);this.overlapPrevCheck.x=e,this.overlapPrevCheck.z=t;let i,s,n,a,r,h,o=Math.floor(2);for(let l=-o;l<=o;l++)for(let d=-o;d<=o;d++)i=(e+l)*Ae/me,s=(t+d)*Ae/me,n=Math.floor(i),a=Math.floor(s),r=(e+l)%xe,h=(t+d)%xe,r<0&&(r+=xe),h<0&&(h+=xe),l==-o||l==o||d==-o||d==o?this.applyTileOverlap(n,a,r,h,-1):this.applyTileOverlap(n,a,r,h,Math.abs(this.overlapCheckNode.g));for(this.overlapCheckNode=this.overlapCheckNode.next;this.overlapCheckNode.i<st.vehicleIndex+1e3;)this.updateOverlapMap()}updateOverlapRedraw(){for(Oo.fz2=me/2,Oo.oci=this.overlapRedrawTiles.length-1;Oo.oci>=0;Oo.oci--){var e,t,i,s,n;if(Oo.ocx=this.overlapRedrawTiles[Oo.oci][0],Oo.ocz=this.overlapRedrawTiles[Oo.oci][1],Oo.cx=So[Oo.ocx][Oo.ocz].p.x,Oo.cz=So[Oo.ocx][Oo.ocz].p.z,(Oo.cx-this.overlapCheckNode.p.x)*(Oo.cx-this.overlapCheckNode.p.x)+(Oo.cz-this.overlapCheckNode.p.z)*(Oo.cz-this.overlapCheckNode.p.z)>4e4)if(this.overlapRedrawTiles.splice(Oo.oci,1),null===(e=this.loadedCells[Oo.ocx])||void 0===e?void 0:e[Oo.ocz])if(this.loadedCells[Oo.ocx][Oo.ocz].resetOverlapMap(null===(t=So[Oo.ocx])||void 0===t?void 0:t[Oo.ocz],null===(i=ko[Oo.ocx])||void 0===i?void 0:i[Oo.ocz]),this.loadedCells[Oo.ocx][Oo.ocz].ready)this.stagingCells.push(this.loadedCells[Oo.ocx][Oo.ocz]);else{let e=this.loadedCells[Oo.ocx][Oo.ocz];console.log(e.genRow,e.overlapIndex,e.treeGenIndex,e.farWallRenderer.ready)}else console.log(null===(s=this.loadedCells[Oo.ocx])||void 0===s||null===(n=s[Oo.ocz])||void 0===n?void 0:n.ready)}}updateOverlapMap(){if(Oo.nx=Math.floor(this.overlapCheckNode.p.x/Ae),Oo.nz=Math.floor(this.overlapCheckNode.p.z/Ae),Oo.nx==this.overlapPrevCheck.x&&Oo.nz==this.overlapPrevCheck.z&&this.overlapCheckNode.next)return void(this.overlapCheckNode=this.overlapCheckNode.next);let e,t,i,s;this.overlapRedrawTiles.length&&this.updateOverlapRedraw(),Oo.dx=Oo.nx-this.overlapPrevCheck.x,Oo.dz=Oo.nz-this.overlapPrevCheck.z,this.overlapPrevCheck.x=Oo.nx,this.overlapPrevCheck.z=Oo.nz;let n,a,r,h=jo;for(r=1-h;r<=h;r++){var o,l;if(0!=Oo.dx)n=this.overlapCheckNode.p.x+Oo.dx*h*Ae,a=this.overlapCheckNode.p.z+r*Ae,e=Math.floor(n/me),t=Math.floor(a/me),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,(null===(o=this.loadedCells[e])||void 0===o?void 0:o[t])&&!this.loadedCells[e][t].needsOverlapRedraw&&(this.loadedCells[e][t].needsOverlapRedraw=!0,this.overlapRedrawTiles.push([e,t])),i=Math.floor((n-e*me)/Ae),s=Math.floor((a-t*me)/Ae),this.applyTileOverlap(e,t,i,s,-1);if(0!==Oo.dz)n=this.overlapCheckNode.p.x+r*Ae,a=this.overlapCheckNode.p.z+Oo.dz*h*Ae,e=Math.floor(n/me),t=Math.floor(a/me),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,(null===(l=this.loadedCells[e])||void 0===l?void 0:l[t])&&!this.loadedCells[e][t].needsOverlapRedraw&&(this.loadedCells[e][t].needsOverlapRedraw=!0,this.overlapRedrawTiles.push([e,t])),i=Math.floor((n-e*me)/Ae),s=Math.floor((a-t*me)/Ae),this.applyTileOverlap(e,t,i,s,-1)}for(h-=1,r=-h;r<=h;r++)0!=Oo.dx&&(n=this.overlapCheckNode.p.x+Oo.dx*h*Ae,a=this.overlapCheckNode.p.z+r*Ae,e=Math.floor(n/me),t=Math.floor(a/me),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,i=Math.floor((n-e*me)/Ae),s=Math.floor((a-t*me)/Ae),this.applyTileOverlap(e,t,i,s,Math.abs(this.overlapCheckNode.g))),0!==Oo.dz&&(n=this.overlapCheckNode.p.x+r*Ae,a=this.overlapCheckNode.p.z+Oo.dz*h*Ae,e=Math.floor(n/me),t=Math.floor(a/me),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,i=Math.floor((n-e*me)/Ae),s=Math.floor((a-t*me)/Ae),this.applyTileOverlap(e,t,i,s,Math.abs(this.overlapCheckNode.g)));this.overlapCheckNode.next&&(this.overlapCheckNode=this.overlapCheckNode.next)}checkInitialTileset(e){let t,i,s,n,a=this.getCoords(e.p),r=a.x,h=a.z,o={node:e,originIndex:e.i,newTiles:[],deadTiles:[]};for(t=-this.tf;t<=this.tf;t++)for(s=t+r,i=-this.tf;i<=this.tf;i++)n=i+h,o.newTiles.push([s,n]),s in this.seenCells||(this.seenCells[s]={}),(!(n in this.seenCells)||e.i>this.seenCells[s][n])&&(this.seenCells[s][n]=e.i);this.upcomingTilesets.push(o),this.prevTile.x=r,this.prevTile.z=h}checkTilesetForNode(e){let t=this.getCoords(e.p),i=t.x,s=t.z;if(i===this.prevTile.x&&s===this.prevTile.z)return;let n,a,r,h,o,l,d,c,p=i-this.prevTile.x,u=s-this.prevTile.z,g={node:e,originIndex:this.checkIndex,newTiles:[],deadTiles:[]};for(0!==p&&(o=this.prevTile.x+p*(this.tf+1),l=this.prevTile.x-p*this.tf),0!==u&&(d=this.prevTile.z+u*(this.tf+1),c=this.prevTile.z-u*this.tf),n=-this.tf;n<=this.tf;n++)for(r=n+i,a=-this.tf;a<=this.tf;a++)h=a+s,0!==p&&(r==o&&g.newTiles.push([o,h]),r-p==l&&g.deadTiles.push([l,h-u])),0!==u&&(h==d&&g.newTiles.push([r,d]),h-u==c&&(void 0!==l&&r-p===l||g.deadTiles.push([r-p,c]))),r in this.seenCells||(this.seenCells[r]={}),(!(h in this.seenCells[r])||this.checkIndex>this.seenCells[r][h])&&(this.seenCells[r][h]=this.checkIndex);this.upcomingTilesets.push(g),this.prevTile.x=i,this.prevTile.z=s}getCellKey(e,t){return e+":"+t}checkStageTileset(){if(this.upcomingTilesets[0].originIndex<st.vehicleIndex+Co){let e,t,i,s,n=this.upcomingTilesets.shift();for(i of n.newTiles)e=i[0],t=i[1],s=this.getCellKey(e,t),e in this.loadedCells&&t in this.loadedCells[e]||s in this.preStagedCellMap||(this.preStagedCellMap[s]=!0,this.preStagedCells.push([e,t]));this.stagedTilesets.push(n)}}stageCell(e){var t,i,s,n;Oo.c=this.getCell(),Oo.x=e[0],Oo.z=e[1],Oo.x in this.loadedCells||(this.loadedCells[Oo.x]={}),Oo.redraw=!!(null===(t=this.loadedCells[Oo.x][Oo.z])||void 0===t?void 0:t.needsOverlapRedraw),Oo.c.initGeneration(Oo.x,Oo.z,null===(i=zo[Oo.x])||void 0===i?void 0:i[Oo.z],null===(s=So[Oo.x])||void 0===s?void 0:s[Oo.z],null===(n=ko[Oo.x])||void 0===n?void 0:n[Oo.z],this.heightmap,Oo.redraw),this.loadedCells[Oo.x][Oo.z]=Oo.c,this.stagingCells.push(Oo.c)}checkDrawTileset(){if(st.vehicleIndex>=this.stagedTilesets[0].originIndex){let i,s=this.stagedTilesets[0];for(i of s.newTiles){var e,t;if(!(null===(e=this.loadedCells[i[0]])||void 0===e||null===(t=e[i[1]])||void 0===t?void 0:t.ready))return;this.loadedCells[i[0]][i[1]].display()}for(i of s.deadTiles){let e=i[0],t=i[1];e in this.seenCells&&this.seenCells[e][t]<s.originIndex?(this.retireCell(e,t),ko[e]&&(delete ko[e][t],0==Object.keys(ko[e]).length&&delete ko[e]),zo[e]&&(delete zo[e][t],delete So[e][t],0==Object.keys(zo[e]).length&&(delete zo[e],delete So[e]))):this.loadedCells[e][t].hide()}this.stagedTilesets.shift()}}update(){if(this.checkIndex<st.vehicleIndex+Mo&&this.checkNode.next)this.checkNode=this.checkNode.next,this.checkIndex=this.checkNode.i,this.checkTilesetForNode(this.checkNode);else if(this.overlapCheckNode.i<st.vehicleIndex+1e3)this.updateOverlapMap();else if(this.preStagedCells.length)Oo.psc=this.preStagedCells.shift(),delete this.preStagedCellMap[this.getCellKey(Oo.psc[0],Oo.psc[1])],this.stageCell(Oo.psc);else if(this.stagingCells.length){for(Oo.max=this.stagingCells.length/2+2,Oo.c=0;Oo.c<this.stagingCells.length&&!(--Oo.max<=0);Oo.c++)this.stagingCells[Oo.c].generate()&&(this.stagingCells.splice(Oo.c,1),Oo.c--);ts["farcells-staged"]=this.stagingCells.length}this.seenIndex<st.vehicleIndex&&(this.upcomingTilesets.length&&this.checkStageTileset(),this.stagedTilesets.length&&this.checkDrawTileset(),this.seenIndex++)}getCoords(e){return{x:Math.floor(e.x/me),y:0,z:Math.floor(e.z/me)}}getOrigin(e){return{x:Math.floor(e.x/me)*me,y:0,z:Math.floor(e.z/me)*me}}getCell(){if(this.retiredCells.length)return this.retiredCells.pop();this.cellCount++;let e=new this.cellClass(this.heightmap,this.groundMaterial);return ts.farcells=this.cellCount,this.container.add(e.mesh),e}}var Ro=new class{constructor(){this.arng=new window.alea(Ve),this.container=new h.G,this.scene=null,this.envLayer=new h.G,this.vehicleOrigin=new h.W,this.loadProg=0,this.sceneReady=!1,this.checkPerformance=!1,this.topographyLoaderInit=this._topographyLoaderInit.bind(this),this.topographyReset=this._topographyReset.bind(this),this.topographyLoader=this._topographyLoader.bind(this),this.sceneReset=this._sceneReset.bind(this),this.sceneLoaderInit=this._sceneLoaderInit.bind(this),this.sceneLoader=this._sceneLoader.bind(this),this.updateConfig=this._updateConfig.bind(this),this.farGridLoaderInit=this._farGridLoaderInit.bind(this),this.farGridReset=this._farGridReset.bind(this),this.farGridLoader=this._farGridLoader.bind(this),this.nearGridReset=this._nearGridReset.bind(this),this.nearGridLoaderInit=this._nearGridLoaderInit.bind(this),this.nearGridLoader=this._nearGridLoader.bind(this),this.postGridLoader=this._postGridLoader.bind(this),this.setSceneTopographyBound=this.setSceneToplogy.bind(this),this.setSceneSkinBound=this.setSceneSkin.bind(this),this.setSceneWeatherIndexBound=this.setSceneWeatherIndex.bind(this),this.sunOffset=new h.W,this.checkTimer=.2,this.lastCheckTime=-1,this.skySpeed=5,this.skyOffset=225,wh.addListener("topography",this.setSceneTopographyBound),wh.addListener("skin",this.setSceneSkinBound),wh.addListener("weatherIndex",this.setSceneWeatherIndexBound),this.container.add(this.envLayer),te(wh.value.viewLodIndex),ie(wh.value.detailLodIndex)}nextSkin(){let e=wh.value.sceneName,t=wh.value.skin,i=wh.value.weatherIndex,s=wh.sceneMeta.scenes[e];if(i++,s.skinWeathers[t].length>i)wh.set("weatherIndex",i);else{let e=s.skins.indexOf(t);wh.set("weatherIndex",0),wh.set("skin",s.skins[(e+1)%s.skins.length])}}prevSkin(){let e=wh.value.sceneName,t=wh.value.skin,i=wh.value.weatherIndex,s=wh.sceneMeta.scenes[e],n=s.skinWeathers[t];if(i--,i>=0)wh.set("weatherIndex",i);else{let e=s.skins.indexOf(t)-1;e<0&&(e=s.skins.length-1),wh.set("weatherIndex",n.length-1),wh.set("skin",s.skins[e])}}initScene(e){let t=e;this.scene&&(this.envLayer.remove(this.scene.container),this.scene.destroy(),delete this.scene),this.scene=new t(this.getNearGridHeightAt.bind(this)),this.envLayer.add(this.scene.container),this.scene.sanitiseConfig(wh),this.scene.initialise(Ve,wh.value,(()=>this.onSceneReady()))}onSceneReady(){this.loadProg=0,this.sceneReady=!0,this.heightmap=this.scene.heightmap,this.midline&&(this.container.remove(this.midline.container),this.midline.destroy()),this.midline=new wo,this.getOriginPose(),this.midline.initialise(Ve,this.heightmap,this.vehicleOrigin),this.midlineAttempts=0,no.sendUpdate("skinChange",this.scene.getSkinName(wh.value.skin))}_topographyLoaderInit(){this.sceneReady=!1,this.loadProg=0,this.loadTime=Date.now(),window.localStorage.getItem("seed_failed")&&(console.log("BAD SEED"),window.localStorage.removeItem("seed_failed")),this.checkPerformance=!1,window.localStorage.getItem("analytics_returningPlayer")||(console.log("Env: Analysing performance for dynamic config"),this.checkPerformance=!0),this.initScene(ph[wh.value.sceneName])}_topographyReset(){this.sceneReady=!1,this.scene.reset(Ve,wh.value,(()=>this.onSceneReady))}_topographyLoader(){return this.sceneReady?this.buildMidline():0}_sceneReset(){}_sceneLoaderInit(){console.log(" - Topography initialised in",Date.now()-this.loadTime),no.midlineLoadTime=Date.now()-this.loadTime,no.playerProfile&&(no.playerProfile.midlineLoadTime=no.midlineLoadTime)}_sceneLoader(){return this.loadProg=this.scene.loader(),this.loadProg>=1&&(this.scene.setScene(wh.value),this.initSky(),this.initRoad()),this.loadProg}_updateConfig(){te(wh.value.viewLodIndex),ie(wh.value.detailLodIndex),this.scene.updateConfig(wh.value.viewLodIndex,wh.value.detailLodIndex),this.scene.setScene(wh.value);let e=2*fe;this.sky.scale.set(e,e,e),wh.value.detailLodIndex*wh.value.viewLodIndex==0?this.sky.visible=!1:this.sky.visible=!0,Qe.far=fe,Qe.updateProjectionMatrix()}_farGridLoaderInit(){this.loadTime=Date.now(),this.farGrid&&(this.farGrid.destroy(),this.envLayer.remove(this.farGrid.container),delete this.farGrid),this.farGrid=new Lo(this.heightmap,this.scene.groundMaterial,this.scene.farGridCell),this.envLayer.add(this.farGrid.container)}_farGridReset(){this.farGrid.reset(this.heightmap)}_farGridLoader(){return this.loadProg=this.farGrid.loader(),this.loadProg}_nearGridReset(){this.nearGrid.reset(this.heightmap)}_nearGridLoaderInit(){console.log(" - Far grid initialised in",Date.now()-this.loadTime),this.nearGrid&&(this.nearGrid.destroy(),this.envLayer.remove(this.nearGrid.container),delete this.nearGrid),this.nearGrid=new No(this.heightmap,this.scene.groundMaterial,this.scene.nearGridCell),this.envLayer.add(this.nearGrid.container)}_nearGridLoader(){return this.loadProg=this.nearGrid.loader(),1==this.loadProg&&(console.log(" - Both grids initialised in",Date.now()-this.loadTime),no.envLoadTime=Date.now()-this.loadTime,no.playerProfile&&(no.playerProfile.envLoadTime=no.envLoadTime),no.sendUpdate("loadTimes",{midline:no.midlineLoadTime,env:no.envLoadTime})),this.loadProg}_postGridLoader(){return this.scene.onGridReady(),1}buildMidline(){return this.loadProg=this.midline.loader(),this.loadProg<1?this.loadProg<0?(this.midlineAttempts++,this.midlineAttempts>=25||0==wh.initialNode&&this.midlineAttempts>=4?(console.log("Too many failed - reloading"),void qe(Date.now(),!0)):(this.getOriginPose(this.midlineAttempts),this.vehicleOrigin.x+this.vehicleOrigin.z>1e6?void qe(Date.now(),!0):(this.midline.initialise(Ve,this.heightmap,this.vehicleOrigin),0))):this.loadProg:(this.midline.finalise(),this.scene.onMidlineReady(),this.loadProg=0,1)}setSceneToplogy(e){this.scene.setTopography(e)}setSceneSkin(e){this.scene.setSkin(e),no.sendUpdate("skinChange",this.scene.getSkinName(e))}setSceneWeatherIndex(e){this.scene.setWeatherIndex(e),no.sendUpdate("weatherChange",e)}initSky(){if(this.sky)return;let e=2*fe;this.sky=new h.B(new h.J(1,1,10,10),Fe),this.sky.rotation.x=Math.PI/2,this.sky.position.y=200,this.sky.renderOrder=-100,this.sky.scale.set(e,e,e),this.sky.frustumCulled=!1,this.envLayer.add(this.sky)}initRoad(){this.roadController&&(this.roadController.destroy(),this.container.remove(this.roadController.container),delete this.roadController),this.roadController=new bo,this.container.add(this.roadController.container)}getHeightAt(e,t,i){return this.heightmap.getXZ(e,t,i)}getNearGridHeightAt(e,t){return this.nearGrid.testHeight(e,t)}testGround(e,t){return this.nearGrid.testGround(e.x,e.z,t)}testFarGrid(e,t){return this.farGrid.checkActiveCell(e,t)}getHeight(e,t,i){let s=this.nearGrid.testHeight(e.x,e.z);return s||this.heightmap.getXZ(e.x,e.z,i)}getOriginPose(e=0){let t=new window.alea(Ve),i=0+500*e,s=500*e,n=this.getHeightAt(i,s),a=this.getHeightAt(i+1,s+1),r=Math.abs((a-n)/1.414);for(;n<20||r>.5;)i+=100*Math.abs(t()),s+=100*Math.abs(t()),n=this.getHeightAt(i,s),a=this.getHeightAt(i+1,s+1),r=Math.abs((a-n)/1.414);return n=this.getHeightAt(i,s),this.vehicleOrigin.set(i,n,s),this.vehicleOrigin}update(e,t){if(this.midline.update()){try{this.roadController.update()}catch(Kc){throw Kc.cause="roadController",Kc}try{this.scene.update(e,t)}catch(Kc){throw Kc.cause="sceneController",Kc}try{this.nearGrid.update()}catch(Kc){throw Kc.cause="nearGrid",Kc}try{this.farGrid.update()}catch(Kc){throw Kc.cause="farGrid",Kc}}else this.roadController.handleMidlineReset(),this.scene.handleMidlineReset(),this.nearGrid.handleMidlineReset(),this.farGrid.handleMidlineReset();this.scene.updateAudio(),this.updateSky(e,t)}updateSky(e,t){ue.position.x=T.position.x+ue.sunOffset.x,ue.position.y=T.position.y+ue.sunOffset.y,ue.position.z=T.position.z+ue.sunOffset.z,this.sky.position.x=T.position.x,this.sky.position.y=T.position.y+this.skyOffset,this.sky.position.z=T.position.z,Fe.userData.time.value=t*this.skySpeed,Fe.uniformsNeedUpdate=!0}};const To={Chase:{name:"Near Chase",i:0,pitch:{near:.3,far:.2},yOffset:{near:.8,far:1},posOffset:new h.W(0,0,1.4),range:{near:3.5,far:4.5},farSpeed:45,smoothFactor:1.5},ChaseFar:{name:"Far Chase",i:1,pitch:{near:.25,far:.15},yOffset:{near:1,far:2},posOffset:new h.W(0,0,0),range:{near:7,far:10},farSpeed:45,smoothFactor:1.25},FirstPerson:{name:"First Person",i:2,pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:new h.W(0,.6,1.4),smoothFactor:.33,range:{near:.75,far:.75},farSpeed:45,rollFactor:-.75},Bonnet:{name:"Bonnet",i:3,posOffset:new h.W,rollFactor:-.75},Debug:{name:"Debug",i:4,pitch:{near:.5,far:.5},yOffset:{near:10,far:20},posOffset:new h.W(0,0,0),smoothFactor:1.5,range:{near:40,far:40},farSpeed:45}};let Po=["Chase","ChaseFar","FirstPerson"];const Go="config-camera-mode";var Bo=class{smoothLerp(e){return-1*(3-2*(e=Math.min(1,e)))*e*e+1}smootherLerp(e){return((e=Math.min(1,e))*(6*e-15)+10)*e*e*e*-1+1}constructor(e){if(this.onViewChange=()=>{},this.mode=To[Po[G]],this.modeIndex=0,this.boosting=!1,this.targetFOV=0,this.curFOV=ve,this.boostFOV=ve+3,this.orientation=new h.m(0,0,0,"YXZ"),this.targets={y:0,x:0},this.vCenter=new h.W,this.camFwd=new h.W,this.uLerpA=0,this.uLerpB=0,this.uDist=0,this.uSmoothA=0,this.uSmoothB=0,this.uH=0,this.uCollisionCheck=1,this.randFrame=!1,this.onViewChange=e,this.camera=Qe,this.camera.add(z.listener),T.addListener(S,this.reset.bind(this)),T.addListener(O,this.initVehicleAngles.bind(this)),window.localStorage.getItem(Go))try{this.modeIndex=JSON.parse(window.localStorage.getItem(Go))}catch{console.log("Camera: Failed to load mode from memory")}this.initVehicleAngles(!0)}initVehicleAngles(e=!1){if(!T.cameras)return;Po=Object.keys(T.cameras);let t=T.cameras;for(let i in t){let e=To[i],s=t[i];e.pitch=s.pitch,e.yOffset=s.yOffset,e.posOffset.fromArray(s.posOffset),e.range=s.range,e.farSpeed=s.farSpeed,e.smoothFactor=s.smoothFactor,e.hideVehicle=s.hideVehicle}this.modeIndex%=Po.length,this.mode=To[Po[this.modeIndex]],e||window.localStorage.setItem(Go,this.modeIndex),this.reset()}updateViewDist(){this.camera.far=we,this.camera.updateProjectionMatrix()}reset(){let e=0;isNaN(this.orientation.y+this.targets.y)||(e=this.targets.y-this.orientation.y),e%=2*Math.PI,this.uLerpA=this.smoothLerp(T.speed/this.mode.farSpeed),this.uLerpB=1-this.uLerpA,this.targets.x=this.mode.pitch.near*this.uLerpA+this.mode.pitch.far*this.uLerpB+T.pitch,this.targets.x*=-1,this.targets.y=T.heading-Math.PI,this.targets.z=0,this.mode.rollFactor&&(this.targets.z=T.roll*this.mode.rollFactor),this.orientation.x=this.targets.x,this.orientation.y=this.targets.y-e,this.orientation.z=this.targets.z,T.geo.visible=!this.mode.hideVehicle}setSize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.onViewChange()}update(e){p.key[u.Camera]&&(this.modeIndex=(this.modeIndex+1)%Po.length,this.mode=To[Po[this.modeIndex]],window.localStorage.setItem(Go,this.modeIndex),this.reset(),no.sendUpdate("cameraChange",Po[this.modeIndex]),p.key[u.Camera]=!1),this.uLerpA=this.smoothLerp(T.speed/this.mode.farSpeed),this.uLerpB=1-this.uLerpA,this.uSmoothA=Math.min(e/(P*this.mode.smoothFactor),1),this.uSmoothC=this.uSmoothA/2,this.uSmoothB=1-this.uSmoothA,this.uSmoothD=1-this.uSmoothC,this.vCenter.copy(this.mode.posOffset).applyQuaternion(T.quaternion).add(T.position),this.vCenter.y+=this.mode.yOffset.near*this.uLerpA+this.mode.yOffset.far*this.uLerpB,this.camera.position.copy(this.vCenter);let t=T.heading-Math.PI;this.targets.y<-2&&t>2?this.orientation.y+=2*Math.PI:this.targets.y>2&&t<-2&&(this.orientation.y-=2*Math.PI),this.targets.y=t,this.mode.rollFactor?(this.targets.x=this.mode.pitch.near*this.uLerpA+this.mode.pitch.far*this.uLerpB+T.pitch,this.targets.z=T.roll*this.mode.rollFactor,this.orientation.z=this.targets.z*this.uSmoothA+this.orientation.z*this.uSmoothB):(this.targets.x=this.mode.pitch.near*this.uLerpA+this.mode.pitch.far*this.uLerpB+T.pitch,this.targets.x=Math.max(-.2,this.targets.x)),this.targets.x*=-1,this.orientation.x=this.targets.x*this.uSmoothC+this.orientation.x*this.uSmoothD,this.orientation.y=this.targets.y*this.uSmoothA+this.orientation.y*this.uSmoothB,this.camera.setRotationFromEuler(this.orientation),this.camera.getWorldDirection(this.camFwd),Qe.fwd.copy(this.camFwd).normalize().multiplyScalar(-1),this.uDist=this.mode.range.near*this.uLerpA+this.mode.range.far*this.uLerpB,this.camera.position.add(this.camFwd.multiplyScalar(-this.uDist)),this.uCollisionCheck-=e,this.mode.i<2&&this.uCollisionCheck<0&&(this.uH=Ro.getHeight(this.camera.position)+1.5,this.uH>this.camera.position.y?(this.camera.position.y=this.uH,this.camera.lookAt(this.vCenter)):this.uH<this.camera.position.y+2?this.uCollisionCheck=(this.uH-this.camera.position.y)/2:this.collisionCheck=1)}updateConfig(){}destroy(){this.camera.clear()}};var Wo=class{smoothLerp(e){return-1*(3-2*(e=Math.min(1,e)))*e*e+1}smootherLerp(e){return((e=Math.min(1,e))*(6*e-15)+10)*e*e*e*-1+1}constructor(e,t){this.onViewChange=()=>{},this.modeIndex=0,this.lockChangeAlertBound=this.lockChangeAlert.bind(this),this.onMouseMoveBound=this.onMouseMove.bind(this),this.orientation=new h.m(0,0,0,"YXZ"),this.targets={y:0,x:0},this.vCenter=new h.W,this.camFwd=new h.W,this.uLerpA=0,this.uLerpB=0,this.uDist=0,this.uSmoothA=0,this.uSmoothB=0,this.uH=0,this.uCollisionCheck=1,this.randFrame=!1,this.dir=new h.W,this.leftVec=new h.W(0,0,1),this.upVec=new h.W(0,1,0),this.camUp=new h.W,this.camLeft=new h.W,this.trackPosition=new h.W,this.targetPosition=new h.W,this.targetSmoothing=.025,this.posVec=new h.W,this.sX=0,this.sZ=1,this.targetSpeed=0,this.speed=0,this.baseSpeed=75,this.targetElevSpeed=0,this.elevSpeed=0,this.baseElevSpeed=25,this.targetRotSpeed=0,this.rotSpeed=0,this.baseRotSpeed=1,this.targetRotX=0,this.targetRotY=0,this.mouseSense=.001,this.targetZoom=1,this.curZoom=1,this.maxZoom=8,this.minZoom=.75,this.zoomSpeed=5,this.xSmooth=.003,this.rotSmooth=.02,this.matchSpeed=!1,this.track=!1,this.onViewChange=e,this.camera=Qe,this.camContainer=new h.G,this.camContainer.add(this.camera),this.camContainer.rotation.order="ZYX",this.camera.rotation.set(0,0,0),this.camera.rotation.y=Math.PI,this.camera.position.set(0,0,0),this.canvas=t,this.canvas.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock,this.canvas.onclick=()=>{this.canvas.requestPointerLock()},document.addEventListener("pointerlockchange",this.lockChangeAlertBound,!1),this.camera.add(z.listener),this.debug=new h.B(new h.S(2,32,16),new h.C({color:110832})),ao.add(this.debug),this.reset()}lockChangeAlert(){document.pointerLockElement===this.canvas||document.mozPointerLockElement===this.canvas?document.addEventListener("mousemove",this.onMouseMoveBound,!1):document.removeEventListener("mousemove",this.onMouseMoveBound,!1)}onMouseMove(e){this.targetRotY-=e.movementX*this.mouseSense/this.curZoom,this.targetRotX+=e.movementY*this.mouseSense*this.camera.aspect/this.curZoom}updateViewDist(){this.camera.far=we,this.camera.updateProjectionMatrix()}reset(){this.camContainer.position.copy(T.position),this.camContainer.position.y+=5,this.camContainer.rotation.y=T.heading,this.camContainer.rotation.x=.2,this.curZoom=1,this.targetZoom=1,this.sX=Math.sin(this.camContainer.rotation.y+Math.PI),this.sZ=Math.cos(this.camContainer.rotation.y+Math.PI),this.targetPosition.copy(this.camContainer.position),this.targetRotX=this.camContainer.rotation.x,this.targetRotY=this.camContainer.rotation.y}setSize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.onViewChange()}update(e){if(p.key[u.Camera]&&(this.camera.far=1e4,this.camera.updateProjectionMatrix(),p.key[u.Camera]=!1),p.key[u.StickySteer]&&(p.key[u.StickySteer]=!1,this.matchSpeed=!this.matchSpeed),p.key[u.NodeDebug]){let e=tt(this.camContainer.position.x,this.camContainer.position.z,st.vehicleNode,!0).n,t=it(this.camContainer.position.x,this.camContainer.position.z,e);console.log("Near node is "+t.n.i+" at dist "+t.d),this.debug.position.copy(t.n.p),p.key[u.NodeDebug]=!1}this.matchSpeed?this.targetSpeed=Math.max(1,T.speed):(this.speed=.9*this.speed,this.targetSpeed=0),this.targetElevSpeed=0,this.posVec.set(0,0,0),this.dir.x=0,this.hadInput=!1,p.key[u.Forward]&&(this.hadInput=!0,this.posVec.x-=e*this.speed*this.sX,this.posVec.z-=e*this.speed*this.sZ),p.key[u.Backward]&&(this.hadInput=!0,this.posVec.x+=e*this.speed*this.sX,this.posVec.z+=e*this.speed*this.sZ),this.dir.z=0,p.key[u.Left]&&(this.hadInput=!0,this.posVec.x-=e*this.speed*this.sZ,this.posVec.z+=e*this.speed*this.sX),p.key[u.Right]&&(this.hadInput=!0,this.posVec.x+=e*this.speed*this.sZ,this.posVec.z-=e*this.speed*this.sX),this.hadElev=!1,p.click.right?(this.hadElev=!0,this.posVec.y-=e*this.elevSpeed):p.click.left&&(this.hadElev=!0,this.posVec.y+=e*this.elevSpeed),this.hadInput&&!this.matchSpeed&&(this.targetSpeed=this.baseSpeed),this.hadElev&&(this.targetElevSpeed=this.baseElevSpeed),p.key[u.BoostAccel]&&(this.targetSpeed*=2),this.speed=.9*this.speed+.1*this.targetSpeed,this.elevSpeed=.95*this.elevSpeed+.05*this.targetElevSpeed,this.hadRot=!1,this.targetRotSpeed=0,p.key[u.LeftArrow]?(this.hadRot=!0,this.targetRotY+=e*this.rotSpeed):p.key[u.RightArrow]&&(this.hadRot=!0,this.targetRotY-=e*this.rotSpeed),p.key[u.UpArrow]?(this.hadRot=!0,this.targetRotX-=e*this.rotSpeed*.5):p.key[u.DownArrow]&&(this.hadRot=!0,this.targetRotX+=e*this.rotSpeed*.5),this.hadRot&&(this.targetRotSpeed=1*this.baseRotSpeed/this.curZoom),p.key[u.Num1]&&(this.targetRotSpeed*=2),this.rotSpeed=.98*this.rotSpeed+.02*this.targetRotSpeed,this.camContainer.rotation.x=this.camContainer.rotation.x*(1-this.rotSmooth)+this.targetRotX*this.rotSmooth,this.camContainer.rotation.y=this.camContainer.rotation.y*(1-this.rotSmooth)+this.targetRotY*this.rotSmooth,this.sX=Math.sin(this.camContainer.rotation.y+Math.PI),this.sZ=Math.cos(this.camContainer.rotation.y+Math.PI),0!=p.scrollDelta&&(this.targetZoom-=p.scrollDelta*e*this.zoomSpeed,this.targetZoom=Math.max(Math.min(this.maxZoom,this.targetZoom),this.minZoom),p.scrollDelta=0),this.curZoom=.95*this.curZoom+.05*this.targetZoom,this.curZoom!=this.camera.zoom&&(this.camera.zoom=this.curZoom,this.camera.updateProjectionMatrix()),p.key[u.T]&&(p.key[u.T]=!1,this.track=!this.track,this.track||(this.camera.rotation.x=0,this.camera.rotation.y=Math.PI,this.camera.rotation.z=0)),this.track&&(this.trackPosition.copy(T.frontAxlePosition),this.trackPosition.y+=.5,this.camContainer.lookAt(this.trackPosition)),p.key[u.ResetCamera]&&(this.reset(),p.key[u.ResetCamera]=!1),this.camera.getWorldDirection(this.camFwd),this.targetPosition.add(this.posVec),this.camContainer.position.lerp(this.targetPosition,this.targetSmoothing),this.uCollisionCheck-=e,this.uCollisionCheck<0&&(this.uH=Ro.getHeight(this.targetPosition)+.5,this.uH>this.targetPosition.y?this.targetPosition.y=this.uH:this.uH<this.targetPosition.y+2?this.uCollisionCheck=(this.uH-this.targetPosition.y)/2:this.collisionCheck=1)}updateConfig(){}destroy(){this.camContainer.clear(),this.camera.clear(),ao.remove(this.debug)}};function Eo(e,t){return 0==t?e>0?Math.PI/2:3*Math.PI/2:0==e?t>0?0:Math.PI:e>0?t>0?Math.atan(e/t):Math.PI+Math.atan(e/t):t<0?Math.PI+Math.atan(e/t):2*Math.PI+Math.atan(e/t)}var Zo=new class extends l{constructor(...e){super(...e),this.default=-9.81,this.value=-9.81}};var Fo={mouseWidgetHeight:24,mouseWidgetWidth:640,useMouse:!0},Ho=i.p+"static/media/achievement.3ef707de.wav";const Qo={edge:!1},Yo={edge:"achievement-edge"};var Vo=new class extends x{constructor(...e){super(...e),this.value=Qo,this.hasLoaded=!1,this.sound=null,this.loadAchievements(),this.hasLoaded=!0,z.hasInit?this.onAudioInit():z.addInitListener(this.onAudioInit.bind(this))}onAudioInit(){z.getAudio(Ho,(e=>{this.sound=e}))}set(e,t){var i;e in this.value&&!this.value[e]&&1==t&&(null===(i=this.sound)||void 0===i||i.play(),window.localStorage.setItem(Yo[e],t));super.set(e,t)}loadAchievements(){let e,t;for(t in this.value)e=JSON.parse(window.localStorage.getItem(Yo[t])||Qo[t]),this.value[t]=e}};const Uo=Object.keys(Ch),Xo=()=>({personal:Jo(),global:{daily:Jo(),allTime:Jo()}}),Jo=()=>{let e={};for(let t of gh){e[t]={};for(let i of Uo)e[t][i]=-1}return e},qo=Xo();var Ko=new class extends x{}({...qo,key:"fastestMile",seconds:-1,live:{value:-1,progress:0,prev:0},liveInterval:{startTime:0,startNode:0,endNode:160}});const _o=[{key:"fastestMile",label:"Fastest Any Mile",unit:"seconds",state:Ko,stateKey:"seconds"},{key:"fastestFirstFive",label:"Fastest First Five Miles",unit:"seconds"},{key:"furthestJourney",label:"Furthest Single Journey",unit:"meters"},{key:"furthestOnRoad",label:"Furthest On-Road",unit:"meters"}];var $o=new class extends x{constructor(e){super(e),this.updateView(),this.loadRecords(),this.listenRecords(),Rh.addListener("type",this.onVehicleChanged.bind(this))}switchBoard(){"global"==this.view.board?this.set("view",{...this.view,board:"personal"}):this.set("view",{...this.view,board:"global"})}switchTime(){"daily"==this.view.time?this.set("view",{...this.view,time:"allTime"}):this.set("view",{...this.view,time:"daily"})}loadRecords(){for(let e of _o)e.state&&e.state.set("personal",this.getRecords("records_"+e.key))}updateView(){this.set("view",{...this.view,topography:wh.initialValue.topography,vehicle:Rh.value.type})}onVehicleChanged(e){this.updateView()}listenRecords(){}getRecords(e){let t=null;try{t=JSON.parse(window.localStorage.getItem(e))}catch(Kc){console.warn("Could not load record "+e+" from local storage")}if(null==t){t=Xo().personal}return t}storeRecords(e,t){window.localStorage.setItem("records_"+e,JSON.stringify(t))}getStorage(e){let t=null;try{t=JSON.parse(window.localStorage.getItem(e))}catch(Kc){console.warn("Could not load record "+e+" from local storage")}return t}encodeKey(e){return"records_"+wh.initialValue.topography+"_"+Rh.value.type+"_"+e}store(e,t){isNaN(t)?console.warn("Avoiding record of NaN value ",t):t<0?console.warn("Avoiding record of default value ",t):window.localStorage.setItem(this.encodeKey(e),t)}}({view:{topography:"normal",vehicle:"Roadster",time:"daily",board:"personal"},global:null});var el=new class extends l{constructor(...e){super(...e),this.default=!1,this.value=!1}};var tl=new class{constructor(){this.onDisplayBound=this.onDisplay.bind(this),this.onSocketBound=this.onSocket.bind(this),this.hasInit=!1,this.updateViewBound=this.updateView.bind(this),this.seenIndex=0,this.updateBound=this.update.bind(this),this.endNodeOffset=0,this.endNodeTracker=0,null!==Hh.value?this.onSocket(Hh.value):Hh.addListener(this.onSocketBound),$o.addListener("view",this.updateViewBound),el.addListener(this.onDisplayBound)}onDisplay(e){e?(this.resetFastestMile(),I.addSlowListener(this.updateBound)):I.addSlowListener(this.updateBound)}onSocket(e){e.on("leaderboard",this.onNewLeaderboard.bind(this)),e.on("partialLeaderboard",this.onPartialLeaderboard.bind(this)),e.on("newRecord",this.onNewRecord.bind(this)),e.emit("requestLeaderboard")}onNewLeaderboard(e){$o.set("global",e)}onPartialLeaderboard(e){}onNewRecord(e){console.log("Got a new record!")}submitRecord(e,t,i,s,n="Anonymous"){Hh.value&&Hh.value.emit("challengeRecord",{key:i,topography:e,vehicle:t,value:s,name:n})}updateView(e){this.resetFastestMile()}pause(){this.paused=!0}resume(){this.paused=!1,this.hasInit||this.resetFastestMile(),this.hasInit=!0}init(){$o.updateView(),this.resetFastestMile(),this.paused=!0,this.hasInit=!1}resetFastestMile(){Ko.set("liveInterval",{startTime:I.playTime,startNode:st.vehicleIndex,endNode:st.vehicleIndex+160}),Ko.set("live",{value:0,prev:Ko.live.prev,progress:0})}nodeDidChange(){wh.saveProgress(st.vehicleIndex)}update(e){this.paused||(this.updateFastestMile(e),this.seenIndex=st.vehicleIndex)}checkRecordBreak(e,t,i){return!(e<1)&&(this.tr=t.personal[$o.view.topography][$o.view.vehicle],(e<this.tr||this.tr<0)&&(t.personal[$o.view.topography][$o.view.vehicle]=e,!0))}updateFastestMile(e){Ko.live.value+=1e3*e/1e3,this.seenIndex!==st.vehicleIndex&&(Ko.live.progress=(st.vehicleIndex-Ko.liveInterval.startNode)/160,Ko.liveInterval.endNode<=st.vehicleIndex&&(this.checkRecordBreak(Ko.live.value,Ko)&&(Ko.onChanged("personal",Ko.personal),$o.storeRecords(Ko.key,Ko.personal)),this.submitRecord($o.view.topography,$o.view.vehicle,Ko.key,Ko.live.value),Ko.set("liveInterval",{startTime:I.playTime,startNode:st.vehicleIndex,endNode:st.vehicleIndex+160}),Ko.live.prev=Ko.live.value,Ko.live.value=0,Ko.live.progress=0)),Ko.onChanged("live",Ko.live)}};const il={None:0,Basic:1,Reset:2,Boost:3,UTurn:4,Reverse:5},sl={Reset:"seen-reset",Boost:"seen-boost"},nl={Basic:Bh.newUser,Reset:null==localStorage.getItem(sl.Reset),Boost:null==localStorage.getItem(sl.Boost)},al=e=>{e in nl&&(nl[e]=!1,localStorage.setItem(sl[e],!0),rl.value==il[e]&&rl.set(il.None))},rl=new l(Bh.newUser?il.Basic:il.None);var hl=rl,ol=i.p+"static/media/tyres_01_m.2ec57852.mp3",ll=i.p+"static/media/sus_01.6624d5cb.mp3",dl=i.p+"static/media/veh_brake_02.4c95eb2a.mp3",cl=i.p+"static/media/veh_brake_01.9dca1f18.mp3",pl=i.p+"static/media/rolling_offroad_04.e2ad11f4.mp3",ul=i.p+"static/media/veh_scrape_01.3499a87a.mp3",gl=i.p+"static/media/hit_01.33777ad9.mp3",ml=i.p+"static/media/hit_02.c5bc2ff2.mp3",xl=i.p+"static/media/hit_03.43267a22.mp3";const vl="roll",wl="engine",fl="engine2",bl="brake",Al="boost",yl=.8,Il={brake:dl,boost:cl,engine2:dl},Dl={sus:ll,tyre:ol,roll:null,offroad:pl},Nl={hits:[gl,ml,xl],scrape:ul};var Ml=class{constructor(e){this.sounds={tyres:[],sus:[],rolls:[],offroads:[]},this.worldSounds={hits:[],scrape:null},this.audioReady=!1,this.paved=!0,this.updateNull=()=>{},this.vol=0,this.decel=!1,this.lerpTarget=0,this.speedTarget=0,this.boostT=0,this.brakeT=0,this.tls=[0,0,0,0],this.coll=!1,this.hitIndex=0,this.vc=e,this.update=this.updateNull,"Planet"==wh.sceneName&&(this.paved=!1),wh.addListener("sceneName",(e=>this.paved="Planet"!==e))}suspend(){for(let t in this.sounds){var e;if(Array.isArray(this.sounds[t]))for(let e of this.sounds[t])e.setVolume(0);else null===(e=this.sounds[t])||void 0===e||e.setVolume(0)}for(let t of this.worldSounds.hits)t.setVolume(0);this.worldSounds.scrape.setVolume(0)}initForVehicle(e,t,i){this.update=this.updateNull,this.inputs=t,this.wheels=i,this.soundCount=0,this.soundLoaded=0;for(let r in e.audio)this.loadSound(r,e.audio[r]);for(let r in Il)e.audio[r]||this.loadSound(r,Il[r]);Dl.roll=e.audio.roll,this.loadWorldSounds();for(let r in this.sounds){var s,n;for(let e=0;e<this.sounds[r].length;e++)this.sounds[r][e].stop();null===(s=(n=this.sounds[r]).stop)||void 0===s||s.call(n)}let a=[];e.bike?a.push({x:0,z:e.wheels.length},{x:0,z:0}):a.push({x:e.wheels.width/2,z:e.wheels.length},{x:-e.wheels.width/2,z:e.wheels.length},{x:e.wheels.width/2,z:0},{x:-e.wheels.width/2,z:0});for(let r=0;r<a.length;r++)this.loadTyre(r,a[r]);this.lerpTarget=0,this.speedTarget=0}soundDidLoad(){this.soundLoaded++,this.soundLoaded>=this.soundCount&&(this.update=this.updateLive)}loadHit(e){this.soundCount++,z.getPositionalAudio(Nl.hits[e],(t=>{this.worldSounds.hits[e]=t,t.setRefDistance(5),t.setRolloffFactor(3*yl),t.setVolume(0),T.add(t),t.onEnded=()=>{t.stop()},this.soundDidLoad()}),this.worldSounds.hits[e])}loadWorldSounds(){for(let e=0;e<Nl.hits.length;e++)this.loadHit(e);this.soundCount++,z.getPositionalAudio(Nl.scrape,(e=>{this.worldSounds.scrape&&(this.worldSounds.scrape.stop(),T.remove(this.worldSounds.scrape)),this.worldSounds.scrape=e,e.setLoop(!0),e.setLoopStart(.1),e.setLoopEnd(e.buffer.duration-.1),e.setVolume(0),e.setRefDistance(8),e.setRolloffFactor(yl),e.play(),e.position.set(0,.5,T.wheels.length/2),T.add(this.worldSounds.scrape),this.soundDidLoad()}))}loadTyre(e,t){this.soundCount+=4,z.getPositionalAudio(Dl.tyre,(i=>{this.sounds.tyres[e]&&this.sounds.tyres[e].stop(),this.sounds.tyres[e]=i,i.setLoop(!0),i.setLoopStart(.1),i.setLoopEnd(i.buffer.duration-.1),i.setRefDistance(2*T.wheels.length),i.setRolloffFactor(4),i.setVolume(0),i.offset=Math.random()*i.buffer.duration,i.detune=-400*Math.random(),i.play(),i.position.x=t.x,i.position.z=t.z,T.add(i),this.soundDidLoad()}),this.sounds.tyres[e]),z.getPositionalAudio(Dl.roll,(i=>{this.sounds.rolls[e]&&this.sounds.rolls[e].stop(),this.sounds.rolls[e]=i,i.setLoop(!0),i.setLoopStart(.1),i.setLoopEnd(i.buffer.duration-.1),i.setVolume(0),i.setRefDistance(2*T.wheels.length),i.setRolloffFactor(3*yl),i.offset=(.1*Math.random()+.25*e)*i.buffer.duration,i.play(),i.position.x=t.x,i.position.z=t.z,T.add(i),this.soundDidLoad()}),this.sounds.rolls[e]),z.getPositionalAudio(Dl.offroad,(i=>{this.sounds.offroads[e]&&this.sounds.offroads[e].stop(),this.sounds.offroads[e]=i,i.setLoop(!0),i.setLoopStart(.1),i.setLoopEnd(i.buffer.duration-.1),i.setVolume(0),i.setRefDistance(2*T.wheels.length),i.setRolloffFactor(3*yl),i.offset=Math.random()*i.buffer.duration,i.detune=800*Math.random(),i.play(),i.position.x=t.x,i.position.z=t.z,e<2&&(i.position.z=T.wheels.length),T.add(i),this.soundDidLoad()}),this.sounds.offroads[e]),z.getPositionalAudio(Dl.sus,(i=>{this.sounds.sus[e]&&this.sounds.sus[e].stop(),this.sounds.sus[e]=i,i.setLoop(!0),i.setLoopStart(.1),i.setLoopEnd(i.buffer.duration-.1),i.setRefDistance(.8),i.setRolloffFactor(yl),i.setVolume(0),i.offset=Math.random()*i.buffer.duration,i.detune=-400*Math.random(),i.play(),i.position.x=t.x,i.position.z=t.z,T.add(i),this.soundDidLoad()}),this.sounds.sus[e])}loadSound(e,t){this.soundCount++,z.getPositionalAudio(t,(t=>{var i;null===(i=this.sounds[e])||void 0===i||i.stop(),this.sounds[e]=t,e==vl&&(t.setLoop(!0),t.setLoopStart(.1),t.setLoopEnd(t.buffer.duration-.1),t.setVolume(0),t.setRefDistance(2*T.wheels.length),t.setRolloffFactor(yl),t.play(),t.position.set(0,.5,T.wheels.length/2)),e!=wl&&e!=fl||(t.setLoop(!0),t.setLoopStart(.1),t.setLoopEnd(t.buffer.duration-.1),t.setRefDistance(2*T.wheels.length),t.setRolloffFactor(yl),t.position.set(0,.5,T.wheels.length),t.setVolume(0),t.play()),e!=bl&&e!=Al||(t.setLoop(!0),t.setLoopStart(.1),t.setLoopEnd(t.buffer.duration-.1),t.setRefDistance(2*T.wheels.length),t.setRolloffFactor(yl),t.position.set(0,.5,T.wheels.length/2),t.setVolume(0),t.play()),T.add(this.sounds[e]),this.soundDidLoad()}),this.sounds[e])}updateLive(e,t,i){this.updateEngine(e,this.inputs),this.updateBoost(),this.updateBrakes(),this.updateTyres(e,this.wheels),this.updateCollisions()}updateEngine(e,t){let i=this.sounds.engine,s=this.sounds.engine2,n=T.speed/(1.25*T.metrics.topSpeed);n=n<.5?n*n*2:2*(1-n),n*=Math.abs(this.vc.inputs.accel)/T.metrics.accel,0!=t.accel?(this.vol<.2?this.vol=.2:this.vol<1&&(this.decel&&(this.vol+=.2,this.decel=!1),this.vol+=2*e,this.vol=Math.min(1,this.vol,T.speed/20)),this.speedTarget=Math.min(T.speed,T.metrics.topSpeed+10)/15+2,this.lerpTarget=.95*this.lerpTarget+.05*this.speedTarget,i.setPlaybackRate(4*this.lerpTarget),s.setPlaybackRate(.06+this.lerpTarget/16),this.t1=.6*(1-this.smoothstep(this.vol)),i.setVolume(this.t1),s.setVolume(this.t1*n)):this.vol>0&&(0==this.decel&&(this.lerpTarget-=.05),this.decel=!0,this.vol-=e,this.vol=Math.max(0,this.vol),this.t1=.6*this.vol,i.setVolume(this.t1),s.setVolume(this.t1*n))}updateBoost(){if(this.sounds.boost){if(this.vc.hasAccel&&this.vc.hasBoost){let e=T.speed/T.metrics.topSpeed,t=1-Math.min(1,e);t=.75+(1-t)/2,this.sounds.boost.setPlaybackRate(t),t=2*(1-(t-.25)),this.boostT=.9*this.boostT+.1*t}else this.boostT*=.9;this.sounds.boost.setVolume(1.5*this.boostT)}}updateBrakes(){T.braking?(this.brakeT=.9*this.brakeT+.1*Math.min(1,Math.max(0,(T.speed-5)/20)),this.sounds.brake.setPlaybackRate(1),this.sounds.brake.setVolume(.4*this.brakeT*T.brakeLerp)):this.sounds.brake.setVolume(0)}updateTyres(e,t){let i=1*Math.max(0,Math.min(1,(T.speed-2)/T.metrics.topSpeed));for(let s of t){if(T.bike&&s.i>1)break;this.maxAud=Math.max(0,Math.min(1,((Math.abs(s.latDirDot)-.05)*s.speed-2)/4)),T.handbrake&&s.i>1&&(this.maxAud=Math.max(this.maxAud,Math.min(1,(Math.abs(s.lonDirDot*s.speed)-2)/4))),T.braking&&s.speed>40&&(this.maxAud=Math.max(this.maxAud,.5*Math.abs(s.lonDirDot))),this.tl=this.tls[s.i],this.maxAud>0?this.tl=.95*this.tl+.05*this.maxAud:this.tl=.8*this.tl,s.shockPos<.25&&(this.tl*=4*s.shockPos),s.onRoad&&this.paved?(this.sounds.tyres[s.i].setVolume(this.tl),this.sounds.offroads[s.i].setVolume(0),this.sounds.rolls[s.i].setVolume(i),this.sounds.rolls[s.i].setPlaybackRate(.6+T.speed/T.metrics.topSpeed*.4)):(this.sounds.tyres[s.i].setVolume(0),s.shockPos<.25?this.sounds.offroads[s.i].setVolume(Math.max(i*s.shockPos*4,this.tl)):this.sounds.offroads[s.i].setVolume(Math.max(i,this.tl)),this.sounds.offroads[s.i].setPlaybackRate(.5+T.speed/T.metrics.topSpeed),this.sounds.rolls[s.i].setVolume(0)),this.tls[s.i]=this.tl,this.tl=Math.max(Math.min(1,Math.abs(40*s.dShockPos)),0),this.tl*=s.shockPos<.5?0:2*s.shockPos-1,this.sounds.sus[s.i].setVolume(.6*this.tl)}}updateRoll(){this.sounds.roll.setVolume(Math.max(0,Math.min(1,(T.speed-2)/T.metrics.topSpeed)))}updateCollisions(){this.vc.didCollide&&!this.vc.collisionsDisabled?this.coll?this.worldSounds.scrape.setVolume(Math.min(1,2*this.vc.collisionStrength)):(this.coll=!0,this.worldSounds.hits[this.hitIndex].setVolume(Math.min(1,.6*this.vc.collisionStrength)),this.worldSounds.hits[this.hitIndex].detune=-1200*Math.random()+600,this.worldSounds.hits[this.hitIndex].play(),this.hitIndex=(this.hitIndex+1)%2):(this.coll=!1,this.worldSounds.scrape.setVolume(0))}smoothstep(e){return-1*(3-2*e)*e*e+1}};const Cl=2*Math.PI,jl=2.5*Math.PI,kl={easy:.6,normal:.75,hard:.6},zl={easy:.55,normal:.55,hard:.4},Sl={};var Ol=class{constructor(e){this.inputs={accel:0,steer:0,brake:0},this.targetNode=null,this.targetFineIndex=0,this.targetPos=new h.W,this.targetSpeed=0,this.targetRoadHeading=0,this.dH=0,this.angleDif=0,this.angleDifAbs=0,this.lookahead=20,this.bendiness=0,this.bendyAngles=[],this.bendyLookahead=4,this.bendyFactor=1,this.bendinessVal=0,this.lateralOffsetFactor=2,this.debugShape=null,this.doNotResetIfOffroad=!1,this.updateIndex=0,this.vehicleIndex=0,this.vehicleAccel=0,this.pVehicleSpeed=0,this.vehicleFrontAxel=new h.W,this.pRoadEdgeProximity=0,this.dRoadEdgeProximity=0,this.pSteer=0,this.lerpIndex=0,this.resetVehicle=e||(()=>{}),this.debugShape=new h.B(new h.S(.5,32,16),new h.C({color:16711935})),this.bendinessShape=new h.B(new h.S(.5,32,16),new h.C({color:65535})),this.targetShape=new h.B(new h.S(.3,32,16),new h.C({color:16776960})),wh.addListener("topography",(()=>this.onTopographyChanged())),wh.addListener("sceneName",(()=>this.onTopographyChanged())),this.onTopographyChanged()}onTopographyChanged(){"Planet"==wh.value.sceneName?this.bendyFactor=zl[wh.value.topography]:this.bendyFactor=kl[wh.value.topography]}initialise(){this.doNotResetIfOffroad=!T.onRoad,this.vehicleIndex=st.vehicleIndex,this.targetNode=st.vehicleNode,this.bendyAngles.length=0,this.bendyRoot=st.vehicleNode,this.bendyTail=st.vehicleNode,this.bendiness=this.targetNode.da,this.bendyAngles.push(this.targetNode.da);for(let e=1;e<this.bendyLookahead;e++)this.bendyTail=this.bendyTail.next,this.bendiness+=this.bendyTail.da,this.bendyAngles.push(Math.abs(this.bendyTail.da))}reset(){this.pDeltaSteer=0,this.pSteer=0,this.steerSpeed=0}update(e){if(this.vehicleAccel=(T.speed-this.pVehicleSpeed)/e,this.pVehicleSpeed=T.speed,Sl.m=it(T.frontAxlePosition.x,T.frontAxlePosition.z,st.vehicleNode,!0),this.roadEdgeProximity=Sl.m.d/(Te-T.wheels.width/2)*Sl.m.s,this.roadEdgeProximity<0?this.roadEdgeProximity=Math.max(-1,Math.min(0,2*(this.roadEdgeProximity+.5))):this.roadEdgeProximity=Math.min(1,Math.max(0,2*(this.roadEdgeProximity-.5))),this.roadEdgeProximityAbs=Math.abs(this.roadEdgeProximity),this.dRoadEdgeProximity=this.roadEdgeProximityAbs-this.pRoadEdgeProximity,this.pRoadEdgeProximity=this.roadEdgeProximityAbs,T.onRoad)null!=this.offRoadTime&&(this.offRoadTime=null),this.doNotResetIfOffroad=!1;else if(!this.doNotResetIfOffroad)if(null==this.offRoadTime)this.offRoadTime=Date.now(),this.offRoadMidlineDist=Sl.m.d;else if(Date.now()-this.offRoadTime>5e3){if(Sl.m.d>this.offRoadMidlineDist-5)return void this.resetVehicle();this.offRoadTime=Date.now()}if(T.speed<1){if(null==this.stuckTime)this.stuckTime=Date.now();else if(Date.now()-this.stuckTime>3e3)return console.log("Autodrive stuck; forcing a reset"),this.stuckTime=null,void this.resetVehicle()}else null!==this.stuckTime&&(this.stuckTime=null);this.updateTarget(),Sl.dist=this.targetPos.distanceTo(T.position),Sl.steerRadius=Sl.dist/2/Math.sin(this.angleDifAbs),this.inputs.steer=Math.atan(T.wheels.length/Sl.steerRadius),this.angleDif>0&&(this.inputs.steer*=-1),Sl.angleOfArrival=-2*this.angleDif+T.heading,Sl.vnHeading=T.heading-(jl-st.vehicleNode.a)%Cl,Sl.vnHeading>3?Sl.vnHeading-=Cl:Sl.vnHeading<-3&&(Sl.vnHeading+=Cl),Sl.vnHeading=Math.abs(Sl.vnHeading),Sl.targetArrivalDif=this.targetRoadHeading-Sl.angleOfArrival,Sl.targetArrivalDif>3?Sl.targetArrivalDif-=Cl:Sl.targetArrivalDif<-3&&(Sl.targetArrivalDif+=Cl),Sl.targetArrivalDif=Math.abs(Sl.targetArrivalDif),Sl.beelineAssessment=1.5*Sl.targetArrivalDif,Sl.beelineAssessment+=4*Math.abs(T.slip),Sl.beelineAssessment+=Sl.vnHeading,this.beelineFactor=1-Math.max(0,Math.min(1,Math.cos(Sl.beelineAssessment))),this.dRoadEdgeProximity>0&&Math.sign(this.roadEdgeProximity)!=Math.sign(this.inputs.steer)&&(this.beelineFactor+=this.roadEdgeProximityAbs/4,this.beelineFactor=Math.max(0,Math.min(1,this.beelineFactor))),this.beelineSteer=-this.angleDif,this.inputs.steer=this.inputs.steer*(1-this.beelineFactor)+this.beelineSteer*this.beelineFactor,this.roadEdgeProximityAbs>0&&(this.inputs.steer<0&&this.roadEdgeProximity<0&&st.vehicleNode.rWallDist||this.inputs.steer>0&&this.roadEdgeProximity>0&&st.vehicleNode.lWallDist)&&(this.inputs.steer/=1+this.roadEdgeProximityAbs*this.roadEdgeProximityAbs*this.roadEdgeProximityAbs),this.inputs.steer=Math.max(Math.min(T.metrics.maxSteer,this.inputs.steer),-T.metrics.maxSteer),this.targetSpeed=this.lookahead,T.speed>this.targetSpeed?(this.targetDecel=(this.targetSpeed*this.targetSpeed-T.speed*T.speed)/(2*Sl.dist),this.inputs.accel=0,this.inputs.brake>0?this.brakeThreshold=Math.max(1,1.5-this.bendinessMax*T.metrics.brake/4):this.brakeThreshold=Math.max(1.05,1.5-this.bendinessMax*T.metrics.brake/4),this.brakeFactor=1+3*this.bendinessMax,this.brakeFactor*=1-(5*T.slip+3*Math.abs(this.inputs.steer)),T.speed/this.targetSpeed>this.brakeThreshold?(this.inputs.brake=T.speed/this.targetSpeed-1,this.inputs.brake*=this.brakeFactor,this.inputs.brake=Math.min(1,this.inputs.brake)):this.inputs.brake=0):0==this.inputs.accel&&T.speed>.95*this.targetSpeed?(this.inputs.accel=0,this.inputs.brake=0):(this.inputs.accel=T.metrics.accel,this.inputs.brake=0),this.updateIndex++,this.updateIndex>=7&&(this.updateIndex=0),T.bike?this.steerLerp=7*e:this.steerLerp=.5,this.inputs.steer=this.pSteer*(1-this.steerLerp)+this.inputs.steer*this.steerLerp,this.pSteer=this.inputs.steer}updateTarget(){this.lookahead=15+this.bendinessVal*(.8*T.metrics.topSpeed-15),this.maxTargetDist=10+Math.max(0,Math.min(this.lookahead,T.speed)-10);let e=Math.floor(this.maxTargetDist/10);(this.targetNode.i<st.vehicleIndex+e||this.lerpIndex>=10||this.targetNode.i<=st.vehicleIndex)&&(this.bendiness-=this.targetNode.da,this.bendyAngles.shift(),this.targetNode=this.targetNode.next,this.bendyTail=this.bendyTail.next,this.bendiness+=this.bendyTail.da,this.bendyAngles.push(Math.abs(this.bendyTail.da)),this.bendinessShape.position.copy(this.bendyTail.p),this.lerpIndex=0,this.dH=this.targetNode.p.y-st.vehicleNode.p.y,this.bendinessVal=Math.abs(this.bendiness/this.bendyLookahead),this.bendinessMax=Math.max(...this.bendyAngles),this.bendinessLerp=Math.min(1,(this.bendinessMax-this.bendinessVal)/.75),this.bendinessVal=this.bendinessVal*(1-this.bendinessLerp)+this.bendinessMax*this.bendinessLerp,this.bendinessVal-=.025,this.bendinessVal=Math.min(1,Math.max(0,this.bendyFactor-this.bendinessVal)/this.bendyFactor),this.bendinessVal*=this.bendinessVal,this.bendinessVal*=this.bendinessVal);let t=this.targetNode.p.distanceTo(T.position);if(this.lerpIndex=Math.max(this.lerpIndex,Math.max(Math.floor(this.maxTargetDist-t)),0),this.lerpIndex<10){this.targetPos.copy(this.targetNode.ps[this.lerpIndex]);let e=this.targetNode.a-this.targetNode.next.a;e=e>3?this.targetNode.next.a+Cl:e<-3?this.targetNode.next.a-Cl:this.targetNode.next.a;let t=1-this.lerpIndex/10;this.targetRoadHeading=this.targetNode.a*t+e*(1-t)}else this.targetPos.copy(this.targetNode.next.p),this.targetRoadHeading=this.targetNode.next.a;this.targetRoadHeading=(jl-this.targetRoadHeading)%Cl;let i=Eo(this.targetPos.x-T.position.x,this.targetPos.z-T.position.z);this.angleDif=T.heading-i,this.angleDif>Math.PI?this.angleDif-=Cl:this.angleDif<-Math.PI&&(this.angleDif+=Cl),this.angleDifAbs=Math.abs(this.angleDif),this.targetShape.position.copy(this.targetNode.p),this.debugShape.position.copy(this.targetPos)}};const Ll=[2.23694,3.59999],Rl=[1/1604,.001];const Tl=new h.W(0,1,0),Pl=2*Math.PI,Gl=.5,Bl={default:new h.E({color:11184810}),grey:new h.D({color:5592405}),wheel:new h.D({color:4473924}),white:new h.D({color:15658734}),black:new h.D({color:3355443}),tire:new h.D({color:2236962}),body:new h.F({color:16316664,roughness:.5}),map:new h.F({color:16777215,roughness:.5,map:X(null)}),metal:new h.D({color:16777215}),redlight:new h.F({color:6702148,emissive:16711680,roughness:.5}),rearlight:new h.F({color:6702148,emissive:16711680,roughness:.5,emissiveIntensity:0}),reverselight:new h.F({color:6710852,emissive:16777096}),headlight:new h.F({color:6710886,emissive:16777181}),window:new h.E({color:6712183,specular:2236962}),shadow:new h.C({color:0,colorWrite:!1,depthWrite:!1,side:h.k}),null:new h.D({color:16711935})},Wl={turnSpeed:0,turnAccel:0,pTurnSpeed:0};var El=class{constructor(){this.inputs={accel:0,steer:0,brake:0,handbrake:0,stiffSteer:0},this.sounds={},this.inputDisabled=!1,this.orientation=new h.m(0,0,0,"YXZ"),this.steerOrientation=new h.m(0,0,0,"YXZ"),this.vehicleDef=null,this.selectedVehicleIndex=0,this.driveModeIndex=0,this.driveForceFactor=1,this.insideWall=!0,this.wasInsideWall=!0,this.tiltX=0,this.tiltZ=0,this.body=null,this.wheels=new h.G,this.wheelEulers=[],this.tV=new h.W,this.tVec=new h.W,this.wheelHeights=[],this.groundHeights=[],this.wheelFwd=new h.W(0,0,1),this.wheelVelDir=new h.W,this.wheelVelMag=0,this.targetHeading=0,this.pOrientation=0,this.motionDir=new h.W,this.pPos=new h.W,this.analytics={resetCount:0,rawDS:0},this.promptResetTimer=null,this.update=()=>{},this.dom={},this.hasInit=!1,this.canCancelAutodrive=!1,this.canEnableAutodrive=!0,this.changeVehicleBound=this.changeVehicle.bind(this),this.changeModeBound=this.changeMode.bind(this),this.wasUsingCruise=!1,this.changeInputBound=this.changeInput.bind(this),this.headlights={left:{},right:{}},this.pdT=.1,this.holdHandbrake=!1,this.uiTimer=0,this.speedFactor=1,this.distFactor=1,this.onUnitsChangedBound=this.onUnitsChanged.bind(this),this.groundAngleLat=0,this.groundAngleLon=0,this.wheelDown=new h.W,this.didCollide=!1,this.printDebug=!1,this.v1=new h.W,this.v2=new h.W,this.v3=new h.W,this.v4=new h.W,this.v5=new h.W,this.didCrash=!1,this.curWallIndex=null,this.collisionStrength=0,this.wrongWay=!1,this.nodeCheckFrame=60,this.targetVehicleNodeIndex=0,this.nextUpdateDistance=25,this.nextUpdateIncrement=25,this.maxUpdateIncrement=250,this.nextAnalyticsUpdate={},this.steerSpeed=0,this.steerMode=1,this.lastAccel=0,this.hasBoost=!1,this.hasAccel=!1,this.boostFromTap=!1,this.useMouse=!0,this.maxSteerSpeed=4,this.prevSteer=0,this.scrollSteer=!1,this.scrollAccel=!1,this.mouse={x:0,y:0},this.prevMouse={x:0,y:0},this.mouseDist=0,this.mouseCruiseSpeed=Fh.default,this.autodrive=j.value,this.soggyStiff=!1,this.soggyTurnInterval=.75,this.soggyInterval=1,this.soggyTimer=0,this.soggyLerp=0,this.soggyTurning=!1,this.soggyTurningDir=0,this.soggyStartPoint=0,this.soggySteerFactor=1,this.soggySteerTimeFactor=1,this.soggyMaxSteer=1,this.soggyStiffLerp=0,this.soggySlip=1,this.soggySlipB=1,this.initialise()}initialise(){this.autoDriver=new Ol((()=>{this.resetToNode(st.vehicleNode)})),this.initialisePosition(),this.audio=new Ml(this),Rh.addListener("type",this.changeVehicleBound),Rh.addListener("mode",this.changeModeBound),Rh.addListener("input",this.changeInputBound),this.changeInput(Rh.value.input,!0),f.addListener("Units",this.onUnitsChangedBound),this.onUnitsChanged(f.Units),this.initVehicle(Ch[Rh.value.type]),this.dom.speed=document.getElementById("ui-speed-val"),this.dom.dist=document.getElementById("ui-dist-val"),this.dom.mouseMarker=document.getElementById("ui-mouse-bar-marker"),this.dom.mousePrompt=document.getElementById("ui-mouse-prompt"),T.addListener(L,this.onHeadlightsChanged.bind(this)),this.onHeadlightsChanged(),Wh.dist=10*(st.vehicleNode.i-st.initIndex+wh.accumulatedProgress),wh.addListener("weatherIndex",(()=>this.updateHeadlights())),p.addListener(u.Headlights,(()=>T.setHeadlights(!T.headlights,!0))),p.addListener(u.Lights,(()=>T.setHeadlights(!T.headlights,!0))),p.addListener(u.AutoDrive,(()=>{this.canToggleAutodrive&&(j.set(!this.autodrive),this.canToggleAutodrive=!1)})),j.addListener((()=>{this.onAutodrive()})),this.onAutodrive(),this.headlights=T.headlights,this.hasInit=!0}onAutodrive(){this.autodrive=j.value,T.handbrake=!1,this.holdHandbrake=!1,this.autodrive&&(this.canCancelAutodrive=!1,this.autoDriver.initialise())}initialisePosition(){st.initIndex=st.vehicleNode.i-wh.initialNode;let e=st.vehicleNode.a-st.vehicleNode.next.da/2;this.setPose(st.vehicleNode.p.x,st.vehicleNode.p.y,st.vehicleNode.p.z,Math.PI/2-e,!0),this.autoDriver.initialise()}detatch(){Rh.removeListener("type",this.changeVehicleBound),Rh.removeListener("mode",this.changeVehicleBound),f.removeListener("Units",this.onUnitsChangedBound),T.removeListener(L,this.onHeadlightsChanged.bind(this))}setDriveMode(e){if(this.driveModeFactor=.5,this.wheels.children[0].hasDrive=!0,this.wheels.children[1].hasDrive=!0,this.driveMode=e,T.bike)switch(e){case zh:this.driveModeFactor=1,this.wheels.children[0].hasDrive=!0,this.wheels.children[1].hasDrive=!1;break;case Sh:this.driveModeFactor=1,this.wheels.children[0].hasDrive=!1,this.wheels.children[1].hasDrive=!0}else switch(this.wheels.children[2].hasDrive=!0,this.wheels.children[3].hasDrive=!0,e){case zh:this.driveModeFactor=1,this.wheels.children[2].hasDrive=!1,this.wheels.children[3].hasDrive=!1;break;case Sh:this.driveModeFactor=1,this.wheels.children[0].hasDrive=!1,this.wheels.children[1].hasDrive=!1}}onHeadlightsChanged(){this.setLights(T.headlights)}changeVehicle(e){this.initVehicle(Ch[e]),no.sendUpdate("vehicleChange",e)}changeMode(e){this.setDriveMode(e),no.sendUpdate("driveModeChange",e)}changeInput(e,t=!1){this.useMouse=e==jh,this.useMouse?null==Fh.value?Fh.reset():t||(this.wasUsingCruise=!0):this.wasUsingCruise||t?this.wasUsingCruise=!1:Fh.set(null),t||j.set(!1),no.sendUpdate("inputModeChange",e),this.hasInit&&this.resetToNode(st.vehicleNode)}setLights(e){e?(Bl.rearlight.emissiveIntensity=.5,Bl.headlight.emissiveIntensity=.5):(Bl.rearlight.emissiveIntensity=0,Bl.headlight.emissiveIntensity=0)}updateHeadlights(){let e=3.25-2.5*(ue.intensity+pe.intensity),t=Math.max(.25,e);T.setHeadlightIntensity(t)}positionHeadlights(){}initVehicle(e){var t;if((null===(t=this.vehicleDef)||void 0===t?void 0:t.name)==e.name)return;for(this.update=this.updatePass;T.geo.children.length;)T.geo.remove(T.geo.children[T.geo.children.length-1]);this.vehicleDef=e,this.soggySteerTimeFactor=1,T.setModel(e),e.map&&(Bl.map.map=X(e.map));let i=e.bodyObj,s=e.wheelObj;const n=new is.a;let a=Bl;if(e.skins){let t=Object.keys(e.skins)[0];for(let i in e.skins[t])a[i].color.setHex(e.skins[t][i])}n.load(i.default,(e=>{e.traverse((e=>{if(e.isMesh){let t=Bl.default,i=e.name.split("_")[1];i in Bl&&(t=Bl[i]),e.material=t,"shadow"==i&&(e.castShadow=!0)}})),this.positionHeadlights(),this.updateHeadlights(),e.rotation.y=-Math.PI/2,T.geo.add(e)})),n.load(s.default,(t=>{t.traverse((e=>{if(e.isMesh){let t=Bl.wheel,i=e.name.split("_")[1];i in Bl&&(t=Bl[i]),e.material=t,"shadow"==i&&(e.castShadow=!0),e.position.z-=T.wheels.tyreWidth}})),this.initWheels(t,T.bike),this.setDriveMode(Rh.value.mode),this.audio.initForVehicle(e,this.inputs,this.wheels.children),this.resetToNode(st.vehicleNode),this.update=this.updateStationed,tl.pause()}))}initLights(){T.setHeadlightColour(T.headlightColour)}setPose(e,t,i,s,n=!1){for(var a;s<0;)s+=2*Math.PI;let r=0;if(n&&(null===(a=T.wheels)||void 0===a?void 0:a.length)){let n=new h.W(e+Math.sin(s)*T.wheels.length,t,i+Math.cos(s)*T.wheels.length),a=Ro.getHeight(n);r=-Math.tan((a-t)/T.wheels.length),t+=T.wheels.travel/2}T.position.set(e,t,i),this.orientation.x=r,this.orientation.z=0,this.orientation.y=s,T.heading=this.orientation.y,T.motionHeading=T.heading,T.setRotationFromEuler(this.orientation),T.updateMatrix(),T.updateMatrixWorld(),this.updateVehicleNode(),st.vehicleIndexDidChange=!0}initWheels(e,t=!1){let i,s=this.vehicleDef.wheels;for(;this.wheels.children.length;)this.wheels.remove(this.wheels.children[this.wheels.children.length-1]);this.wheelEulers.length=0,i=e.clone(),this.prepWheelState(i,s),i.i=0,i.name="fl",i.front=!0,i.relPos=new h.W(t?0:s.width/2,s.radius,s.length),i.hasDrive=!0,i.position.copy(i.relPos),i.rotation.y=Math.PI/2,this.wheelEulers.push(new h.m(0,Math.PI/2,0,"YXZ")),this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos),i=e.clone(),this.prepWheelState(i,s),i.i=1,i.front=!t,i.name="fr",i.relPos=new h.W(t?0:-s.width/2,s.radius,t?0:s.length),i.hasDrive=!0,i.position.copy(i.relPos),i.rotation.y=-Math.PI/2,this.wheelEulers.push(new h.m(0,-Math.PI/2,0,"YXZ")),this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos),t||(i=e.clone(),this.prepWheelState(i,s),i.i=2,i.front=!1,i.name="rl",i.relPos=new h.W(s.width/2,s.radius,0),i.hasDrive=!1,i.position.copy(i.relPos),i.rotation.y=Math.PI/2,this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos),i=e.clone(),this.prepWheelState(i,s),i.i=3,i.front=!1,i.name="rr",i.relPos=new h.W(-s.width/2,s.radius,0),i.hasDrive=!1,i.position.copy(i.relPos),i.rotation.y=-Math.PI/2,this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos)),T.geo.add(this.wheels)}prepWheelState(e,t){e.shockPos=.5,e.dShockPos=0,e.shockFactor=.5,e.shockExcess=0,e.groundHeight=0,e.pHeight=0,e.worldPos=new h.W,e.tPos=new h.W,e.tVel=new h.W,e.pVel=new h.W,e.pPos=new h.W,e.height=0,e.pSus=0,e.vel=new h.W,e.velDir=new h.W,e.acc=new h.W,e.groundCollide=0,e.groundNorm=new h.W,e.groundState={n:[0,1,0]},e.speed=0,e.lonDirDot=0,e.latDirDot=0,e.friction=1,e.wd=0,e.collisionFactor=0,e.radius=t.radius,e.travel=t.travel}updateWheelWorldPos(e){e.worldPos.copy(e.relPos),e.worldPos.applyMatrix4(T.matrixWorld)}destroy(){}suspend(){this.audio.suspend(),this.update=this.updateStationed,tl.pause()}reload(){this.initialisePosition(),this.resetToNode(st.vehicleNode)}updateStationed(e){if(st.vehicleIndexDidChange=!1,T.pPosition.copy(T.position),this.handleInput(e),T.handbrake=!0,this.useMouse&&this.hasAccel||!this.useMouse&&(0!=T.drive||null!==Fh.value)||this.autodrive)return T.handbrake=!1,this.holdHandbrake=null==Fh.value,this.update=this.updateLive,tl.resume(),void(this.dom.mousePrompt.style.display="none");this.inputs.accel=0,this.updateWheelMotion(e),this.updateChassisMotion(e),this.updateWheelState(e),this.audio.update(e),this.pdT=e}updatePass(e,t){}updateLive(e,t){T.pPosition.copy(T.position),this.handleInput(e),this.updateWheelMotion(e),this.updateChassisMotion(e),this.updateWheelState(e),this.didCollide&&!this.collisionsDisabled&&(this.updateChassisMotion(e),this.updateWheelState(e),this.didCollide=!0),this.updateVehicleState(e),this.uiTimer+=e,this.uiTimer>.033&&(this.uiTimer-=.033,this.updateUI()),this.pdT=e,st.vehicleIndexDidChange=!1,this.updateVehicleNode();try{this.audio.update(e)}catch(Kc){if(this.handleCrash(),this.didCrash)throw Kc.cause="vehicle_matrix",Kc.data=this.wheels.children[0],Kc}}updateVehicleState(e){var t,i,s,n;for(Wl.w of(this.dS=(t=T.pPosition.x,i=T.pPosition.z,s=T.position.x,n=T.position.z,Math.sqrt((s-t)*(s-t)+(n-i)*(n-i))),this.analytics.rawDS+=this.dS,T.vel.subVectors(T.pPosition,T.position).multiplyScalar(1/e),T.speed=this.dS/e,T.speedLerp=Math.min(1,T.speed/T.metrics.topSpeed),Wh.speed=T.speed,T.accel.set(0,0,0),this.wheels.children))T.accel.add(Wl.w.acc.multiplyScalar(1/e));if(T.accel.multiplyScalar(.25),T.accel.applyAxisAngle(Tl,-this.orientation.y),T.pVel.copy(T.vel),!isFinite(T.speed)){let e={wheelHeights:this.wheelHeights,tiltX:this.tiltX,tiltZ:this.tiltZ,dS:this.dS,speed:T.speed,pos:T.position,pPos:T.pPosition,nodeIndex:st.vehicleIndex,onRoad:T.onRoad};throw new Error(JSON.stringify(e))}}onUnitsChanged(e){this.speedFactor=Ll[e],this.distFactor=Rl[e]}updateUI(){this.dom.speed.innerHTML=(Wh.speed*this.speedFactor).toFixed(1),this.dom.dist.innerHTML=(Math.floor(Wh.dist*this.distFactor*10)/10).toFixed(1)}updateBasic(e){T.speed+=this.inputs.accel*e,T.steer+=this.inputs.steer*e,T.steer=Math.max(Math.min(T.metrics.maxSteer,T.steer),-T.metrics.maxSteer),T.position.x+=Math.cos(T.rotation.y)*T.speed*e,T.position.z-=Math.sin(T.rotation.y)*T.speed*e,T.rotation.y+=T.steer*e}updateWheelMotion(e){let t;for(t of(this.printDebug=!this.printDebug,this.wheelDown.set(0,-T.wheels.radius,0).applyEuler(this.orientation),T.rockLonTarget=T.accel.z+this.sinTiltX*Zo.value,T.rockLonTarget>0?T.rockLonTarget/=Math.max(T.rockLonTarget,14):T.rockLonTarget/=-1*Math.min(T.rockLonTarget,-14),T.rockLonTarget*=T.metrics.rockFactor,Wl.l=Math.min(1,15*e),T.rockLon=T.rockLon*(1-Wl.l)+T.rockLonTarget*Wl.l,this.vehicleDef.bike||(T.rockLatTarget=T.accel.x-this.sinTiltZ*Zo.value,T.rockLatTarget>0?T.rockLatTarget/=Math.max(T.rockLatTarget,20):T.rockLatTarget/=-1*Math.min(T.rockLatTarget,-20),T.rockLatTarget*=T.metrics.rockFactor,T.rockLat=T.rockLat*(1-Wl.l)+T.rockLatTarget*Wl.l),this.wheels.children))t.front&&(this.steerOrientation.copy(this.orientation),T.bike?this.steerOrientation.y+=T.steer:0==t.i?this.steerOrientation.y+=T.steerL:this.steerOrientation.y+=T.steerR),t.vel.subVectors(t.worldPos,t.pPos),t.tVel.subVectors(t.tPos,t.pPos),Wl.steepness=0,t.shockPos>0&&t.dH>0&&(Wl.steepness=t.dH/t.vel.length()),t.dXZ=Math.sqrt(t.vel.x*t.vel.x+t.vel.z*t.vel.z),t.dH=t.groundHeight-t.pHeight,t.collisionFactor=0,t.pdH=(t.vel.y-t.tVel.y)/t.dXZ,!t.onRoad&&t.dH>0&&t.pdH>0&&t.pdH<1&&(Wl.m=1-2*t.pdH,Wl.m<1&&(t.vel.x*=Wl.m,t.vel.z*=Wl.m)),t.velDir.copy(t.vel).normalize(),0==t.shockPos?t.dS=.98*t.dS:t.dS=t.vel.length(),t.vel.divideScalar(this.pdT),t.speed=t.vel.length(),t.pPos.copy(t.worldPos),t.front?(this.tV.set(0,0,1).applyEuler(this.steerOrientation),t.lonDirDot=t.velDir.dot(this.tV),t.direction=t.lonDirDot<0?-1:1,this.tV.set(1,0,0).applyEuler(this.steerOrientation),t.latDirDot=t.velDir.dot(this.tV)):(this.tV.set(0,0,1).applyEuler(this.orientation),t.lonDirDot=t.velDir.dot(this.tV),t.direction=t.lonDirDot<0?-1:1,this.tV.set(1,0,0).applyEuler(this.orientation),t.latDirDot=t.velDir.dot(this.tV)),t.dXZ>.001?t.groundAngle=-Math.atan(t.dH/t.dXZ)||0:t.groundAngle=this.tiltX*t.lonDirDot+this.tiltZ*t.latDirDot,t.acc.set(0,0,0),T.braking?(T.brakeLerp+=e/.25,T.brakeLerp>1&&(T.brakeLerp=1),T.brakeForce=T.brakeLerp*T.metrics.brake,this.autodrive&&(T.brakeForce=this.autoDriver.inputs.brake*T.metrics.brake),Wl.maxDecel=t.speed*t.lonDirDot/e*-1,Wl.maxDecel<0?t.acc.z=Math.max(Wl.maxDecel,-T.brakeForce):t.acc.z=Math.min(Wl.maxDecel,T.brakeForce),t.speed<.1&&(T.braking=!1)):t.hasDrive&&(t.acc.z=T.drive*this.driveModeFactor,T.bike?t.front?t.acc.z*=T.frSteerDifferential:t.acc.z/=T.frSteerDifferential:0==t.i?t.acc.z*=T.steerDifferential:1==t.i?t.acc.z/=T.steerDifferential:2==t.i?t.acc.z*=T.rearSteerDifferential:t.acc.z/=T.rearSteerDifferential),t.friction<1&&(t.acc.z*=t.friction),T.bike&&(t.friction*=2),!t.front&&T.handbrake&&(t.acc.z=0),Wl.wheelWeight=2*t.shockFactor,Wl.frictionMultiplier=this.hasBoost&&!this.autodrive?Math.max(.75,Math.abs(t.lonDirDot)):1,Wl.latNorm=Wl.wheelWeight*Math.cos(t.groundAngle*Math.abs(t.latDirDot))*-Zo.value*t.friction*Wl.frictionMultiplier,this.useMouse||this.autodrive?T.bike||this.autodrive?Wl.maxLat=t.speed*t.latDirDot/e*-1-Zo.value*this.sinTiltZ:Wl.maxLat=t.speed*t.latDirDot/e*-.5-Zo.value*this.sinTiltZ:(Wl.maxLat=t.speed/e*-t.latDirDot,t.hasDrive&&this.hasBoost?(Rh.mode==kh&&(Wl.maxLat*=T.metrics.slipBase-1.25*T.metrics.slipMod*(T.speedLerp*T.speedLerp)),(Rh.mode==zh||Rh.mode==Sh)&&(Wl.maxLat*=T.metrics.slipBase-T.metrics.slipMod*(T.speedLerp*T.speedLerp))):t.speed>1&&(Wl.maxLat*=T.metrics.slipBase-T.metrics.slipMod*(T.speedLerp*T.speedLerp)),Wl.maxLat-=Zo.value*this.sinTiltZ),t.slip=0,Wl.maxLat<0?Wl.maxLat<-Wl.latNorm?(t.spin=t.acc.z>0&&t.latDirDot>.3,t.slip=t.latDirDot,t.acc.x+=-Wl.latNorm):(t.spin=!1,t.acc.x+=Wl.maxLat):Wl.maxLat>Wl.latNorm?(t.spin=t.acc.z>0&&t.latDirDot<-.3,t.slip=-t.latDirDot,t.acc.x+=Wl.latNorm):(t.spin=!1,t.acc.x+=Wl.maxLat),!t.front&&T.handbrake&&(Wl.lonNorm=Wl.wheelWeight*Math.cos(t.groundAngle*t.lonDirDot)*-Zo.value*t.friction*Wl.frictionMultiplier,Wl.maxLon=t.speed*t.lonDirDot/e*-1+Zo.value*this.sinTiltX*2,t.acc.z+=Math.max(Math.min(Wl.maxLon,Wl.lonNorm),-Wl.lonNorm)),(t.onRoad||1==t.groundNorm.y)&&(t.acc.x+=Wl.wheelWeight*Zo.value*this.sinTiltZ,t.acc.z-=Wl.wheelWeight*Zo.value*this.sinTiltX),Wl.rawSpeed=t.speed*t.lonDirDot,!(t.i>1&&T.handbrake)&&Math.abs(Wl.rawSpeed)>0&&(Wl.rollResistance=Wl.rawSpeed*T.metrics.rollResistance,Wl.rawSpeed<0?Wl.rollResistance+=Math.max(-.1,Wl.rawSpeed/e):Wl.rollResistance+=Math.min(.1,Wl.rawSpeed/e),t.acc.z-=Wl.rollResistance),t.acc.y+=T.downforce*Zo.value,t.acc.z*=Math.min(1,3*t.shockFactor),t.front?t.acc.applyEuler(this.steerOrientation):t.acc.applyEuler(this.orientation),t.acc.y+=Zo.value,t.onRoad||1==t.groundNorm.y||(t.acc.x-=Wl.wheelWeight*Zo.value*t.groundNorm.x*1.5,t.acc.z-=Wl.wheelWeight*Zo.value*t.groundNorm.z*1.5),t.shockPos>0&&(t.front?t.acc.y+=T.rockLon:t.acc.y-=T.rockLon,T.bike||(t.i%2==0?t.acc.y+=T.rockLat:t.acc.y-=T.rockLat)),t.acc.y-=Wl.wheelWeight*Zo.value,t.dSus=(t.pSus-t.acc.y)/e,t.pSus=t.acc.y,t.dSus<0?t.dSus*=T.metrics.dampening:T.bike?t.dSus*=.5*T.metrics.dampening:t.dSus*=1.5*T.metrics.dampening,t.acc.y-=t.dSus,t.vel.add(t.acc.multiplyScalar(e)),t.tPos.addVectors(t.worldPos,t.vel.multiplyScalar(e)),t.pVel.copy(t.vel),this.wheelHeights[t.i]=t.tPos.y,this.groundHeights[t.i]=t.groundHeight,t.shockPos>0&&(t.hasDrive&&t.spin?t.dS*=1+T.slip:t.dS*=Math.abs(t.lonDirDot))}updateChassisMotion(e){Wl.wheelWidth=this.vehicleDef.wheels.width,Wl.wheelLength=this.vehicleDef.wheels.length,Wl.axleFPos=this.v1,Wl.axleFDir=this.v2,Wl.axleRPos=this.v3,Wl.axleRDir=this.v4,Wl.chassisDir=this.v5,T.bike?(Wl.axleFPos.copy(this.wheels.children[0].tPos),Wl.axleRPos.copy(this.wheels.children[1].tPos),Wl.shockF=this.wheels.children[0].collisionFactor+this.wheels.children[0].shockPos,Wl.shockR=this.wheels.children[1].collisionFactor+this.wheels.children[1].shockPos,Wl.shockSum=Wl.shockF+Wl.shockR,Wl.shockRatio=0==Wl.shockSum?.5:Wl.shockR/Wl.shockSum):(Wl.wL=this.wheels.children[0],Wl.wR=this.wheels.children[1],Wl.d=Wl.wL.tPos.distanceTo(Wl.wR.tPos),Wl.shockSum=Wl.wL.collisionFactor+Wl.wR.collisionFactor,Wl.shockRatio=0==Wl.shockSum?.5:Wl.wL.collisionFactor/Wl.shockSum,Wl.discrepency=Wl.d-Wl.wheelWidth,Wl.leftOffset=Wl.discrepency*(1-Wl.shockRatio),Wl.axleFDir.subVectors(Wl.wR.tPos,Wl.wL.tPos).normalize(),Wl.axleFPos.copy(Wl.axleFDir),Wl.axleFPos.multiplyScalar(Wl.wheelWidth/2+Wl.leftOffset),Wl.axleFPos.add(Wl.wL.tPos),Wl.wL=this.wheels.children[2],Wl.wR=this.wheels.children[3],Wl.d=Wl.wL.tPos.distanceTo(Wl.wR.tPos),Wl.shockSum=Wl.wL.collisionFactor+Wl.wR.collisionFactor,Wl.shockRatio=0==Wl.shockSum?.5:Wl.wL.collisionFactor/Wl.shockSum,Wl.discrepency=Wl.d-Wl.wheelWidth,Wl.leftOffset=Wl.discrepency*(1-Wl.shockRatio),Wl.axleRDir.subVectors(Wl.wR.tPos,Wl.wL.tPos).normalize(),Wl.axleRPos.copy(Wl.axleRDir),Wl.axleRPos.multiplyScalar(Wl.wheelWidth/2+Wl.leftOffset),Wl.axleRPos.add(Wl.wL.tPos),Wl.shockF=this.wheels.children[0].collisionFactor+this.wheels.children[1].collisionFactor,Wl.shockR=this.wheels.children[2].collisionFactor+this.wheels.children[3].collisionFactor,Wl.shockSum=Wl.shockF+Wl.shockR,Wl.shockRatio=0==Wl.shockSum?.5:Wl.shockR/Wl.shockSum),Wl.d=Wl.axleFPos.distanceTo(Wl.axleRPos),Wl.discrepency=Wl.d-Wl.wheelLength,Wl.leftOffset=Wl.discrepency*(1-Wl.shockRatio),Wl.chassisDir.subVectors(Wl.axleFPos,Wl.axleRPos).normalize(),T.position.copy(Wl.chassisDir),T.position.multiplyScalar(Wl.leftOffset),T.position.add(Wl.axleRPos),T.frontAxlePosition.copy(Wl.axleFPos),this.pOrientation=T.heading,this.orientation.y=Eo(Wl.chassisDir.x,Wl.chassisDir.z),Wl.deltaHeading=this.orientation.y-T.heading,Wl.deltaHeading>3?T.heading+=Pl:Wl.deltaHeading<-3&&(T.heading-=Pl),Wl.deltaHeading=this.orientation.y-T.heading,T.speedLerp=T.speed/T.metrics.topSpeed,Wl.turnSpeed=(this.orientation.y-T.heading)/e,Wl.turnAccel=(Wl.turnSpeed-Wl.pTurnSpeed)/e,Wl.maxTurnAccel=5-2*T.speedLerp,this.didCollide||(Wl.turnAccel<-Wl.maxTurnAccel?Wl.turnSpeed=Wl.pTurnSpeed-Wl.maxTurnAccel*e:Wl.turnAccel>Wl.maxTurnAccel&&(Wl.turnSpeed=Wl.pTurnSpeed+Wl.maxTurnAccel*e)),this.orientation.y=T.heading+Wl.turnSpeed*e,Wl.pTurnSpeed=Wl.turnSpeed,this.orientation.y>Pl?this.orientation.y-=Pl:this.orientation.y<-Pl&&(this.orientation.y+=Pl),T.heading=this.orientation.y,T.fwd.set(Math.sin(T.heading),0,Math.cos(T.heading)),T.position.y>0?this.tVec.subVectors(T.pPosition,T.position).normalize().multiplyScalar(T.metrics.drag*T.speed*T.speed*e*e):this.tVec.subVectors(T.pPosition,T.position).normalize().multiplyScalar(.25*T.speed*T.speed*e*e),T.position.add(this.tVec),T.bike?(Wl.d1=this.wheels.children[0].tPos.distanceTo(this.wheels.children[1].tPos),Wl.r1=Math.asin((this.wheelHeights[0]-this.wheelHeights[1])/Wl.d1),this.tiltX=-Wl.r1||0,this.tiltX=Math.max(Math.min(1.2,this.tiltX),-1.2),this.sinTiltX=Math.sin(this.tiltX),T.pitch=this.tiltX,this.orientation.x=this.tiltX,Wl.r1=Math.asin((this.groundHeights[0]-this.groundHeights[1])/Wl.d1),this.gradientX=-Wl.r1||0,Wl.vs=T.steer/(T.metrics.maxSteer*this.soggySteerFactor)*Math.min(1,T.speed/T.metrics.topSpeed),this.tiltZ=1.2*-Wl.vs,T.slip=this.wheels.children[1].slip):(Wl.d1=this.wheels.children[0].tPos.distanceTo(this.wheels.children[2].tPos),Wl.d2=this.wheels.children[1].tPos.distanceTo(this.wheels.children[3].tPos),Wl.r1=Math.asin((this.wheelHeights[0]-this.wheelHeights[2])/Wl.d1),Wl.r2=Math.asin((this.wheelHeights[1]-this.wheelHeights[3])/Wl.d2),Wl.tiltX=-(Wl.r1+Wl.r2)/2||this.tiltX,Wl.tiltLerp=3*(1+T.speedLerp),Math.abs(Wl.tiltX-this.tiltX)/e<Wl.tiltLerp?this.tiltX=Wl.tiltX:Wl.tiltX<this.tiltX?this.tiltX-=Wl.tiltLerp*e:this.tiltX+=Wl.tiltLerp*e,this.tiltX=Math.max(Math.min(1.3,this.tiltX),-1.3),this.sinTiltX=Math.sin(this.tiltX),T.pitch=this.tiltX,this.orientation.x=this.tiltX,Wl.r1=Math.asin((this.groundHeights[0]-this.groundHeights[2])/Wl.d1),Wl.r2=Math.asin((this.groundHeights[1]-this.groundHeights[3])/Wl.d2),this.gradientX=-(Wl.r1+Wl.r2)/2||0,Wl.d2=Wl.wheelWidth*Math.cos(this.tiltX),Wl.d1=this.wheelHeights[1]-this.wheelHeights[0],Wl.r1=Math.asin(Wl.d1/Wl.d2),Wl.d1=this.wheelHeights[3]-this.wheelHeights[2],Wl.r2=Math.asin(Wl.d1/Wl.d2),Wl.shockF=this.wheels.children[0].shockPos+this.wheels.children[1].shockPos,Wl.shockR=this.wheels.children[2].shockPos+this.wheels.children[3].shockPos,Wl.shockSum=Wl.shockF+Wl.shockR,Wl.shockRatio=0==Wl.shockSum?.5:Wl.shockF/Wl.shockSum,Wl.tiltZ=-(Wl.r1*Wl.shockRatio+Wl.r2*(1-Wl.shockRatio))||this.tiltZ,Math.abs(Wl.tiltZ-this.tiltZ)/e<Wl.tiltLerp?this.tiltZ=Wl.tiltZ:Wl.tiltZ<this.tiltZ?this.tiltZ-=Wl.tiltLerp*e:this.tiltZ+=Wl.tiltLerp*e,T.slip=(this.wheels.children[0].slip+this.wheels.children[1].slip+this.wheels.children[2].slip+this.wheels.children[3].slip)/4),T.gradient=this.gradientX,this.tiltZ=Math.max(Math.min(1.3,this.tiltZ),-1.3),this.orientation.z=this.tiltZ,T.roll=this.tiltZ,this.sinTiltZ=Math.sin(this.tiltZ),this.tVec.set(0,-T.wheels.radius,0).applyEuler(this.orientation),T.position.add(this.tVec),this.motionDir.copy(T.position).sub(this.pPos).normalize(),!this.didCollide&&T.direction>0?(Wl.trueHeading=Eo(this.motionDir.x,this.motionDir.z),Wl.trueHeading-T.motionHeading>3?T.motionHeading+=Pl:Wl.trueHeading-T.motionHeading<-3&&(T.motionHeading-=Pl),T.motionHeading=0*T.motionHeading+1*Eo(this.motionDir.x,this.motionDir.z),T.speed<5&&(T.motionHeading=T.motionHeading*(T.speed/5)+T.heading*(1-T.speed/5))):T.motionHeading=T.heading,this.pPos.copy(T.position),T.setRotationFromEuler(this.orientation);try{T.updateMatrix(),T.updateMatrixWorld(),this.didCrash=!1}catch(Kc){if(this.handleCrash(),this.didCrash)throw Kc.cause="vehicle_matrix",Kc;this.didCrash=!0}}handleCrash(){this.resetToNode(st.vehicleNode)}updateWheelState(e){let t;for(t of(Wl.wheelCirc=this.vehicleDef.wheels.circumference,T.downforce=Math.min(1,T.speed/T.metrics.topSpeed),T.downforce*=T.downforce*T.metrics.aeroFactor,T.bike?(Wl.r=0,Wl.r=this.wheels.children[0].dS/Wl.wheelCirc*6.28*this.wheels.children[0].direction,this.wheelEulers[0].z+=Wl.r,this.wheelEulers[0].y=T.steer*(1-Math.sin(Math.abs(this.tiltZ)))+1.57,this.wheels.children[0].setRotationFromEuler(this.wheelEulers[0]),Wl.r=this.wheels.children[1].dS/Wl.wheelCirc*6.28*this.wheels.children[1].direction,this.wheels.children[1].rotation.x=this.wheels.children[1].rotation.x+Wl.r):(Wl.r=0,Wl.r=this.wheels.children[0].dS/Wl.wheelCirc*6.28*this.wheels.children[0].direction,this.wheelEulers[0].z+=Wl.r,this.wheelEulers[0].y=T.steerL+1.57,this.wheels.children[0].setRotationFromEuler(this.wheelEulers[0]),Wl.r=this.wheels.children[1].dS/Wl.wheelCirc*6.28*this.wheels.children[1].direction,this.wheelEulers[1].z-=Wl.r,this.wheelEulers[1].y=T.steerR-1.57,this.wheels.children[1].setRotationFromEuler(this.wheelEulers[1]),T.handbrake||(Wl.r=this.wheels.children[2].dS/Wl.wheelCirc*6.28*this.wheels.children[2].direction,this.wheels.children[2].rotation.x=this.wheels.children[2].rotation.x+Wl.r,Wl.r=this.wheels.children[3].dS/Wl.wheelCirc*6.28*this.wheels.children[3].direction,this.wheels.children[3].rotation.x=this.wheels.children[3].rotation.x+Wl.r)),Wl.d=T.wheels.radius,Wl.airborne=!1,Wl.grounded=!1,this.didCollide||(this.collisionStrength=0,this.collisionsDisabled=!1),this.didCollide=!1,T.onRoad=!1,this.wheelsInside={},this.wheels.children))this.updateWheelWorldPos(t),t.pHeight=t.groundHeight,this.tVec.copy(t.worldPos).add(this.wheelDown),t.groundState.insideWall=t.insideWall,t.groundState.debug=1==t.i,Wl.ground=Ro.testGround(this.tVec,t.groundState),t.groundNorm.set(Wl.ground.n[0],Wl.ground.n[1],Wl.ground.n[2]),t.groundHeight=Wl.ground.h,t.friction=Wl.ground.f,t.onRoad=Wl.ground.r,T.onRoad=T.onRoad||t.onRoad,Wl.airborne=Wl.airborne||t.groundHeight<t.worldPos.y-1,Wl.grounded=Wl.grounded||t.onRoad&&t.worldPos.y<t.groundHeight+.1,Wl.ground.w?(t.wd=Wl.ground.wd,t.wn=Wl.ground.wn,t.ws=Wl.ground.ws,null==t.wi||t.wi!=Wl.ground.wi?(t.wi=Wl.ground.wi,t.insideWall=t.wd<0,t.mayCollide=!0,null==this.wheelsInside[Wl.ground.wi]&&(this.wheelsInside[Wl.ground.wi]=t.insideWall),this.wheelsInside[t.wi]!==t.insideWall&&(this.collideWallEnd(t),this.didCollide=!0)):(null==this.wheelsInside[Wl.ground.wi]&&(this.wheelsInside[Wl.ground.wi]=this.collisionsDisabled?t.wd<0:t.insideWall),this.wheelsInside[t.wi]!==t.insideWall&&(this.collideWallEnd(t),this.didCollide=!0),this.collisionsDisabled?this.wheelsInside[t.wi]!==t.wd<0?this.didCollide=!0:t.insideWall=t.wd<0:t.insideWall!==t.wd<0?(this.collideWallEdge(t),this.didCollide=!0):t.insideWall=t.wd<0)):(t.wi=null,t.insideWall=null),Wl.shockDist=-(t.worldPos.y-t.groundHeight-Wl.d)+t.travel,t.shockFactor=Math.max(Wl.shockDist/(2*t.travel),0),t.prevShockPos=t.shockPos,t.shockPos=t.shockFactor,t.shockExcess=0,t.shockPos>1&&(t.shockExcess=t.shockPos-1,t.shockExcess=Math.min(1,t.shockExcess),t.worldPos.y+=t.shockExcess*t.travel*2,t.shockPos=1),t.dShockPos=t.shockPos-t.prevShockPos,t.position.y=t.radius+t.shockPos*t.travel*2-t.travel;!nl.Reset||T.onRoad||this.promptResetTimer?this.promptResetTimer&&T.onRoad&&(hl.value==il.Reset&&hl.set(il.None),clearTimeout(this.promptResetTimer),this.promptResetTimer=null):this.promptResetTimer=setTimeout((()=>{hl.set(il.Reset),setTimeout((()=>{hl.value==il.Reset&&hl.set(il.None)}),15e3)}),5e3),!this.autodrive&&nl.Boost&&hl.value==il.None&&T.onRoad&&T.speed>5&&this.tiltX<-.11&&(hl.set(il.Boost),setTimeout((()=>{al("Boost")}),[3e3])),Wl.airborne&&!Wl.grounded&&(this.collisionsDisabled=!0),T.bike?T.direction=this.wheels.children[1].direction:T.direction=Math.min(this.wheels.children[2].direction,this.wheels.children[3].direction),t.speed<.5&&(T.direction=0)}collideTerrain(e,t){T.bike,e.collisionFactor=1,this.wheelHeights[e.i]=e.tPos.y,this.collisionStrength=0}collideWallEnd(e){this.collisionsDisabled||(this.tVec.copy(e.tPos),e.tPos.copy(e.pPos),e.pPos.copy(this.tVec),T.bike||(this.tVec.copy(e.vel),this.tVec.y=0,e.tPos.add(this.tVec.multiplyScalar(-.8))),e.collisionFactor=1,this.wheelHeights[e.i]=e.tPos.y,this.collisionStrength=T.speed/10)}collideWallEdge(e,t=1){this.collisionsDisabled||(this.tVec.set(e.wn.x,.01,e.wn.z),e.tPos.add(this.tVec.multiplyScalar(e.wd*e.ws)),this.collTemp=(e.velDir.x*-e.wn.z+e.velDir.z*e.wn.x)*Math.abs(e.wd)*.75,this.tVec.set(-e.wn.z,0,e.wn.x).multiplyScalar(this.collTemp),e.tPos.sub(this.tVec),e.collisionFactor=1,this.collisionStrength=Math.max(this.collisionStrength,Math.abs(this.collTemp/this.pdT)),this.wheelHeights[e.i]=e.tPos.y)}updateVehicleNode(){if(st.vehicleNode.next){if(st.vehicleNode.i<this.targetVehicleNodeIndex)return T.wrongWay=!1,hl.value==il.UTurn&&hl.set(il.None),st.vehicleNode=st.vehicleNode.next,st.vehicleIndex=st.vehicleNode.i,st.vehicleIndexDidChange=!0,void tl.nodeDidChange();Wl.d1=T.position.distanceToSquared(st.vehicleNode.p),Wl.d2=T.position.distanceToSquared(st.vehicleNode.next.next.p),Wl.d2>14400?(this.nodeCheckFrame--,this.nodeCheckFrame<=0&&(this.nodeCheckFrame=60,Wl.closest=tt(T.position.x,T.position.z,st.vehicleNode,!0),Wl.closest.n.i>st.vehicleNode.i&&(this.targetVehicleNodeIndex=Wl.closest.n.i),Vo.value.edge||Ro.testFarGrid(T.position.x,T.position.z)||(Vo.set("edge",!0),no.sendUpdate("achievment","edge")))):Wl.d2<Wl.d1?(T.wrongWay=!1,hl.value!=il.UTurn&&hl.value!=il.Reverse||hl.set(il.None),st.vehicleNode=st.vehicleNode.next,st.vehicleIndex=st.vehicleNode.i,st.vehicleIndexDidChange=!0,tl.nodeDidChange()):Wl.d1>400&&T.onRoad?(T.wrongWay||(Wl.transformedNodeAngle=(2.5*Math.PI-st.vehicleNode.a)%(2*Math.PI),Wl.angleDif=Math.abs(T.heading-Wl.transformedNodeAngle),Wl.angleDif>2&&Wl.angleDif<4.3&&(no.sendUpdate("wrongWay"),T.wrongWay=!0,hl.set(il.UTurn))),!T.wrongWay&&T.direction<0&&(T.reversingTooFar=!0,hl.set(il.Reverse))):T.wrongWay?(Wl.transformedNodeAngle=(2.5*Math.PI-st.vehicleNode.a)%(2*Math.PI),Wl.angleDif=Math.abs(T.heading-Wl.transformedNodeAngle),(Wl.angleDif<1.4||Wl.angleDif>4.9)&&(T.wrongWay=!1,hl.value==il.UTurn&&hl.set(il.None))):T.reversingTooFar&&(T.reversingTooFar=!1,hl.value==il.Reverse&&hl.set(il.None)),Wh.dist=10*(st.vehicleNode.i-st.initIndex+wh.accumulatedProgress),this.analytics.rawDS>this.nextUpdateDistance&&(this.nextUpdateDistance=this.analytics.rawDS+this.nextUpdateIncrement,this.nextUpdateIncrement<this.maxUpdateIncrement&&(this.nextUpdateIncrement=Math.min(this.maxUpdateIncrement,2*this.nextUpdateIncrement)),this.nextAnalyticsUpdate.distance=Wh.dist,this.nextAnalyticsUpdate.rawDistance=this.analytics.rawDS,this.nextAnalyticsUpdate.speed=Wh.speed,no.sendUpdate("vehicleController",this.nextAnalyticsUpdate),this.nextAnalyticsUpdate={})}}handleInput(e){this.inputs.accel=0,this.inputs.drive=0,0!=p.scrollDelta&&null!=Fh.value&&(p.scrollDelta<0?Fh.inc5():Fh.dec5()),this.canToggleAutodrive=!p.key[u.AutoDrive],this.inputDisabled&&!this.autodrive||(this.autodrive?(this.autoDriver.update(e),this.inputs.accel=this.autoDriver.inputs.accel,this.inputs.steer=this.autoDriver.inputs.steer,null!==Fh.value&&(T.speed>Fh.value&&(this.inputs.accel=0,T.speed>Fh.value+1&&(this.autoDriver.inputs.brake=Math.max(this.autoDriver.inputs.brake,T.speed/Fh.value-1))),0==Fh.value?(this.inputs.accel=0,this.autoDriver.inputs.brake=1):T.handbrake&&(T.handbrake=!1)),this.autoDriver.inputs.brake>0?(T.braking||(T.brakeLerp=0),T.braking=!0,Bl.redlight.emissiveIntensity=Gl):(T.braking=!1,Bl.redlight.emissiveIntensity=0),!this.useMouse&&(p.key[u.Left]||p.key[u.LeftArrow]||p.key[u.Forward]||p.key[u.UpArrow]||p.key[u.Right]||p.key[u.RightArrow]||p.key[u.Backward]||p.key[u.DownArrow])?this.canCancelAutodrive&&!this.inputDisabled&&j.set(!1):this.canCancelAutodrive=!0):this.useMouse?(Wl.w2=window.innerWidth/2,Wl.mouseWidth=Math.max(Wl.w2,Fo.mouseWidgetWidth)/2,Wl.h2=window.innerHeight/2,Wl.wHeight=window.innerHeight*(Fo.mouseWidgetHeight/100)+25,p.mouseEnabled?(this.mouse.x=(p.mouse.x-Wl.w2)/Wl.mouseWidth,this.mouse.y=-(p.mouse.y-(Wl.h2-Wl.wHeight)-Wl.h2)/Wl.h2*2):(this.mouse.x=0,this.mouse.y=0),this.mouse.x=Math.max(Math.min(1,this.mouse.x),-1),this.mouse.y=Math.max(0,this.mouse.y),this.canMouse=this.mouse.y>0,T.handbrake&&(this.hasAccel=!1,this.steer=0,this.mouse.x=0),null==Fh.value?(this.hasAccel=p.click.left&&this.canMouse,this.hasAccel&&(this.inputs.accel=T.metrics.accel),this.hasBoost=!1):(this.hasAccel=p.click.left&&this.canMouse,this.hasBoost=null!==Fh.value&&this.hasAccel),p.click.right?(this.hasAccel=!1,T.direction>0?(T.braking||(T.brakeLerp=0),T.braking=!0,Bl.redlight.emissiveIntensity=Gl,this.inputs.accel=0):(T.braking=!1,this.inputs.accel=.75*-T.metrics.accel,Bl.redlight.emissiveIntensity=0)):(T.braking=!1,Bl.redlight.emissiveIntensity=0,!this.hasBoost&&T.direction<0&&(T.braking=!0,Bl.redlight.emissiveIntensity=Gl)),T.braking?Bl.redlight.emissiveIntensity=Gl:Bl.redlight.emissiveIntensity=0,this.inputs.steer=-this.mouse.x,this.mouse.y<=0&&(this.inputs.steer=0),Wl.da=this.inputs.steer-this.prevSteer,Wl.da<-this.maxSteerSpeed*e?this.inputs.steer=this.prevSteer-this.maxSteerSpeed*e:Wl.da>this.maxSteerSpeed*e&&(this.inputs.steer=this.prevSteer+this.maxSteerSpeed*e),this.prevSteer=this.inputs.steer,this.dom.mouseMarker.style.transform="translateX("+(50+50*-this.inputs.steer)+"%)",this.inputs.steer*=1-T.speed/T.metrics.topSpeed*.4):(this.hasBoost=this.hasBoost&&(this.hasAccel||null!==Fh.value),p.key[u.Forward]||p.key[u.UpArrow]?(this.hasAccel||0!=f.DoubleTap||(this.hasBoost=!this.hasAccel&&I.appTime-this.lastAccel<.15,this.boostFromTap=this.hasBoost),this.boostFromTap&&0===f.DoubleTap||(this.hasBoost=!(!p.key[u.BoostAccel]&&!p.key[u.BoostAccel2])),nl.Boost&&this.hasBoost&&al("Boost"),this.hasAccel=!0,this.lastAccel=I.appTime,!this.hasBoost&&T.direction<0?(T.braking=!0,Bl.redlight.emissiveIntensity=Gl):(T.braking=!1,Bl.redlight.emissiveIntensity=0,this.inputs.accel=T.metrics.accel),this.holdHandbrake=!1):p.key[u.Backward]||p.key[u.DownArrow]?(this.hasAccel=!1,T.direction>0?(T.braking||(T.brakeLerp=0),T.braking=!0,Bl.redlight.emissiveIntensity=Gl):(T.braking=!1,this.inputs.accel=-T.metrics.accel,Bl.redlight.emissiveIntensity=0),this.holdHandbrake=!1):(this.hasAccel=!1,T.braking=!1,Bl.redlight.emissiveIntensity=0),this.inputs.steer=0,(p.key[u.Left]||p.key[u.LeftArrow])&&(this.inputs.steer+=1),(p.key[u.Right]||p.key[u.RightArrow])&&(this.inputs.steer-=1),this.inputs.stiffSteer=p.key[u.StickySteer],this.inputs.stiffSteer&&p.key[u.Handbrake]&&!this.inputs.handbrake&&(this.holdHandbrake=!0),this.inputs.handbrake=!T.bike&&p.key[u.Handbrake],T.handbrake=!T.bike&&p.key[u.Handbrake]||this.holdHandbrake),null===Fh.value||this.autodrive||T.braking||T.handbrake||0!=this.inputs.accel&&!this.useMouse||(this.useMouse||(this.hasBoost=!(!p.key[u.BoostAccel]&&!p.key[u.BoostAccel2])),this.inputs.accel>=0&&Fh.value-T.speed>0&&(this.inputs.accel=Math.min(T.metrics.accel,(Fh.value-T.speed)/e)),this.useMouse&&this.hasBoost&&(this.inputs.accel=T.metrics.accel)),this.hasBoost?this.inputs.accel+=T.metrics.accel*Math.max(0,1-T.speed/T.metrics.topSpeed):this.inputs.accel>0&&T.speed<27&&(this.inputs.accel+=T.metrics.accel*Math.max(0,.5*(1-T.speed/27))),p.key[u.Reset]?(this.resetToNode(st.vehicleNode),nl.Reset&&al("Reset"),p.key[u.Reset]=!1,this.analytics.resetCount++,no.sendUpdate("resetCount",this.analytics.resetCount),this.holdHandbrake=null==Fh.value):c&&(p.key[u.PageUp]&&st.vehicleNode.next?(this.resetToNode(st.vehicleNode.next),this.holdHandbrake=!0,p.key[u.PageUp]=!1):p.key[u.PageDown]&&st.vehicleNode.prev&&(this.resetToNode(st.vehicleNode.prev),this.holdHandbrake=!0,p.key[u.PageDown]=!1)),this.autodrive?(T.steer=this.inputs.steer,T.updateSteer()):this.getSoggySteerState(e),this.getDriveState(e),this.inputDisabled||(p.scrollDelta=0),T.hasBoost=this.hasBoost)}checkAutodriveProgress(){}resetToNode(e){let t=e.a-e.next.da/2;this.setPose(e.p.x,e.p.y,e.p.z,Math.PI/2-t,!0),this.inputs.accel=0,this.inputs.steer=0,this.inputs.brake=0,this.inputs.handbrake=0,this.inputs.stiffSteer=0,this.hasBoost=!1;let i=0;for(let s of this.wheels.children)s.shockPos=.5,s.groundHeight=0,s.vel.set(0,0,0),s.velDir.set(0,0,0),s.acc.set(0,0,0),s.dSus=0,s.pSus=0,s.dS=0,s.tPos.set(0,0,0),s.prevShockPos=.5,s.insideWall=!0,s.i%2==0?s.rotation.set(0,Math.PI/2,0):s.rotation.set(0,-Math.PI/2,0),s.collisionFactor=0,s.wd=0,this.wheelHeights[i]=0,i++,this.updateWheelWorldPos(s),s.pPos.copy(s.worldPos);i=0;for(let s of this.wheelEulers)i%2==0?s.set(0,Math.PI/2,0):s.set(0,-Math.PI/2,0);this.pPos.copy(T.position),T.pitch=this.orientation.x,T.reset(),hl.value==il.UTurn&&hl.set(il.None),Wh.speed=T.speed,Wl.turnSpeed=0,Wl.pTurnSpeed=0,this.targetHeading=0,this.update=this.updateStationed,tl.pause(),this.tiltX=this.orientation.x,this.sinTiltX=Math.sin(this.tiltX),this.tiltZ=this.orientation.z,this.sinTiltZ=Math.sin(this.tiltZ),this.dS=0,this.didCollide=!1,this.collisionsDisabled=!1,this.updateUI(),st.vehicleNode=e,st.vehicleIndex=e.i,st.vehicleIndexDidChange=!0,this.targetVehicleNodeIndex=st.vehicleIndex,this.motionDir.set(0,0,1),this.steerOrientation.copy(this.orientation),this.autoDriver.reset(),this.useMouse&&(this.dom.mousePrompt.style.display="block")}getDriveState(e){this.inputs.accel>0?T.drive<this.inputs.accel?(T.drive+=T.metrics.jerk*e,T.drive>this.inputs.accel&&(T.drive=this.inputs.accel)):T.drive=this.inputs.accel:T.drive>this.inputs.accel?(T.drive-=T.metrics.jerk*e,T.drive<this.inputs.accel&&(T.drive=this.inputs.accel)):T.drive=this.inputs.accel}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e}smoothLerp(e){return(3-2*e)*e*e}halfLerp(e){return 2*((3-2*(e=e/2+.5))*e*e-.5)}getSoggySteerState(e){if(Wl.maxSteer=T.metrics.maxSteer,this.soggySteerFactor=1-.75*T.speedLerp,T.bike?(this.soggyTurnInterval=T.metrics.steerInterval,this.soggySteerTimeFactor=1+T.speedLerp*T.speedLerp):(this.soggyTurnInterval=T.metrics.steerInterval,this.soggySteerTimeFactor=1+.5*T.speedLerp,T.slip>0&&!this.inputs.stiffSteer&&(this.soggySlip=1-T.slip,this.soggySlip*=this.soggySlip,this.soggySlipB=Math.max(.5,this.soggySlip),this.soggySteerTimeFactor*=this.soggySlipB,this.soggySteerFactor=1-.75*T.speedLerp*this.soggySlipB)),this.useMouse&&(this.soggySteerTimeFactor=.05/this.soggyTurnInterval),Wl.maxSteer*=this.soggySteerFactor,Wl.steerTarget=this.inputs.steer*Wl.maxSteer,this.inputs.stiffSteer)return this.soggyStiff=!0,this.soggyStiffLerp=Math.min(1,this.soggyStiffLerp+10*e),e/=2*this.soggyTurnInterval,this.inputs.steer!=this.soggyTurningDir&&(this.soggyStiffLerp=0,this.soggyTurningDir=this.inputs.steer),0==this.inputs.steer?Wl.steerTarget=T.steer:T.steer+=this.inputs.steer*e*(Wl.maxSteer/T.metrics.maxSteer)*Math.abs((T.steer-Wl.steerTarget)/Wl.maxSteer)*this.soggyStiffLerp,void T.updateSteer();this.soggyStiff&&(this.soggyStiff=!1,this.soggyTimer=0,this.soggyStartPoint=T.steer),0!=this.inputs.steer||this.useMouse?this.soggyTurning&&this.soggyTurningDir==this.inputs.steer||(this.soggyTimer=0,this.soggyStartPoint=T.steer,this.soggyInterval=this.soggyTurnInterval/(Math.abs(Wl.steerTarget-T.steer)/Wl.maxSteer),T.bike&&Math.abs(Wl.steerTarget-T.steer)>Wl.maxSteer&&(this.soggyInterval*=1-T.speedLerp/2),this.soggyTurning=!0,this.soggyTurningDir=this.inputs.steer):this.soggyTurning&&(this.soggyTurning=!1,T.bike?this.soggyInterval=this.soggyTurnInterval*Math.abs(T.steer/(1*Wl.maxSteer)):this.soggyInterval=this.soggySlipB*this.soggyTurnInterval*Math.abs(T.steer/(2*Wl.maxSteer)),this.soggyTimer=0,this.soggyStartPoint=T.steer,this.soggyTurningDir=0),this.soggyTimer+=e/this.soggySteerTimeFactor,this.soggyLerp=Math.min(1,this.soggyTimer/this.soggyInterval),this.soggyLerp=this.halfLerp(this.soggyLerp),T.steer=this.soggyStartPoint*(1-this.soggyLerp)+Wl.steerTarget*this.soggyLerp,T.updateSteer()}};const Zl={},Fl=(e,t)=>{if(isNaN(t))console.warn("Attempting to set nan config value for ",e);else{window.localStorage.setItem(Ql[e],t),Yl[e]=t;for(let i of Zl[e]||[])i(t)}},Hl={UseAckermann:!0,AudioLevel:1,Units:0},Ql={},Yl={UseAckermann:Hl.UseAckermann,AudioLevel:Hl.AudioLevel,Units:Hl.Units};for(let _c in Yl){let e;Ql[_c]="config-"+_c;try{e=JSON.parse(window.localStorage.getItem(Ql[_c]))}catch(Kc){console.warn("JSON Parsing exception"),console.warn(Kc),Fl(_c,Hl[_c]),e=Hl[_c]}Yl[_c]=null===e?Hl[_c]:e}var Vl=Yl;new class{constructor(){this.setBound=this.set.bind(this),this.ls=window.localStorage,this.loadConfig()}loadConfig(){let e;for(let t in Vl)e=this.get(t),Vl[t]=null==e?Hl[t]:e}get(e){return JSON.parse(this.ls.getItem("config-"+e))}set(e,t){console.log("Set config '"+e+"' to "+t),Vl[e]=t,window.localStorage.setItem("config-"+e,t)}};const Ul="no_prompt_fps";var Xl=new class extends l{constructor(...e){super(...e),this.default=!1,this.value=!1,this.disabled=null!=window.localStorage.getItem(Ul)||null!=window.localStorage.getItem("analytics_didChangeQuality")||wh.value.viewLodIndex*wh.value.detailLodIndex==0}disable(){this.disabled=!0,window.localStorage.setItem(Ul,!0)}};var Jl=new class{constructor(){this.domStats={},this.active=!1,this.initialised=!1,this.showCamPos=!1,this.updateBound=this.update.bind(this),p.addListener(u.Debug,this.toggleActive.bind(this)),p.addListener(u.Debug2,(()=>{this.showCamPos=!this.showCamPos}))}setStats(e){this.stats=e,document.body.appendChild(this.stats.dom),this.stats.dom.style.display="none"}init(){this.dom=document.getElementById("ui-debug"),this.domPos=document.getElementById("ui-debug-position"),this.domFarCoords=document.getElementById("ui-debug-far-coords"),this.domNode=document.getElementById("ui-debug-node"),this.domTail=document.getElementById("ui-debug-midline-tail");for(let e in ts){let t=document.createElement("div");t.className="ui-debug-row";let i=document.createElement("div");i.className="ui-debug-label",i.innerHTML=e+":",t.appendChild(i);let s=document.createElement("div");s.className="ui-debug-value",s.innerHTML=ts[e],t.appendChild(s),this.dom.appendChild(t),this.domStats[e]=s}this.initialised=!0}toggleActive(){this.initialised||this.init(),this.stats&&(this.active=!this.active,this.active?(I.addListener(this.updateBound),this.dom.style.display="flex",this.stats.dom.style.display="block"):(I.removeListener(this.updateBound),this.dom.style.display="none",this.stats.dom.style.display="none"))}update(){let e,t,i;this.showCamPos?Qe.parent?(e=Qe.parent.position.x,t=Qe.parent.position.y,i=Qe.parent.position.z):(e=Qe.position.x,t=Qe.position.y,i=Qe.position.z):(e=T.position.x,t=T.position.y,i=T.position.z),this.domPos.innerHTML=Math.floor(e)+"x "+Math.floor(t)+"y "+Math.floor(i)+"z";let s,n,a=e/me,r=i/me;s=Math.floor((a-Math.floor(a))*xe),n=Math.floor((r-Math.floor(r))*xe),a=Math.floor(a),r=Math.floor(r),this.domFarCoords.innerHTML=s+", "+n+" @ "+a+", "+r,this.domNode.innerHTML=st.vehicleNode.i,this.domTail.innerHTML=st.tail.i;for(let h in this.domStats)this.domStats[h].innerHTML=ts[h]}};var ql=class{constructor(e,t,i,s){this.screenSize=new h.V,this.renderScale=1,this.onError=()=>{},this.onLoadProgress=()=>{},this.loadStages=[],this.isCineCam=!1,this.loadLoopBound=this.loadLoop.bind(this),this.maxLoadLoops=1e3,this.loadLoopCount=0,this.loadInactivityTimer=0,this.prevLoadProg=0,this.fineLoadProgress=0,this.initialised=!1,this.midlineDidReset=!0,this.onLoadedBound=this.onLoaded.bind(this),this.firstFrame=!0,this.basicPromptInterval=null,this.onAudioInitBound=this.onAudioInit.bind(this),this.onTickerStateBound=this.onTickerState.bind(this),this.lights={},this.fpsTracker=0,this.statsTimer=0,this.updateBound=this.update.bind(this),this.physDT=0,this.maxPhysDT=.02,this.minPhysDT=.004,this.checkNoGPU=0,this.lowFPSWaiter=0,this.canvas=e,this.onError=i,this.onLoadProgress=s,this.stats=new o.a,this.stats.dom.style.left="",this.stats.dom.style.right="0",this.pauseDom=document.getElementById("game-paused"),this.initScene(e),I.addStateListener(this.onTickerStateBound),p.init(t),p.addListener(u.NodeDebug,(()=>console.log(st.vehicleNode))),p.addListener(u.Mute,(()=>{c&&(null==this.scene.fog?this.scene.fog=new h.q(16448255,25e-5):this.scene.fog=null),z.toggleMute()})),p.addListener(u.CameraToggle,(()=>this.toggleCamera())),p.addListener(u.E,(()=>{this.isCineCam||(p.key[u.E]=!1,Ro.nextSkin())})),p.addListener(u.Q,(()=>{this.isCineCam||(p.key[u.Q]=!1,Ro.prevSkin())})),wh.addListener("seed",(()=>{no.recordSeed(wh.value.seed),this.regenerateAll()})),wh.addListener("sceneName",(()=>{this.regenerateAll()})),wh.addListener("topography",(()=>{this.regenerateTopography()})),wh.addListener("viewLodIndex",(()=>{this.regenerateViewDist()})),wh.addListener("detailLodIndex",this.regenerateDetail.bind(this)),wh.addListener("renderScale",(e=>{this.renderScale=mh[e],no.sendUpdate("renderScale",e),this.setSize(this.screenSize.x,this.screenSize.y)})),this.renderScale=mh[wh.value.renderScale],p.lockKeys(),T.addListener(O,this.onVehicleChanged.bind(this)),this.generate()}pregenerate(){d.set(!0),no.sendUpdate("sceneConfigChange",{...wh.value,initNode:wh.initialNode,accumProg:wh.accumulatedProgress}),wh.loadProgress(),p.lockKeys(),this.vehicleController.suspend(),I.removeListener(this.updateBound),this.midlineDidReset=!0,this.loadProgress=0,this.loadStages.length=0,this.onLoadProgress(0)}regenerateAll(){this.pregenerate(),this.scene.fog=ne(),this.generate()}regenerateSeed(){}regenerateTopography(){this.pregenerate(),this.loadStages.push({name:"topography",setup:Ro.topographyLoaderInit,loader:Ro.topographyLoader,portion:.25,frameIterations:50}),this.loadStages.push({name:"scene",setup:Ro.sceneLoaderInit,loader:Ro.sceneLoader,portion:.1,frameIterations:1}),this.loadStages.push({name:"farGrid",setup:Ro.farGridReset,loader:Ro.farGridLoader,portion:.35,frameIterations:10}),this.loadStages.push({name:"nearGrid",setup:Ro.nearGridReset,loader:Ro.nearGridLoader,portion:.28,frameIterations:10}),this.loadStages.push({name:"finalise",setup:()=>{},loader:Ro.postGridLoader,portion:.02,frameIterations:10}),this.loadStage=this.loadStages[0],this.loadStage.setup(),I.addListener(this.loadLoopBound)}regenerateViewDist(){Ro.updateConfig(),this.camController.updateViewDist(),this.regenerateAll()}regenerateDetail(){Ro.updateConfig(),this.regenerateAll();let e=512*(wh.value.detailLodIndex+1);ue.shadow.mapSize.width=e,ue.shadow.mapSize.height=e,ue.shadow.map.dispose(),ue.shadow.map=null}generate(){this.loadProgress=0,this.midlineDidReset=!0,this.loadStages.push({name:"topography",setup:Ro.topographyLoaderInit,loader:Ro.topographyLoader,portion:.25,frameIterations:50}),this.loadStages.push({name:"scene",setup:Ro.sceneLoaderInit,loader:Ro.sceneLoader,portion:.1,frameIterations:1}),this.loadStages.push({name:"farGrid",setup:Ro.farGridLoaderInit,loader:Ro.farGridLoader,portion:.35,frameIterations:10}),this.loadStages.push({name:"nearGrid",setup:Ro.nearGridLoaderInit,loader:Ro.nearGridLoader,portion:.28,frameIterations:10}),this.loadStages.push({name:"finalise",setup:()=>{},loader:Ro.postGridLoader,portion:.02,frameIterations:10}),this.loadStage=this.loadStages[0],this.loadStage.setup(),I.addListener(this.loadLoopBound)}loadLoop(e){try{let t,i=1e3*e,s=Date.now()+i;for(this.fineLoadProgress=0,t=0;t<this.maxLoadLoops&&(this.fineLoadProgress=this.loadStage.loader(),!(this.fineLoadProgress>=1||Date.now()>=s));t++);if(this.fineLoadProgress>=1){let e=this.loadStages.shift();if(this.loadProgress+=e.portion,console.log("Loaded "+e.name+"..."),0==this.loadStages.length)return console.log("Loading complete"),I.removeListener(this.loadLoopBound),void this.onLoaded();this.loadStage=this.loadStages[0],this.loadStage.setup(),this.fineLoadProgress=this.loadProgress,this.onLoadProgress(this.loadProgress)}else this.fineLoadProgress=this.loadProgress+this.loadStages[0].portion*this.fineLoadProgress,this.onLoadProgress(this.fineLoadProgress);if(this.prevLoadProg>=this.fineLoadProgress){if(this.loadInactivityTimer+=e,this.loadInactivityTimer>3){if(no.sendFeedback("LOAD ERROR: Stuck at progress ",this.loadProgress),!Bh.NewPlayer)return this.onError("LOAD ERROR: Stuck at progress ",this.loadProgress),void I.retire();qe(null,!0)}}else this.loadInactivityTimer=0;this.prevLoadProg=this.fineLoadProgress,this.loadLoopCount=0,this.render(),this.stats.update()}catch(Kc){return console.error(Kc),this.onError(Kc.stack.toString()),no.sendFeedback("LOAD ERROR: "+Kc.stack.toString()),void I.retire()}}onLoaded(){this.initialised?(this.vehicleController.reload(this.midlineDidReset),p.unlockKeys()):(this.initVehicle(),window.addEventListener("keydown",this.onAudioInitBound),window.addEventListener("mousedown",this.onAudioInitBound),Jl.setStats(this.stats),tl.init(),this.initialised=!0),this.camController.updateViewDist(),d.set(!1),this.onLoadProgress(1),this.beginRender()}awaitVehicleMotion(){T.speed>1&&(hl.set(il.None),clearInterval(this.basicPromptInterval))}beginGame(){var e,t;e=Th,t=!0,localStorage.setItem(e,t),hl.value!==il.None&&(this.basicPromptInterval=setInterval(this.awaitVehicleMotion.bind(this),3e3)),p.unlockKeys(),this.canvas.focus(),no.initialiseAnalytics()}resetVehicle(){this.vehicleController.resetToNode(st.vehicleNode)}onAudioInit(){z.init(),window.removeEventListener("keydown",this.onAudioInitBound),window.removeEventListener("mousedown",this.onAudioInitBound)}onTickerState(e){this.pauseDom.style.display=e?"block":"none"}initRenderer(e=!0,t=!0){this.renderer=new h.X({canvas:this.canvas,antialias:e,powerPreference:"high-performance",stencil:!1,logarithmicDepthBuffer:t}),console.log("Device pixel ratio: ",window.devicePixelRatio),this.renderer.setPixelRatio(Math.min(1,window.devicePixelRatio)),this.renderer.setClearColor(16777215,1),console.log("Antialias, logdepth ",e,t),this.renderer.shadowMap.enabled=!0}initScene(e){this.scene=ao,this.scene.background=ge,this.scene.fog=ne(),this.renderer=new h.X({canvas:this.canvas,antialias:wh.value.antialias,powerPreference:"high-performance",stencil:!1,logarithmicDepthBuffer:!1}),console.log("Device pixel ratio: ",window.devicePixelRatio),this.renderer.setPixelRatio(Math.min(1,window.devicePixelRatio)),this.renderer.setClearColor(16777215,1),this.renderer.shadowMap.enabled=!0,this.lights.ambient=ce,this.scene.add(this.lights.ambient);let t=pe;t.position.set(0,1,0),this.lights.hemi=t,this.scene.add(this.lights.hemi);let i=ue;i.position.set(0,10,0),i.castShadow=!0,i.shadow.radius=2,i.shadow.camera.left=-4,i.shadow.camera.right=4,i.shadow.camera.top=4,i.shadow.camera.bottom=-4,i.shadow.camera.updateProjectionMatrix();let s=512*(wh.value.detailLodIndex+1);i.shadow.mapSize.width=s,i.shadow.mapSize.height=s,i.shadow.camera.near=.5,i.shadow.camera.far=300,i.target=T,this.lights.dir=i,this.scene.add(this.lights.dir),this.toggleCamera(),this.scene.add(Ro.container),this.scene.add(T),this.setSize(e.offsetWidth,e.offsetHeight),this.render()}toggleCamera(){this.camController&&(this.camController.destroy(),this.camController.camContainer?this.scene.remove(this.camController.camContainer):this.scene.remove(this.camController.camera),this.isCineCam=!this.isCineCam,this.vehicleController.inputDisabled=this.isCineCam),this.isCineCam?this.camController=new Wo(this.onViewChange.bind(this),this.canvas):this.camController=new Bo(this.onViewChange.bind(this))}initVehicle(){this.vehicleController=new El,this.onVehicleChanged()}onVehicleChanged(){let e=this.lights.dir.shadow.camera,t=T.metrics.shadowMapSize;e.left=-t,e.right=t,e.top=t,e.bottom=-t,e.updateProjectionMatrix()}destroy(){for(this.camController.destroy(),this.vehicleController.destroy(),this.bikeController.destroy(),I.removeListener(this.updateBound);this.scene.children.length;)console.log("Removing scene children"),this.scene.remove(this.scene.children[0]);for(;this.canvas.lastChild;)this.canvas.removeChild(this.canvas.lastChild);this.renderer.clear()}render(){this.renderer.render(this.scene,this.camController.camera)}beginRender(){T.headlights||(T.setHeadlights(!0),T.lightsContainer.position.y-=100,this.update(I.dT,I.appTime),T.setHeadlights(!1),T.lightsContainer.position.y+=100),I.addListener(this.updateBound)}update(e,t){A.disabled||(e>.07?(this.checkNoGPU+=1,this.checkNoGPU>10&&(A.set(!0),A.disable())):this.checkNoGPU>0&&(this.checkNoGPU-=1));try{if(this.physDT+=e,this.physDT>this.maxPhysDT)for(this.vehicleController.update(this.maxPhysDT,t),this.physDT-=this.maxPhysDT;this.physDT>this.maxPhysDT;)this.vehicleController.update(this.maxPhysDT,t),this.physDT-=this.maxPhysDT;this.physDT>this.minPhysDT&&(this.vehicleController.update(this.physDT),this.physDT=0),this.camController.update(e),Ro.update(e,t)}catch(Kc){return console.error(Kc),this.onError(Kc.stack.toString()),no.sendFeedback("UPDATE ERROR IN "+Kc.cause+": "+Kc.stack.toString()),void I.retire()}this.render(),this.stats.update(),ts["draw-calls"]=this.renderer.info.render.calls,this.fpsTracker++,this.statsTimer+=e,this.statsTimer>=5&&this.updateStats()}updateStats(){this.curFPS=this.fpsTracker/this.statsTimer,this.fpsTracker=0,this.statsTimer=0,this.lowFPSWaiter>3&&this.curFPS<45&&this.curFPS>15&&!Xl.disabled&&(this.curFPS<20&&A.set(!0),Xl.set(!0),Xl.disable()),this.lowFPSWaiter++,no.sendUpdate("stats",{fps:this.curFPS,drawCalls:this.renderer.info.render.calls,playTime:1e3*I.playTime})}onViewChange(){}setSize(e,t){this.screenSize.set(e,t),this.renderer.setSize(e*this.renderScale,t*this.renderScale),this.camController.setSize(e,t),this.render()}},Kl=(i(17),i.p+"static/media/warning.2f7f711f.svg"),_l=i.p+"static/media/u_turn.38a08a9e.svg",$l=i.p+"static/media/arrow_up.fdd3dd06.svg",ed=(i(45),i.p+"static/media/no_mobile_1.959d982f.svg"),td=i.p+"static/media/anslo_ico.77ddc9f9.svg",id=i.p+"static/media/splash-logo-placeholder-7b.2d60164d.png",sd=i(0);const nd=[{q:"Why does it run so poorly/like a slideshow?",a:"Check that your browser application is running with hardware acceleration enabled - both in the browser settings and your GPU settings"},{q:"What's different about this driving game?",a:"The custom environment generation engine has been carefully designed for expansive, true-to-life scenery stretching endlessly into the horizon without repetition. With an entirely procedurally generated world, players can easily swap between different locations, seasons, and weathers to suit their mood. And, being browser-based, accessing the game couldn't be easier; one click and you're off."},{q:"How does the environment generation engine work?",a:"The full write-up is still in the works (see above), but in short: a heightmap is generated with a custom algorithm similar to perlin noise, and the road's midline is traced through that heightmap using simple rules on gradient and curvature. The environment is rendered in chunks of different resolutions based on how close to the road's midline they will appear. Add in a lot of dynamic geometry management, textures, and basic vehicle physics, and you have Slow Roads."},{q:"Why a JavaScript browser game, and not a conventional engine?",a:"Browser games have a massive benefit of broad compatibility and ease of access; as long as you have a modern browser, simply load up the web page and start playing in one click - no installs or logins needed. Further, writing browser games in pure JavaScript, rather than building them from an engine such as Unity, allows for more powerful control over optimisation, which is critical for a demanding game such as this. Beyond that... breaking convention and proving novel capabilities can be a rewarding challenge in itself."},{q:"Why electric vehicles?",a:"EVs work well in this context for a few reasons: they're quieter and more peaceful; they're simpler and more intuitive to gamify (no gears or RPM concerns); the physics and audio is easier to code; and they're the future - combustion engines are quickly becoming old fashioned. That said, I'm open to adding more vehicle types, including manual transmission, in future."},{q:"Will you make it open source?",a:"Probably not anytime soon, but I'm not against it in principle. The codebase has always been \"experimental\", and as such unreadable to anyone but me, so probably of limited value right now. If there's interest, I may isolate and open source interesting subsystems like the routing algorithm, or expose an interface for graphics mods."},{q:"Why can I drive through trees and signs?",a:"Off-road object collisions might be a useful \"threat\" for discouraging shortcuts in a competitive context, but if you're just here to chill they would only add insult to injury. Ignoring off-road object collisions is also a huge saving on physics processing, so altogether it's a reasonable tradeoff."},{q:"Why is driving off-road so broken? No shadows, sinking into the ground, missing geometry, etc.",a:"Off-road driving isn't an intended gameplay element, so it isn't really supported; rather, I decided there's no reason to prohibit it. The engine is optimised for going one direction and following the road only, so don't be surprised if it \"looks broken\" should you choose to ignore that."},{q:"Will you support mobile/controllers/wheels?",a:"Controllers yes, but achieving good performance on mobiles might be difficult, and is something I still need to explore. Support for controllers and wheels is planned in the next few weeks."},{q:"How much will it cost?",a:Object(sd.jsxs)(sd.Fragment,{children:["Nothing! And no ads, either... enjoy this as a respite from run-away capitalism. However, keeping the game online relies upon kind ",Object(sd.jsx)("a",{className:"about-link",href:"https://ko-fi.com/slowroads",children:"donations"}),", so anything you might be able to contribute would go a long way to supporting it."]})},{q:"Slow roads? More like Fast Roads!",a:'The idea of a "slow road" is about taking the longer scenic route instead of the highway, not about how fast you drive.'},{q:"Will you offer a downloadable/Steam version?",a:"I'm considering a Steam release with extra features in the future, though it's not certain. However, if I don't go that route, it should be possible to offer a free download of the web version."},{q:"Can you add X feature/Y vehicle model/make it more like [insert AAA game here]?",a:"Probably not - the browser is a somewhat limited platform, so advanced features and lots of content isn't a realistic goal. I would also like to maintain the casual, minimal design of the game, and not make it too similar to existing racing games; they already offer all the hardcore features I can't."},{q:"I'm a developer/artist/musician, can I contribute my work to the game?",a:"I'm not accepting content from others, sorry; this is still a personal project for me, and a portfolio piece, so involving work from others defeats the purpose. But thanks for the interest!"}],ad=[{title:"1. Project overview (tl;dr for all sections)",link:"https://anslo.medium.com/slow-roads-tl-dr-a664ac6bce40"},{title:"2. Generating realistic environment heightmaps (early November)"},{title:"3. Pathing a route through the environment"},{title:"4. Rendering seamless, dynamically-generated environment geometry"},{title:"5. Graphics and shading"},{title:"6. Cheap vehicle physics"},{title:"7. Optimisation strategies"},{title:"8. UX approach"},{title:"9. Testing and analytics"},{title:"10. Project Retrospective"}],rd=({title:e,link:t})=>t?Object(sd.jsxs)(sd.Fragment,{children:[Object(sd.jsx)("a",{className:"about-link splash-blog-link",href:t,target:"_blank",rel:"noopener noreferrer",children:e}),Object(sd.jsx)("hr",{})]}):Object(sd.jsxs)(sd.Fragment,{children:[Object(sd.jsx)("div",{className:"splash-blog-missing",children:e}),Object(sd.jsx)("hr",{})]}),hd=({q:e,a:t})=>{const[i,n]=Object(s.useState)(!1);return Object(sd.jsxs)("div",{className:"faq-qa",children:[Object(sd.jsxs)("div",{className:"faq-q",onMouseDown:e=>{n(!i),e.preventDefault()},children:[Object(sd.jsx)("div",{children:e}),Object(sd.jsx)("div",{style:{paddingLeft:"12px"},children:i?"-":"+"})]}),i&&Object(sd.jsx)("div",{className:"faq-a",children:t})]})},od=()=>Object(sd.jsxs)("div",{id:"splash-changelog",children:["New Version: ",Object(sd.jsx)("strong",{children:es}),Object(sd.jsx)("br",{}),Object(sd.jsx)("ul",{children:Ki.map((e=>Object(sd.jsx)("li",{className:"splash-version-change",children:e})))}),Object(sd.jsxs)("div",{id:"splash-feedback-prompt",children:["Please use the feedback form to let me know what you think, or ",Object(sd.jsx)("a",{href:"https://discord.gg/s8XPAAj",children:"join the discord"})," and tell me personally!"]}),Object(sd.jsx)("hr",{style:{borderColor:"#fff",opacity:.1}}),Object(sd.jsxs)("div",{className:"splash-version-footer",children:["Next update target: ",_i.targetDate,Object(sd.jsx)("br",{}),Object(sd.jsx)("ul",{children:_i.changes.map(((e,t)=>Object(sd.jsx)("li",{className:"splash-version-change",children:e},"ch"+t)))})]})]}),ld=({loadProgress:e,gameHasBegun:t,onBegin:i})=>Object(sd.jsx)("div",{id:"splash-loader",className:"splash-ready",onClick:e=>{e.preventDefault(),i()},children:t?"return":"begin"}),dd=()=>Object(sd.jsxs)("div",{className:"splash-notsupported",children:[Object(sd.jsx)("img",{className:"splash-notsupported-icon",src:ed,alt:""}),Object(sd.jsx)("br",{}),"Apologies, this project is not yet properly supported on mobile devices.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),"If you're not on a mobile device, please disregard this message and click below to force a reload.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),Object(sd.jsx)("div",{className:"splash-reload",onMouseDown:()=>{window.localStorage.setItem("force-allow-mobile",!0),window.location.reload()},children:"I have a keyboard"})]});var cd=({onClose:e,supported:t,gameHasBegun:i,loadProgress:s})=>Object(sd.jsxs)("div",{id:"splash-container",children:[qi&&Object(sd.jsx)(od,{}),Object(sd.jsx)("div",{id:"home-bg"}),Object(sd.jsxs)("div",{id:"home",children:[t&&Object(sd.jsxs)(sd.Fragment,{children:[Object(sd.jsxs)("div",{id:"splash-version",children:[Object(sd.jsx)("span",{id:"splash-player-count"}),"v",es]}),Object(sd.jsxs)("a",{id:"splash-anslo",href:"https://twitter.com/anslogen",target:"_blank",rel:"noopener noreferrer",children:[Object(sd.jsx)("img",{src:td,id:"splash-anslo-img",alt:""}),Object(sd.jsx)("div",{children:"from anslo.dev \xa9 2022"})]}),Object(sd.jsxs)("div",{id:"splash-license",children:["This work is licensed under a ",Object(sd.jsx)("a",{rel:"license",className:"splash-link",href:"http://creativecommons.org/licenses/by-nc-nd/4.0/",children:"CC BY-NC-ND 4.0 International License"})]})]}),Object(sd.jsx)("div",{id:"splash-logo-placeholder"}),Object(sd.jsx)("img",{id:"splash-logo",src:id,alt:""}),Object(sd.jsx)("div",{id:"splash-header",children:"slow roads"}),Object(sd.jsx)("div",{id:"splash-subheader",children:"endless driving zen"}),t?Object(sd.jsx)(ld,{loadProgress:s,gameHasBegun:i,onBegin:e}):Object(sd.jsx)(dd,{}),Object(sd.jsxs)("a",{id:"splash-about",href:"#about",children:["about",Object(sd.jsx)("br",{}),"\u25be"]}),t&&Object(sd.jsxs)("div",{id:"splash-footer",children:[Object(sd.jsx)("div",{className:"splash-footer-link",children:Object(sd.jsxs)("a",{href:"https://ko-fi.com/slowroads",target:"_blank",rel:"noopener noreferrer",children:["donate",Object(sd.jsx)("span",{className:"outlink"})]})}),Object(sd.jsx)("div",{className:"splash-footer-link",children:Object(sd.jsxs)("a",{className:"splash-link",href:"https://discord.gg/s8XPAAj",children:["discord",Object(sd.jsx)("span",{className:"outlink"})]})})]})]}),Object(sd.jsxs)("div",{id:"about",children:[Object(sd.jsxs)("a",{id:"splash-top",href:"#home",children:["\u25b4",Object(sd.jsx)("br",{}),"back up"]}),Object(sd.jsxs)("div",{id:"about-wrapper",children:[Object(sd.jsx)("div",{className:"about-content",style:{marginBottom:"80px"},children:Object(sd.jsxs)("div",{className:"splash-about",children:[Object(sd.jsx)("strong",{children:"Slow Roads"})," is a casual, procedurally-generated driving game which lets you disconnect from life for a while and run endlessly toward the distant horizon. Set the scenery to suit your mood, throw on some music, and",Object(sd.jsx)("br",{}),Object(sd.jsx)("strong",{children:"just drive"}),"."]})}),Object(sd.jsx)("div",{className:"splash-topo-divider",children:Object(sd.jsx)("div",{className:"splash-topo-header",children:"Background"})}),Object(sd.jsxs)("div",{className:"about-content",children:[Object(sd.jsxs)("div",{className:"splash-nav",children:[Object(sd.jsx)("a",{className:"splash-nav-item",href:"#background",children:"background"}),Object(sd.jsx)("a",{className:"splash-nav-item",href:"#development",children:"development plan"}),Object(sd.jsx)("a",{className:"splash-nav-item",href:"#blog",children:"technical blog"}),Object(sd.jsx)("a",{className:"splash-nav-item",href:"#faq",children:"faq"}),Object(sd.jsx)("a",{className:"splash-nav-item",href:"#archive",children:"attributions"})]}),Object(sd.jsxs)("div",{className:"splash-about-text",children:["My name is ",Object(sd.jsx)("a",{className:"about-link",href:"https://anslo.dev",children:"anslo"})," and I'm a creative developer exploring in the space between design and computer science. With a background in software engineering and a life-long love of functional art, my projects focus on finding novel applications of digital technology in answering interesting design questions.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),"Slow Roads exists primarily as an exploration of procedural scenery generation, but also as an experiment testing the boundaries of 3D application development within JavaScript. As a game, this project is a nostalgic love letter to the rolling hills of the Peak District, and to the arcade rally games I would play for hours on end as a child. As a technical demo, I aim to set a high bar and redress the negative idea of what can be accomplished in the browser.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),"Aside from this, my hope is that those in need of a simple, soothing escape will find it here."]})]}),Object(sd.jsx)("div",{className:"splash-topo-divider",children:Object(sd.jsx)("div",{className:"splash-topo-header",children:"Development Plan"})}),Object(sd.jsx)("div",{className:"about-content",children:Object(sd.jsxs)("div",{className:"splash-about-text",children:["Following an unexpectedly positive response, development will continue until at least the end of the year, to address the critical bugs and add the most popular features. Maintaining the casual experience with an emphasis on scenery remains the priority, though some hardcore features may be considered in the future for an added challenge.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),Object(sd.jsx)("div",{className:"splash-about-title",children:"Upcoming Release - v1.1.0 (mid/late-November):"}),Object(sd.jsx)("br",{}),Object(sd.jsxs)("div",{style:{marginLeft:"16px"},children:["- Support for controllers and wheels ",Object(sd.jsx)("br",{}),"- In-vehicle first-person view ",Object(sd.jsx)("br",{}),"- Revamped control panel with extra settings for physics/audio/controls/gameplay ",Object(sd.jsx)("br",{}),"- Mouse-look when in autodrive/key-control ",Object(sd.jsx)("br",{}),"- Further bug fixes to minimise generation errors and resolve audio issues ",Object(sd.jsx)("br",{})]}),Object(sd.jsx)("br",{}),Object(sd.jsx)("div",{className:"splash-about-title",children:"Planned Future Features:"}),Object(sd.jsx)("br",{}),Object(sd.jsxs)("div",{style:{marginLeft:"16px"},children:["- More locations and world types",Object(sd.jsx)("br",{}),"- Improved weather effects (rain, snow, fog, wind) and better dynamic controls ",Object(sd.jsx)("br",{}),"- Improved environmental detail and effects (birds, buildings, structures, cows...) ",Object(sd.jsx)("br",{}),"- Improved lighting and shadows ",Object(sd.jsx)("br",{}),"- Improved autodrive, including a lane-follow option ",Object(sd.jsx)("br",{}),"- Quality-of-life features like maximum speed lock, past seeds menu ",Object(sd.jsx)("br",{})]}),Object(sd.jsx)("br",{}),"Find the full plan of work on my ",Object(sd.jsx)("a",{className:"about-link",href:"https://public.zenkit.com/c/VRrOoJJR08/slow-roads?v=AB7dI0FTBJ",children:"ZenKit board"}),".",Object(sd.jsx)("br",{}),"Join the ",Object(sd.jsx)("a",{className:"about-link",href:"https://discord.gg/t2UWVKcy3z",children:"discord server"})," to discuss new ideas.",Object(sd.jsx)("br",{}),"Supporters on ",Object(sd.jsx)("a",{className:"about-link",href:"https://ko-fi.com/slowroads",children:"ko-fi"})," get early access and priority requests!",Object(sd.jsx)("br",{})]})}),Object(sd.jsx)("div",{className:"splash-topo-divider",children:Object(sd.jsx)("div",{className:"splash-topo-header",children:"Technical Blog"})}),Object(sd.jsx)("div",{className:"about-content",children:Object(sd.jsxs)("div",{className:"splash-about-text",children:["While I have no immediate plans to make the source code public, over the next few weeks I will be writing blog posts diving into each of the main components. If you're curious, please follow me on ",Object(sd.jsx)("a",{className:"about-link",href:"https://twitter.com/anslogen",children:"Twitter"})," or ",Object(sd.jsx)("a",{className:"about-link",href:"https://anslo.medium.com/",children:"Medium"})," to be notified of new posts.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),Object(sd.jsx)("div",{className:"splash-about-blog-list",children:ad.map(((e,t)=>Object(sd.jsx)(rd,{title:e.title,link:e.link},t)))})]})}),Object(sd.jsx)("div",{className:"splash-topo-divider",children:Object(sd.jsx)("div",{className:"splash-topo-header",children:"FAQ"})}),Object(sd.jsx)("div",{className:"about-content",children:Object(sd.jsx)("div",{className:"splash-about-text",children:nd.map(((e,t)=>Object(sd.jsx)(hd,{q:e.q,a:e.a},t)))})}),Object(sd.jsx)("div",{className:"splash-topo-divider",children:Object(sd.jsx)("div",{className:"splash-topo-header",children:"Attributions"})}),Object(sd.jsx)("div",{className:"about-content",children:Object(sd.jsxs)("div",{className:"splash-about-text",children:["Brake audio - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/Hencocor/sounds/407406/",children:"Hencocor on freesound.org"}),Object(sd.jsx)("br",{}),"Ambient audio - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/InspectorJ/sounds/401543/",children:"InspectorJ on freesound.org"}),Object(sd.jsx)("br",{}),"Tyre audio - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/fractanimal/sounds/614627/",children:"fractanimal on freesound.org"}),Object(sd.jsx)("br",{}),"Gravel audio - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/seth-m/sounds/341069/",children:"seth-m on freesound.org"}),Object(sd.jsx)("br",{}),"Boost audio - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/YleArkisto/sounds/342892/",children:"YleArkisto on freesound.org"}),Object(sd.jsx)("br",{}),"Suspension audio - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/ingudios/sounds/119468/",children:"ingudios on freesound.org"}),Object(sd.jsx)("br",{}),"Collision sounds - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/jakobthiesen/sounds/174836/",children:"jakobthiesen on freesound.org"}),Object(sd.jsx)("br",{}),"Collision sounds - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/jakobthiesen/sounds/174837/",children:"jakobthiesen on freesound.org"}),Object(sd.jsx)("br",{}),"Collision sounds - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/SubwaySandwitch420/sounds/538947/",children:"SubwaySandwitch420 on freesound.org"}),Object(sd.jsx)("br",{}),"Barrier scrape sound - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/eyenorth/sounds/464846/",children:"eyenorth on freesound.org"}),Object(sd.jsx)("br",{}),"Misc sound effects - ",Object(sd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/HECKFRICKER/sounds/625312/",children:"HECKFRICKER on freesound.org"}),Object(sd.jsx)("br",{})]})})]}),null==Qh.value?Object(sd.jsx)("div",{id:"splash-distance",className:"splash-footer",children:"thank you for playing"}):Object(sd.jsxs)("div",{id:"splash-distance",className:"splash-footer",children:["thank you for over ",Math.floor(Qh.value/1e3)," kilometres travelled"]})]})]}),pd=(i(47),i.p+"static/media/lock_open.2037b97e.svg"),ud=i.p+"static/media/lock_closed.2c30efba.svg",gd=i.p+"static/media/refresh.56c65653.svg";const md=["mph","kmph"],xd=["miles","km"],vd=[.44704,.277778],wd=[60*vd[0],100*vd[1]],fd=({conversion:e,cruiseDefault:t})=>{const[i,n]=Object(s.useState)(Fh.value),[a,r]=Object(s.useState)(t),[h,o]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{null!=i&&r(i)}),[r,i]),Object(s.useEffect)((()=>(Fh.addListener(n),()=>{Fh.removeListener(n)})),[n]),Object(sd.jsxs)("div",{id:"ui-cruise-controls",children:[Object(sd.jsx)("img",{id:"ui-cruise-toggle",title:"Toggle cruise control",alt:"",src:null===i?pd:ud,onMouseDown:()=>{Fh.set(null==Fh.value?a:null)},onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)}),null!==i&&Object(sd.jsxs)("div",{id:"ui-cruise-select",children:[Object(sd.jsx)("div",{className:"ui-cruise-arrow",onMouseDown:()=>{Fh.inc5()},children:"\u25b4"}),Object(sd.jsx)("div",{id:"ui-cruise-value",children:Math.round(i/e)}),Object(sd.jsx)("div",{className:"ui-cruise-arrow",onMouseDown:()=>{Fh.dec5()},children:"\u25be"})]}),null==i&&h&&Object(sd.jsx)("div",{id:"ui-cruise-label",children:"Cruise control"})]})};var bd=()=>{const[e,t]=Object(s.useState)(f.Units),[i,n]=Object(s.useState)(!1);return Object(s.useEffect)((()=>(f.addListener(v.Units,t),()=>{f.removeListener(v.Units,t)})),[]),Object(sd.jsxs)("div",{id:"main-stats",children:[Object(sd.jsxs)("div",{id:"ui-dist",className:"ui-stat",children:[Object(sd.jsx)("span",{id:"ui-dist-val",className:"ui-stat-val",children:"0"}),Object(sd.jsx)("div",{className:"ui-stat-unit",onMouseDown:()=>f.set(v.Units,(e+1)%2),children:xd[e]}),Object(sd.jsxs)("div",{id:"ui-dist-reset",children:[Object(sd.jsx)("img",{id:"ui-dist-reset-icon",alt:"",src:gd,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:()=>{wh.revertProgress(),window.localStorage.setItem("reloading",!0),window.location.reload()}}),i&&Object(sd.jsx)("div",{id:"ui-dist-reset-warning",children:"Reset distance (page will reload)"})]})]}),Object(sd.jsx)("div",{className:"ui-stat-spacer"}),Object(sd.jsxs)("div",{id:"ui-speed",className:"ui-stat",children:[Object(sd.jsx)("span",{id:"ui-speed-val",className:"ui-stat-val",children:"0"}),Object(sd.jsx)("div",{className:"ui-stat-unit",onMouseDown:()=>f.set(v.Units,(e+1)%2),children:md[e]}),Object(sd.jsx)(fd,{conversion:vd[e],cruiseDefault:wd[e]})]})]})},Ad=(i(21),i.p+"static/media/globe.0021026f.svg"),yd=i.p+"static/media/config.fa1e0797.svg",Id=i.p+"static/media/v_config_1.45a9fb9a.svg",Dd=i.p+"static/media/w_clear.e325f7bb.svg",Nd=i.p+"static/media/w_sunset.6daecb38.svg",Md=i.p+"static/media/w_sunrise.d42cfd8c.svg",Cd=i.p+"static/media/w_cloud.126a5129.svg",jd=i.p+"static/media/w_night.c1e24675.svg",kd=i.p+"static/media/cycle_timer.e67c5684.svg",zd=i.p+"static/media/s_winter.a14698ea.svg",Sd=i.p+"static/media/s_spring.9771ab1e.svg",Od=i.p+"static/media/s_summer.eea0686a.svg",Ld=i.p+"static/media/s_autumn.76993205.svg",Rd=i.p+"static/media/mars.4b77b21a.svg",Td=i.p+"static/media/s_moon.ef286549.svg",Pd=i.p+"static/media/venus.7fd51f92.svg",Gd=i.p+"static/media/panorama.568dc952.svg",Bd=i.p+"static/media/feedback2.24052523.svg",Wd=i.p+"static/media/controls.0048d852.svg",Ed=i.p+"static/media/controls_mouse_icon.0ab0135a.svg",Zd=i.p+"static/media/favicon_circle_white.eb1953e3.svg",Fd=(i.p,i.p,i.p+"static/media/ico_kofi.0dd3be2c.svg"),Hd=(i.p,i.p+"static/media/controls_mouse_buttons.1f93e888.svg"),Qd=i.p+"static/media/loc_hills_lines.39f0c4cc.png",Yd=i.p+"static/media/loc_offworld.5e298b5e.png",Vd=(i(48),i.p+"static/media/vol_high.30de055e.svg"),Ud=i.p+"static/media/vol_off.11497865.svg";const Xd=({container:e,level:t,setLevel:i,dragging:n,setDragging:a})=>{const r=Object(s.useCallback)((t=>{if(e.current){let s=e.current.getBoundingClientRect();i(Math.min(Math.max(0,(s.bottom-t.clientY)/s.height),1))}t.stopPropagation()}),[e,i]),h=Object(s.useCallback)((()=>{a(!1)}),[a]);return Object(s.useEffect)((()=>(n?(window.addEventListener("mousemove",r),window.addEventListener("mouseup",h)):(window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",h)),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",h)})),[r,h,n]),Object(sd.jsx)("div",{id:"slider-handle",style:{top:100*(1-t)+"%"},onMouseDown:e=>{r(e),a(!0),e.stopPropagation()}})};var Jd=()=>{const[e,t]=Object(s.useState)(f.AudioLevel),[i,n]=Object(s.useState)(e>0),[a,r]=Object(s.useState)(.5),[h,o]=Object(s.useState)(!1),l=Object(s.useRef)(null);return Object(s.useEffect)((()=>{n(e<=0)}),[n,e]),Object(s.useEffect)((()=>{f.set(v.AudioLevel,e)}),[e]),Object(s.useEffect)((()=>(f.addListener(v.AudioLevel,t),()=>{f.removeListener(v.AudioLevel,t)})),[t]),Object(sd.jsx)(xc,{icon:i?Ud:Vd,expanded:!!h,onMouseDown:s=>{i?t(0==a?.5:a):(r(e),t(0)),s.stopPropagation()},children:Object(sd.jsx)("div",{id:"slider-container",ref:l,children:Object(sd.jsx)("div",{id:"slider-line",onMouseDown:e=>{let i=e.target.getBoundingClientRect();t((i.bottom-e.clientY)/i.height),o(!0),e.stopPropagation()},children:Object(sd.jsx)(Xd,{level:e,setLevel:t,dragging:h,setDragging:o,container:l})})})})};const qd=[Wd,Ed],Kd={clearSnow:Dd,clearSpring:Dd,clearAutumn:Dd,sunset:Nd,twilight:Nd,autumnSunset:Nd,winterSunset:Nd,autumnSunrise:Md,winterSunrise:Md,springSunrise:Md,sunrise:Md,clear:Dd,rain:Cd,autumnRain:Cd,springRain:Cd,snow:Cd,mars:Dd,venus:Cd,night:jd,marsRise:Nd,venusSet:Nd,moon:Dd},_d={spring:Sd,summer:Od,autumn:Ld,winter:zd,mars:Rd,venus:Pd,moon:Td},$d=n.a.memo((({toggleSplash:e})=>Object(sd.jsx)(sd.Fragment,{children:Object(sd.jsxs)("div",{id:"menu-bar",onMouseEnter:()=>{p.setMouseEnabled(!1)},onMouseLeave:()=>{p.setMouseEnabled(!0)},children:[Object(sd.jsx)(ec,{}),Object(sd.jsx)(dc,{toggleSplash:e})]})}))),ec=()=>Object(sd.jsxs)("div",{id:"menu-bar-left",children:[Object(sd.jsx)(tc,{}),Object(sd.jsx)("div",{className:"menu-bar-vertical-divider"}),Object(sd.jsx)(oc,{}),Object(sd.jsx)(lc,{})]}),tc=()=>{const[e,t]=Object(s.useState)(!1),[i,n]=Object(s.useState)(Ve),[a,r]=Object(s.useState)(wh.value.sceneName),[h,o]=Object(s.useState)(wh.value.topography),[l,d]=Object(s.useState)(!1),[c,p]=Object(s.useState)(!1),[u,g]=Object(s.useState)(!1),[m,x]=Object(s.useState)(Ve),[v,w]=Object(s.useState)(wh.value.sceneName),[f,b]=Object(s.useState)(wh.value.topography),[A,y]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{t(l||c||u)}),[t,l,c,u]),Object(s.useEffect)((()=>{d(m!==i)}),[d,m,i]),Object(s.useEffect)((()=>{p(v!==a)}),[p,v,a]),Object(s.useEffect)((()=>{g(f!==h)}),[g,f,h]),Object(sd.jsx)(sd.Fragment,{children:Object(sd.jsxs)("div",{className:"menu-item",tabIndex:-1,onMouseEnter:()=>{y(!0)},onMouseLeave:()=>{y(!1)},children:[Object(sd.jsx)(ac,{src:Ad}),A&&Object(sd.jsxs)("div",{className:"menu-panel",children:[Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",style:{color:c?"#fff":"",textShadow:c?"0px 0px 5px #fff":""},children:"scene"}),Object(sd.jsx)(sc,{options:["HILLS","OFF-WORLD"],bgs:[Qd,Yd],selectedIndex:uh.indexOf(v),onSelectIndex:e=>{e<2&&w(uh[e])}}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",style:{color:u?"#fff":"",textShadow:u?"0px 0px 5px #fff":""},children:"road complexity"}),Object(sd.jsx)(sc,{options:["CASUAL","NORMAL","HARD"],bgs:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIyLTA3LTIwVDIyOjI1OjI3KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNy0yMFQyMjoyNToyNyswMTowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiMDMwZWJhNi0zM2ExLTczNGEtOWVmYS1mNWNiZTYxOGUwNmUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1NWZiMTAyYi03OTQxLWIxNGQtYWMzYi1hOGQwN2QzNjRhOTkiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ3ZGJkYzVmLTY5NzAtZjI0ZC04ZWNiLWRjZTQ0NDU1Y2YxOCIgc3RFdnQ6d2hlbj0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YmUwMzA0Ni0yYjU5LWQ3NDUtOTE1Mi00YTIzMmNiMWIyNDciIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YjAzMGViYTYtMzNhMS03MzRhLTllZmEtZjVjYmU2MThlMDZlIiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDIyOjI1OjI3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+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","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIyLTA3LTIwVDIyOjI0OjE5KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNy0yMFQyMjoyNDoxOSswMTowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkOGQzZTNhOC1lZTRkLWRmNDYtOTc0MS00YThkOGZmNDVmYjYiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2MDk3Y2Y0Zi01MzRhLTA5NGMtYjg1MS03NDAzODQ1NjM5YjciIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ3ZGJkYzVmLTY5NzAtZjI0ZC04ZWNiLWRjZTQ0NDU1Y2YxOCIgc3RFdnQ6d2hlbj0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YmUwMzA0Ni0yYjU5LWQ3NDUtOTE1Mi00YTIzMmNiMWIyNDciIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZDhkM2UzYTgtZWU0ZC1kZjQ2LTk3NDEtNGE4ZDhmZjQ1ZmI2IiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDIyOjI0OjE5KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+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","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIyLTA3LTIwVDIyOjIzOjI2KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNy0yMFQyMjoyMzoyNiswMTowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmMjI5ZmVhYS1kM2Q5LTI3NDktOTMxYy1hOTcxZmNiNGUwMzkiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDowMWQxODExZC1hNjczLTc5NDctOGU1ZS0yYTc5OWE4MjVlMzUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ3ZGJkYzVmLTY5NzAtZjI0ZC04ZWNiLWRjZTQ0NDU1Y2YxOCIgc3RFdnQ6d2hlbj0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YmUwMzA0Ni0yYjU5LWQ3NDUtOTE1Mi00YTIzMmNiMWIyNDciIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZjIyOWZlYWEtZDNkOS0yNzQ5LTkzMWMtYTk3MWZjYjRlMDM5IiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDIyOjIzOjI2KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Ac/3CQAADNNJREFUeNrtXdmS27oOtBavsizLsrb7//+J+wLUMDoWSZCg9gdWpZLJmObSbAAN4AQAp2OMjgQAngDQAsD/NKMDgAcARBPOLca5dYa5fQHgstH9iQCgHPnebcDvHeHZuAJABgAFAHwAoMH96A17IjUqnIPEuTvj/H99To3fl/17DxCxO0xXvKi6zW5muMgckDlvcG9izb44XwrHMxIDQIpn5QEAOQC8EXhqBDwCH0kAaoRA5q6Z19v1958mfnXXPC74Yug2+zPhoeaCTLVBkDlr2GW5gLMdKWznDAA3BJ8nALyQ+ZS4N0MQ4oBM7fm4RTiXX7+7xzmfXAHmiYf0ABG7A60DmR7XM5oBZHKLg7k1kNG9uq8VMONIYT8qCGU4fzK7bADH53FLNEyw9TkzJ5z86wAZFpNpNBvdwjw+D2IyewKZPMSruzAT8IyA8zXsbY/rETme6U5zXmIfgKHJvWeg92v1ydwNJsl7JsC2ZTLk+I1Wvg8fjdP9srEzl+LedgZ/jMvjkWnOTO5zTk4DBDxAxv4ivwws5jrj3GxApkE6vlaQSUNEPVYANJkBZLiAEOG9HwPqm8+cTz9oVnGYS9YH/GtgMdHCQaZdsQ/uESLqsYHH7csEV53/pcFzLgYwqi13gIwZ+XWHvJ2ZptNBNIEMMdd0ZWtfbtz/4sreOiZ7vmgicR9foD4tSDi2ViFeJUhXQzEZUwibXr5boIdFeg10l2JuYJ8KYHUs5sn4XTfN+Sh853pamHDstDGqvgRfgK1Ohh6WwsMBHCmRDwq3PhHkaGT4b2f82cjxcvWaV3cP7PsmFKLXnd9nSICZSzi2Rhbz1dD1+4LMucZSuNWi2XRHOh4PdBvRiG6jxLXQSeZ7/LcGz9cTAS1mXKx2x+aRDYvj+KAyzT6JAIxJOPZaqakUaYb05+SaNSwWsn62KQ/D/W/wjJTK8FWeDj+jxd97R+CKNPOvDYrWdCcAo8sd4gCMjsF4n10b4Zh3qGqiy5MM8kAKXGi6FG/8uxx/5iJIpXVCpaWFTFNci6kS8rhg88U9uuFciSnlhqTTHl/jaEcAI8Fgrpqz66qr+U8ukkk4Vi3QVIrwyz9wQWvGa0qv5gcPZep5MGMNE1wiQMeWWeJzDjKjGpynjUJ5T+b81eCcjRgPTm1wk3ilCtiENOfKsRnzedwQVBqBl5jMgNyTXj9XYCb9Mjk+C2UznNGugGVPGVzIBSNSxMIfGvPVqlxDavDHzB3+S/BLVpYREVd6fnc0ndZkJg3XNcM59gHWtFccu32Az+h2ZhqFyH42uUnU+/HCO3JWAOdX4mYKAJdftEtHm0uYpxzBHYGln4iauwgNdZqYpUc3KNclw+/QMte6V8zOGllRgazugft3h79SBW8hQCNw2Zso1JT9fHHY/4yxH+peV7jfH/zzF/++AYB2LCLSL8CRRhS+DMRYTAvoAjK5wZZdw0WI8YCqldro0ND44t+/8UV7IoBcLGk0Adod99fFF1Tj/9+jGPRmyH5OHPe9kH7EXXJsmsCJfOS8LTyAhSh5O3AUckKqLmpmnTZhDdG4sVC/SnsTR4GcCdByPHed4YFrENTOOwWXWJMm8T9PWUkiDTK6Qj4dTFuCkV61J0MQNjx4HyUMfcU5pjjOShjb1kHMDdOZNv8QLtpJDZ7wV+2tVJjSY8fAYsNeOoHH37YOtRfAxBonkgoyErVAI8XR+GWiZ/cj1BwxWFJusZDcCJDuACwpGrc2seSxHubcNykznNwTb1/3hE98XE33T8DPsegCLG+B5DwbdSu3ZGAC44WQ5q4Vc4z1l2noNXfiHuAzr/i5JvOVDTA2Ajw1fGUjWFNp8MshkkDAchV2mOrCdOTYlqKxW67yf4z5Ck2FDCIM27S8FJU8RY8qJaJEpm0hVbhI9YOUStbsQ8mopWS42oF29TjxkOUEdGE6bgEjGxOzgvWXrTzGMsBlDlYc2QzJwkVjAisfcRWxo8cEztFEw2JcCu+cLUxMKT/WMbZrFplKbfgU+w4+OF80mzh3pcHFTWE63c0XZCur3yzWrN2pWOwY5hwhm5DxoiOTp4Hc13QBb8BL93fNK5lD5xAHAJgI7FqJ9Gg+Xg+gOVgL457VS/flnX5Iu68a1hApyCrJZkh6XMzol9CJ5Hy6BHJMzFaJjh16mf0BCyc03KzBvD6NKGBr/KKPEbBRF4ObtzL8rC8C25wCKlOKxEvg8LwYzu0OWVN2CMt2w1jejEe7Xovv7gR2kaHXCLOg+qtP+Gtz2Y04edUEqVJhS8kCFio1hKnvMI3DbozZSWh+jrGcqBClRzyBXx1gVYGBE/B8I2+NCRPjRVUbfNPImMlwU6sjS5imDCNpi2pwyxz+HECzSjBJFQ1JoYjWuIy/XJt+6gTuTth0A9Sdykfqvq90CDBCoHXNEiex4WE6LSeVIcE9pQLouaL7qkBfBN32zuVr9MudwL84U7TCQ5Hg3L8Wtm4akDn51LnZc7mCOf0lxNIpIfMDcgXQxwSmq9VKnQYIO1VxJimQuOAly36YZGqhI5diR1PVvqFKfR+HPehgva1f12TiXEf8jKGLnz9g5dHEX6j8YUaGpmo9Sg7lDP7677Qah7JPqUb6TvHEr+MVX8WGuf7FEdYOUnRLdcJOVU2xAsf6t2tR8qqRIU6W8ycQyFAYr/QIiXNHCfP11yGtEYfVEMgcTEauTMFUqvUeGXWxRQe+jRnyYACNJMj4OkNdN/u9IDZA4PqxNOmOWjPzVVF0aWb3gr/+T5vctxBVriQu6Bx9e5bsqU8sc8H22L5Dam0bYRDp4HcRdJ++3JsFGJVRVGBXMNt18abuPNiuJA/ItvVrNZN5p/arvuBcr/jndIEXSmXIPkp0tbUuFUB/KEBim+u3e4DhAIDrS5o4gsuYg9d0KPIVJhieQV8xbypTSe0MkMO/je/bwaiVS0g1k88zrrur4LEbKNFvCwXPVQMMAYEplZybRs5JClSLfL+U0LQ6norgKYe/IlhboKhnA5OZQr/zBvfOmmrr3qkjJgmehQ54TtjN+0uWBDAq29Ch/Y3xotg0fiK5/F15Ofa6ebpaMyEavamdNaXFZFNoPrgmUb+1kPHaAIbMJd1LWlhuzNXCyfY98nD+c2FeBmd7BHK+n9A9rEm1GqJcB9ckqvHBCw14w7Gm9AibEUu9pJ0HVTf1Eppbl7J0U6nVAHIiZE5MXcnwIfiQpAyTqMNHUTrPK1L0ZXclzeCtjELxT11mNOHV5MzHwNXwwnmqcy8H4582slITqsC9GLGpAv/RrEx/cD8g027l18UsYbpo3vCivzz3nTREtiadNLCp+hqOQp78U1QPaCqfD5nAJfy37EqQvkicUYBbr5bY4MdZfEnABQBM4QHuUtE8uhRfPKDF4KVTEwL7wCYT+VpsK8ORr0XSNKM5FJ7qc9U/FbIlySWUCTw3wJxBX+jpcYDI5ABjqu431llTpfW/BiWnZsBreN8o/pDIoMG5Aq+cK5lEkuZ3GsCsDJnUaopIzg4wPibSQ3OQKzgcuj5r3ziyv6vF5fBtgBc7sAzK18lGMuS5RZykTaKIaZK5gIx0eQ6TBbEIgDE5eXV29AvkuinucVyEnbw2DvdKMJoX46VpgC+qdM1wDmESTdXW5yvMti6h5zxnmDrSHOYWv/wBIm7mEUciMGQv3cTRvKA+gAnyzWxEp7pcJVI+2wCmtNvgyQT0TlFnN8qoEQe+8G8L2c+cQjtdBKQ+zCMrXUcHcoXKTYAVOscpAV7nhbkrw5E+qAJ+WYYM/+8Z1/QMfzV7TaUiSqG7ERnYaqWEze94lym37KLMPcW9S3Be//jhfCihyRFoWogDYPyobW2g0okDGw3dWcHmXD0EM5tDqYRjRgZ2rwj3bELOkYC2TMJ/J/KYuCKfRDNuk4l0hKfdvP6u/qtsIQ53tTaLa4hX7SslLfOnxoMdwyTjallM+qar0PeoQa4XuxjAmPotc7J5dU7exTb0ntEsuliEFF2EibrXbK5CVsOyle2I8EuXIS+txuWYRDXeFdc5vAKzSZ1EpJwLYFKLA86pZXvXvFCt5wZtsZTj1+LFvDo+Gp1wuDsE2NwV6XquZNGHzpDnRInI3+O7ZmM9zaUirDqAmYXBmJLrXByBZ4Md2xwgY+2X6PDnIgfwegtHo7ZW8c7W+dwJRqkyDcA8hb7XV3PvkqkBxpQzVDuElm1Ai/JS9thozPZw9x5Kz4vm93NKbmxxcKorSvepCg0wOs2TmFOfc9ArCFML9myZRk+lLbOZs02n9LfYqEJ7BKFY+JARVd5rNM9UOXDY0lVat6VTuT+FPuMZeu8lvqyvE5A0HbaKQjXbVNUUbKX2KafAum/ju5uwlmZLHQYqsM8RCpHtr7tz+QRK3k4iWvV/bKfRliNnGlIAAAAASUVORK5CYII="],selectedIndex:gh.indexOf(f),onSelectIndex:e=>b(gh[e])}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",style:{color:l?"#fff":"",textShadow:l?"0px 0px 5px #fff":""},children:"generation seed"}),Object(sd.jsx)(ic,{curValue:m,onChanged:x}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:e&&Object(sd.jsx)("div",{className:"menu-apply-arrows arrows-down",children:"\u25be \u25be \u25be"})}),Object(sd.jsx)("div",{className:"menu-panel-row menu-apply-row",children:Object(sd.jsx)("div",{id:"menu-apply",className:e?"menu-panel-button":"menu-panel-button-inactive",onMouseDown:()=>{e&&(l?(qe(m),wh.set("topography",f,!0),wh.set("sceneName",v,!0),wh.set("seed",m)):c?(wh.set("topography",f,!0),wh.set("sceneName",v)):wh.set("topography",f),n(Ve),o(f),r(v))},children:"apply changes"})}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:e&&Object(sd.jsx)("div",{className:"menu-apply-arrows arrows-up",children:"\u25b4 \u25b4 \u25b4"})})]})]})})},ic=({curValue:e,onChanged:t})=>{const[i,n]=Object(s.useState)(e),[a,r]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{r(!Ke(i))}),[r,i]),Object(s.useEffect)((()=>{a&&t(i)}),[a,t,i]),Object(s.useEffect)((()=>()=>{p.unlockKeys()}),[]),Object(sd.jsx)("div",{className:"menu-panel-row",children:Object(sd.jsx)("input",{className:a||0==i.length?"seed-input":"seed-input seed-invalid",tabIndex:1,placeholder:"seed",value:i,maxLength:32,onChange:e=>n(e.target.value),onKeyDown:e=>{13==e.which&&e.target.blur()},onFocus:()=>{p.lockKeys()},onBlur:()=>{a||n(Ve),p.unlockKeys()}})})},sc=({options:e,bgs:t,selectedIndex:i,onSelectIndex:n})=>{const[a,r]=Object(s.useState)(!1);return Object(sd.jsxs)("div",{className:"menu-panel-row",style:t?{backgroundImage:"url("+t[i]+")"}:{},onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[Object(sd.jsxs)("div",{className:"",children:[e[i],Object(sd.jsx)("div",{className:"menu-panel-row-expand",style:{opacity:a?1:.75},children:"\u25b8"})]}),a&&Object(sd.jsxs)("div",{className:"menu-panel-option-list",style:{transform:"translateY(-"+(31*e.length-31)+"px)"},children:[e.map(((e,i)=>Object(sd.jsx)("div",{className:"menu-panel-option-list-row",style:t?{backgroundImage:"url("+t[i]+")"}:{},onClick:()=>n(i),children:e},"option-"+e))),Object(sd.jsx)("div",{className:"panel-expander"})]})]})},nc=({options:e,selectedIndex:t,onSelectIndex:i})=>Object(sd.jsx)("div",{className:"menu-panel-row",children:e.map(((e,s)=>Object(sd.jsx)("div",{className:t==s?"menu-panel-choice-option choice-selected":"menu-panel-choice-option",onClick:()=>i(s),children:e},"option-"+e)))}),ac=({src:e,text:t,onMouseDown:i,highlight:s})=>t?Object(sd.jsx)("div",{className:s?"menu-icon-text highlight":"menu-icon-text",onMouseDown:i,children:t}):Object(sd.jsx)("img",{className:s?"menu-icon highlight":"menu-icon",src:e,alt:"",width:"50%",onMouseDown:i}),rc=()=>{const[e,t]=Object(s.useState)(Ui.value);return Object(s.useEffect)((()=>(Ui.addListener(t),()=>{Ui.removeListener(t)})),[t]),Object(sd.jsx)("div",{style:{borderTop:"1px solid #fff4"},children:Object(sd.jsxs)(wc,{selected:!1,icon:kd,label:"cycle timer",children:[Object(sd.jsx)(bc,{selected:0==e,text:"off",onMouseDown:()=>Ui.set(0)}),Object(sd.jsx)(bc,{selected:1==e,text:"3m",onMouseDown:()=>Ui.set(1)}),Object(sd.jsx)(bc,{selected:2==e,text:"8m",onMouseDown:()=>Ui.set(2)}),Object(sd.jsx)(bc,{selected:3==e,text:"15m",onMouseDown:()=>Ui.set(3)})]})})},hc=({canSelect:e,configKey:t,configVal:i,icon:n,onMouseDown:a})=>{const[r,h]=Object(s.useState)(wh.value[t]);return Object(s.useEffect)((()=>(wh.addListener(t,h),()=>{wh.removeListener(t,h)})),[t]),Object(sd.jsx)(bc,{selected:r==i&&e,icon:n,onMouseDown:a})},oc=()=>{const[e,t]=Object(s.useState)(wh.sceneMeta.scenes[wh.sceneMeta.current]),[i,n]=Object(s.useState)(wh.value.skin),a=Object(s.useCallback)((()=>{t(wh.sceneMeta.scenes[wh.value.sceneName]),n("default")}),[t]);Object(s.useEffect)((()=>(wh.addListener("sceneName",a),()=>{wh.removeListener("sceneName",a)})),[a]),Object(s.useEffect)((()=>(wh.addListener("skin",n),()=>{wh.removeListener("skin",n)})),[n]),Object(s.useEffect)((()=>(wh.addListener("seed",a),()=>{wh.removeListener("seed",a)})),[a]);const r=Object(s.useCallback)(((t,i)=>{wh.set("skin",e.skins[t]),wh.set("weatherIndex",i)}),[e]),h=Object(s.useCallback)((t=>{wh.set("skin",e.skins[t]),console.log("Skin index ",t),wh.set("weatherIndex",0)}),[e]);let o=e.skins,l=e.skinNames,d=e.skinWeathers;return Object(sd.jsxs)(xc,{icon:Gd,children:[o.length&&o.map(((e,t)=>Object(sd.jsx)(wc,{selected:e==i,icon:_d[l[e]],label:l[e],onMouseDown:()=>h(t),children:d[e].map(((s,n)=>Object(sd.jsx)(hc,{canSelect:e==i,configKey:"weatherIndex",configVal:n,icon:Kd[s],onMouseDown:()=>r(t,n)},n)))},e))),e.hasCycles&&Object(sd.jsx)(rc,{}),Object(sd.jsx)("div",{className:"stack-back",style:{width:"200px"}})]})},lc=()=>{const[e,t]=Object(s.useState)(Rh.value.type);return Object(s.useEffect)((()=>(Rh.addListener("type",t),()=>{Rh.removeListener("type",t)})),[]),Object(sd.jsxs)(xc,{icon:Id,children:[Object.keys(Ch).map((t=>Object(sd.jsx)(wc,{selected:t==e,icon:Ch[t].icon,label:t.toLowerCase(),onMouseDown:()=>Rh.set("type",t)},"veh-type-"+t))),Object(sd.jsx)("div",{className:"stack-back",style:{width:"200px"}})]})},dc=({toggleSplash:e})=>Object(sd.jsxs)("div",{id:"menu-bar-right",children:[Object(sd.jsx)(uc,{}),Object(sd.jsx)(gc,{}),Object(sd.jsx)(Jd,{}),Object(sd.jsx)(pc,{}),Object(sd.jsx)(cc,{}),Object(sd.jsx)("div",{className:"menu-bar-vertical-divider"}),Object(sd.jsx)(mc,{toggleSplash:e})]}),cc=()=>{const[e,t]=Object(s.useState)(!1),[i,n]=Object(s.useState)(wh.value.viewLodIndex),[a,r]=Object(s.useState)(wh.value.detailLodIndex),[h,o]=Object(s.useState)(wh.value.renderScale),[l,d]=Object(s.useState)(Rh.value.mode),[c,p]=Object(s.useState)(f.value[v.DoubleTap]),[u,g]=Object(s.useState)(f.value[v.Units]),[m,x]=Object(s.useState)(f.value[v.AutoPause]),[w,b]=Object(s.useState)(Xl.value);return Object(s.useEffect)((()=>(Xl.addListener(b),()=>{Xl.removeListener(b)})),[b]),Object(s.useEffect)((()=>(wh.addListener("viewLodIndex",n),()=>{wh.removeListener("viewLodIndex",n)})),[n]),Object(s.useEffect)((()=>(wh.addListener("detailLodIndex",r),()=>{wh.removeListener("detailLodIndex",r)})),[r]),Object(s.useEffect)((()=>(wh.addListener("renderScale",o),()=>{wh.removeListener("renderScale",o)})),[r]),Object(s.useEffect)((()=>(Rh.addListener("mode",d),()=>{Rh.removeListener("mode",d)})),[d]),Object(s.useEffect)((()=>(f.addListener(v.Units,g),()=>{f.removeListener(v.Units,g)})),[g]),Object(s.useEffect)((()=>(f.addListener(v.AutoPause,x),()=>{f.removeListener(v.AutoPause,x)})),[x]),Object(s.useEffect)((()=>(f.addListener(v.DoubleTap,p),()=>{f.removeListener(v.DoubleTap,p)})),[p]),Object(sd.jsxs)(sd.Fragment,{children:[Object(sd.jsxs)("div",{className:"menu-item",style:{backgroundColor:w?"#222":""},tabIndex:-1,onMouseEnter:()=>{Xl.set(!1),t(!0)},onMouseLeave:()=>{t(!1)},children:[Object(sd.jsx)(ac,{src:yd}),e&&Object(sd.jsxs)("div",{className:"menu-panel",style:{right:"-51px",overflowY:"auto"},children:[Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:"drive mode"}),Object(sd.jsx)(nc,{options:["awd","fwd","rwd"],selectedIndex:l,onSelectIndex:e=>Rh.set("mode",e)}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:"units"}),Object(sd.jsx)(nc,{options:["miles","kilometres"],selectedIndex:u,onSelectIndex:e=>f.set(v.Units,e)}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:"double-tap to boost"}),Object(sd.jsx)(nc,{options:["on","off"],selectedIndex:c,onSelectIndex:e=>f.set(v.DoubleTap,e)}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:"pause when inactive"}),Object(sd.jsx)(nc,{options:["on","off"],selectedIndex:m,onSelectIndex:e=>f.set(v.AutoPause,e)}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:"view distance"}),Object(sd.jsx)(nc,{options:["low","med","high","ultra"],selectedIndex:i,onSelectIndex:e=>wh.set("viewLodIndex",e)}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:"environment detail"}),Object(sd.jsx)(nc,{options:["low","med","high","ultra"],selectedIndex:a,onSelectIndex:e=>wh.set("detailLodIndex",e)}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:"render scale"}),Object(sd.jsx)(nc,{options:["0.5","0.75","1.0","1.5"],selectedIndex:h,onSelectIndex:e=>wh.set("renderScale",e)}),Object(sd.jsx)("div",{className:"menu-panel-row menu-panel-title"})]})]}),w&&Object(sd.jsxs)("div",{id:"fps-prompt",children:[Object(sd.jsx)("span",{style:{fontSize:"18px",fontWeight:1e3},children:"Low FPS?"}),Object(sd.jsx)("br",{}),"Try lowering the quality settings",Object(sd.jsx)("br",{})," or enabling hardware acceleration",Object(sd.jsx)("br",{}),Object(sd.jsx)("span",{style:{paddingLeft:"calc(100% - 50px)"},children:"\u2193"})]})]})},pc=()=>{const[e,t]=Object(s.useState)(!1),[i,n]=Object(s.useState)(""),[a,r]=Object(s.useState)(!1),[h,o]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{e||r(!1)}),[r,e]),Object(s.useEffect)((()=>()=>{p.setMouseEnabled(!0),p.unlockKeys()}),[]),Object(s.useEffect)((()=>{e&&(o(!1),window.localStorage.setItem("feedback-seen",!0)),e&&!a||(p.setMouseEnabled(!0),p.unlockKeys())}),[e,a]),Object(sd.jsxs)(sd.Fragment,{children:[h&&Object(sd.jsx)("div",{className:"feedback-prompt",children:"Any thoughts so far?"}),e&&Object(sd.jsxs)("div",{className:"feedback-main",onMouseEnter:e=>{t(!0)},onMouseLeave:e=>{t(!1)},children:[Object(sd.jsxs)("div",{className:"feedback-header",children:[Object(sd.jsx)("div",{className:"feedback-title",children:"Feedback"}),Object(sd.jsx)("div",{className:"feedback-close",onMouseDown:e=>{t(!1),e.preventDefault()},children:"close"})]}),Object(sd.jsxs)("div",{className:"feedback-blurb",children:["Please share any thoughts, complaints, or ideas for features below.",Object(sd.jsx)("br",{}),"You can also join the ",Object(sd.jsx)("a",{className:"feedback-link",href:"https://discord.gg/s8XPAAj",children:"discord"})," to talk to me directly."]}),a?Object(sd.jsx)("div",{className:"feedback-input feedback-sent",children:"Thanks!"}):Object(sd.jsxs)(sd.Fragment,{children:[Object(sd.jsx)("textarea",{className:"feedback-input",type:"text",maxLength:"500",placeholder:"Max 500 characters",value:i,onChange:e=>n(e.target.value),onFocus:()=>{p.lockKeys()},onBlur:()=>{p.unlockKeys()}}),Object(sd.jsx)("div",{className:"feedback-send",onMouseDown:e=>{i.length&&!a&&(no.sendFeedback(i),n(""),r(!0),window.localStorage.setItem("feedback-seen",!0)),e.preventDefault()},children:"Send"})]})]}),Object(sd.jsx)("div",{className:e?"menu-item item-selected":h?"menu-item highlight":"menu-item",style:{padding:"0px 12px",width:"auto",textAlign:"right",display:"flex"},onMouseEnter:e=>{t(!0),e.preventDefault()},onMouseLeave:e=>{t(!1),e.preventDefault()},children:Object(sd.jsx)("img",{alt:"",style:{height:"50%",marginTop:"25px",marginRight:"4px",transform:"translateY(-50%)"},src:Bd})})]})},uc=()=>Object(sd.jsxs)("a",{href:"https://ko-fi.com/slowroads",target:"_blank",rel:"noreferrer",title:"Support development on Ko-fi!",className:"menu-item",style:{padding:"0px 12px",width:"auto",textAlign:"right",display:"flex"},children:[Object(sd.jsx)("img",{alt:"",style:{height:"50%",marginTop:"25px",marginRight:"8px",transform:"translateY(-50%)"},src:Fd}),Object(sd.jsx)("div",{style:{fontSize:"14px",color:"#fff"},children:"donate"})]}),gc=()=>{const[e,t]=Object(s.useState)(Rh.value.input),[i,n]=Object(s.useState)(1);return Object(s.useEffect)((()=>(Rh.addListener("input",t),()=>{Rh.removeListener("input",t)})),[t]),Object(sd.jsx)(sd.Fragment,{children:Object(sd.jsxs)(xc,{icon:qd[e],children:[Object(sd.jsx)(wc,{selected:1==e,icon:Ed,label:"mouse",onMouseDown:()=>{Rh.set("input",1)},onMouseEnter:()=>n(2),onMouseLeave:()=>n(0)}),Object(sd.jsx)(wc,{selected:0==e,icon:Wd,label:"keyboard",onMouseDown:()=>{Rh.set("input",0)},onMouseEnter:()=>n(1),onMouseLeave:()=>n(0)}),i>0&&Object(sd.jsx)("div",{id:"controls-bg",children:2==i?Object(sd.jsxs)("div",{children:[Object(sd.jsxs)("div",{className:"control-panel-title",children:["Mouse Controls",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),Object(sd.jsx)("span",{style:{color:"#fff8"},children:"(first-person camera recommended)"})]}),Object(sd.jsx)("div",{className:"control-panel",children:Object(sd.jsx)("img",{className:"control-mouse-img",src:Hd,alt:""})})]}):Object(sd.jsxs)("div",{children:[Object(sd.jsx)("div",{className:"control-panel-title",children:"Keyboard Controls"}),Object(sd.jsxs)("div",{className:"control-panel",children:[Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",children:Object(sd.jsx)("div",{className:"control-key",children:"W"})}),Object(sd.jsxs)("div",{className:"control-key-row",children:[Object(sd.jsx)("div",{className:"control-key",children:"A"}),Object(sd.jsx)("div",{className:"control-key",children:"S"}),Object(sd.jsx)("div",{className:"control-key",children:"D"})]}),Object(sd.jsxs)("div",{className:"control-label",children:["drive",Object(sd.jsx)("br",{}),"(or arrow keys)"]})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"W"})}),Object(sd.jsxs)("div",{className:"control-label",children:["boost accel",Object(sd.jsx)("br",{}),"(double-tap)"]})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",style:{width:"9vh"},children:"SHIFT"})}),Object(sd.jsxs)("div",{className:"control-label",children:["boost accel",Object(sd.jsx)("br",{}),"(hold)"]})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"R"})}),Object(sd.jsx)("div",{className:"control-label",children:"reset vehicle"})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"F"})}),Object(sd.jsx)("div",{className:"control-label",children:"toggle autodrive"})]})]}),Object(sd.jsxs)("div",{className:"control-panel",children:[Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",style:{width:"18vh"},children:"SPACE"})}),Object(sd.jsx)("div",{className:"control-label",children:"handbrake"})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"C"})}),Object(sd.jsx)("div",{className:"control-label",children:"change camera"})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsxs)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:[Object(sd.jsx)("div",{className:"control-key",children:"Q"}),Object(sd.jsx)("div",{className:"control-key",children:"E"})]}),Object(sd.jsx)("div",{className:"control-label",children:"prev/next weather"})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"H"})}),Object(sd.jsx)("div",{className:"control-label",children:"toggle headlights"})]}),Object(sd.jsxs)("div",{className:"control-section",children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"U"})}),Object(sd.jsx)("div",{className:"control-label",children:"toggle UI"})]})]})]})})]})})},mc=({toggleSplash:e})=>Object(sd.jsx)(sd.Fragment,{children:Object(sd.jsx)("div",{className:"menu-item",onMouseDown:()=>e(),children:Object(sd.jsx)(ac,{src:Zd})})}),xc=e=>{const[t,i]=Object(s.useState)(e.expanded);return Object(sd.jsxs)("div",{className:e.highlight?"menu-item highlight":"menu-item",tabIndex:-1,onMouseEnter:()=>{var t;i(!0),null===(t=e.onExpanded)||void 0===t||t.call(e,!0)},onMouseLeave:()=>{var t;i(!1),null===(t=e.onExpanded)||void 0===t||t.call(e,!1)},children:[Object(sd.jsx)(ac,{src:e.icon,onMouseDown:e.onMouseDown,highlight:e.highlight}),(t||e.expanded)&&Object(sd.jsx)(vc,{children:e.children})]})},vc=e=>Object(sd.jsx)("div",{className:"menu-stack",children:e.children}),wc=e=>{const[t,i]=Object(s.useState)(e.expanded||e.pinned);return Object(s.useEffect)((()=>{i(e.pinned)}),[e.pinned]),Object(sd.jsxs)("div",{className:e.selected?"menu-item item-selected":"menu-item",onMouseEnter:()=>{var t;i(!0),null===(t=e.onMouseEnter)||void 0===t||t.call(e)},onMouseLeave:()=>{var t;i(e.pinned),null===(t=e.onMouseLeave)||void 0===t||t.call(e)},children:[Object(sd.jsx)("img",{className:"menu-icon",src:e.icon,alt:"",onMouseDown:()=>{var t;return null===(t=e.onMouseDown)||void 0===t?void 0:t.call(e)}}),t&&e.children?Object(sd.jsx)(fc,{children:e.children}):Object(sd.jsx)("div",{className:"stack-label",style:e.selected?{color:"#fff"}:{},onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:e.label})]})},fc=e=>Object(sd.jsx)("div",{className:"stack-row",children:e.children}),bc=e=>Object(sd.jsx)("div",{className:e.selected?"stack-row-item item-selected":"stack-row-item",onMouseDown:()=>{var t;return null===(t=e.onMouseDown)||void 0===t?void 0:t.call(e)},children:Object(sd.jsx)(ac,{src:e.icon,text:e.text})});var Ac=$d;i(49);const yc=16,Ic=.0625;class Dc{constructor(e,t,i,s){this.origin={x:0,z:0},this.seenIndex=0,this.loadedNode=null,this.subNode=0,this.angles=[],this.pos={x:0,y:0},this.onLoadStateBound=this.onLoadState.bind(this),this.onTickBound=this.onTick.bind(this),this.progressCounter=0,this.tickTimer=0,this.svg=e,this.lineDOM=t,this.points=this.lineDOM.points,this.underlineDOM=i,this.uPoints=this.underlineDOM.points,this.circleDOM=s,this.loadedNode=st.vehicleNode,this.seenIndex=st.vehicleNode.i,this.baseA=st.vehicleNode.a,this.angles.push(this.baseA),this.pA=this.baseA,this.pos.x=this.loadedNode.p.x,this.pos.y=this.loadedNode.p.z,d.addListener(this.onLoadStateBound),this.onLoadState(d.value)}onLoadState(e){e?I.removeSlowListener(this.onTickBound):I.addSlowListener(this.onTickBound)}makePoint(e,t){let i=this.svg.createSVGPoint();return i.x=e,i.y=t,i}destroy(){I.removeSlowListener(this.onTickBound),d.removeListener(this.onLoadStateBound)}onTick(e){if(this.lerp=Math.floor(((e,t,i)=>{let s,n,a,r,h,o;return a=i.p.x,r=i.p.z,h=i.next.p.x,o=i.next.p.z,s=(h-a)*(h-a)+(o-r)*(o-r),n=((e-a)*(h-a)+(t-r)*(o-r))/s,isNaN(n)?0:Math.max(Math.min(n,1),0)})(T.position.x,T.position.z,st.vehicleNode)*yc),!(this.loadedNode.i==st.vehicleNode.i+16&&this.lerp<=this.subNode)){for(;this.loadedNode.i<st.vehicleNode.i+16;){for(this.i=this.subNode;this.i<yc;this.i++)this.l=this.i/yc,this.l1=1-this.l,this.p=this.makePoint(this.loadedNode.p.x*this.l1+this.loadedNode.next.p.x*this.l,this.loadedNode.p.z*this.l1+this.loadedNode.next.p.z*this.l),this.points.appendItem(this.p),this.uPoints.appendItem(this.p),this.baseA-=this.loadedNode.next.da*Ic,this.angles.push(this.baseA);this.loadedNode=this.loadedNode.next,this.progressCounter++,this.progressCounter>100&&Math.abs(this.loadedNode.a-this.baseA)<.1&&(this.baseA=this.loadedNode.a,this.progressCounter=0),this.subNode=0}for(this.i=this.subNode;this.i<this.lerp;this.i++)this.l=this.i/yc,this.l1=1-this.l,this.p=this.makePoint(this.loadedNode.p.x*this.l1+this.loadedNode.next.p.x*this.l,this.loadedNode.p.z*this.l1+this.loadedNode.next.p.z*this.l),this.points.appendItem(this.p),this.uPoints.appendItem(this.p),this.baseA-=this.loadedNode.next.da*Ic,this.angles.push(this.baseA);for(this.subNode=this.lerp;this.points.length>256;)this.points.removeItem(0),this.uPoints.removeItem(0),this.angles.shift(),this.pos=this.points.getItem(0)}this.pA=.95*this.pA+.05*this.angles[0],this.transform="rotate("+(90-180*this.pA/Math.PI)+")",this.transform+=" translate("+-1*this.pos.x+" "+-1*this.pos.y+")",this.lineDOM.setAttribute("transform",this.transform),this.underlineDOM.setAttribute("transform",this.transform),this.circleDOM.setAttribute("cx",this.pos.x),this.circleDOM.setAttribute("cy",this.pos.y),this.circleDOM.setAttribute("transform",this.transform)}}var Nc=n.a.memo((()=>{const e=Object(s.useRef)(null),t=Object(s.useRef)(null),i=Object(s.useRef)(null),n=Object(s.useRef)(null),a=Object(s.useRef)(null),[r,h]=Object(s.useState)(j.value);return Object(s.useEffect)((()=>{if(null!==e.current&&null!==t.current&&null!==i.current&&null!==n.current)return a.current||(a.current=new Dc(e.current,t.current,i.current,n.current)),()=>{a.current&&a.current.destroy()}}),[e,t,i,n,a]),Object(s.useEffect)((()=>(j.addListener(h),()=>{j.removeListener(h)})),[h]),Object(sd.jsx)("div",{id:"upcoming-container",style:{opacity:r?"0":"1"},children:Object(sd.jsx)("svg",{ref:e,viewBox:"0 0 160 120",width:"100%",height:"100%",children:Object(sd.jsxs)("g",{transform:"translate(80 96) scale(-0.5 -0.5)",children:[Object(sd.jsx)("polyline",{ref:i,points:"",transform:"translate(0 0)",stroke:"#2224",strokeWidth:"24",strokeLinecap:"round",fill:"none"}),Object(sd.jsx)("polyline",{ref:t,points:"",transform:"translate(0 0)",stroke:"#fff9",strokeWidth:"12",strokeLinecap:"round",fill:"none"}),Object(sd.jsx)("circle",{ref:n,fill:"#444",r:"3"})]})})})}));i(50);const Mc={edge:{title:"The Edge",body:'"What did you expect?"'}};var Cc=()=>{const[e,t]=Object(s.useState)(null),[i,n]=Object(s.useState)(null);return Object(s.useEffect)((()=>(Vo.addListener("any",t),()=>{Vo.removeListener("any",t)})),[t]),Object(s.useEffect)((()=>{e&&n(Mc[e])}),[e,n]),null!==e&&setTimeout((()=>{t(null)}),5e3),Object(sd.jsx)("div",{id:"achievement",className:null!==e?"achievement-active":"",children:null!=i&&Object(sd.jsxs)(sd.Fragment,{children:[Object(sd.jsx)("div",{id:"achievement-title",children:i.title}),Object(sd.jsx)("div",{id:"achievement-body",children:i.body}),Object(sd.jsx)("div",{id:"achievement-unlocked",children:"achievement unlocked"})]})})};i(51);const jc=e=>{if("number"!==typeof e&&(e=parseFloat(e)),e<60)return e.toFixed(3);let t=Math.floor(e/60);return(e=(e-60*t).toFixed(3))<10&&(e="0"+e),t<10&&(t="0"+t),t+":"+e},kc=({view:e})=>Object(sd.jsxs)("div",{id:"ui-records-leaderboard",children:[Object(sd.jsxs)("div",{className:"ui-records-title",children:[Object(sd.jsx)("div",{children:"Records"}),Object(sd.jsxs)("div",{className:"ui-records-board-switch",children:[Object(sd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>$o.switchBoard(),children:"\u25c2"}),Object(sd.jsx)("div",{className:"ui-records-board-switch-value",children:e.board}),Object(sd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>$o.switchBoard(),children:"\u25b8"})]}),"global"==e.board&&Object(sd.jsxs)("div",{className:"ui-records-board-switch",children:[Object(sd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>$o.switchTime(),children:"\u25c2"}),Object(sd.jsx)("div",{className:"ui-records-board-switch-value",children:"allTime"==e.time?"all time":"daily"}),Object(sd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>$o.switchTime(),children:"\u25b8"})]})]}),"personal"==e.board?Object(sd.jsx)(zc,{topography:e.topography,vehicle:e.vehicle}):Object(sd.jsx)(Sc,{time:e.time,topography:e.topography,vehicle:e.vehicle})]}),zc=({topography:e,vehicle:t})=>{const[i,n]=Object(s.useState)(Ko.personal),a=Object(s.useCallback)((e=>{n({...e})}),[n]);Object(s.useEffect)((()=>(Ko.addListener("personal",a),()=>{Ko.removeListener("personal",a)})),[a]);const r=i[e][t];return Object(sd.jsxs)("div",{className:"ui-records-row",children:[Object(sd.jsx)("div",{className:"ui-records-record",children:"Fastest Mile:"}),Object(sd.jsx)("div",{className:"ui-records-value",children:r<0?"-":jc(r)})]})},Sc=({time:e,topography:t,vehicle:i})=>{var n,a;const[r,h]=Object(s.useState)($o.global);Object(s.useEffect)((()=>($o.addListener("global",h),()=>{$o.removeListener("global",h)})),[h]);let o=null;return r&&(o=r[e][t][i]),o?Object(sd.jsxs)("div",{className:"ui-records-row",children:[Object(sd.jsx)("div",{className:"ui-records-record",children:"Fastest Mile:"}),Object(sd.jsx)("div",{className:"ui-records-value",children:(null===(n=o)||void 0===n||null===(a=n.fastestMile)||void 0===a?void 0:a.value)>0?jc(o.fastestMile.value):"-"}),Object(sd.jsx)("div",{className:"ui-records-addendum",children:o.fastestMile.name})]}):Object(sd.jsx)("div",{className:"ui-records-row",style:{fontStyle:"italic"},children:"Could not connect"})},Oc=e=>{const[t,i]=Object(s.useState)(Ko.live),n=Object(s.useCallback)((e=>{i({...e})}),[i]);return Object(s.useEffect)((()=>(Ko.addListener("live",n),()=>{Ko.removeListener("live",n)})),[n]),Object(sd.jsxs)("div",{id:"ui-records-current",children:[Object(sd.jsx)("div",{className:"ui-records-title",children:"Current"}),Object(sd.jsxs)("div",{className:"ui-records-row",children:[Object(sd.jsx)("div",{className:"ui-records-record",children:"Fastest Mile:"}),Object(sd.jsx)("div",{className:"ui-records-value",children:t.value<0?"-":jc(t.value.toFixed(3))}),Object(sd.jsxs)("div",{className:"ui-records-addendum",children:[Object(sd.jsx)("div",{className:"ui-records-progress",children:Object(sd.jsx)("div",{className:"ui-records-progress-fill",style:{width:100*t.progress+"%"}})}),Object(sd.jsx)("img",{alt:"",src:gd,className:"ui-records-reset",onMouseDown:()=>{tl.resetFastestMile()}})]})]}),Object(sd.jsxs)("div",{className:"ui-records-row",children:[Object(sd.jsx)("div",{className:"ui-records-record",style:{fontSize:"14px",fontStyle:"italic"},children:"previous:"}),Object(sd.jsx)("div",{className:"ui-records-value",style:{fontSize:"12px"},children:t.prev<=0?"-":jc(t.prev)}),Object(sd.jsx)("div",{className:"ui-records-addendum",style:{fontSize:"10px"}})]})]})};var Lc=e=>{var t;const[i,n]=Object(s.useState)(el.value),[a,r]=Object(s.useState)($o.view);return Object(s.useEffect)((()=>(el.addListener(n),()=>{el.removeListener(n)})),[]),Object(s.useEffect)((()=>($o.addListener("view",r),()=>{$o.removeListener("view",r)})),[r]),i?Object(sd.jsxs)("div",{id:"ui-records-main",children:[Object(sd.jsxs)("div",{id:"ui-records-header",children:[Object(sd.jsx)("div",{id:"ui-records-title",children:"STATS"}),Object(sd.jsx)("div",{id:"ui-records-category",children:a.topography+" / "+(null===(t=a.vehicle)||void 0===t?void 0:t.toLowerCase())})]}),Object(sd.jsx)(kc,{view:a}),Object(sd.jsx)("br",{}),Object(sd.jsx)(Oc,{})]}):Object(sd.jsx)(sd.Fragment,{children:" "})};const Rc="reloading";let Tc=!1;if(!Bh.newUser)try{let e=JSON.parse(Bh.lastActiveTime);Tc=Date.now()-e<3e4}catch(Kc){}const Pc=!(Tc||null!==window.localStorage.getItem(Rc));window.localStorage.removeItem(Rc);const Gc=n.a.memo((()=>{const e=Object(s.useRef)(null),t=Object(s.useRef)(null),i=Object(s.useRef)(null),[n,a]=Object(s.useState)(Pc),[r,h]=Object(s.useState)(!0),[o,l]=Object(s.useState)(0),[d,c]=Object(s.useState)(null),[g,x]=Object(s.useState)(!Pc),[v,w]=Object(s.useState)(!1),f=Object(s.useCallback)((()=>{n?I.resume(!0):I.pause(!0),!g&&n&&x(!0),a(!n)}),[a,n,x,g]),b=Object(s.useCallback)((()=>{h(!r)}),[h,r]);Object(s.useEffect)((()=>(p.addListener(u.Esc,f),()=>{p.removeListener(u.Esc,f)})),[f]),Object(s.useEffect)((()=>(p.addListener(u.UI,b),()=>{p.removeListener(u.UI,b)})),[b]),Object(s.useEffect)((()=>(A.addListener(w),()=>{A.removeListener(w)})),[w]),Object(s.useEffect)((()=>{if(null===e.current||null===t.current)return;if(new ResizeObserver((t=>{i.current&&e.current&&i.current.setSize(e.current.offsetWidth,e.current.offsetHeight)})).observe(e.current),!i.current&&g){if(m)return;i.current=new ql(t.current,e.current,c,l),console.log("Making new sceneController and beginning"),i.current.beginGame()}return()=>{i.current}}),[g]);const y=o<1;return Object(sd.jsxs)("div",{id:"game-main",ref:e,tabIndex:1,className:"render-panel",children:[n&&Object(sd.jsx)(cd,{supported:!m,loadProgress:o,gameHasBegun:g,onClose:()=>{var e;f(),null===(e=i.current)||void 0===e||e.beginGame()}}),null!==d&&Object(sd.jsx)(Fc,{msg:d}),Object(sd.jsxs)("div",{id:"update-alert",onMouseDown:e=>{e.target.style.display="none"},children:[Object(sd.jsx)("div",{className:"update-alert-title",children:"New version available!"}),"Update with a hard refresh",Object(sd.jsx)("br",{}),"(CTRL + F5)"]}),g&&Object(sd.jsxs)("div",{id:"game-ui",style:{display:n||!r?"none":"block"},onContextMenu:e=>{e.preventDefault()},children:[Object(sd.jsx)(Ec,{}),Object(sd.jsx)(Cc,{}),Object(sd.jsx)(Zc,{sceneController:i}),Object(sd.jsx)("div",{id:"game-paused",onClick:()=>{v?A.disable():I.resume(!0)},children:1==v?Object(sd.jsxs)("div",{className:"game-paused-ha",children:["Critically low FPS detected - check you have hardware acceleration enabled for your browser.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),"You may have to check your browser settings, GPU control panel, or OS settings for your browser application.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),"Refresh the page to dismiss this message.",Object(sd.jsx)("br",{})]}):Object(sd.jsx)("div",{className:"game-paused-main",children:"PAUSED"})}),Object(sd.jsx)(Lc,{}),Object(sd.jsx)(Wc,{}),Object(sd.jsx)(Ac,{toggleSplash:f}),Object(sd.jsx)(bd,{}),y?Object(sd.jsx)(Bc,{loadProgress:o}):Object(sd.jsx)(Nc,{}),Object(sd.jsx)("div",{id:"game-ui-backing"})]}),Object(sd.jsxs)("div",{id:"ui-debug",children:[Object(sd.jsxs)("div",{className:"ui-debug-row",children:[Object(sd.jsx)("div",{className:"ui-debug-label",children:"Position:"}),Object(sd.jsx)("div",{id:"ui-debug-position",children:"1, 2, 3"})]}),Object(sd.jsxs)("div",{className:"ui-debug-row",children:[Object(sd.jsx)("div",{className:"ui-debug-label",children:"Far Coords:"}),Object(sd.jsx)("div",{id:"ui-debug-far-coords",children:"1, 2, 3"})]}),Object(sd.jsxs)("div",{className:"ui-debug-row",children:[Object(sd.jsx)("div",{className:"ui-debug-label",children:"Vehicle Node:"}),Object(sd.jsx)("div",{id:"ui-debug-node",children:"1"})]}),Object(sd.jsxs)("div",{className:"ui-debug-row",children:[Object(sd.jsx)("div",{className:"ui-debug-label",children:"Midline Tail:"}),Object(sd.jsx)("div",{id:"ui-debug-midline-tail",children:"123"})]}),Object(sd.jsx)("hr",{})]}),Object(sd.jsx)("canvas",{ref:t,className:"render-canvas",tabIndex:-1,onContextMenu:e=>{e.preventDefault()}})]})})),Bc=({loadProgress:e})=>Object(sd.jsx)("div",{id:"live-loader-bg",children:Object(sd.jsxs)("div",{id:"live-loader",children:[Object(sd.jsx)("div",{className:"live-load-text",children:Math.round(100*e)+"%"}),Object(sd.jsx)("div",{className:"live-load-bar",style:{width:100*e+"%"}}),Object(sd.jsx)("div",{className:"live-load-title",children:"generating..."})]})}),Wc=()=>{const[e,t]=Object(s.useState)(j.value);return Object(s.useEffect)((()=>(j.addListener(t),()=>{j.removeListener(t)})),[t]),Object(sd.jsxs)("div",{id:"autodrive",className:e?"autodrive-active":"",onMouseDown:()=>j.set(!e),children:[Object(sd.jsx)("div",{className:e?"autodrive-bar autodrive-bar-left autodrive-bar-active":"autodrive-bar autodrive-bar-left"}),Object(sd.jsxs)("div",{id:"autodrive-button",children:["autodrive ",e?"on":"off"]}),Object(sd.jsx)("div",{className:e?"autodrive-bar autodrive-bar-right autodrive-bar-active":"autodrive-bar autodrive-bar-right"})]})},Ec=()=>{const[e,t]=Object(s.useState)(hl.value),[i,n]=Object(s.useState)(hl.value);return Object(s.useEffect)((()=>(hl.addListener(t),()=>{hl.removeListener(t)})),[t]),Object(s.useEffect)((()=>{e!==il.None&&n(e)}),[e,n]),Object(sd.jsxs)("div",{id:"control-prompt",style:{opacity:hl.value},children:[i==il.Basic&&Object(sd.jsxs)(sd.Fragment,{children:[Object(sd.jsxs)("div",{children:[Object(sd.jsx)("div",{className:"control-key-row",children:Object(sd.jsx)("div",{className:"control-key",children:"W"})}),Object(sd.jsxs)("div",{className:"control-key-row",children:[Object(sd.jsx)("div",{className:"control-key",children:"A"}),Object(sd.jsx)("div",{className:"control-key",children:"S"}),Object(sd.jsx)("div",{className:"control-key",children:"D"})]}),Object(sd.jsx)("div",{className:"control-label",children:"drive"})]}),Object(sd.jsxs)("div",{style:{width:"18vh"},children:[Object(sd.jsxs)("div",{className:"control-key-row",style:{marginTop:"5.8vh"},children:[Object(sd.jsx)("div",{className:"control-key",children:"Q"}),Object(sd.jsx)("div",{className:"control-key",children:"E"})]}),Object(sd.jsx)("div",{className:"control-label",children:"change setting"})]}),Object(sd.jsxs)("div",{style:{width:"18vh"},children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"5.8vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"C"})}),Object(sd.jsx)("div",{className:"control-label",children:"change camera"})]}),Object(sd.jsxs)("div",{style:{width:"18vh"},children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"5.8vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"F"})}),Object(sd.jsx)("div",{className:"control-label",children:"toggle autodrive"})]})]}),i==il.Reset&&Object(sd.jsxs)("div",{style:{width:"18vh"},children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",children:"R"})}),Object(sd.jsx)("div",{className:"control-label",children:"stay on the road"})]}),i==il.Boost&&Object(sd.jsxs)("div",{style:{width:"18vh"},children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("div",{className:"control-key",style:{width:"8vh"},children:"shift"})}),Object(sd.jsx)("div",{className:"control-label",children:"hold to boost acceleration"})]}),i==il.UTurn&&Object(sd.jsxs)("div",{style:{width:"18vh"},children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("img",{id:"wrong-way-icon",src:_l,alt:""})}),Object(sd.jsx)("div",{className:"control-label",children:"wrong way"})]}),i==il.Reverse&&Object(sd.jsxs)("div",{style:{width:"18vh"},children:[Object(sd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(sd.jsx)("img",{id:"wrong-way-icon",src:$l,alt:""})}),Object(sd.jsx)("div",{className:"control-label",children:"keep moving forward"})]})]})},Zc=({sceneController:e})=>{const[t,i]=Object(s.useState)(Rh.input);Object(s.useEffect)((()=>(Rh.addListener("input",i),()=>Rh.removeListener("input",i))),[i]);const n=t==jh;return Object(sd.jsxs)("div",{id:"ui-mouse",style:{bottom:"calc("+Fo.mouseWidgetHeight+"vh + 25px)",display:n?"block":"none"},children:[Object(sd.jsx)("div",{id:"ui-mouse-prompt",children:"[ click to begin ]"}),Object(sd.jsxs)("div",{id:"ui-mouse-input",children:[Object(sd.jsxs)("div",{className:"ui-mouse-bar",children:[Object(sd.jsx)("div",{className:"ui-mouse-bar-line"}),Object(sd.jsx)("div",{className:"ui-mouse-bar-midline"})]}),Object(sd.jsx)("div",{id:"ui-mouse-bar-marker",children:Object(sd.jsx)("div",{className:"ui-mouse-bar-marker-tick"})})]}),Object(sd.jsx)("div",{className:"ui-mouse-bar-boundary"}),Object(sd.jsx)("div",{className:"ui-mouse-reset",onMouseDown:t=>{var i;null===(i=e.current)||void 0===i||i.resetVehicle(),t.preventDefault(),t.stopPropagation()},children:"reset"})]})},Fc=({msg:e})=>Object(sd.jsxs)("div",{id:"game-error",children:[Object(sd.jsx)("img",{id:"game-error-icon",src:Kl,alt:""}),Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),Object(sd.jsx)("div",{id:"game-error-title",children:"Critical Error"}),Object(sd.jsx)("br",{}),Object(sd.jsxs)("div",{id:"game-error-message",children:["Apologies - please click below to continue with a different generation seed. Your distance progress will carry over.",Object(sd.jsx)("br",{}),Object(sd.jsx)("br",{}),"This error has been recorded for investigation."]}),Object(sd
.jsx)("br",{}),Object(sd.jsx)("br",{}),Object(sd.jsx)("div",{id:"game-error-reload",onMouseDown:()=>{window.localStorage.setItem("restore-progress",st.vehicleIndex-st.initIndex+wh.accumulatedProgress),qe(null,!0)},children:"reload"})]});var Hc=Gc;const Qc=()=>Object(sd.jsx)("div",{className:"App",children:Object(sd.jsx)(Hc,{})});var Yc=function(){return Object(sd.jsx)(Qc,{})};i(27),i(3),i(52);sd.Fragment,sd.Fragment,sd.Fragment;i(53);const Vc={sessionCount:0,pastSessionCount:0,averages:{duration:0,distance:0,resetCount:0,skins:{},difficultyResets:{easy:0,normal:0,hard:0},skinChanges:0,weatherChanges:0,vehicleChanges:0,driveModeChanges:0,cruiseControlSpeed:0,fps:0,autodriveTime:0},maxes:{duration:0,distance:0},cumulatives:{difficulty:{easy:0,normal:0,hard:0},totalVisits:0,viewDistance:[],detailLevel:[],returningPlayers:0,revisits:0,skinTimes:{},driveModeTimes:{},stickySteer:0,cruiseControlUses:0,browser:{},hourlyVisits:[],lowFPS:0,lowFPSBrowser:{},lowFPSResolution:{},lowFPSView:[0,0,0,0],lowFPSDetail:[0,0,0,0],location:{}},poorPerformance:[],activeSessions:{},feedback:[],quarterlyActiveSessions:[],quarterlyCumulativeSessions:[],pastSessions:[],upTime:0};new class{constructor(){this.connected=!1,this.sessionCount=0,this.pastSessionCount=0,this.averages={duration:0,distance:0,resetCount:0,skins:{},difficultyResets:{easy:0,normal:0,hard:0},skinChanges:0,weatherChanges:0,vehicleChanges:0,driveModeChanges:0,autodriveTime:0},this.maxes={duration:0,distance:0},this.cumulatives={totalVisits:0,revisits:0,mobileVisits:0,returningPlayers:0,difficulty:{easy:0,normal:0,hard:0},viewDistance:[],detailLevel:[],skinTimes:{},driveModeTimes:{},hourlyVisits:[],browser:{}},this.activeSessions={},this.feedback=[],this.quarterlyActiveSessions=[],this.quarterlyCumulativeSessions=[],this.poorPerformance=[],this.pastSessions=[],this.upTime=0,this.callbacks={},this.setConnected=()=>{};for(let e in Vc)this.callbacks[e]=()=>{}}initialise(){this.connected||(console.log("yada yada"),this.socket=Object(_e.a)(Yh),this.socket.on("connect",(()=>{console.log("Got connect"),this.socket.emit("request-dash",window.location.hash.slice(1))})),this.socket.on("connect_error",(()=>{this.setConnected(!1)})),this.socket.on("disconnect",(()=>{this.setConnected(!1)})),this.socket.on("authenticated",(e=>{console.log("Authenticated"),console.log(e),this.connected=!0,this.setConnected(!0),this.parseData(e)})),this.socket.on("dash-update",(e=>{this.parseData(e)})))}parseData(e){for(let t in e)"dashSessionCount"!==t&&"dashSessions"!==t&&(this[t]=e[t],"averages"==t&&(e.averages.autodriveTime=Uc(e.averages.autodriveTime),e.averages.duration=Uc(e.averages.duration)),this.callbacks[t](this[t]))}addCallback(e,t){this.callbacks[e]=t}};function Uc(e){let t=e/1e3,i=t/60;t%=60;let s=i/60;return i%=60,Xc(Math.floor(s))+":"+Xc(Math.floor(i))+":"+Xc(Math.floor(t))}function Xc(e){return e<10?"0"+e:""+e}const Jc={layer:0,d:0,h:0,sq:0,sqb:0,wx:0,wz:0,ox:0,oz:0,px:0,pz:0,cell:null,ix:0,iz:0,depth:0};new h.Q({uniforms:{groundCol:{value:new h.i(4473924)}},vertexShader:"\n  attribute float gradient;\n\n  varying vec4 col;\n\n  varying float height;\n  varying float vGradient;\n\n  void main() {\n    vec4 wPos = modelMatrix * vec4( position, 1.0 );\n\n    // col.x = 0.5;\n    // col.y = wPos.y / 1000.0; // Height range between black and white // doesn't get used\n    // col.z = 0.5;\n    // col.w = 1.0;\n\n    height = wPos.y / 200.0; // clamp between 0 and 1 if possible? choose something matched to scene, 200m max range\n\n    vGradient = gradient;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position.x, 0.0, position.z, 1.0 );\n  }\n",fragmentShader:"\n\nvarying vec4 col;\nvarying float height;\nvarying float vGradient;\n\nvoid main() {\n\n  float hh = mod(height * 200.0, 5.0); // mod is spacing between lines, height converted back to metres\n\n  // swap - and pos tan for whack art\n  // Use atan for more accurate version\n\n  float boundA = 0.1 + vGradient * 0.25;// + tan(vGradient);//*vGradient*0.25;\n\n  float addB = 0.1 + vGradient * 0.25;\n  float boundB = 5.0 - addB;\n\n  if(hh < boundA) {\n    if(hh < boundA * 0.6) {\n      hh = 0.0;\n    } else {\n      hh = (hh - boundA * 0.6) / (boundA * 0.4);\n    }\n  } else if(hh > boundB) {\n    if(hh > 5.0 - (addB * 0.4)) {\n      hh = 1.0 - (hh - (addB * 0.4)) / (addB * 0.6);\n    } else {\n      hh = 1.0;\n    }\n  } else {\n    hh = 1.0;\n  }\n\n  vec3 base = vec3(0.0, 0.0, 0.0);\n  // vec3 base = vec3(height);\n  vec3 topo = vec3(hh, hh, hh);\n\n  gl_FragColor = vec4(mix(base, topo, 1.0), 1.0);\n}\n\n"}),new h.a(16777215,.1),new h.s(16777215,16777215,.2),new h.j(16777215,.6);var qc=e=>{e&&e instanceof Function&&i.e(3).then(i.bind(null,55)).then((({getCLS:t,getFID:i,getFCP:s,getLCP:n,getTTFB:a})=>{t(e),i(e),s(e),n(e),a(e)}))};r.a.render(Object(sd.jsx)(n.a.StrictMode,{children:Object(sd.jsx)(Yc,{})}),document.getElementById("root")),qc()}],[[54,1,2]]]);
</script>    <script src=""></script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script type="text/javascript">
    window.SDK_OPTIONS = {
        gameId: "r2tzpy9cgrn2u4xgzc9z0zbtvxm16mby",
        onEvent: function(a) {
            switch (a.name) {
                case "SDK_GAME_PAUSE":
                    // pause game logic / mute audio
                    break;
                case "SDK_GAME_START":
                    // advertisement done, resume game logic and unmute audio
                    break;
                case "SDK_READY":
                    // when sdk is ready
                    break;
            }
        }
    };
    (function(a, b, c) {
        var d = a.getElementsByTagName(b)[0];
        a.getElementById(c) || (a = a.createElement(b), a.id = c, a.src = "", d.parentNode.insertBefore(a, d))
    })(document, "script", "gamemonetize-sdk");
</script>

<script type="text/javascript">
    let isAdShown = false;

    function onClick(e) {
        if (!isAdShown && typeof sdk !== 'undefined' && typeof sdk.showBanner === 'function') {
            sdk.showBanner(); 
            isAdShown = true; 
        }

        window.removeEventListener("click", onClick); 
        init(); 
    }

    window.addEventListener("click", onClick);
</script>





<iframe name="google_video_inner_static_iframe" id="google_video_inner_static_iframe" src="about:blank" style="height: 0px; width: 0px; display:none"></iframe><div style="position: fixed; top: 0px; cursor: pointer; opacity: 0.9; z-index: 10000; right: 0px; display: none;"><canvas width="80" height="48" style="width: 80px; height: 48px; display: block;"></canvas><canvas width="80" height="48" style="width: 80px; height: 48px; display: none;"></canvas><canvas width="80" height="48" style="width: 80px; height: 48px; display: none;"></canvas></div><div id="sdk__baguette" style="z-index: 100; position: absolute; top: 0px; left: 0px;"></div></body></html>