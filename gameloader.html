<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script>
      location.href = "/";
    </script>
  <title>Game Loader</title>
  <link rel="stylesheet" href="css/games.css" />
</head>
<body>
  <div class="loader-page">
    <div class="loader-wrapper">
      <div id="gameContainer"></div>
      <footer class="loader-footer">
        <div class="branding">
          <img src="assets/nexora-logo.png" alt="Nexora Logo" />
          <span>Nexora</span>
        </div>
        <button id="fullscreenBtn" class="fullscreen-btn">
          <img src="assets/full-screen-icon.svg" alt="Full Screen" />
        </button>
      </footer>
    </div>
  </div>

  <script>
    function initLoader() {
      const allGames    = JSON.parse(sessionStorage.getItem("gamesList")    || "[]");
      const currentGame = JSON.parse(sessionStorage.getItem("currentGame") || "null");
      if (!currentGame) {
        location.href = "game.html";
        return;
      }

      const container = document.getElementById("gameContainer");
      const fsBtn     = document.getElementById("fullscreenBtn");

      container.innerHTML = `
        <div class="loader-start">
          <img src="${currentGame.thumbnail}" alt="${currentGame.title}" />
          <h2 class="game-title">${currentGame.title}</h2>
          <button id="playBtn" class="play-btn">Play Now</button>
        </div>
      `;

      document.getElementById("playBtn").onclick = () => {
        const iframe = document.createElement("iframe");
        iframe.src = currentGame.file;
        iframe.setAttribute("allowfullscreen", "");
        iframe.frameBorder = 0;
        iframe.className = "game-iframe";
        container.innerHTML = "";
        container.appendChild(iframe);
      };

      fsBtn.onclick = () => {
        const el = container.querySelector(".game-iframe") || container;
        if (el.requestFullscreen) el.requestFullscreen();
        else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
      };
    }

    initLoader();

  </script>
</body>
</html>
